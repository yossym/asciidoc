<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="generator" content="Asciidoctor 2.0.12">
<meta name="author" content="yossym">
<title>VBA</title>
<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:300,300italic,400,400italic,600,600italic%7CNoto+Serif:400,400italic,700,700italic%7CDroid+Sans+Mono:400,700">
<style>
/* Asciidoctor default stylesheet | MIT License | https://asciidoctor.org */
/* Uncomment @import statement to use as custom stylesheet */
/*@import "https://fonts.googleapis.com/css?family=Open+Sans:300,300italic,400,400italic,600,600italic%7CNoto+Serif:400,400italic,700,700italic%7CDroid+Sans+Mono:400,700";*/
article,aside,details,figcaption,figure,footer,header,hgroup,main,nav,section{display:block}
audio,video{display:inline-block}
audio:not([controls]){display:none;height:0}
html{font-family:sans-serif;-ms-text-size-adjust:100%;-webkit-text-size-adjust:100%}
a{background:none}
a:focus{outline:thin dotted}
a:active,a:hover{outline:0}
h1{font-size:2em;margin:.67em 0}
abbr[title]{border-bottom:1px dotted}
b,strong{font-weight:bold}
dfn{font-style:italic}
hr{-moz-box-sizing:content-box;box-sizing:content-box;height:0}
mark{background:#ff0;color:#000}
code,kbd,pre,samp{font-family:monospace;font-size:1em}
pre{white-space:pre-wrap}
q{quotes:"\201C" "\201D" "\2018" "\2019"}
small{font-size:80%}
sub,sup{font-size:75%;line-height:0;position:relative;vertical-align:baseline}
sup{top:-.5em}
sub{bottom:-.25em}
img{border:0}
svg:not(:root){overflow:hidden}
figure{margin:0}
fieldset{border:1px solid silver;margin:0 2px;padding:.35em .625em .75em}
legend{border:0;padding:0}
button,input,select,textarea{font-family:inherit;font-size:100%;margin:0}
button,input{line-height:normal}
button,select{text-transform:none}
button,html input[type="button"],input[type="reset"],input[type="submit"]{-webkit-appearance:button;cursor:pointer}
button[disabled],html input[disabled]{cursor:default}
input[type="checkbox"],input[type="radio"]{box-sizing:border-box;padding:0}
button::-moz-focus-inner,input::-moz-focus-inner{border:0;padding:0}
textarea{overflow:auto;vertical-align:top}
table{border-collapse:collapse;border-spacing:0}
*,*::before,*::after{-moz-box-sizing:border-box;-webkit-box-sizing:border-box;box-sizing:border-box}
html,body{font-size:100%}
body{background:#fff;color:rgba(0,0,0,.8);padding:0;margin:0;font-family:"Noto Serif","DejaVu Serif",serif;font-weight:400;font-style:normal;line-height:1;position:relative;cursor:auto;tab-size:4;word-wrap:anywhere;-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased}
a:hover{cursor:pointer}
img,object,embed{max-width:100%;height:auto}
object,embed{height:100%}
img{-ms-interpolation-mode:bicubic}
.left{float:left!important}
.right{float:right!important}
.text-left{text-align:left!important}
.text-right{text-align:right!important}
.text-center{text-align:center!important}
.text-justify{text-align:justify!important}
.hide{display:none}
img,object,svg{display:inline-block;vertical-align:middle}
textarea{height:auto;min-height:50px}
select{width:100%}
.subheader,.admonitionblock td.content>.title,.audioblock>.title,.exampleblock>.title,.imageblock>.title,.listingblock>.title,.literalblock>.title,.stemblock>.title,.openblock>.title,.paragraph>.title,.quoteblock>.title,table.tableblock>.title,.verseblock>.title,.videoblock>.title,.dlist>.title,.olist>.title,.ulist>.title,.qlist>.title,.hdlist>.title{line-height:1.45;color:#7a2518;font-weight:400;margin-top:0;margin-bottom:.25em}
div,dl,dt,dd,ul,ol,li,h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6,pre,form,p,blockquote,th,td{margin:0;padding:0}
a{color:#2156a5;text-decoration:underline;line-height:inherit}
a:hover,a:focus{color:#1d4b8f}
a img{border:0}
p{font-family:inherit;font-weight:400;font-size:1em;line-height:1.6;margin-bottom:1.25em;text-rendering:optimizeLegibility}
p aside{font-size:.875em;line-height:1.35;font-style:italic}
h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6{font-family:"Open Sans","DejaVu Sans",sans-serif;font-weight:300;font-style:normal;color:#ba3925;text-rendering:optimizeLegibility;margin-top:1em;margin-bottom:.5em;line-height:1.0125em}
h1 small,h2 small,h3 small,#toctitle small,.sidebarblock>.content>.title small,h4 small,h5 small,h6 small{font-size:60%;color:#e99b8f;line-height:0}
h1{font-size:2.125em}
h2{font-size:1.6875em}
h3,#toctitle,.sidebarblock>.content>.title{font-size:1.375em}
h4,h5{font-size:1.125em}
h6{font-size:1em}
hr{border:solid #dddddf;border-width:1px 0 0;clear:both;margin:1.25em 0 1.1875em;height:0}
em,i{font-style:italic;line-height:inherit}
strong,b{font-weight:bold;line-height:inherit}
small{font-size:60%;line-height:inherit}
code{font-family:"Droid Sans Mono","DejaVu Sans Mono",monospace;font-weight:400;color:rgba(0,0,0,.9)}
ul,ol,dl{font-size:1em;line-height:1.6;margin-bottom:1.25em;list-style-position:outside;font-family:inherit}
ul,ol{margin-left:1.5em}
ul li ul,ul li ol{margin-left:1.25em;margin-bottom:0;font-size:1em}
ul.square li ul,ul.circle li ul,ul.disc li ul{list-style:inherit}
ul.square{list-style-type:square}
ul.circle{list-style-type:circle}
ul.disc{list-style-type:disc}
ol li ul,ol li ol{margin-left:1.25em;margin-bottom:0}
dl dt{margin-bottom:.3125em;font-weight:bold}
dl dd{margin-bottom:1.25em}
abbr,acronym{text-transform:uppercase;font-size:90%;color:rgba(0,0,0,.8);border-bottom:1px dotted #ddd;cursor:help}
abbr{text-transform:none}
blockquote{margin:0 0 1.25em;padding:.5625em 1.25em 0 1.1875em;border-left:1px solid #ddd}
blockquote cite{display:block;font-size:.9375em;color:rgba(0,0,0,.6)}
blockquote cite::before{content:"\2014 \0020"}
blockquote cite a,blockquote cite a:visited{color:rgba(0,0,0,.6)}
blockquote,blockquote p{line-height:1.6;color:rgba(0,0,0,.85)}
@media screen and (min-width:768px){h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6{line-height:1.2}
h1{font-size:2.75em}
h2{font-size:2.3125em}
h3,#toctitle,.sidebarblock>.content>.title{font-size:1.6875em}
h4{font-size:1.4375em}}
table{background:#fff;margin-bottom:1.25em;border:solid 1px #dedede;word-wrap:normal}
table thead,table tfoot{background:#f7f8f7}
table thead tr th,table thead tr td,table tfoot tr th,table tfoot tr td{padding:.5em .625em .625em;font-size:inherit;color:rgba(0,0,0,.8);text-align:left}
table tr th,table tr td{padding:.5625em .625em;font-size:inherit;color:rgba(0,0,0,.8)}
table tr.even,table tr.alt{background:#f8f8f7}
table thead tr th,table tfoot tr th,table tbody tr td,table tr td,table tfoot tr td{line-height:1.6}
h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6{line-height:1.2;word-spacing:-.05em}
h1 strong,h2 strong,h3 strong,#toctitle strong,.sidebarblock>.content>.title strong,h4 strong,h5 strong,h6 strong{font-weight:400}
.center{margin-left:auto;margin-right:auto}
.stretch{width:100%}
.clearfix::before,.clearfix::after,.float-group::before,.float-group::after{content:" ";display:table}
.clearfix::after,.float-group::after{clear:both}
:not(pre).nobreak{word-wrap:normal}
:not(pre).nowrap{white-space:nowrap}
:not(pre).pre-wrap{white-space:pre-wrap}
:not(pre):not([class^=L])>code{font-size:.9375em;font-style:normal!important;letter-spacing:0;padding:.1em .5ex;word-spacing:-.15em;background:#f7f7f8;-webkit-border-radius:4px;border-radius:4px;line-height:1.45;text-rendering:optimizeSpeed}
pre{color:rgba(0,0,0,.9);font-family:"Droid Sans Mono","DejaVu Sans Mono",monospace;line-height:1.45;text-rendering:optimizeSpeed}
pre code,pre pre{color:inherit;font-size:inherit;line-height:inherit}
pre>code{display:block}
pre.nowrap,pre.nowrap pre{white-space:pre;word-wrap:normal}
em em{font-style:normal}
strong strong{font-weight:400}
.keyseq{color:rgba(51,51,51,.8)}
kbd{font-family:"Droid Sans Mono","DejaVu Sans Mono",monospace;display:inline-block;color:rgba(0,0,0,.8);font-size:.65em;line-height:1.45;background:#f7f7f7;border:1px solid #ccc;-webkit-border-radius:3px;border-radius:3px;-webkit-box-shadow:0 1px 0 rgba(0,0,0,.2),0 0 0 .1em white inset;box-shadow:0 1px 0 rgba(0,0,0,.2),0 0 0 .1em #fff inset;margin:0 .15em;padding:.2em .5em;vertical-align:middle;position:relative;top:-.1em;white-space:nowrap}
.keyseq kbd:first-child{margin-left:0}
.keyseq kbd:last-child{margin-right:0}
.menuseq,.menuref{color:#000}
.menuseq b:not(.caret),.menuref{font-weight:inherit}
.menuseq{word-spacing:-.02em}
.menuseq b.caret{font-size:1.25em;line-height:.8}
.menuseq i.caret{font-weight:bold;text-align:center;width:.45em}
b.button::before,b.button::after{position:relative;top:-1px;font-weight:400}
b.button::before{content:"[";padding:0 3px 0 2px}
b.button::after{content:"]";padding:0 2px 0 3px}
p a>code:hover{color:rgba(0,0,0,.9)}
#header,#content,#footnotes,#footer{width:100%;margin-left:auto;margin-right:auto;margin-top:0;margin-bottom:0;max-width:62.5em;*zoom:1;position:relative;padding-left:.9375em;padding-right:.9375em}
#header::before,#header::after,#content::before,#content::after,#footnotes::before,#footnotes::after,#footer::before,#footer::after{content:" ";display:table}
#header::after,#content::after,#footnotes::after,#footer::after{clear:both}
#content{margin-top:1.25em}
#content::before{content:none}
#header>h1:first-child{color:rgba(0,0,0,.85);margin-top:2.25rem;margin-bottom:0}
#header>h1:first-child+#toc{margin-top:8px;border-top:1px solid #dddddf}
#header>h1:only-child,body.toc2 #header>h1:nth-last-child(2){border-bottom:1px solid #dddddf;padding-bottom:8px}
#header .details{border-bottom:1px solid #dddddf;line-height:1.45;padding-top:.25em;padding-bottom:.25em;padding-left:.25em;color:rgba(0,0,0,.6);display:-ms-flexbox;display:-webkit-flex;display:flex;-ms-flex-flow:row wrap;-webkit-flex-flow:row wrap;flex-flow:row wrap}
#header .details span:first-child{margin-left:-.125em}
#header .details span.email a{color:rgba(0,0,0,.85)}
#header .details br{display:none}
#header .details br+span::before{content:"\00a0\2013\00a0"}
#header .details br+span.author::before{content:"\00a0\22c5\00a0";color:rgba(0,0,0,.85)}
#header .details br+span#revremark::before{content:"\00a0|\00a0"}
#header #revnumber{text-transform:capitalize}
#header #revnumber::after{content:"\00a0"}
#content>h1:first-child:not([class]){color:rgba(0,0,0,.85);border-bottom:1px solid #dddddf;padding-bottom:8px;margin-top:0;padding-top:1rem;margin-bottom:1.25rem}
#toc{border-bottom:1px solid #e7e7e9;padding-bottom:.5em}
#toc>ul{margin-left:.125em}
#toc ul.sectlevel0>li>a{font-style:italic}
#toc ul.sectlevel0 ul.sectlevel1{margin:.5em 0}
#toc ul{font-family:"Open Sans","DejaVu Sans",sans-serif;list-style-type:none}
#toc li{line-height:1.3334;margin-top:.3334em}
#toc a{text-decoration:none}
#toc a:active{text-decoration:underline}
#toctitle{color:#7a2518;font-size:1.2em}
@media screen and (min-width:768px){#toctitle{font-size:1.375em}
body.toc2{padding-left:15em;padding-right:0}
#toc.toc2{margin-top:0!important;background:#f8f8f7;position:fixed;width:15em;left:0;top:0;border-right:1px solid #e7e7e9;border-top-width:0!important;border-bottom-width:0!important;z-index:1000;padding:1.25em 1em;height:100%;overflow:auto}
#toc.toc2 #toctitle{margin-top:0;margin-bottom:.8rem;font-size:1.2em}
#toc.toc2>ul{font-size:.9em;margin-bottom:0}
#toc.toc2 ul ul{margin-left:0;padding-left:1em}
#toc.toc2 ul.sectlevel0 ul.sectlevel1{padding-left:0;margin-top:.5em;margin-bottom:.5em}
body.toc2.toc-right{padding-left:0;padding-right:15em}
body.toc2.toc-right #toc.toc2{border-right-width:0;border-left:1px solid #e7e7e9;left:auto;right:0}}
@media screen and (min-width:1280px){body.toc2{padding-left:20em;padding-right:0}
#toc.toc2{width:20em}
#toc.toc2 #toctitle{font-size:1.375em}
#toc.toc2>ul{font-size:.95em}
#toc.toc2 ul ul{padding-left:1.25em}
body.toc2.toc-right{padding-left:0;padding-right:20em}}
#content #toc{border-style:solid;border-width:1px;border-color:#e0e0dc;margin-bottom:1.25em;padding:1.25em;background:#f8f8f7;-webkit-border-radius:4px;border-radius:4px}
#content #toc>:first-child{margin-top:0}
#content #toc>:last-child{margin-bottom:0}
#footer{max-width:none;background:rgba(0,0,0,.8);padding:1.25em}
#footer-text{color:rgba(255,255,255,.8);line-height:1.44}
#content{margin-bottom:.625em}
.sect1{padding-bottom:.625em}
@media screen and (min-width:768px){#content{margin-bottom:1.25em}
.sect1{padding-bottom:1.25em}}
.sect1:last-child{padding-bottom:0}
.sect1+.sect1{border-top:1px solid #e7e7e9}
#content h1>a.anchor,h2>a.anchor,h3>a.anchor,#toctitle>a.anchor,.sidebarblock>.content>.title>a.anchor,h4>a.anchor,h5>a.anchor,h6>a.anchor{position:absolute;z-index:1001;width:1.5ex;margin-left:-1.5ex;display:block;text-decoration:none!important;visibility:hidden;text-align:center;font-weight:400}
#content h1>a.anchor::before,h2>a.anchor::before,h3>a.anchor::before,#toctitle>a.anchor::before,.sidebarblock>.content>.title>a.anchor::before,h4>a.anchor::before,h5>a.anchor::before,h6>a.anchor::before{content:"\00A7";font-size:.85em;display:block;padding-top:.1em}
#content h1:hover>a.anchor,#content h1>a.anchor:hover,h2:hover>a.anchor,h2>a.anchor:hover,h3:hover>a.anchor,#toctitle:hover>a.anchor,.sidebarblock>.content>.title:hover>a.anchor,h3>a.anchor:hover,#toctitle>a.anchor:hover,.sidebarblock>.content>.title>a.anchor:hover,h4:hover>a.anchor,h4>a.anchor:hover,h5:hover>a.anchor,h5>a.anchor:hover,h6:hover>a.anchor,h6>a.anchor:hover{visibility:visible}
#content h1>a.link,h2>a.link,h3>a.link,#toctitle>a.link,.sidebarblock>.content>.title>a.link,h4>a.link,h5>a.link,h6>a.link{color:#ba3925;text-decoration:none}
#content h1>a.link:hover,h2>a.link:hover,h3>a.link:hover,#toctitle>a.link:hover,.sidebarblock>.content>.title>a.link:hover,h4>a.link:hover,h5>a.link:hover,h6>a.link:hover{color:#a53221}
details,.audioblock,.imageblock,.literalblock,.listingblock,.stemblock,.videoblock{margin-bottom:1.25em}
details>summary:first-of-type{cursor:pointer;display:list-item;outline:none;margin-bottom:.75em}
.admonitionblock td.content>.title,.audioblock>.title,.exampleblock>.title,.imageblock>.title,.listingblock>.title,.literalblock>.title,.stemblock>.title,.openblock>.title,.paragraph>.title,.quoteblock>.title,table.tableblock>.title,.verseblock>.title,.videoblock>.title,.dlist>.title,.olist>.title,.ulist>.title,.qlist>.title,.hdlist>.title{text-rendering:optimizeLegibility;text-align:left;font-family:"Noto Serif","DejaVu Serif",serif;font-size:1rem;font-style:italic}
table.tableblock.fit-content>caption.title{white-space:nowrap;width:0}
.paragraph.lead>p,#preamble>.sectionbody>[class="paragraph"]:first-of-type p{font-size:1.21875em;line-height:1.6;color:rgba(0,0,0,.85)}
table.tableblock #preamble>.sectionbody>[class="paragraph"]:first-of-type p{font-size:inherit}
.admonitionblock>table{border-collapse:separate;border:0;background:none;width:100%}
.admonitionblock>table td.icon{text-align:center;width:80px}
.admonitionblock>table td.icon img{max-width:none}
.admonitionblock>table td.icon .title{font-weight:bold;font-family:"Open Sans","DejaVu Sans",sans-serif;text-transform:uppercase}
.admonitionblock>table td.content{padding-left:1.125em;padding-right:1.25em;border-left:1px solid #dddddf;color:rgba(0,0,0,.6);word-wrap:anywhere}
.admonitionblock>table td.content>:last-child>:last-child{margin-bottom:0}
.exampleblock>.content{border-style:solid;border-width:1px;border-color:#e6e6e6;margin-bottom:1.25em;padding:1.25em;background:#fff;-webkit-border-radius:4px;border-radius:4px}
.exampleblock>.content>:first-child{margin-top:0}
.exampleblock>.content>:last-child{margin-bottom:0}
.sidebarblock{border-style:solid;border-width:1px;border-color:#dbdbd6;margin-bottom:1.25em;padding:1.25em;background:#f3f3f2;-webkit-border-radius:4px;border-radius:4px}
.sidebarblock>:first-child{margin-top:0}
.sidebarblock>:last-child{margin-bottom:0}
.sidebarblock>.content>.title{color:#7a2518;margin-top:0;text-align:center}
.exampleblock>.content>:last-child>:last-child,.exampleblock>.content .olist>ol>li:last-child>:last-child,.exampleblock>.content .ulist>ul>li:last-child>:last-child,.exampleblock>.content .qlist>ol>li:last-child>:last-child,.sidebarblock>.content>:last-child>:last-child,.sidebarblock>.content .olist>ol>li:last-child>:last-child,.sidebarblock>.content .ulist>ul>li:last-child>:last-child,.sidebarblock>.content .qlist>ol>li:last-child>:last-child{margin-bottom:0}
.literalblock pre,.listingblock>.content>pre{-webkit-border-radius:4px;border-radius:4px;overflow-x:auto;padding:1em;font-size:.8125em}
@media screen and (min-width:768px){.literalblock pre,.listingblock>.content>pre{font-size:.90625em}}
@media screen and (min-width:1280px){.literalblock pre,.listingblock>.content>pre{font-size:1em}}
.literalblock pre,.listingblock>.content>pre:not(.highlight),.listingblock>.content>pre[class="highlight"],.listingblock>.content>pre[class^="highlight "]{background:#f7f7f8}
.literalblock.output pre{color:#f7f7f8;background:rgba(0,0,0,.9)}
.listingblock>.content{position:relative}
.listingblock code[data-lang]::before{display:none;content:attr(data-lang);position:absolute;font-size:.75em;top:.425rem;right:.5rem;line-height:1;text-transform:uppercase;color:inherit;opacity:.5}
.listingblock:hover code[data-lang]::before{display:block}
.listingblock.terminal pre .command::before{content:attr(data-prompt);padding-right:.5em;color:inherit;opacity:.5}
.listingblock.terminal pre .command:not([data-prompt])::before{content:"$"}
.listingblock pre.highlightjs{padding:0}
.listingblock pre.highlightjs>code{padding:1em;-webkit-border-radius:4px;border-radius:4px}
.listingblock pre.prettyprint{border-width:0}
.prettyprint{background:#f7f7f8}
pre.prettyprint .linenums{line-height:1.45;margin-left:2em}
pre.prettyprint li{background:none;list-style-type:inherit;padding-left:0}
pre.prettyprint li code[data-lang]::before{opacity:1}
pre.prettyprint li:not(:first-child) code[data-lang]::before{display:none}
table.linenotable{border-collapse:separate;border:0;margin-bottom:0;background:none}
table.linenotable td[class]{color:inherit;vertical-align:top;padding:0;line-height:inherit;white-space:normal}
table.linenotable td.code{padding-left:.75em}
table.linenotable td.linenos{border-right:1px solid currentColor;opacity:.35;padding-right:.5em}
pre.pygments .lineno{border-right:1px solid currentColor;opacity:.35;display:inline-block;margin-right:.75em}
pre.pygments .lineno::before{content:"";margin-right:-.125em}
.quoteblock{margin:0 1em 1.25em 1.5em;display:table}
.quoteblock:not(.excerpt)>.title{margin-left:-1.5em;margin-bottom:.75em}
.quoteblock blockquote,.quoteblock p{color:rgba(0,0,0,.85);font-size:1.15rem;line-height:1.75;word-spacing:.1em;letter-spacing:0;font-style:italic;text-align:justify}
.quoteblock blockquote{margin:0;padding:0;border:0}
.quoteblock blockquote::before{content:"\201c";float:left;font-size:2.75em;font-weight:bold;line-height:.6em;margin-left:-.6em;color:#7a2518;text-shadow:0 1px 2px rgba(0,0,0,.1)}
.quoteblock blockquote>.paragraph:last-child p{margin-bottom:0}
.quoteblock .attribution{margin-top:.75em;margin-right:.5ex;text-align:right}
.verseblock{margin:0 1em 1.25em}
.verseblock pre{font-family:"Open Sans","DejaVu Sans",sans;font-size:1.15rem;color:rgba(0,0,0,.85);font-weight:300;text-rendering:optimizeLegibility}
.verseblock pre strong{font-weight:400}
.verseblock .attribution{margin-top:1.25rem;margin-left:.5ex}
.quoteblock .attribution,.verseblock .attribution{font-size:.9375em;line-height:1.45;font-style:italic}
.quoteblock .attribution br,.verseblock .attribution br{display:none}
.quoteblock .attribution cite,.verseblock .attribution cite{display:block;letter-spacing:-.025em;color:rgba(0,0,0,.6)}
.quoteblock.abstract blockquote::before,.quoteblock.excerpt blockquote::before,.quoteblock .quoteblock blockquote::before{display:none}
.quoteblock.abstract blockquote,.quoteblock.abstract p,.quoteblock.excerpt blockquote,.quoteblock.excerpt p,.quoteblock .quoteblock blockquote,.quoteblock .quoteblock p{line-height:1.6;word-spacing:0}
.quoteblock.abstract{margin:0 1em 1.25em;display:block}
.quoteblock.abstract>.title{margin:0 0 .375em;font-size:1.15em;text-align:center}
.quoteblock.excerpt>blockquote,.quoteblock .quoteblock{padding:0 0 .25em 1em;border-left:.25em solid #dddddf}
.quoteblock.excerpt,.quoteblock .quoteblock{margin-left:0}
.quoteblock.excerpt blockquote,.quoteblock.excerpt p,.quoteblock .quoteblock blockquote,.quoteblock .quoteblock p{color:inherit;font-size:1.0625rem}
.quoteblock.excerpt .attribution,.quoteblock .quoteblock .attribution{color:inherit;text-align:left;margin-right:0}
p.tableblock:last-child{margin-bottom:0}
td.tableblock>.content{margin-bottom:1.25em;word-wrap:anywhere}
td.tableblock>.content>:last-child{margin-bottom:-1.25em}
table.tableblock,th.tableblock,td.tableblock{border:0 solid #dedede}
table.grid-all>*>tr>*{border-width:1px}
table.grid-cols>*>tr>*{border-width:0 1px}
table.grid-rows>*>tr>*{border-width:1px 0}
table.frame-all{border-width:1px}
table.frame-ends{border-width:1px 0}
table.frame-sides{border-width:0 1px}
table.frame-none>colgroup+*>:first-child>*,table.frame-sides>colgroup+*>:first-child>*{border-top-width:0}
table.frame-none>:last-child>:last-child>*,table.frame-sides>:last-child>:last-child>*{border-bottom-width:0}
table.frame-none>*>tr>:first-child,table.frame-ends>*>tr>:first-child{border-left-width:0}
table.frame-none>*>tr>:last-child,table.frame-ends>*>tr>:last-child{border-right-width:0}
table.stripes-all tr,table.stripes-odd tr:nth-of-type(odd),table.stripes-even tr:nth-of-type(even),table.stripes-hover tr:hover{background:#f8f8f7}
th.halign-left,td.halign-left{text-align:left}
th.halign-right,td.halign-right{text-align:right}
th.halign-center,td.halign-center{text-align:center}
th.valign-top,td.valign-top{vertical-align:top}
th.valign-bottom,td.valign-bottom{vertical-align:bottom}
th.valign-middle,td.valign-middle{vertical-align:middle}
table thead th,table tfoot th{font-weight:bold}
tbody tr th{background:#f7f8f7}
tbody tr th,tbody tr th p,tfoot tr th,tfoot tr th p{color:rgba(0,0,0,.8);font-weight:bold}
p.tableblock>code:only-child{background:none;padding:0}
p.tableblock{font-size:1em}
ol{margin-left:1.75em}
ul li ol{margin-left:1.5em}
dl dd{margin-left:1.125em}
dl dd:last-child,dl dd:last-child>:last-child{margin-bottom:0}
ol>li p,ul>li p,ul dd,ol dd,.olist .olist,.ulist .ulist,.ulist .olist,.olist .ulist{margin-bottom:.625em}
ul.checklist,ul.none,ol.none,ul.no-bullet,ol.no-bullet,ol.unnumbered,ul.unstyled,ol.unstyled{list-style-type:none}
ul.no-bullet,ol.no-bullet,ol.unnumbered{margin-left:.625em}
ul.unstyled,ol.unstyled{margin-left:0}
ul.checklist{margin-left:.625em}
ul.checklist li>p:first-child>.fa-square-o:first-child,ul.checklist li>p:first-child>.fa-check-square-o:first-child{width:1.25em;font-size:.8em;position:relative;bottom:.125em}
ul.checklist li>p:first-child>input[type="checkbox"]:first-child{margin-right:.25em}
ul.inline{display:-ms-flexbox;display:-webkit-box;display:flex;-ms-flex-flow:row wrap;-webkit-flex-flow:row wrap;flex-flow:row wrap;list-style:none;margin:0 0 .625em -1.25em}
ul.inline>li{margin-left:1.25em}
.unstyled dl dt{font-weight:400;font-style:normal}
ol.arabic{list-style-type:decimal}
ol.decimal{list-style-type:decimal-leading-zero}
ol.loweralpha{list-style-type:lower-alpha}
ol.upperalpha{list-style-type:upper-alpha}
ol.lowerroman{list-style-type:lower-roman}
ol.upperroman{list-style-type:upper-roman}
ol.lowergreek{list-style-type:lower-greek}
.hdlist>table,.colist>table{border:0;background:none}
.hdlist>table>tbody>tr,.colist>table>tbody>tr{background:none}
td.hdlist1,td.hdlist2{vertical-align:top;padding:0 .625em}
td.hdlist1{font-weight:bold;padding-bottom:1.25em}
td.hdlist2{word-wrap:anywhere}
.literalblock+.colist,.listingblock+.colist{margin-top:-.5em}
.colist td:not([class]):first-child{padding:.4em .75em 0;line-height:1;vertical-align:top}
.colist td:not([class]):first-child img{max-width:none}
.colist td:not([class]):last-child{padding:.25em 0}
.thumb,.th{line-height:0;display:inline-block;border:solid 4px #fff;-webkit-box-shadow:0 0 0 1px #ddd;box-shadow:0 0 0 1px #ddd}
.imageblock.left{margin:.25em .625em 1.25em 0}
.imageblock.right{margin:.25em 0 1.25em .625em}
.imageblock>.title{margin-bottom:0}
.imageblock.thumb,.imageblock.th{border-width:6px}
.imageblock.thumb>.title,.imageblock.th>.title{padding:0 .125em}
.image.left,.image.right{margin-top:.25em;margin-bottom:.25em;display:inline-block;line-height:0}
.image.left{margin-right:.625em}
.image.right{margin-left:.625em}
a.image{text-decoration:none;display:inline-block}
a.image object{pointer-events:none}
sup.footnote,sup.footnoteref{font-size:.875em;position:static;vertical-align:super}
sup.footnote a,sup.footnoteref a{text-decoration:none}
sup.footnote a:active,sup.footnoteref a:active{text-decoration:underline}
#footnotes{padding-top:.75em;padding-bottom:.75em;margin-bottom:.625em}
#footnotes hr{width:20%;min-width:6.25em;margin:-.25em 0 .75em;border-width:1px 0 0}
#footnotes .footnote{padding:0 .375em 0 .225em;line-height:1.3334;font-size:.875em;margin-left:1.2em;margin-bottom:.2em}
#footnotes .footnote a:first-of-type{font-weight:bold;text-decoration:none;margin-left:-1.05em}
#footnotes .footnote:last-of-type{margin-bottom:0}
#content #footnotes{margin-top:-.625em;margin-bottom:0;padding:.75em 0}
.gist .file-data>table{border:0;background:#fff;width:100%;margin-bottom:0}
.gist .file-data>table td.line-data{width:99%}
div.unbreakable{page-break-inside:avoid}
.big{font-size:larger}
.small{font-size:smaller}
.underline{text-decoration:underline}
.overline{text-decoration:overline}
.line-through{text-decoration:line-through}
.aqua{color:#00bfbf}
.aqua-background{background:#00fafa}
.black{color:#000}
.black-background{background:#000}
.blue{color:#0000bf}
.blue-background{background:#0000fa}
.fuchsia{color:#bf00bf}
.fuchsia-background{background:#fa00fa}
.gray{color:#606060}
.gray-background{background:#7d7d7d}
.green{color:#006000}
.green-background{background:#007d00}
.lime{color:#00bf00}
.lime-background{background:#00fa00}
.maroon{color:#600000}
.maroon-background{background:#7d0000}
.navy{color:#000060}
.navy-background{background:#00007d}
.olive{color:#606000}
.olive-background{background:#7d7d00}
.purple{color:#600060}
.purple-background{background:#7d007d}
.red{color:#bf0000}
.red-background{background:#fa0000}
.silver{color:#909090}
.silver-background{background:#bcbcbc}
.teal{color:#006060}
.teal-background{background:#007d7d}
.white{color:#bfbfbf}
.white-background{background:#fafafa}
.yellow{color:#bfbf00}
.yellow-background{background:#fafa00}
span.icon>.fa{cursor:default}
a span.icon>.fa{cursor:inherit}
.admonitionblock td.icon [class^="fa icon-"]{font-size:2.5em;text-shadow:1px 1px 2px rgba(0,0,0,.5);cursor:default}
.admonitionblock td.icon .icon-note::before{content:"\f05a";color:#19407c}
.admonitionblock td.icon .icon-tip::before{content:"\f0eb";text-shadow:1px 1px 2px rgba(155,155,0,.8);color:#111}
.admonitionblock td.icon .icon-warning::before{content:"\f071";color:#bf6900}
.admonitionblock td.icon .icon-caution::before{content:"\f06d";color:#bf3400}
.admonitionblock td.icon .icon-important::before{content:"\f06a";color:#bf0000}
.conum[data-value]{display:inline-block;color:#fff!important;background:rgba(0,0,0,.8);-webkit-border-radius:50%;border-radius:50%;text-align:center;font-size:.75em;width:1.67em;height:1.67em;line-height:1.67em;font-family:"Open Sans","DejaVu Sans",sans-serif;font-style:normal;font-weight:bold}
.conum[data-value] *{color:#fff!important}
.conum[data-value]+b{display:none}
.conum[data-value]::after{content:attr(data-value)}
pre .conum[data-value]{position:relative;top:-.125em}
b.conum *{color:inherit!important}
.conum:not([data-value]):empty{display:none}
dt,th.tableblock,td.content,div.footnote{text-rendering:optimizeLegibility}
h1,h2,p,td.content,span.alt{letter-spacing:-.01em}
p strong,td.content strong,div.footnote strong{letter-spacing:-.005em}
p,blockquote,dt,td.content,span.alt{font-size:1.0625rem}
p{margin-bottom:1.25rem}
.sidebarblock p,.sidebarblock dt,.sidebarblock td.content,p.tableblock{font-size:1em}
.exampleblock>.content{background:#fffef7;border-color:#e0e0dc;-webkit-box-shadow:0 1px 4px #e0e0dc;box-shadow:0 1px 4px #e0e0dc}
.print-only{display:none!important}
@page{margin:1.25cm .75cm}
@media print{*{-webkit-box-shadow:none!important;box-shadow:none!important;text-shadow:none!important}
html{font-size:80%}
a{color:inherit!important;text-decoration:underline!important}
a.bare,a[href^="#"],a[href^="mailto:"]{text-decoration:none!important}
a[href^="http:"]:not(.bare)::after,a[href^="https:"]:not(.bare)::after{content:"(" attr(href) ")";display:inline-block;font-size:.875em;padding-left:.25em}
abbr[title]::after{content:" (" attr(title) ")"}
pre,blockquote,tr,img,object,svg{page-break-inside:avoid}
thead{display:table-header-group}
svg{max-width:100%}
p,blockquote,dt,td.content{font-size:1em;orphans:3;widows:3}
h2,h3,#toctitle,.sidebarblock>.content>.title{page-break-after:avoid}
#header,#content,#footnotes,#footer{max-width:none}
#toc,.sidebarblock,.exampleblock>.content{background:none!important}
#toc{border-bottom:1px solid #dddddf!important;padding-bottom:0!important}
body.book #header{text-align:center}
body.book #header>h1:first-child{border:0!important;margin:2.5em 0 1em}
body.book #header .details{border:0!important;display:block;padding:0!important}
body.book #header .details span:first-child{margin-left:0!important}
body.book #header .details br{display:block}
body.book #header .details br+span::before{content:none!important}
body.book #toc{border:0!important;text-align:left!important;padding:0!important;margin:0!important}
body.book #toc,body.book #preamble,body.book h1.sect0,body.book .sect1>h2{page-break-before:always}
.listingblock code[data-lang]::before{display:block}
#footer{padding:0 .9375em}
.hide-on-print{display:none!important}
.print-only{display:block!important}
.hide-for-print{display:none!important}
.show-for-print{display:inherit!important}}
@media print,amzn-kf8{#header>h1:first-child{margin-top:1.25rem}
.sect1{padding:0!important}
.sect1+.sect1{border:0}
#footer{background:none}
#footer-text{color:rgba(0,0,0,.6);font-size:.9em}}
@media amzn-kf8{#header,#content,#footnotes,#footer{padding:0}}
</style>
</head>
<body class="article">
<div id="header">
<h1>VBA</h1>
<div class="details">
<span id="author" class="author">yossym</span><br>
<span id="email" class="email"><a href="mailto:docomoxyz@gmail.com">docomoxyz@gmail.com</a></span><br>
<span id="revdate">2021-04-13</span>
</div>
<div id="toc" class="toc">
<div id="toctitle">Table of Contents</div>
<ul class="sectlevel1">
<li><a href="#_unix形式日付を普通の日付にする">1. Unix形式日付を普通の日付にする</a></li>
<li><a href="#_vbe">2. VBE</a>
<ul class="sectlevel2">
<li><a href="#_エディタの設定">2.1. [エディタの設定]</a></li>
<li><a href="#_ショートカットキー">2.2. ショートカットキー</a></li>
</ul>
</li>
<li><a href="#_変数">3. 変数</a>
<ul class="sectlevel2">
<li><a href="#_関数系">3.1. 関数系</a></li>
<li><a href="#_文章">3.2. 文章</a>
<ul class="sectlevel3">
<li><a href="#_一行">3.2.1. 一行</a></li>
</ul>
</li>
<li><a href="#_filesystemobject">3.3. FilesystemObject</a></li>
<li><a href="#_textstream">3.4. TextStream</a></li>
<li><a href="#_その他">3.5. その他</a></li>
</ul>
</li>
<li><a href="#_初期値">4. 初期値</a>
<ul class="sectlevel2">
<li><a href="#_長さ0の文字列">4.1. 長さ0の文字列（""）</a></li>
<li><a href="#_値0の文字列vbnullstring">4.2. 値0の文字列（vbNullString）</a></li>
</ul>
</li>
<li><a href="#_lorem_ipsum">5. lorem ipsum</a></li>
<li><a href="#_workbook">6. Workbook</a>
<ul class="sectlevel2">
<li><a href="#_workbook_新規">6.1. Workbook 新規</a></li>
<li><a href="#_workbook_開く">6.2. Workbook 開く</a></li>
<li><a href="#_workbook_閉じる">6.3. Workbook 閉じる</a></li>
<li><a href="#_workbook_保存">6.4. Workbook 保存</a></li>
<li><a href="#_ワークブックを開くとき閉じるとき">6.5. ワークブックを開くとき、閉じるとき</a></li>
<li><a href="#_workbook存在確認">6.6. WorkBook存在確認</a></li>
<li><a href="#_メニュー追加">6.7. メニュー追加</a></li>
</ul>
</li>
<li><a href="#_worksheets">7. WorkSheets</a>
<ul class="sectlevel2">
<li><a href="#_worksheets_追加">7.1. WorkSheets 追加</a></li>
<li><a href="#_worksheets_削除">7.2. WorkSheets 削除</a></li>
<li><a href="#_worksheet_copyコピー">7.3. worksheet copyコピー</a></li>
<li><a href="#_sheetexists_シートの存在確認">7.4. SheetExists シートの存在確認</a></li>
<li><a href="#_すべてのシート選択">7.5. すべてのシート選択</a></li>
</ul>
</li>
<li><a href="#_cells">8. cells</a>
<ul class="sectlevel2">
<li><a href="#_セルを直接selectする">8.1. セルを直接selectする</a></li>
<li><a href="#_行の追加">8.2. 行の追加</a>
<ul class="sectlevel3">
<li><a href="#_1行追加">8.2.1. 1行追加</a></li>
<li><a href="#_複数行追加">8.2.2. 複数行追加</a></li>
<li><a href="#_1列追加">8.2.3. 1列追加</a></li>
<li><a href="#_複数列追加">8.2.4. 複数列追加</a></li>
</ul>
</li>
<li><a href="#_最終行取得">8.3. 最終行取得</a></li>
<li><a href="#_最終列取得">8.4. 最終列取得</a></li>
<li><a href="#_selection">8.5. Selection</a></li>
<li><a href="#_セルの指定">8.6. セルの指定</a>
<ul class="sectlevel3">
<li><a href="#_セルの指定_2">8.6.1. セルの指定</a></li>
</ul>
</li>
<li><a href="#_セルの追加">8.7. セルの追加</a></li>
<li><a href="#_セルの値コピー">8.8. セルの値コピー</a></li>
<li><a href="#_セルの値コピーfill">8.9. セルの値コピー(Fill*)</a></li>
<li><a href="#_セル配列">8.10. セル　↔　配列</a></li>
<li><a href="#_コピペ">8.11. コピペ</a></li>
<li><a href="#_ソート">8.12. ソート</a>
<ul class="sectlevel3">
<li><a href="#_セル配列変数">8.12.1. セル配列　→　変数</a></li>
</ul>
</li>
<li><a href="#_アドレス指定">8.13. アドレス指定</a></li>
<li><a href="#_ハイパーリンク">8.14. ハイパーリンク</a></li>
<li><a href="#_セルフォントに色をつける">8.15. セル,フォントに色をつける</a></li>
<li><a href="#_セルの検索">8.16. セルの検索</a></li>
</ul>
</li>
<li><a href="#_変数_2">9. 変数</a>
<ul class="sectlevel2">
<li><a href="#_値のない場合の表現">9.1. 値のない場合の表現</a>
<ul class="sectlevel3">
<li><a href="#_empty">9.1.1. Empty</a></li>
<li><a href="#_nothing">9.1.2. Nothing</a></li>
<li><a href="#_null">9.1.3. Null</a></li>
<li><a href="#">9.1.4. ""</a></li>
<li><a href="#_vbnullstring">9.1.5. VbNullString</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#_関数">10. 関数</a>
<ul class="sectlevel2">
<li><a href="#_配列を受け取る関数">10.1. 配列を受け取る関数</a></li>
<li><a href="#_fix_int_round_四捨五入切り捨て">10.2. fix, int, round, 四捨五入、切り捨て</a></li>
<li><a href="#_vbaで関数名を変数で使う">10.3. VBAで関数名を変数で使う</a></li>
<li><a href="#_httpリクエスト">10.4. HTTPリクエスト</a></li>
<li><a href="#_sprintf関数">10.5. sprintf関数</a></li>
</ul>
</li>
<li><a href="#_ファイル">11. ファイル</a>
<ul class="sectlevel2">
<li><a href="#_ファイル読み込みsjisfilesystemobject">11.1. ファイル読み込み(sjis,FileSystemObject)</a></li>
<li><a href="#_ファイル読み込みutf_8adodb">11.2. ファイル読み込み(UTF-8,ADODB)</a></li>
<li><a href="#_ファイル書き込みsjisfilesystemobject">11.3. ファイル書き込み(sjis,FileSystemObject)</a></li>
<li><a href="#_ファイル書き込みutf_8adodb">11.4. ファイル書き込み(UTF-8,ADODB)</a></li>
<li><a href="#_ファイル一覧取得">11.5. ファイル一覧取得</a></li>
<li><a href="#_フォルダ一覧">11.6. フォルダ一覧</a></li>
<li><a href="#_フォルダを再起してファイル一覧取得">11.7. フォルダを再起してファイル一覧取得</a></li>
<li><a href="#_ado">11.8. ado</a>
<ul class="sectlevel3">
<li><a href="#_adoでcsv読み込み">11.8.1. adoでcsv読み込み</a></li>
</ul>
</li>
<li><a href="#_adodb_recordsetで2次元配列ソート">11.9. ADODB.RecordSetで2次元配列ソート</a></li>
</ul>
</li>
<li><a href="#_特殊フォルダ">12. 特殊フォルダ</a></li>
<li><a href="#_ファイル選択dialog">13. ファイル選択Dialog</a>
<ul class="sectlevel2">
<li><a href="#_1ファイル選択">13.1. 1ファイル選択</a></li>
<li><a href="#_タイトルを変更">13.2. タイトルを変更</a></li>
<li><a href="#_複数ファイル">13.3. 複数ファイル</a></li>
</ul>
</li>
<li><a href="#_フォルダ選択dialog">14. フォルダ選択Dialog</a></li>
<li><a href="#_vbscript_これだけ書いとけ">15. VBScript これだけ書いとけ</a></li>
<li><a href="#_filesystemobject_オブジェクト">16. FileSystemObject オブジェクト</a>
<ul class="sectlevel2">
<li><a href="#_メソッド">16.1. メソッド</a>
<ul class="sectlevel3">
<li><a href="#_buildpath_メソッド">16.1.1. BuildPath メソッド</a></li>
<li><a href="#_copyfile_メソッド">16.1.2. CopyFile メソッド</a></li>
<li><a href="#_copyfolder_メソッド">16.1.3. CopyFolder メソッド</a></li>
<li><a href="#_createfolder_メソッド">16.1.4. CreateFolder メソッド</a></li>
<li><a href="#_createtextfile_メソッド">16.1.5. CreateTextFile メソッド</a></li>
<li><a href="#_deletefile_メソッド">16.1.6. DeleteFile メソッド</a></li>
<li><a href="#_deletefolder_メソッド">16.1.7. DeleteFolder メソッド</a></li>
<li><a href="#_drive_exists_メソッド">16.1.8. drive exists メソッド</a></li>
<li><a href="#_fileexists_メソッド">16.1.9. FileExists メソッド</a></li>
<li><a href="#_folderexists_メソッド">16.1.10. FolderExists メソッド</a></li>
<li><a href="#_getabsolutepathname_メソッド">16.1.11. GetAbsolutePathName メソッド</a></li>
<li><a href="#_getbasenameメソッド">16.1.12. ★GetBaseNameメソッド</a></li>
<li><a href="#_getdrive_メソッド">16.1.13. GetDrive メソッド</a></li>
<li><a href="#_getdrivename_メソッド">16.1.14. GetDriveName メソッド</a></li>
<li><a href="#_getextensionname_メソッド">16.1.15. GetExtensionName メソッド</a></li>
<li><a href="#_getfile_メソッド">16.1.16. GetFile メソッド</a></li>
<li><a href="#_getfilename_メソッド">16.1.17. ★GetFileName メソッド</a></li>
<li><a href="#_getfolder_メソッド">16.1.18. GetFolder メソッド</a></li>
<li><a href="#_getparentfoldername_メソッド">16.1.19. ★GetParentFolderName メソッド</a></li>
<li><a href="#_getspecialfolder_メソッド">16.1.20. GetSpecialFolder メソッド</a></li>
<li><a href="#_gettempname_メソッド">16.1.21. GetTempName メソッド</a></li>
<li><a href="#_movefile_メソッド">16.1.22. MoveFile メソッド</a></li>
<li><a href="#_movefolder_メソッド">16.1.23. MoveFolder メソッド</a></li>
<li><a href="#_opentextfile_メソッド">16.1.24. OpenTextFile メソッド</a></li>
</ul>
</li>
<li><a href="#_プロパティ">16.2. プロパティ</a>
<ul class="sectlevel3">
<li><a href="#_drives_プロパティ">16.2.1. Drives プロパティ</a></li>
<li><a href="#_name_プロパティ">16.2.2. Name プロパティ</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#_textstream_オブジェクト">17. TextStream オブジェクト</a>
<ul class="sectlevel2">
<li><a href="#_メソッド_2">17.1. メソッド</a>
<ul class="sectlevel3">
<li><a href="#_close_メソッド">17.1.1. Close メソッド</a></li>
<li><a href="#_read_メソッド">17.1.2. Read メソッド</a></li>
<li><a href="#_readall_メソッド">17.1.3. ReadAll メソッド</a></li>
<li><a href="#_readline_メソッド">17.1.4. ReadLine メソッド</a></li>
<li><a href="#_skip_メソッド">17.1.5. Skip メソッド</a></li>
<li><a href="#_skipline_メソッド">17.1.6. SkipLine メソッド</a></li>
<li><a href="#_write_メソッド">17.1.7. Write メソッド</a></li>
<li><a href="#_write空白行メソッド">17.1.8. Write空白行メソッド</a></li>
<li><a href="#_writeline_メソッド">17.1.9. WriteLine メソッド</a></li>
</ul>
</li>
<li><a href="#_プロパティ_2">17.2. プロパティ</a>
<ul class="sectlevel3">
<li><a href="#_atendofline_プロパティ">17.2.1. AtEndOfLine プロパティ</a></li>
<li><a href="#_atendofstream_プロパティ">17.2.2. AtEndOfStream プロパティ</a></li>
<li><a href="#_column_プロパティ">17.2.3. Column プロパティ</a></li>
<li><a href="#_line_プロパティ">17.2.4. Line プロパティ</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#_userform">18. UserForm</a>
<ul class="sectlevel2">
<li><a href="#_listbox">18.1. ListBox</a></li>
</ul>
</li>
<li><a href="#_collection_dictionary">19. Collection, Dictionary</a></li>
<li><a href="#_疑似collection">20. 疑似collection</a></li>
<li><a href="#_collection_オブジェクト">21. Collection オブジェクト</a>
<ul class="sectlevel2">
<li><a href="#_add_メソッド_vba">21.1. Add メソッド (VBA)</a></li>
<li><a href="#_item_メソッド">21.2. Item メソッド</a></li>
<li><a href="#_remove_メソッド_vba">21.3. Remove メソッド (VBA)</a></li>
<li><a href="#_count_プロパティ_vba">21.4. Count プロパティ (VBA)</a></li>
<li><a href="#_collectionのソート">21.5. Collectionのソート</a></li>
</ul>
</li>
<li><a href="#_dictionary_オブジェクト_microsoft_docs">22. Dictionary オブジェクト | Microsoft Docs</a>
<ul class="sectlevel2">
<li><a href="#_メソッド_3">22.1. メソッド</a>
<ul class="sectlevel3">
<li><a href="#_add_メソッド">22.1.1. Add メソッド</a></li>
<li><a href="#_exists_メソッド">22.1.2. Exists メソッド</a></li>
<li><a href="#_items_メソッド">22.1.3. Items メソッド</a></li>
<li><a href="#_keys_メソッド">22.1.4. Keys メソッド</a></li>
<li><a href="#_remove_メソッド">22.1.5. Remove メソッド</a></li>
<li><a href="#_removeall_メソッド">22.1.6. RemoveAll メソッド</a></li>
</ul>
</li>
<li><a href="#_プロパティ_3">22.2. プロパティ</a>
<ul class="sectlevel3">
<li><a href="#_comparemode_プロパティ">22.2.1. CompareMode プロパティ</a></li>
<li><a href="#_count_プロパティ">22.2.2. Count プロパティ</a></li>
<li><a href="#_item_プロパティ">22.2.3. Item プロパティ</a></li>
<li><a href="#_key_プロパティ">22.2.4. Key プロパティ</a></li>
</ul>
</li>
<li><a href="#_dictionaryのソート">22.3. Dictionaryのソート</a></li>
<li><a href="#_dictionaryにclassを追加">22.4. DictionaryにClassを追加</a></li>
<li><a href="#_ユーザ定義型">22.5. ユーザ定義型</a></li>
</ul>
</li>
<li><a href="#_グラフ">23. グラフ</a>
<ul class="sectlevel2">
<li><a href="#_グラフ作成">23.1. グラフ作成</a></li>
<li><a href="#_グラフの系列追加">23.2. グラフの系列追加</a></li>
<li><a href="#_グラフのタイトル変更">23.3. グラフのタイトル変更</a></li>
<li><a href="#_グラフ移動">23.4. グラフ移動</a></li>
<li><a href="#_グラフ行列入れ替え">23.5. グラフ行列入れ替え</a></li>
<li><a href="#_軸の設定">23.6. 軸の設定</a>
<ul class="sectlevel3">
<li><a href="#_軸のタイトル">23.6.1. 軸のタイトル</a></li>
<li><a href="#_横軸の最小値最大値">23.6.2. 横軸？の最小値、最大値</a></li>
</ul>
</li>
<li><a href="#_マーカー設定">23.7. マーカー設定</a></li>
</ul>
</li>
<li><a href="#_正規表現で1行を空白で分割">24. 正規表現で1行を空白で分割</a></li>
<li><a href="#_donotupdate">25. DoNotUpdate</a></li>
<li><a href="#_indirect関数を使う">26. INDIRECT関数を使う</a></li>
<li><a href="#_配列を使うのに役立つ4つの関数arraylbounduboundsplitの使い方">27. 配列を使うのに役立つ4つの関数――Array、LBound、UBound、Splitの使い方</a>
<ul class="sectlevel2">
<li><a href="#_array_関数_visual_basic_for_applications_microsoft_docs">27.1. Array 関数 (Visual Basic for Applications) | Microsoft Docs</a></li>
<li><a href="#_lbound_関数_visual_basic_for_applications_microsoft_docs">27.2. LBound 関数 (Visual Basic for Applications) | Microsoft Docs</a></li>
<li><a href="#_ubound_関数_visual_basic_for_applications_microsoft_docs">27.3. UBound 関数 (Visual Basic for Applications) | Microsoft Docs</a></li>
<li><a href="#_split_関数_visual_basic_for_applications_microsoft_docs">27.4. Split 関数 (Visual Basic for Applications) | Microsoft Docs</a></li>
<li><a href="#_join_関数_visual_basic_for_applications_microsoft_docs">27.5. Join 関数 (Visual Basic for Applications) | Microsoft Docs</a></li>
</ul>
</li>
<li><a href="#_配列の内容をセルにコピー">28. 配列の内容をセルにコピー</a>
<ul class="sectlevel2">
<li><a href="#_1次元配列ソート">28.1. 1次元配列ソート</a></li>
<li><a href="#_2次元配列ソート">28.2. 2次元配列ソート</a></li>
</ul>
</li>
<li><a href="#_罫線">29. 罫線</a></li>
<li><a href="#_borders_オブジェクト_excel_microsoft_docs">30. Borders オブジェクト (Excel) | Microsoft Docs</a>
<ul class="sectlevel2">
<li><a href="#_borders_プロパティ_excel_microsoft_docs">30.1. Borders プロパティ (Excel) | Microsoft Docs</a></li>
<li><a href="#_xllinestyle_列挙_excel_microsoft_docs">30.2. XlLineStyle 列挙 (Excel) | Microsoft Docs</a></li>
</ul>
</li>
<li><a href="#_ディレクティブ_microsoft_docs">31. ディレクティブ | Microsoft Docs</a></li>
<li><a href="#_イベント_visual_basic_for_applications_microsoft_docs">32. イベント (Visual Basic for Applications) | Microsoft Docs</a></li>
<li><a href="#_関数_visual_basic_for_applications_microsoft_docs">33. 関数 (Visual Basic for Applications) | Microsoft Docs</a>
<ul class="sectlevel2">
<li><a href="#_変換関数">33.1. 変換関数</a>
<ul class="sectlevel3">
<li><a href="#Asc">33.1.1. Asc 関数</a></li>
<li><a href="#Chr">33.1.2. Chr 関数</a></li>
<li><a href="#CVErr">33.1.3. CVErr 関数</a></li>
<li><a href="#Format">33.1.4. Format 関数</a></li>
<li><a href="#Hex">33.1.5. Hex 関数</a></li>
<li><a href="#Oct">33.1.6. Oct 関数</a></li>
<li><a href="#Str">33.1.7. Str 関数</a></li>
<li><a href="#Val">33.1.8. Val 関数</a></li>
</ul>
</li>
<li><a href="#_数学関数">33.2. 数学関数</a>
<ul class="sectlevel3">
<li><a href="#Abs">33.2.1. Abs 関数</a></li>
<li><a href="#Arn">33.2.2. Atn 関数</a></li>
<li><a href="#Cos">33.2.3. Cos 関数</a></li>
<li><a href="#_派生した数学関数">33.2.4. 派生した数学関数</a></li>
<li><a href="#Exp">33.2.5. Exp 関数</a></li>
<li><a href="#IntFix">33.2.6. Int、Fix 関数</a></li>
<li><a href="#Log">33.2.7. Log 関数</a></li>
<li><a href="#Rnd">33.2.8. Rnd 関数</a></li>
<li><a href="#Sgn">33.2.9. Sgn 関数</a></li>
<li><a href="#Sin">33.2.10. Sin 関数</a></li>
<li><a href="#Sqr">33.2.11. Sqr 関数</a></li>
<li><a href="#Tan">33.2.12. Tan 関数</a></li>
</ul>
</li>
<li><a href="#_データ型変換関数">33.3. データ型変換関数</a>
<ul class="sectlevel3">
<li><a href="#_データ型変換関数_2">33.3.1. データ型変換関数</a></li>
</ul>
</li>
<li><a href="#_その他の関数">33.4. その他の関数</a>
<ul class="sectlevel3">
<li><a href="#Array">33.4.1. Array 関数</a></li>
<li><a href="#CallByName">33.4.2. CallByName 関数</a></li>
<li><a href="#Choose">33.4.3. Choose 関数</a></li>
<li><a href="#Command">33.4.4. Command</a></li>
<li><a href="#_instr_関数">33.4.5. InStr 関数</a></li>
</ul>
</li>
<li><a href="#_is関数">33.5. is関数</a></li>
<li><a href="#_isarray_関数_visual_basic_for_applications_microsoft_docs">33.6. IsArray 関数 (Visual Basic for Applications) | Microsoft Docs</a></li>
</ul>
</li>
<li><a href="#_ステートメント_microsoft_docs">34. ステートメント | Microsoft Docs</a>
<ul class="sectlevel2">
<li><a href="#_close_ステートメント">34.1. Close ステートメント</a></li>
<li><a href="#_doloop_ステートメント">34.2. Do&#8230;&#8203;Loop ステートメント</a></li>
<li><a href="#_for_eachnext_ステートメント">34.3. For Each&#8230;&#8203;Next ステートメント</a></li>
<li><a href="#_fornext_ステートメント">34.4. For&#8230;&#8203;Next ステートメント</a></li>
<li><a href="#_function">34.5. Function</a>
<ul class="sectlevel3">
<li><a href="#_配列を引数として渡す">34.5.1. 配列を引数として渡す</a></li>
<li><a href="#_配列を戻り値として受け取る">34.5.2. 配列を戻り値として受け取る</a></li>
</ul>
</li>
<li><a href="#_ifthenelse_ステートメント">34.6. If&#8230;&#8203;Then&#8230;&#8203;Else ステートメント</a></li>
<li><a href="#_redim_ステートメント">34.7. ReDim ステートメント</a></li>
<li><a href="#_open_ステートメント">34.8. Open ステートメント</a></li>
<li><a href="#_unload_ステートメント">34.9. Unload ステートメント</a></li>
<li><a href="#_whilewend_ステートメント">34.10. While&#8230;&#8203;Wend ステートメント</a></li>
</ul>
</li>
<li><a href="#_sleep関数を使う">35. sleep関数を使う</a></li>
<li><a href="#_エクセルシート関数">36. エクセルシート関数</a>
<ul class="sectlevel2">
<li><a href="#_シート名取得">36.1. シート名取得</a></li>
<li><a href="#_ファイル名取得">36.2. ファイル名取得</a></li>
</ul>
</li>
<li><a href="#_visual_basic_言語リファレンス">37. Visual Basic 言語リファレンス</a>
<ul class="sectlevel2">
<li><a href="#_文字セット">37.1. 文字セット</a></li>
<li><a href="#_定数_visual_basic_for_applications">37.2. 定数 (Visual Basic for Applications)</a>
<ul class="sectlevel3">
<li><a href="#_vba_定数">37.2.1. VBA 定数</a></li>
</ul>
</li>
<li><a href="#_データ型の概要_microsoft_docs">37.3. データ型の概要 | Microsoft Docs</a>
<ul class="sectlevel3">
<li><a href="#_type_conversion_関数type_conversion">37.3.1. Type Conversion 関数[[Type Conversion]]</a></li>
</ul>
</li>
<li><a href="#_ディレクティブ">37.4. ディレクティブ</a>
<ul class="sectlevel3">
<li><a href="#_const_ディレクティブ">37.4.1. #Const ディレクティブ</a></li>
<li><a href="#_ifthenelse_ディレクティブ">37.4.2. #If&#8230;&#8203;Then&#8230;&#8203;#Else ディレクティブ</a></li>
</ul>
</li>
<li><a href="#_イベント_visual_basic_for_applications">37.5. イベント (Visual Basic for Applications)</a>
<ul class="sectlevel3">
<li><a href="#_activate_イベントdeactivate_イベントactivatedeactivate">37.5.1. Activate イベント、Deactivate イベント[[Activate、Deactivate]]</a></li>
<li><a href="#_initialize_イベント">37.5.2. Initialize イベント</a></li>
<li><a href="#_queryclose_イベント">37.5.3. QueryClose イベント</a></li>
<li><a href="#_resize_イベント">37.5.4. Resize イベント</a></li>
<li><a href="#_terminate_イベント">37.5.5. Terminate イベント</a></li>
</ul>
</li>
<li><a href="#_関数_visual_basic_for_applications">37.6. 関数 (Visual Basic for Applications)</a>
<ul class="sectlevel3">
<li><a href="#_array_関数">37.6.1. Array 関数</a></li>
<li><a href="#_callbyname_関数">37.6.2. CallByName 関数</a></li>
<li><a href="#_choose_関数">37.6.3. Choose 関数</a></li>
<li><a href="#_command">37.6.4. Command</a></li>
<li><a href="#_変換関数_2">37.6.5. 変換関数</a></li>
<li><a href="#_createobject_関数">37.6.6. CreateObject 関数</a></li>
<li><a href="#_curdir_関数">37.6.7. CurDir 関数</a></li>
<li><a href="#_date_関数">37.6.8. Date 関数</a></li>
<li><a href="#_dateadd_関数">37.6.9. DateAdd 関数</a></li>
<li><a href="#_datediff_関数">37.6.10. DateDiff 関数</a></li>
<li><a href="#_datepart_関数">37.6.11. DatePart 関数</a></li>
<li><a href="#_dateserial_関数">37.6.12. DateSerial 関数</a></li>
<li><a href="#_datevalue_関数">37.6.13. DateValue 関数</a></li>
<li><a href="#_day_関数">37.6.14. Day 関数</a></li>
<li><a href="#_ddb_関数">37.6.15. DDB 関数</a></li>
<li><a href="#_dir_関数">37.6.16. Dir 関数</a></li>
<li><a href="#_doevents_関数">37.6.17. DoEvents 関数</a></li>
<li><a href="#_environ_関数">37.6.18. Environ 関数</a></li>
<li><a href="#_eof_関数">37.6.19. EOF 関数</a></li>
<li><a href="#_error_関数">37.6.20. Error 関数</a></li>
<li><a href="#_fileattr_関数">37.6.21. FileAttr 関数</a></li>
<li><a href="#_filedatetime_関数">37.6.22. FileDateTime 関数</a></li>
<li><a href="#_filelen_関数">37.6.23. FileLen 関数</a></li>
<li><a href="#_filter_関数">37.6.24. Filter 関数</a></li>
<li><a href="#_formatcurrency_関数">37.6.25. FormatCurrency 関数</a></li>
<li><a href="#_formatdatetime_関数">37.6.26. FormatDateTime 関数</a></li>
<li><a href="#_formatnumber_関数">37.6.27. FormatNumber 関数</a></li>
<li><a href="#_formatpercent_関数">37.6.28. FormatPercent 関数</a></li>
<li><a href="#_freefile_関数">37.6.29. FreeFile 関数</a></li>
<li><a href="#_fv_関数">37.6.30. FV 関数</a></li>
<li><a href="#_getallsettings_関数">37.6.31. GetAllSettings 関数</a></li>
<li><a href="#_getattr_関数">37.6.32. GetAttr 関数</a></li>
<li><a href="#_getobject_関数">37.6.33. GetObject 関数</a></li>
<li><a href="#_getsetting_関数">37.6.34. GetSetting 関数</a></li>
<li><a href="#_hour_関数">37.6.35. Hour 関数</a></li>
</ul>
</li>
<li><a href="#_タスク別のキーワード">37.7. タスク別のキーワード</a>
<ul class="sectlevel3">
<li><a href="#_キーワード_visual_basic_for_applications">37.7.1. キーワード (Visual Basic for Applications)</a></li>
<li><a href="#_配列キーワードの概要">37.7.2. 配列キーワードの概要</a></li>
<li><a href="#_制御フローキーワードの概要">37.7.3. 制御フローキーワードの概要</a></li>
<li><a href="#_変換キーワードの概要">37.7.4. 変換キーワードの概要</a></li>
<li><a href="#_日付と時刻のキーワード_サマリー">37.7.5. 日付と時刻のキーワード サマリー</a></li>
<li><a href="#_ディレクトリとファイルのキーワード_サマリー">37.7.6. ディレクトリとファイルのキーワード サマリー</a></li>
<li><a href="#_エラー_キーワード_サマリー">37.7.7. エラー キーワード サマリー</a></li>
<li><a href="#_財務キーワードの概要">37.7.8. 財務キーワードの概要</a></li>
<li><a href="#_入力と出力のキーワードの概要">37.7.9. 入力と出力のキーワードの概要</a></li>
<li><a href="#_数学キーワード_サマリー">37.7.10. 数学キーワード サマリー</a></li>
<li><a href="#_その他のキーワード_サマリー">37.7.11. その他のキーワード サマリー</a></li>
<li><a href="#_レジストリ_キーワードの概要">37.7.12. レジストリ キーワードの概要</a></li>
<li><a href="#_文字列操作キーワードの概要">37.7.13. 文字列操作キーワードの概要</a></li>
<li><a href="#_変数と定数のキーワード_サマリー">37.7.14. 変数と定数のキーワード サマリー</a></li>
</ul>
</li>
<li><a href="#_microsoft_forms_リファレンス">37.8. Microsoft Forms リファレンス</a></li>
<li><a href="#_オブジェクト_visual_basic_for_applications">37.9. オブジェクト (Visual Basic for Applications)</a>
<ul class="sectlevel3">
<li><a href="#_err_オブジェクト">37.9.1. Err オブジェクト</a></li>
<li><a href="#_メソッド_4">37.9.2. メソッド</a></li>
</ul>
</li>
<li><a href="#_演算子の概要">37.10. 演算子の概要</a></li>
<li><a href="#_statements">37.11. Statements</a>
<ul class="sectlevel3">
<li><a href="#_on_error_ステートメントon_error">37.11.1. On Error ステートメント[[On Error]]</a></li>
<li><a href="#_ongosubongoto_ステートメントongosubongotoongosubongoto">37.11.2. On&#8230;&#8203;GoSub、On&#8230;&#8203;GoTo ステートメント[[On&#8230;&#8203;GoSub]][[On&#8230;&#8203;GoTo]][[On&#8230;&#8203;GoSub、On&#8230;&#8203;GoTo]]</a></li>
</ul>
</li>
<li><a href="#_visual_basic_add_in_model_reference">37.12. Visual Basic Add-in Model reference</a></li>
</ul>
</li>
<li><a href="#_tip">38. tip</a>
<ul class="sectlevel2">
<li><a href="#_yyyymmddss時刻のフォーマット">38.1. YYYYMMDDSS時刻のフォーマット</a></li>
<li><a href="#_vbscriptでiniファイルを使う">38.2. vbscriptでiniファイルを使う</a></li>
<li><a href="#_gui_と_cui_のどちらで実行されたかを判定する方法">38.3. GUI と CUI のどちらで実行されたかを判定する方法</a></li>
</ul>
</li>
</ul>
</div>
</div>
<div id="content">
<div class="sect1">
<h2 id="_unix形式日付を普通の日付にする">1. Unix形式日付を普通の日付にする</h2>
<div class="sectionbody">
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-vbscript" data-lang="vbscript">Dim Mon as New Scripting.Dictionary

Mon.Add "Jan",1
Mon.Add "Feb",2
Mon.Add "Mar",3
Mon.Add "Apr",4
Mon.Add "May",5
Mon.Add "Jun",6
Mon.Add "Jul",7
Mon.Add "Aug",8
Mon.Add "Sep",9
Mon.Add "Oct",10
Mon.Add "Nav",11
Mon.Add "Dec",12

dim items As Variant
items = split(line," ")
dim datetime
datetime = item(5) &amp; "/" &amp; mon(items(2)) &amp; "/"
	&amp; items(3) &amp; " " &amp; items(4)</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p>日時（日本標準時）　→　UnixTimestamp</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-VBscript" data-lang="VBscript">=(($a$1 - 25569) * (60 * 60 * 24)) - (60 * 60 * 9)</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p>日時（協定世界時）　→　UnixTimestamp</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-VBscript" data-lang="VBscript">=(($a$1 - 25569) * (60 * 60 * 24))</code></pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
UNIXエポックは1970年1月1日00:00:00で、全てのタイムスタンプの基準点（25569）。
</td>
</tr>
</table>
</div>
<div class="ulist">
<ul>
<li>
<p>UnixTimestamp　→　日時（日本標準時）</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-VBscript" data-lang="VBscript">=25569 + (($a$1 + (60 * 60 * 9)) / (60 * 60 * 24))</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p>UnixTimestamp　→　日時（協定世界時）</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-excel" data-lang="excel">=25569 + (($a$1 ) / (60 * 60 * 24))</code></pre>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_vbe">2. VBE</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_エディタの設定">2.1. [エディタの設定]</h3>
<div class="paragraph">
<p>レジストリ編集を編集してエディタの色を変更する</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-vbscript" data-lang="vbscript">コンピューター\HKEY_CURRENT_USER\SOFTWARE\Microsoft\VBA\7.1\Common

HKEY_CURRENT_USER\Software\Microsoft\VBA\7.1\Common</code></pre>
</div>
</div>
<div class="paragraph">
<p>文字列の編集</p>
</div>
<div class="ulist">
<div class="title">規定の設定</div>
<ul>
<li>
<p>[ CodeBackColors ] 0 0 0 7 6 0 0 0 0 0 0 0 0 0 0 0</p>
</li>
<li>
<p>[ CodeForeColors ] 0 0 5 0 1 10 14 0 0 0 0 0 0 0 0 0</p>
</li>
</ul>
</div>
<div class="ulist">
<div class="title">[おすすめ設定(白系)]</div>
<ul>
<li>
<p>[ CodeBackColors ] 0 0 15 7 6 9 0 0 0 0 0 0 0 0 0 0</p>
</li>
<li>
<p>[ CodeForeColors ] 0 0 4 0 1 4 13 15 0 0 0 0 0 0 0 0</p>
</li>
</ul>
</div>
<div class="ulist">
<div class="title">[おすすめ設定(黒系)]</div>
<ul>
<li>
<p>[ CodeBackColors ] 4 0 7 7 6 4 4 4 0 0 0 0 0 0 0 0</p>
</li>
<li>
<p>[ CodeForeColors ] 7 0 5 4 1 9 11 1 0 0 0 0 0 0 0 0</p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="_ショートカットキー">2.2. ショートカットキー</h3>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 11.1111%;">
<col style="width: 44.4444%;">
<col style="width: 44.4445%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">キー操作</th>
<th class="tableblock halign-left valign-top">説明</th>
<th class="tableblock halign-left valign-top">独自</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">CTRL+A</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">すべて選択</p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">CTRL+B</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">コメントアウト</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">CTRL+C</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">コピー</p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">CTRL+D</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">アンコメント</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">CTRL+E</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">ファイルのエクスポート</p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">CTRL+F</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">検索</p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">CTRL+G</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">イミディエイト ウィンドウ</p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">CTRL+H</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">置換</p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">CTRL+I</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">クイック ヒント</p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">CTRL+J</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">CTRL+K</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">CTRL+L</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">呼び出し履歴</p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">CTRL+M</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">ファイルのインポート</p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">CTRL+N</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">CTRL+O</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">CTRL+P</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">印刷</p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">CTRL+Q</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">終了してMicrosoft Excelへ戻る</p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">CTRL+R</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">プロジェクト エクスプローラー</p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">CTRL+S</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">上書き保存</p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">CTRL+T</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">CTRL+U</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">CTRL+V</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">貼り付け</p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">CTRL+W</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">CTRL+X</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">切り取り</p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">CTRL+Y</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">CTRL+Z</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">元に戻す</p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_変数">3. 変数</h2>
<div class="sectionbody">
<div class="dlist">
<dl>
<dt class="hdlist1">メタ構文変数（メタこうぶんへんすう、metasyntactic variable）</dt>
<dd>
<p>hoge, fuga, piyo, hogera</p>
</dd>
<dt class="hdlist1">フォルダ</dt>
<dd>
<p>fldr</p>
</dd>
<dt class="hdlist1">WorkBook</dt>
<dd>
<p>wb</p>
</dd>
<dt class="hdlist1">WorkSheet</dt>
<dd>
<p>ws</p>
</dd>
<dt class="hdlist1">Range</dt>
<dd>
<p>rng, rg</p>
</dd>
<dt class="hdlist1">最初</dt>
<dd>
<p>FirstRow, FirstColumn</p>
</dd>
<dt class="hdlist1">最終</dt>
<dd>
<p>LastRow, LastColumn</p>
</dd>
<dt class="hdlist1">Controls </dt>
<dd>
<p>ctl</p>
</dd>
</dl>
</div>
<div class="sect2">
<h3 id="_関数系">3.1. 関数系</h3>
<div class="dlist">
<dl>
<dt class="hdlist1">テキスト読み込み</dt>
<dd>
<p>s</p>
</dd>
<dt class="hdlist1">Variant</dt>
<dd>
<p>Var</p>
</dd>
</dl>
</div>
</div>
<div class="sect2">
<h3 id="_文章">3.2. 文章</h3>
<div class="paragraph">
<p>sentence</p>
</div>
<div class="sect3">
<h4 id="_一行">3.2.1. 一行</h4>
<div class="paragraph">
<p>One Line</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_filesystemobject">3.3. FilesystemObject</h3>
<div class="paragraph">
<p>fso</p>
</div>
</div>
<div class="sect2">
<h3 id="_textstream">3.4. TextStream</h3>
<div class="paragraph">
<p>ts</p>
</div>
<div class="paragraph">
<p>ots</p>
</div>
<div class="paragraph">
<p>its</p>
</div>
</div>
<div class="sect2">
<h3 id="_その他">3.5. その他</h3>
<div class="dlist">
<dl>
<dt class="hdlist1">閾値</dt>
<dd>
<p>Threshold</p>
</dd>
<dt class="hdlist1">整列</dt>
<dd>
<p>Alignment</p>
</dd>
<dt class="hdlist1">下限値</dt>
<dd>
<p>lower limit</p>
</dd>
<dt class="hdlist1">上限値</dt>
<dd>
<p>upper limit</p>
</dd>
<dt class="hdlist1">中間値</dt>
<dd>
<p>Median</p>
</dd>
<dt class="hdlist1">集計</dt>
<dd>
<p>agregate</p>
</dd>
</dl>
</div>
<div class="paragraph">
<p>summary	|まとめ</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_初期値">4. 初期値</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_長さ0の文字列">4.1. 長さ0の文字列（""）</h3>

</div>
<div class="sect2">
<h3 id="_値0の文字列vbnullstring">4.2. 値0の文字列（vbNullString）</h3>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-vbscript" data-lang="vbscript">    Dim s As String
    s = "a"
    Debug.Print StrPtr(s)
    s = ""
    Debug.Print StrPtr(s)
    s = vbNullString
    Debug.Print StrPtr(s)</code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_lorem_ipsum">5. lorem ipsum</h2>
<div class="sectionbody">
<div class="paragraph">
<p>lorem ipsum（ロレム・イプサム、略してリプサム lipsum ともいう）</p>
</div>
<div class="paragraph">
<p>ダミーテキスト,サンプルテキスト</p>
</div>
<div class="literalblock">
<div class="content">
<pre> Lorem ipsum dolor sit amet, consectetur adipiscing elit, sed do eiusmod
tempor incididunt ut labore et dolore magna aliqua.
 Ut enim ad minim veniam, quis nostrud exercitation ullamco laboris nisi ut
aliquip ex ea commodo consequat.
 Duis aute irure dolor in reprehenderit in voluptate velit esse cillum dolore
eu fugiat nulla pariatur.
 Excepteur sint occaecat cupidatat non proident, sunt in culpa qui officia
deserunt mollit anim id est laborum.</pre>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_workbook">6. Workbook</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_workbook_新規">6.1. Workbook 新規</h3>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-vbscript" data-lang="vbscript">Dim wb As Workbook
' シートの枚数を指定
Application.SheetsInNewWorkbook = 1
Set wb = Workbooks.Add</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_workbook_開く">6.2. Workbook 開く</h3>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-vbscript" data-lang="vbscript">Workbook.Open "hoge.xlsx"</code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-vbscript" data-lang="vbscript">Workbook.Open Filename:="hoge.xlsx",ReadOnly:=True</code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-vbscript" data-lang="vbscript">Dim wb As Workbook
Set wb = Workbook.Open("hoge.xlsx")</code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-vbscript" data-lang="vbscript">Dim wb As Workbook
Set wb = Workbook.Open(FileName:="hoge.xlsx",ReadOnly:=True)</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_workbook_閉じる">6.3. Workbook 閉じる</h3>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-vbscript" data-lang="vbscript">Application.DisplayAlerts=False
wb.Close
Application.DisplayAlerts=True</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_workbook_保存">6.4. Workbook 保存</h3>
<div class="listingblock">
<div class="title">(1)とか_1とかをファイル末尾につけたりする自作関数</div>
<div class="content">
<pre class="highlight"><code class="language-vbscript" data-lang="vbscript">    Dim s As String
    Dim r As String
    s = Replace(Range("A1"), Chr(34), "")
    r = GetSerialNumberLatestFile(s, "_")
    MsgBox r


Function GetSerialNumberLatestFile(FileName As String, Separater As String) As String
    Const MAX_LONG As Long = 256
    Dim i As Long
    Dim fso As New Scripting.FileSystemObject
    Dim ext As String
    Dim Path As String
    Dim fn As String
    Dim Result As String
    fn = Replace(FileName, Chr(34), "")
    fn = fso.GetBaseName(fn)
    ext = fso.GetExtensionName(FileName)
    Path = fso.GetParentFolderName(FileName)
    Dim Rt As String, Lt As String
    Lt = Mid(Separater, 1, 1): Rt = Mid(Separater, 2, 1)

    For i = MAX_LONG To 0 Step -1
        If i = 0 Then
            Result = fso.BuildPath(Path, fn &amp; "." &amp; ext)
        Else
            Result = fso.BuildPath(Path, fn &amp; Lt &amp; i &amp; Rt &amp; "." &amp; ext)
        End If
'            Debug.Print i, Result
        If fso.FileExists(Result) Then

                Result = fso.BuildPath(Path, fn &amp; Lt &amp; i + 1 &amp; Rt &amp; "." &amp; ext)

'            Debug.Print "#", i, Result
            Exit For
        End If
    Next
    GetSerialNumberLatestFile = Result
End Function</code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-vbscript" data-lang="vbscript">Workbook.Save</code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-vbscript" data-lang="vbscript">Dim SaveTime As String
Savetime = Format(Now,"yyyymmdd_hhmmss")

Workbook.SaveAs "hoge.xlsx"</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_ワークブックを開くとき閉じるとき">6.5. ワークブックを開くとき、閉じるとき</h3>
<div class="listingblock">
<div class="title">[ThisWorkbook]モジュール</div>
<div class="content">
<pre class="highlight"><code class="language-vbscript" data-lang="vbscript">Private Sub Workbook_Open()
    ''起動時に自動実行する記述
End Sub

Private Sub Workbook_BeforeClose(Cancel As Boolean)
    ''終了時に自動実行する記述
End Sub</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">[標準モジュール]</div>
<div class="content">
<pre class="highlight"><code class="language-vbscript" data-lang="vbscript">Sub Auto_Open()
    ' '起動時に自動実行する記述
End Sub

Sub Auto_Close()
    ' '終了時に自動実行する記述
End Sub</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_workbook存在確認">6.6. WorkBook存在確認</h3>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-vbscript" data-lang="vbscript">Sub sample()
    Debug.Print BookExists("sample.xlsm")
End Sub

Function BookExists(Name As String) As Boolean
    Dim wb As Workbook

    For Each wb In Workbooks
        If wb.Name = Name Then
            BookExists = True
            Exit Function
        End If
    Next
    BookExists = False
End Function</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_メニュー追加">6.7. メニュー追加</h3>
<div class="listingblock">
<div class="title">[標準モジュール]</div>
<div class="content">
<pre class="highlight"><code class="language-vbscript" data-lang="vbscript">Const READ_MENU01 As String = "MENU01"
Public Const MENUBARNAME = "Worksheet Menu Bar"

Sub auto_open()
    Call MenuBtnRegist(READ_MENU01, READ_MENU01, READ_MENU01, 300)
End Sub

Sub auto_close()
    Call MenuBtnDelete(READ_MENU01)
End Sub

Private Function MenuSearch(MenuTitle As String) As Boolean
    Dim i As Long
    With ThisWorkbook.Application.CommandBars(MENUBARNAME)
        For i = 1 To .Controls.Count
            If MenuTitle = .Controls.Item(i).Caption Then
                MenuSearch = True
                Exit Function
            End If

        Next

    End With
    MenuSearch = False
End Function

Private Sub MenuBtnRegist(MenuTitle As String, tipText As String, _
                            OnAction As String, FaceId As Long)
    Dim fMenu As CommandBarControl
    Dim MenuRegistFlag As Boolean: MenuRegistFlag = False

    MenuRegistFlag = MenuSearch(MenuTitle)
    If Not MenuRegistFlag Then
        With ThisWorkbook.Application.CommandBars(MENUBARNAME)
            Set fMenu = .Controls.Add(Type:=msoControlButton, Temporary:=True)

            fMenu.Caption = MenuTitle
            fMenu.Style = msoButtonIconAndCaption
            fMenu.TooltipText = tipText
            fMenu.OnAction = OnAction
            fMenu.FaceId = FaceId
        End With
        Set fMenu = Nothing
    End If

End Sub

Private Sub MenuBtnDelete(MenuTitle As String)
    Dim fMenu As CommandBarControl
    Dim Menu As CommandBar

    Set Menu = Application.CommandBars(MENUBARNAME)

    For Each fMenu In menui.Controls
        If fMenu.Caption = "" Then
            fMenu.Delete
        End If
        If fMenu.Caption = MenuTitle Then
            fMenu.Delete
            Exit Sub
        End If
    Next
End Sub



Sub MENU01()
    MsgBox "aaa"
End Sub</code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_worksheets">7. WorkSheets</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_worksheets_追加">7.1. WorkSheets 追加</h3>
<div class="listingblock">
<div class="title">アクティブシートの左に追加</div>
<div class="content">
<pre class="highlight"><code class="language-vbscript" data-lang="vbscript">WorkSheets.Add
WorkSheets.Add before:=ActiveSheet</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">アクティブシートの左に追加</div>
<div class="content">
<pre class="highlight"><code class="language-vbscript" data-lang="vbscript">WorkSheets.Add After:=Activesheet</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">2番目のシート右に２枚追加</div>
<div class="content">
<pre class="highlight"><code class="language-vbscript" data-lang="vbscript">Worksheets.Add After:=Worksheets(2),Count:=2</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">最終シート？の右にシート追加</div>
<div class="content">
<pre class="highlight"><code class="language-vbscript" data-lang="vbscript">Worksheets.Add After:=Worksheets(Worksheets.Count)</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_worksheets_削除">7.2. WorkSheets 削除</h3>
<div class="listingblock">
<div class="title">アクティブシート削除</div>
<div class="content">
<pre class="highlight"><code class="language-vbscript" data-lang="vbscript">Workbooks.Delete</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_worksheet_copyコピー">7.3. worksheet copyコピー</h3>
<div class="listingblock">
<div class="title">sheets3の右にコピー</div>
<div class="content">
<pre class="highlight"><code class="language-vbscript" data-lang="vbscript">Worksheets("Sheet1").Copy After:=Worksheets("Sheet3")</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">sheets3の右にコピー</div>
<div class="content">
<pre class="highlight"><code class="language-vbscript" data-lang="vbscript">Worksheets("Sheet1").Copy before:=Worksheets("Sheet1")</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_sheetexists_シートの存在確認">7.4. SheetExists シートの存在確認</h3>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-vbscript" data-lang="vbscript">Debug.Print SheetExists(ActiveWorkbook, "まとめ")
' workbookからシートを検索
Function SheetExists(Wb As Workbook, Name As String) As Boolean
    Dim v As Variant
    Dim Result As Boolean

    For Each v In Wb.Sheets
        If v.Name = Name Then
            SheetExists = True
            Exit Function
        End If
    Next
    SheetExists = False
End Function</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_すべてのシート選択">7.5. すべてのシート選択</h3>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-VBSCRIPT" data-lang="VBSCRIPT">worksheets.select</code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_cells">8. cells</h2>
<div class="sectionbody">
<div class="paragraph">
<p>完全なセルの指定
.シートの指定</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-VBSCRIPT" data-lang="VBSCRIPT">="'[filename]シート名'!A1"
="'シート名'!A1"</code></pre>
</div>
</div>
<div class="sect2">
<h3 id="_セルを直接selectする">8.1. セルを直接selectする</h3>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-vbscript" data-lang="vbscript">Application.goto worksheet("sheet1").range("A1")</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_行の追加">8.2. 行の追加</h3>
<div class="sect3">
<h4 id="_1行追加">8.2.1. 1行追加</h4>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-vbscript" data-lang="vbscript">Rows(1).Insert
Range("C3").Insert
Rows("2:3").Insert</code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-vbscript" data-lang="vbscript">Rows("B").Insert</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_複数行追加">8.2.2. 複数行追加</h4>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-vbscript" data-lang="vbscript">Range(Rows(2), Rows(4)).Insert</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_1列追加">8.2.3. 1列追加</h4>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-vbscript" data-lang="vbscript">Columns(1).Insert
Columns("C").Insert
Range("C3").EntireColumn.Insert</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_複数列追加">8.2.4. 複数列追加</h4>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-vbscript" data-lang="vbscript">Range(Columns(3), Columns(6)).Insert</code></pre>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_最終行取得">8.3. 最終行取得</h3>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-vbscript" data-lang="vbscript">Dim LastRow As Long
LastRow = Cells(Rows.Count, 1).End(xlUp).Row</code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-vbscript" data-lang="vbscript">Dim LastRow As Long
LastRow = Range("A1").End(xlDown).Row</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_最終列取得">8.4. 最終列取得</h3>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-vbscript" data-lang="vbscript">Dim LastColumn As Long
LastColumn = Cells(1, Columns.Count).End(xlToLeft).Column</code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-vbscript" data-lang="vbscript">Dim LastColumn As Long
LastColumn = Range("A1").End(xlToRight).Column</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_selection">8.5. Selection</h3>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-vbscript" data-lang="vbscript">Range("A3").CurrentRegion.Selct</code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-vbscript" data-lang="vbscript">Worksheets("Sheet1").Activate
ActiveSheet.UsedRange.Select</code></pre>
</div>
</div>
<div class="literalblock">
<div class="content">
<pre>   A B C D E
 ＋ーーーーーーーーーーーーーー
1｜□□□□□
2｜□■■■□
3｜□■■■□
4｜□■■■□
5｜□■■■□
6｜□□□□□</pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-VBSCRIPT" data-lang="VBSCRIPT">    Debug.Print "先頭行 " &amp; Selection.Row
    Debug.Print "行数 " &amp; Selection.Rows.Count
    Debug.Print "最終行 " &amp; Selection(Selection.Count).Row

    Debug.Print "先頭列 " &amp; Selection.Column
    Debug.Print "列数 " &amp; Selection.Columns.Count
    Debug.Print "最終列 " &amp; Selection(Selection.Count).Column

先頭行 2
行数 4
最終行 5
先頭列 2
列数 3
最終列 4</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_セルの指定">8.6. セルの指定</h3>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-vbscript" data-lang="vbscript">Range("C3").Select

	   A B C D E
	 ＋ーーーーーーーーーーーーーー
	1｜□□□
	2｜□□□
	3｜□□■
	4｜
	5｜
	6｜
	7｜
	8｜
	9｜</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><span class="red">エラーになる</span></p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-VBscript" data-lang="VBscript">Range(Cells(3,3)).Select</code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-vbscript" data-lang="vbscript">Range("A3:B6").Select

	   A B C D E
	 ＋ーーーーーーーーーーーーーー
	1｜
	2｜
	3｜■■
	4｜■■
	5｜■■
	6｜■■
	7｜
	8｜
	9｜</code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-vbscript" data-lang="vbscript">Range("A3,B6").Select

	   A B C D E
	 ＋ーーーーーーーーーーーーーー
	1｜
	2｜
	3｜■
	4｜
	5｜
	6｜　■
	7｜
	8｜
	9｜</code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-vbscript" data-lang="vbscript">Range("A3","B6").Select
	   A B C D E
	 ＋ーーーーーーーーーーーーーー
	1｜
	2｜
	3｜■■
	4｜■■
	5｜■■
	6｜■■
	7｜
	8｜
	9｜</code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-vbscript" data-lang="vbscript">Range("A3:B6","C9:D12").Select

	   A B C D E
	 ＋ーーーーーーーーーーーーーー
	1｜
	2｜
	3｜■■■■
	4｜■■■■
	5｜■■■■
	6｜■■■■
	7｜■■■■
	8｜■■■■
	9｜■■■■
	0｜■■■■
	1｜■■■■
	2｜■■■■
	3｜</code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-vbscript" data-lang="vbscript">Range(Cells(3,3), Cells(6,6)).Select

	   A B C D E
	 ＋ーーーーーーーーーーーーーー
	1｜
	2｜
	3｜　　■■■■
	4｜　　■■■■
	5｜　　■■■■
	6｜　　■■■■
	7｜</code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-vbscript" data-lang="vbscript">Range("A3:B6,C9:D12").Select

	   A B C D E
	 ＋ーーーーーーーーーーーーーー
	1｜
	2｜
	3｜■■
	4｜■■
	5｜■■
	6｜■■
	7｜
	8｜
	9｜　　■■
	0｜　　■■
	1｜　　■■
	2｜　　■■
	3｜</code></pre>
</div>
</div>
<div class="sect3">
<h4 id="_セルの指定_2">8.6.1. セルの指定</h4>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-vbscript" data-lang="vbscript">?range(cells(1,1),cells(3,3)).Address
$A$1:$C$3
?range(rows(1),rows(3)).Address
$1:$3
?range(columns(1),columns(3)).Address

$A:$C


?Columns(4).Addreas
$D:$D

?Columns(4).Address(,false)
D:D</code></pre>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_セルの追加">8.7. セルの追加</h3>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-vbscript" data-lang="vbscript">' 引数なしなら左に移動'
Range("A3:B6").Insert</code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-vbscript" data-lang="vbscript">Range("A3:B6").Insert shift:=xlShiftToRight</code></pre>
</div>
</div>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 1. XlInsertShiftDirection 列挙 (Excel)</caption>
<colgroup>
<col style="width: 44.4444%;">
<col style="width: 11.1111%;">
<col style="width: 44.4445%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">名前</th>
<th class="tableblock halign-left valign-top">値</th>
<th class="tableblock halign-left valign-top">説明</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">xlShiftDown</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">-4121</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">セルを挿入後、下に伸ばす</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">xlShiftToRight</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">-4161</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">セルを挿入後、右に伸ばす</p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect2">
<h3 id="_セルの値コピー">8.8. セルの値コピー</h3>
<div class="paragraph">
<p>空白も含めてコピーしてくれる</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-vbscript" data-lang="vbscript">Dim v As Variant
v = Range("e2:e6").Value

Range("g2:g6") = v</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_セルの値コピーfill">8.9. セルの値コピー(Fill*)</h3>
<div class="ulist">
<ul>
<li>
<p>次の使用例は、シート 1 のセル A1 の内容をセル A1:A10 の範囲に複写します。</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-VBscript" data-lang="VBscript">Worksheets("Sheet1").Range("A1:A10").FillDown</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p>次の使用例は、シート 1 のセル M1 の内容と書式をセル範囲 A1:M1 に複写します。</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-VBscript" data-lang="VBscript">Worksheets("Sheet1").Range("A1:M1").FillLeft</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p>次の使用例は、シート 1 のセル A1 の内容と書式をセル範囲 A1:M1 に複写します。</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-VBscript" data-lang="VBscript">Worksheets("Sheet1").Range("A1:M1").FillRight</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p>次の使用例は、シート 1 のセル A10 の内容と書式をセル範囲 A1:A10 に複写します。</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-VBscript" data-lang="VBscript">Worksheets("Sheet1").Range("A1:A10").FillUp</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_セル配列">8.10. セル　↔　配列</h3>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-vbscript" data-lang="vbscript">Dim var as Variant
var = Range("A1:C3")
Range("A1:C3") = var</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_コピペ">8.11. コピペ</h3>
<div class="listingblock">
<div class="title">普通にコピペ</div>
<div class="content">
<pre class="highlight"><code class="language-VBSCRIPT" data-lang="VBSCRIPT">Range("R25:R30").Select
Selection.Copy
Range("U25").Select
Selection.PasteSpecial</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">1列をコピーして1行にペースト</div>
<div class="content">
<pre class="highlight"><code class="language-VBSCRIPT" data-lang="VBSCRIPT">Range("R25:R30").Select
Selection.Copy
Range("U25").Select
Selection.PasteSpecial Transpose:=True</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_ソート">8.12. ソート</h3>
<div class="ulist">
<ul>
<li>
<p>A1:C5の範囲をA1を基準にソート</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-VBscript" data-lang="VBscript">Range(cells(1,1),cells(5,3))

Call Range("A1:C5").Sort(key1:=Range("A1"), _
    order1:=xlDescending)

'タイトルありの場合
Call Range(Cells(HEADER_SPACE + 1, DstColmn), Cells(LastRow, DstColmn)). _
    Sort(Header:=xlYes, key1:=Cells(HEADER_SPACE + 1, DstColmn), order1:=xlAscending)

Call Range(Cells(1, 1), Cells(5, 3)).Sort(key1:=Range(Cells(1, 1), Cells(1, 1)), _
    order1:=xlDescending)

Call Range(Cells(1, 1), Cells(5, 3)).Sort(key1:=Cells(1, 1), _
    order1:=xlDescending)</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">A1:C5の範囲をA1,B1を基準にソート</div>
<div class="content">
<pre class="highlight"><code class="language-VBSCRIPT" data-lang="VBSCRIPT">Call Range("A1:C5").Sort(key1:=Range("A1"), _
    order1:=xlAscending, _
    key2:=Range("B1"), _
    order2:=xlAscending)</code></pre>
</div>
</div>
<div class="sect3">
<h4 id="_セル配列変数">8.12.1. セル配列　→　変数</h4>
<div class="literalblock">
<div class="content">
<pre>   A B C D E
 ＋ーーーーーーーーーーーーーー
1｜□□□□□
2｜□ＡＥＩ□
3｜□ＢＦＪ□
4｜□ＣＧＫ□
5｜□ＤＨＬ□
6｜□□□□□</pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-VBSCRIPT" data-lang="VBSCRIPT">    Dim 一次元配列 As Variant
    Dim 二次元配列 As Variant

    二次元配列 = Range("B2:D5")
    一次元配列 = WorksheetFunction.Index(二次元配列, 3)
    Debug.Print "3行目 " &amp; Join(一次元配列, ",")
'3行目 C,G,K

    一次元配列 = WorksheetFunction.Index(WorksheetFunction.Transpose(二次元配列), 1)
    Debug.Print "1列目 " &amp; Join(一次元配列, ",")
'1列目 A,B,C,D</code></pre>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_アドレス指定">8.13. アドレス指定</h3>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-VBSCRIPT" data-lang="VBSCRIPT">ActiveCell.Address
$A$1

Activecell.Address(RowAbsolute:=False)
$A1

Activecell.Address(ColumnAbsolute:=False)
A$1

Activecell.Address(RowAbsolute:=False, _
		ColumnAbsolute:=False)
A1

Activecell.Address(ReferenceStyle:= xlA1)
A1 形式(デフォルト)

Activecell.Address(ReferenceStyle:= xlR1C1)
R1C1 形式


Set mc = Worksheets("Sheet1").Cells(1, 1)
MsgBox mc.Address() ' $A$1
MsgBox mc.Address(RowAbsolute:=False) ' $A1
MsgBox mc.Address(ReferenceStyle:=xlR1C1) ' R1C1
MsgBox mc.Address(ReferenceStyle:=xlR1C1, _
    RowAbsolute:=False, _
    ColumnAbsolute:=False, _
    RelativeTo:=Worksheets(1).Cells(3, 3)) ' R[-2]C[-2]</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_ハイパーリンク">8.14. ハイパーリンク</h3>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-vbscript" data-lang="vbscript">Sheets(1).Hyperlinks.Add Range("E2"), "", "'Sheet2'!G2"
Sheets(1).Hyperlinks.Add Anchor:=Range("E2"), Address:="",SubAddress:="'Sheet2'!G2"</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_セルフォントに色をつける">8.15. セル,フォントに色をつける</h3>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-vbscript" data-lang="vbscript">Range("A1").Interior.Color = vbYellow
Range("A1").Font.Color = vbRed</code></pre>
</div>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 16.6666%;">
<col style="width: 16.6666%;">
<col style="width: 66.6668%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">定数</th>
<th class="tableblock halign-left valign-top">値</th>
<th class="tableblock halign-left valign-top">説明</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">vbBlack</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0x000000</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">黒</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">vbRed</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0xFF0000</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">赤</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">vbGreen</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0x00FF00</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">緑</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">vbYellow</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0xFFFF00</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">黄</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">vbBlue</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0xFF0000</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">青</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">vbMagenta</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0xFF00FF</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">紫</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">vbCyan</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0xFFFF00</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">シアン</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">vbWhite</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0xFFFFFF</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">白</p></td>
</tr>
</tbody>
</table>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 2. qbcolor</caption>
<colgroup>
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">数値</th>
<th class="tableblock halign-left valign-top">色</th>
<th class="tableblock halign-left valign-top">数値</th>
<th class="tableblock halign-left valign-top">色</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">0</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">黒</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">8</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">灰色</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">1</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">青</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">9</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">明るい青</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">2</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">緑</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">10</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">明るい緑</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">3</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">水色</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">11</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">明るい水色</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">4</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">赤</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">12</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">明るい赤</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">5</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">紫</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">13</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">明るい紫</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">6</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">黄</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">14</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">明るい黄</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">7</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">白</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">15</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">明るい白</p></td>
</tr>
</tbody>
</table>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 10%;">
<col style="width: 10%;">
<col style="width: 10%;">
<col style="width: 10%;">
<col style="width: 10%;">
<col style="width: 10%;">
<col style="width: 10%;">
<col style="width: 10%;">
<col style="width: 10%;">
<col style="width: 10%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">xlThemeColorDark1</th>
<th class="tableblock halign-left valign-top">xlThemeColorLight1</th>
<th class="tableblock halign-left valign-top">xlThemeColorDark2</th>
<th class="tableblock halign-left valign-top">xlThemeColorLight2</th>
<th class="tableblock halign-left valign-top">xlThemeColorAccent1</th>
<th class="tableblock halign-left valign-top">xlThemeColorAccent2</th>
<th class="tableblock halign-left valign-top">xlThemeColorAccent3</th>
<th class="tableblock halign-left valign-top">xlThemeColorAccent4</th>
<th class="tableblock halign-left valign-top">xlThemeColorAccent5</th>
<th class="tableblock halign-left valign-top">xlThemeColorAccent6</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">xlThemeColorDark1</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">xlThemeColorLight1</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">xlThemeColorDark2</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">xlThemeColorLight2</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">xlThemeColorAccent1</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">xlThemeColorAccent2</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">xlThemeColorAccent3</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">xlThemeColorAccent4</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">xlThemeColorAccent5</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">xlThemeColorAccent6</p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect2">
<h3 id="_セルの検索">8.16. セルの検索</h3>
<div class="ulist">
<ul>
<li>
<p>Object.Find(What, After, LookIn, LookAt, SearchOrder, SearchDirection, MatchCase, MatchByte, SearchFormat)</p>
</li>
<li>
<p>Object.FindNext(After)</p>
</li>
<li>
<p>Object.FindPrevious(After)</p>
</li>
</ul>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 20%;">
<col style="width: 80%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">設定項目</th>
<th class="tableblock halign-left valign-top">内容</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Object</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Rangeオブジェクト</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">What</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">検索するデータを指定 [省略不可]</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">After</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">単一のセルを指定。この引数に指定したセルの次のセルから検索を開始する。省略するとObjectで指定したセル範囲の左上端セルの次のセルから検索する [省略可能]</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">LookIn</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">検索の対象を指定 数式（xlFormulas）、値（xlValues）、コメント（xlComments） [省略可能]</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">LookAt</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">完全に同一なセルだけを検索（xlWhole）、一部分でも一致するセルの検索（xlPart） [省略可能]</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">SearchOrder</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">検索方向を指定する。列方向に検索する（xlByColumns）、行方向に検索する（xlByRows） [省略可能]</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">SearchDirection</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">前方に検索(xlNext：既定値)、後方に検索(xlPrevious)[省略可能]</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">MatchCase</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">大文字と小文字を区別する(True)、区別しない(False) [省略可能]</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">MatchByte</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">半角と全角を区別する(True)、区別しない(False) [省略可能]</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">SearchFormat</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">書式を検索する (True)、検索しない(False) [省略可能]（※）</p></td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_変数_2">9. 変数</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_値のない場合の表現">9.1. 値のない場合の表現</h3>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 16.6666%;">
<col style="width: 16.6666%;">
<col style="width: 66.6668%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">種類</th>
<th class="tableblock halign-left valign-top">型</th>
<th class="tableblock halign-left valign-top">判定</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Empty</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Variant</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">IsEmpty if(IsEmpty(s)=0)</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Nothing</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Object</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">IsNothing if (Object is Nothing)</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Null</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Variant</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">IsNull　If (isNull(s) = True)</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">""</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">String</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">単純比較　IF(s = "")</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">VbNullString</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">String</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">StrPtr if(strPtr(s) = 0)</p></td>
</tr>
</tbody>
</table>
<div class="sect3">
<h4 id="_empty">9.1.1. Empty</h4>
<div class="paragraph">
<p>空白のセルの値</p>
</div>
<div class="paragraph">
<p>Variant変数の初期値</p>
</div>
<div class="paragraph">
<p>IsEmpty</p>
</div>
</div>
<div class="sect3">
<h4 id="_nothing">9.1.2. Nothing</h4>
<div class="paragraph">
<p>Object 型の初期値</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-vbscript" data-lang="vbscript">IF Object is Nothing Then
    ...
ElseIF (Not (Object is Nothing))</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_null">9.1.3. Null</h4>
<div class="paragraph">
<p>Variant型で指定</p>
</div>
<div class="paragraph">
<p>Emptyは[未設定]</p>
</div>
<div class="paragraph">
<p>Null値は[値が無い]</p>
</div>
<div class="paragraph">
<p>IsNull</p>
</div>
</div>
<div class="sect3">
<h4 id="">9.1.4. ""</h4>
<div class="paragraph">
<p>空文字</p>
</div>
<div class="paragraph">
<p>String型</p>
</div>
</div>
<div class="sect3">
<h4 id="_vbnullstring">9.1.5. VbNullString</h4>
<div class="paragraph">
<p>String型の初期値</p>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_関数">10. 関数</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_配列を受け取る関数">10.1. 配列を受け取る関数</h3>
<div class="listingblock">
<div class="title">●渡す側（呼び出し元）●</div>
<div class="content">
<pre class="highlight"><code class="language-vbscript" data-lang="vbscript">Sub PassArg()
    Dim i As Long
    Dim myArray(3) As String

    For i = LBound(myArray) To UBound(myArray)
        myArray(i) = "値" &amp; i
    Next i

    Call RecArg(myArray)
End Sub</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">●受け手側●</div>
<div class="content">
<pre class="highlight"><code class="language-vbscript" data-lang="vbscript">Sub RecArg(myArg() As String)
    Dim j As Long
    Dim Msg As String

    For j = LBound(myArg) To UBound(myArg)
        Msg = Msg &amp; myArg(j) &amp; vbCrLf
    Next j

    MsgBox Msg
End Sub</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_fix_int_round_四捨五入切り捨て">10.2. fix, int, round, 四捨五入、切り捨て</h3>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 3. int</caption>
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">1.5</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">1.4</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">-1.4</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">-2</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">-1.5</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">-2</p></td>
</tr>
</tbody>
</table>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 4. fix</caption>
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">1.5</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">1.4</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">-1.4</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">-1</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">-1.5</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">-1</p></td>
</tr>
</tbody>
</table>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 5. round(x,0)</caption>
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">1.5</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">1.4</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">-1.4</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">-1</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">-1.5</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">-2</p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect2">
<h3 id="_vbaで関数名を変数で使う">10.3. VBAで関数名を変数で使う</h3>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-vbscript" data-lang="vbscript">    Dim i As Long

    For i = 1 To 2
       Application.Run "Call_" &amp; i
    Next

Sub Call_1()
    MsgBox "Call_1"
End Sub

Sub Call_2()
    MsgBox "Call_2"
End Sub</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_httpリクエスト">10.4. HTTPリクエスト</h3>
<div class="paragraph">
<p>参照設定	Microsoft XML v6.0</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-vbscript" data-lang="vbscript">Sub HTTPRequest()
    Dim httpReq As New XMLHTTP60
    httpReq.Open "get", "http://natori-yuko.main.jp/"
    httpReq.send
'    Do While httpReq.readyState &lt; READYSTATE_COMPLETE
    Do While httpReq.readyState &lt; 4
        DoEvents
    Loop
    Debug.Print httpReq.responseText
End Sub</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_sprintf関数">10.5. sprintf関数</h3>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-VBSCRIPT" data-lang="VBSCRIPT">Sub sample()
    Dim str As String
    Dim t As String
    Dim i As Long
    i = 100
    t = "This is a pen."
    str = sprintf("%s%s", t, CLng(i))
    Debug.Print str
End Sub

Public Function sprintf(ByVal st As String, ParamArray args() As Variant) As String
    st = Replace(st, "\n", vbNewLine)
    Dim s() As String: s = Split(st, "%s")
    If (UBound(args) + 1) &lt;&gt; UBound(s) Then
        Err.Raise 1000, "sprintf", "sprintf関数:" &amp; _
            "%sの数と引数の数が一致していません。"
        sprintf = st
        Exit Function
    End If

    Dim buf As String: buf = s(0)
    Dim i As Integer
    For i = 0 To UBound(args)
        buf = buf &amp; args(i) &amp; s(i + 1)
    Next i

    sprintf = buf
End Function</code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_ファイル">11. ファイル</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_ファイル読み込みsjisfilesystemobject">11.1. ファイル読み込み(sjis,FileSystemObject)</h3>
<div class="dlist">
<dl>
<dt class="hdlist1">参照設定</dt>
<dd>
<p>Microsoft ScrptingRuntime</p>
</dd>
</dl>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-VBSCRIPT" data-lang="VBSCRIPT">Dim fso As New Scrpting.Filesystemobject
Dim ts as TextSream
Dim s As String

Set ts = fso.OpenTextFile(FileName)

Do While ts.AtEndOfStream &lt;&gt; True
    s = ts.ReadLine
    ...
Loop
ts.Close</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_ファイル読み込みutf_8adodb">11.2. ファイル読み込み(UTF-8,ADODB)</h3>
<div class="dlist">
<dl>
<dt class="hdlist1">参照設定</dt>
<dd>
<p>Microsoft ActiveX Data Objects 6.0 Library</p>
</dd>
</dl>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-VBSCRIPT" data-lang="VBSCRIPT">Dim i As Long
Dim s As String
Dim text As String
Dim ado As New ADODB.Stream
With ado
    .Charset = "utf-8"
    .Open
    .LoadFromFile (Filename)
    .Close
        text = Split(s, vbLf)
        For i = LBound(text) To UBound(text)
    	Debug.Print text(i)
        Next
End With</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_ファイル書き込みsjisfilesystemobject">11.3. ファイル書き込み(sjis,FileSystemObject)</h3>
<div class="dlist">
<dl>
<dt class="hdlist1">参照設定</dt>
<dd>
<p>Microsoft ScrptingRuntime</p>
</dd>
</dl>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-VBSCRIPT" data-lang="VBSCRIPT">Dim fso As New Scrpting.Filesystemobject
Dim ts as TextSream

' ファイルが存在すればサイズ0にして書き込み
Set ts = fso.OpenTextFile(FileName,ForWriting,True)
ts.WriteLine("This is a  pen.")
ts.Close</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_ファイル書き込みutf_8adodb">11.4. ファイル書き込み(UTF-8,ADODB)</h3>
<div class="dlist">
<dl>
<dt class="hdlist1">参照設定</dt>
<dd>
<p>Microsoft ActiveX Data Objects 6.0 Library</p>
</dd>
</dl>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-VBSCRIPT" data-lang="VBSCRIPT">Dim ado As New ADODB.STream
dim d as string

ado.Type = adTypeText
ado.LineSeparator = 10
ado.Charset = "UTF-8"
ado.Open
ado.WriteText "This is a pen.",adWriteLine
ado.SaveToFile "C:\text.txt", assaveCreateoverwrite
ado.close</code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-VBSCRIPT" data-lang="VBSCRIPT">Dim ado As New ADODB.STream

ado.Type = adTypeText
ado.Charset = "UTF-8"
ado.LineSeparator = 10

ado.Open
ado.WriteText "これはぺんです", 0	' 改行コードなし
ado.WriteText "これはぺんです", 1	' 改行コードあり
Dim s As String
s = ThisWorkbook.Path &amp; "\f.txt"
ado.SaveToFile s, adSaveCreateOverWrite
ado.Close</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_ファイル一覧取得">11.5. ファイル一覧取得</h3>
<div class="dlist">
<dl>
<dt class="hdlist1">参照設定</dt>
<dd>
<p>Microsoft ScrptingRuntime</p>
</dd>
</dl>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-VBSCRIPT" data-lang="VBSCRIPT">Dim f As File
Dim fso As New Scripting.FileSystemObject

For Each f in fso.GetFolder(Path).Files
    f.Name,F.Type
Next</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_フォルダ一覧">11.6. フォルダ一覧</h3>
<div class="dlist">
<dl>
<dt class="hdlist1">参照設定</dt>
<dd>
<p>Microsoft ScrptingRuntime</p>
</dd>
</dl>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-VBSCRIPT" data-lang="VBSCRIPT">Dim fd As Folder
Dim fso As New Scrpting.Filesystemobject

For Each fd In fso.getFolder(Path).subFolders
    fd.Name fd.Path
Next</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_フォルダを再起してファイル一覧取得">11.7. フォルダを再起してファイル一覧取得</h3>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-VBSCRIPT" data-lang="VBSCRIPT">Sub sample()
    Dim fs As New Collection
    Dim v As Variant

    Call FolderSearch("C:\Users\yossym\Desktop\share", fs)

    Dim i As Long: i = 1
    For Each v In fs
        Cells(i, 1) = v
        Cells(i, 2) = v.Type
        Cells(i, 3) = v.Name
        Cells(i, 4) = v.Path
        i = i + 1

    Next
End Sub

Public Sub FolderSearch(Path As String, fs As Collection)

    Dim fso As New Scripting.FileSystemObject
    Dim folder As folder
    Dim subfolder As folder
    Dim f As file

    Set folder = fso.GetFolder(Path)

    'フォルダ内のサブフォルダを列挙
    '（サブフォルダがなければループ内は通らず）
    For Each subfolder In folder.SubFolders
        '再帰的呼び出し
        Call FolderSearch(subfolder.Path, fs)
    Next subfolder

    'カレントフォルダ内のファイルを列挙
    For Each f In folder.Files
        ' file オブジェクトを代入
        fs.Add f
    Next f

End Sub</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_ado">11.8. ado</h3>
<div class="sect3">
<h4 id="_adoでcsv読み込み">11.8.1. adoでcsv読み込み</h4>
<div class="dlist">
<dl>
<dt class="hdlist1">参照設定</dt>
<dd>
<p>Microsoft ActiveX Data Objects 6.0 Library</p>
</dd>
</dl>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-VBSCRIPT" data-lang="VBSCRIPT">sub ado_read_csv()
    dim con As New ADODB.Connection
    dim rs As New ADODB.RecordSet

    dim Folder As String

    Dim sql As String
    Folder = ThisworkBook.Path

    ' スペースを含むitemでも[]で囲むとエラーにならない
    sql = "Select [*] from [database.csv]"

    with con
        .Provider="Microsoft.ACE.OLEDB.12.0"
        .Propaeries("Extended Properties")
        .open Folder
    end with

    rs.open source:=sql, _
        AcriveConnection:=con, _
        CursorType := adoOpenStatic

    Dim i Ad Long
    Rs.Movefirst

    ' ヘッダ書き込み
    For i = 0 to rs.Fields.Count -1
        Cells(1, i+1).= rs.Fields(i).Name
    Next

    range("A2").CopyromRecordset rs

    rs.MoveFitst
    ' これ登録件数
    'rs.RecordCount
    do until rs.EOF
        for
        rd.MoveNext
    Loop

    rs.Close
    Con.Close

end Sub</code></pre>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_adodb_recordsetで2次元配列ソート">11.9. ADODB.RecordSetで2次元配列ソート</h3>
<div class="dlist">
<dl>
<dt class="hdlist1">参照設定</dt>
<dd>
<p>Microsoft ActiveX Data Objects 6.0 Library</p>
</dd>
</dl>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 16.6666%;">
<col style="width: 16.6666%;">
<col style="width: 66.6668%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">定数</th>
<th class="tableblock halign-left valign-top">値</th>
<th class="tableblock halign-left valign-top">説明</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">adbigint</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1280</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">8 バイトの符号付き整数を示します (DBTYPE_I8)。</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">adboolean</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">#</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">ブール値を示します (DBTYPE_BOOL)。</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">adbstr</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">~</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">null で終わる文字列 (Unicode) を示します (DBTYPE_BSTR)。</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">adchar</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">129</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">文字列値を示します (DBTYPE_STR)。</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">addbtimestamp</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">135</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">日付/タイム スタンプ (yyyymmddhhmmss および 10 億分の 1 桁までの分数) を示します (DBTYPE_DBTIMESTAMP)。</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">addouble</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">5</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">倍精度浮動小数点値を示します (DBTYPE_R8)。</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">adinteger</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">3</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">4 バイトの符号付き整数を示します (DBTYPE_I4)。</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">adguid</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">72</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">グローバル一意識別子 (GUID) を示します (DBTYPE_GUID)。</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">adVarChar</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">200</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">文字列値を示します。</p></td>
</tr>
</tbody>
</table>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-VBSCRIPT" data-lang="VBSCRIPT">Const advarchar = 200
Const addouble = 5
Const adinteger = 3
dim rs
Set rs = CreateObject("ADODB.RecordSet")

'DataTypeEnum
call rs.Fields.Append("aptime",addouble)
call rs.Fields.Append("ant",adinteger)
' 文字列は長さも指定する'
call rs.Fields.Append("result",advarchar, 250)

call rs.Open
  rs.AddNew
    rs.Fields("aptime")  = 12345.234
    rs.Fields("ant")  = 1
    rs.Fields("result")  = "OK"

    rs.sort = "ant,aptime"</code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_特殊フォルダ">12. 特殊フォルダ</h2>
<div class="sectionbody">
<div class="dlist">
<dl>
<dt class="hdlist1">参照設定</dt>
<dd>
<p>Microsoft ScrptingRuntime</p>
</dd>
</dl>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_ファイル選択dialog">13. ファイル選択Dialog</h2>
<div class="sectionbody">
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-vbscript" data-lang="vbscript">Sub sample()
    Dim cs As New Collection
    Dim Var As Variant

    'ファイルを1つ選択
    Set cs = SelectFiles("CSVファイル(*.csv),*.csv", False)
    Debug.Print cs.Count
    For Each Var In cs
        Debug.Print Var
    Next

    'ファイルを複数選択
    Set cs = SelectFiles("CSVファイル(*.csv),*.csv", True, "せんたく")
    Debug.Print cs.Count
    For Each Var In cs
        Debug.Print Var
    Next

    'ファイルを複数選択　＆　filterも複数
    Dim s As String
    s = "テキストファイル(*.txt;*.log),*.txt;*.log,すべてのファイル(*.*),*.*"
    Set cs = SelectFiles(s, True, "せんたく")
    Debug.Print cs.Count
    For Each Var In cs
        Debug.Print Var
    Next

End Sub

Function SelectFiles(Filter As String, Multiselect As Boolean, Optional Title As String = "ファイル選択") As Collection
    Dim c As New Collection
    Dim fs As Variant

    fs = Application.GetOpenFilename( _
        FileFilter:=Filter, _
        Multiselect:=Multiselect, _
        Title:=Title)

    Dim i As Long
    If IsArray(fs) Then
        For i = LBound(fs) To UBound(fs)
            c.Add fs(i)
        Next
    Else
        If fs &lt;&gt; False Then
            c.Add fs
        End If
    End If

    Set SelectFiles = c
End Function</code></pre>
</div>
</div>
<div class="sect2">
<h3 id="_1ファイル選択">13.1. 1ファイル選択</h3>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-vbscript" data-lang="vbscript">Dim myFile As Variant

ChDir ThisWorkbook.Path
myFile = Application.GetOpenFilename("CSVファイル(*.csv),*.csv")

If VarType(myFile) = vbBoolean Then
    MsgBox "キャンセルされました"
Else
    MsgBox myFile &amp; " が選択されました"
End If</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_タイトルを変更">13.2. タイトルを変更</h3>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-vbscript" data-lang="vbscript">myFile = Application.GetOpenFilename( _
	filefilter:="CSVファイル(*.csv),*.csv", _
	Title:="This is a pen.")</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_複数ファイル">13.3. 複数ファイル</h3>
<div class="listingblock">
<div class="title">Multiselectがポイント</div>
<div class="content">
<pre class="highlight"><code class="language-vbscript" data-lang="vbscript">Dim f As Variant
fs = Application.GetOpenFilename( _
filefilter:="Excel ファイル (*.xls; *.xlsx),*.xls; *.xlsx", _
 MultiSelect:=True)

If IsArray(fs) Then
    For Each f In fs
        Debug.Print f
    Next
Else
    Debug.Print fs
End If</code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_フォルダ選択dialog">14. フォルダ選択Dialog</h2>
<div class="sectionbody">
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-vbscript" data-lang="vbscript">Private Function SelectFolder() As String
    Dim Result As String:  Result = ""
    With Application.FileDialog(msoFileDialogFolderPicker)
        .AllowMultiSelect = False
        .Title = "フォルダ選択"
        .ButtonName = "OK"
        If .Show Then
            Result = .SelectedItems(1)
        End If
    End With
    SelectFolder = Result
End Function</code></pre>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_vbscript_これだけ書いとけ">15. VBScript これだけ書いとけ</h2>
<div class="sectionbody">
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-vbscript" data-lang="vbscript">Option Explicit

Dim w,args
dim fso
Set w    = WScript
Set args = w.Arguments
set fso  = w.CreateObject("Scripting.FileSystemObject")

Const ForReading   = 1
Const ForWriting   = 2
Const ForAppending = 8

sub Usage
    w.echo w.ScriptName  _
    , VBNewLine _
    , " bat arguments"
end sub

sub rw(FileName)

    Dim its
    Set its = fso.OpenTextFile(FileName, ForReading )

    dim  ots, oFileName
    oFileName = FileName &amp; ".csv"
    set ots = fso.OpenTextFile(oFileName, ForWriting, True)

    Do Until its.AtEndOfStream
        Dim line
        line = its.ReadLine
        ots.WriteLine line
    Loop

    its.close
    ots.close

end sub

sub Main
    if w.Arguments.Count = 0 then
        usage
    end if

    dim i
    set fso = WScript.CreateObject("Scripting.FileSystemObject")

    dim arg
    for each arg in args
        ' w.echo w.scriptFullName _
        ' , vbnewline _
        ' , w.scriptname _
        ' , vbnewline _
        ' , arg
        rw(arg)
    next

end sub

Main</code></pre>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_filesystemobject_オブジェクト">16. FileSystemObject オブジェクト</h2>
<div class="sectionbody">
<div class="dlist">
<dl>
<dt class="hdlist1">参照設定</dt>
<dd>
<p>Microsoft ScrptingRuntime</p>
</dd>
</dl>
</div>
<div class="paragraph">
<p>コンピューターのファイル システムへのアクセスを提供します。</p>
</div>
<div class="listingblock">
<div class="title">構文</div>
<div class="content">
<pre class="highlight"><code class="language-vbscript" data-lang="vbscript">Scripting.FileSystemObject</code></pre>
</div>
</div>
<div class="paragraph">
<div class="title">注釈</div>
<p>次のコードはFileSystemObjectオブジェクトを使用して読み書き可能な<strong>TextStream</strong>
オブジェクトを返す方法を示しています。</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-vbscript" data-lang="vbscript">Set fs = CreateObject("Scripting.FileSystemObject")
Set a = fs.CreateTextFile("c:\testfile.txt", True)
a.WriteLine("This is a test.")
a.Close</code></pre>
</div>
</div>
<div class="paragraph">
<p>コード例では、次のとおりです。</p>
</div>
<div class="ulist">
<ul>
<li>
<p>CreateObject 関数は FileSystemObject (fs) を返します。</p>
</li>
<li>
<p>CreateTextFile メソッドは、ファイルを TextStream オブジェクト (a) として作成します。</p>
</li>
<li>
<p>WriteLine メソッドは、作成されたテキスト ファイルにテキスト行を書き込みます。</p>
</li>
<li>
<p>Close メソッドは、バッファーをフラッシュし、ファイルを閉じます。</p>
</li>
</ul>
</div>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 6. メソッド</caption>
<colgroup>
<col style="width: 20%;">
<col style="width: 80%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">メソッド</th>
<th class="tableblock halign-left valign-top">説明</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">BuildPath</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">既存のパスに名前を追加します。</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">CopyFile</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1 つ以上のファイルを別の場所にコピーします。</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">CopyFolder</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1 つ以上のフォルダーを別の場所にコピーします。</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">CreateFolder</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">新しいフォルダーを作成します。</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">CreateTextFile</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">テキスト ファイルを作成し、ファイルの読み取りまたは書き込みに使用できる TextStream オブジェクトを返します。</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">DeleteFile</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">指定した 1 つ以上のファイルを削除します。</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">DeleteFolder</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">指定した 1 つ以上のフォルダーを削除します。</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">DriveExists</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">指定したドライブが存在するかどうかを確認します。</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">FileExists</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">指定したファイルが存在するかどうかを確認します。</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">FolderExists</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">指定したフォルダーが存在するかどうかを確認します。</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">GetAbsolutePathName</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">指定したパスのドライブのルートからの完全なパスを返します。</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">GetBaseName</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">指定したファイルまたはフォルダーのベース名を返します。</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">GetDrive</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">指定したパスのドライブに対応するドライブ オブジェクトを返します。</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">GetDriveName</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">指定したパスのドライブ名を返します。</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">GetExtensionName</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">指定したパスの最後のコンポーネントのファイル拡張子名を返します。</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">GetFile</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">指定したパスのファイル オブジェクトを返します。</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">GetFileName</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">指定したパスの最後のコンポーネントのファイル名またはフォルダー名を返します。</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">GetFolder</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">指定したパスのフォルダー オブジェクトを返します。</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">GetParentFolderName</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">指定したパスの最後のコンポーネントの親フォルダーの名前を返します。</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">GetSpecialFolder</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Windows の一部の特殊フォルダーのパスを返します。</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">GetTempName</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">ランダムに生成された一時ファイルまたはフォルダーを返します。</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Move</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">指定したファイルまたはフォルダーを別の場所に移動します。</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">MoveFile</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1 つ以上のファイルを別の場所に移動します。</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">MoveFolder</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1 つ以上のフォルダーを別の場所に移動します。</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">OpenAsTextStream</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">指定したファイルを開き、開いたファイルの読み取り、書き込み、または追加書き込みに使用できる TextStream オブジェクトを返します。</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">OpenTextFile</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">ファイルを開き、ファイルへのアクセスに使用できる TextStream オブジェクトを返します。</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">WriteLine</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">指定した文字列と改行文字を TextStream ファイルに書き込みます。</p></td>
</tr>
</tbody>
</table>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 7. プロパティ</caption>
<colgroup>
<col style="width: 20%;">
<col style="width: 80%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">プロパティ</th>
<th class="tableblock halign-left valign-top">説明</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Drives</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">コンピューター上のすべての Drive オブジェクトのコレクションを返します。</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Name</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">指定したファイルまたはフォルダーの名前を設定するか返します。</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Path</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">指定したファイル、フォルダー、またはドライブのパスを返します。</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Size</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">ファイルの場合は、指定したファイルのバイト単位でのサイズを返します。フォルダーの場合、そのフォルダーに含まれるすべてのファイルとサブフォルダーのサイズをバイト単位で返します。</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Type</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">ファイルまたはフォルダーの種類に関する情報を返します (たとえば .TXT で終わるファイルの場合は、"Text Document" を返します)。</p></td>
</tr>
</tbody>
</table>
<div class="sect2">
<h3 id="_メソッド">16.1. メソッド</h3>
<div class="sect3">
<h4 id="_buildpath_メソッド">16.1.1. BuildPath メソッド</h4>
<div class="paragraph">
<p>フォルダーパスとフォルダーまたはファイルの名前を結合し、有効なパス区切り記号と
の組み合わせを返します。</p>
</div>
<div class="listingblock">
<div class="title">構文</div>
<div class="content">
<pre class="highlight"><code class="language-vbscript" data-lang="vbscript">object.BuildPath (path, name)</code></pre>
</div>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 20%;">
<col style="width: 80%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Part</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">object</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">必須です。 常に FileSystemObject の名前。</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">path</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">必須。 _名前_を組み合わせる既存のパス。 絶対パスまたは相対パスを指
定することができ、既存のフォルダーを指定する必要はありません。</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">name</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">必ず指定します。 既存の_パス_に追加されるフォルダーまたはファイルの
名前。</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<div class="title">注釈</div>
<p>BuildPath メソッドでは、必要な場合に限り、既存のパスと名前の間に追加のパス区切
りを挿入します。</p>
</div>
</div>
<div class="sect3">
<h4 id="_copyfile_メソッド">16.1.2. CopyFile メソッド</h4>
<div class="paragraph">
<p>1 つまたは複数のファイルを別の場所にコピーします。</p>
</div>
<div class="listingblock">
<div class="title">構文</div>
<div class="content">
<pre class="highlight"><code class="language-vbscript" data-lang="vbscript">object.CopyFile source, destination, [ overwrite ]</code></pre>
</div>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 20%;">
<col style="width: 80%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">パーツ</th>
<th class="tableblock halign-left valign-top">説明</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">object</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">必ず指定します。 object は、常に FileSystemObject の名前です。</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">source</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">必須。 コピーする 1 つ以上のファイルを示す、ファイル指定用文字列。ワイルドカード文字も使用できます。</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">destination</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">必須です。 source から 1 つ以上のファイルをコピーする先を指定する文字列。 ワイルドカード文字は使用できません。</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">overwrite</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">省略可能。 既存のファイルを上書きできるかどうかを示すブール値です。 True の場合はファイルが上書きされ、False の場合は上書きされません。 既定値は True です。 destination に読み取り専用属性が設定されている場合は、overwrite の値にかかわらず CopyFile は失敗します。</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<div class="title">解説</div>
<p>ワイルドカード文字を使用できるのは、 source 引数の最後のパス コンポーネントだ
けです。 たとえば、以下を使用できます。</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-vbscript" data-lang="vbscript">FileSystemObject.CopyFile "c:\mydocuments\letters\*.doc", "c:\tempfolder\"</code></pre>
</div>
</div>
<div class="paragraph">
<p>以下のようには使用できません。</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-vbscript" data-lang="vbscript">FileSystemObject.CopyFile "c:\mydocuments\*\R1???97.xls", "c:\tempfolder"</code></pre>
</div>
</div>
<div class="paragraph">
<p>source にワイルドカード文字が含まれている場合や、destination がパスの区切り文
字 (**) で終わっている場合は、destination は一致するファイルのコピー先となる既
存のフォルダーと見なされます。 それ以外の場合は、destination は作成するファイ
ルの名前と見なされます。 いずれの場合も、個々のファイルのコピー時に起こり得る
ことは 3 つあります。</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>destination が存在しない場合は、source がコピーされます。 これは通常のケー
スです。</p>
</li>
<li>
<p>destination が既存のファイルの場合、 overwrite が False のときはエラーが発
生します。 True のときは既存のファイルを上書きして source がコピーされます。</p>
</li>
<li>
<p>destination がディレクトリの場合は、エラーが発生します。</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>source でワイルドカード文字が使用されていて、どのファイルとも一致しなかった場
合も、エラーが発生します。 いずれかのエラーが発生した時点で CopyFile メソッド
の実行は停止されます。 エラーが発生するまでに行われた変更を取り消したり元に戻
したりする処理は一切行われません。</p>
</div>
</div>
<div class="sect3">
<h4 id="_copyfolder_メソッド">16.1.3. CopyFolder メソッド</h4>
<div class="paragraph">
<p>フォルダーを再帰的に別の場所にコピーします。</p>
</div>
<div class="listingblock">
<div class="title">構文</div>
<div class="content">
<pre class="highlight"><code class="language-vbscript" data-lang="vbscript">object.CopyFolder source, destination, [ overwrite ]</code></pre>
</div>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 20%;">
<col style="width: 80%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">パーツ</th>
<th class="tableblock halign-left valign-top">説明</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">object</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">必ず指定します。 常に FileSystemObject の名前。</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">source</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">必須。 コピーする 1 つ以上のフォルダーを指定する文字列です。ワイルドカード文字を使用できます。</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">destination</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">必須です。 source のフォルダーとサブフォルダーのコピー先を指定する文字列です。 ワイルドカード文字は使用できません。</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">overwrite</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">省略可能。 既存のフォルダーを上書きするかどうかを示す ブール 値です。 True の場合はファイルが上書きされ、 False の場合は上書きされません。 既定値は True です。</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<div class="title">解説</div>
<p>ワイルドカード文字を使用できるのは、 source 引数の最後のパス コンポーネントだ
けです。 たとえば、以下を使用できます。</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-vbscript" data-lang="vbscript">FileSystemObject.CopyFolder "c:\mydocuments\letters\*", "c:\tempfolder\"</code></pre>
</div>
</div>
<div class="paragraph">
<p>以下のようには使用できません。</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-vbscript" data-lang="vbscript">FileSystemObject.CopyFolder "c:\mydocuments\*\*", "c:\tempfolder\"</code></pre>
</div>
</div>
<div class="paragraph">
<p>source にワイルドカード文字が含まれている場合や、destination がパスの区切り文
字 ()) で終わっている場合は、destination は一致するフォルダーとサブフォルダー
のコピー先となる既存のフォルダーと見なされます。</p>
</div>
<div class="paragraph">
<p>それ以外の場合は、destinationは作成するフォルダーの名前と見なされます。</p>
</div>
<div class="paragraph">
<p>いずれの場合も、個々のフォルダーがコピーされるときに起こり得ることは 4 つあり
ます。</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>destination が存在しない場合は、source フォルダーとそのすべての内容がコピー
されます。 これは通常のケースです。</p>
</li>
<li>
<p>destination が既存のファイルの場合は、エラーが発生します。</p>
</li>
<li>
<p>destination がディレクトリの場合は、フォルダーとそのすべての内容のコピーを
   しようとします。 source に含まれているファイルが destination に既に存在する
場合は、overwrite が False に設定されているとエラーが発生します。 それ以外の場
合、ファイルを既存のファイルにコピーしようとします。</p>
</li>
<li>
<p>destination が読み取り専用のディレクトリで、overwrite が False の場合、既存
   の読み取り専用のファイルをそのディレクトリにコピーしようとするとエラーが発
生します。</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>source でワイルドカード文字が使用されていて、どのフォルダーとも一致しなかった
場合も、エラーが発生します。</p>
</div>
<div class="paragraph">
<p>CopyFolder メソッドは、最初のエラーが発生した時点で処理を中止します。 エラーが
発生するまでに行われた変更を取り消したり元に戻したりする処理は一切行われません。</p>
</div>
</div>
<div class="sect3">
<h4 id="_createfolder_メソッド">16.1.4. CreateFolder メソッド</h4>
<div class="paragraph">
<p>フォルダーを作成します。</p>
</div>
<div class="listingblock">
<div class="title">構文</div>
<div class="content">
<pre class="highlight"><code class="language-vbscript" data-lang="vbscript">object.CreateFolder (foldername)</code></pre>
</div>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 20%;">
<col style="width: 80%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">パーツ</th>
<th class="tableblock halign-left valign-top">説明</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">object</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">必須です。 常に FileSystemObject の名前。</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">foldername</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">必ず指定します。 作成するフォルダーを識別する 文字列式です。</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<div class="title">注釈</div>
<p>指定したフォルダーがすでに存在する場合は、エラーが発生します。</p>
</div>
</div>
<div class="sect3">
<h4 id="_createtextfile_メソッド">16.1.5. CreateTextFile メソッド</h4>
<div class="paragraph">
<p>指定されたファイル名を作成し、ファイルの読み取りまたは書き込みに使用できる<strong>TextStream</strong> オブジェクトを返します。</p>
</div>
<div class="listingblock">
<div class="title">構文</div>
<div class="content">
<pre class="highlight"><code class="language-vbscript" data-lang="vbscript">object.CreateTextFile (filename, [ overwrite, [ unicode ]])</code></pre>
</div>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 20%;">
<col style="width: 80%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">パーツ</th>
<th class="tableblock halign-left valign-top">説明</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">object</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">必須です。 常に<strong>FileSystemObject</strong> または<strong>Folder</strong> オブジェクトの名前を指定します。</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">filename</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">必須。 作成するファイルを示す 文字列式。</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">overwrite</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">省略可能。 既存のファイルを上書きできるかどうかを示す Boolean 値。 ファイルを上書きできる場合は True 、上書きできない場合は False です。 省略した場合、既存のファイルは上書きできます。</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">unicode</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">省略可能。 Unicode ファイルを作成するか、ASCII ファイルを作成するかを示す Boolean 値です。 Unicode ファイルとして作成する場合は True 、ASCII ファイルとして作成する場合は False です。 省略した場合は、ASCII ファイルとみなされます。</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<div class="title">注釈</div>
<p>次のコードは、 CreateTextFileメソッドを使用して、テキストファイルを作成して開
く方法を示しています。 _Overwrite_引数がFalseの場合、または指定されていない場
合は、既に存在する_ファイル名_に対してエラーが発生します。</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-vbscript" data-lang="vbscript">Sub CreateAfile
    Set fs = CreateObject("Scripting.FileSystemObject")
    Set a = fs.CreateTextFile("c:\testfile.txt", True)
    a.WriteLine("This is a test.")
    a.Close
End Sub</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_deletefile_メソッド">16.1.6. DeleteFile メソッド</h4>
<div class="paragraph">
<p>指定したファイルを削除します。</p>
</div>
<div class="listingblock">
<div class="title">構文</div>
<div class="content">
<pre class="highlight"><code class="language-vbscript" data-lang="vbscript">object.DeleteFile filespec, [ force ]</code></pre>
</div>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 20%;">
<col style="width: 80%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">パーツ</th>
<th class="tableblock halign-left valign-top">説明</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">object</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">必須です。 常に FileSystemObject の名前。</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">filespec</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">必須。 削除するファイルの名前です。 __ 最後のパス コンポーネントではワイルドカード文字を使用できます。</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">force</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">省略可能。 読み取り専用属性が設定されているファイルを削除する場合は、 Trueを指定するブール型 (Boolean) の値を指定します。False(既定値)。</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<div class="title">注釈</div>
<p>一致するファイルが見つからない場合はエラーが発生します。 DeleteFile メソッドは、
最初のエラーが発生した時点で中止されます。 エラーが発生する前に行われた変更は
ロールバックされません (元に戻されません)。</p>
</div>
</div>
<div class="sect3">
<h4 id="_deletefolder_メソッド">16.1.7. DeleteFolder メソッド</h4>
<div class="paragraph">
<p>指定したフォルダーおよびその内容を削除します。</p>
</div>
<div class="listingblock">
<div class="title">構文</div>
<div class="content">
<pre class="highlight"><code class="language-vbscript" data-lang="vbscript">object.DeleteFolder folderspec, [ force ]</code></pre>
</div>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 20%;">
<col style="width: 80%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">パーツ</th>
<th class="tableblock halign-left valign-top">説明</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">object</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">必須です。 常に FileSystemObject の名前。</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">folderspec</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">必須。 削除するフォルダーの名前。 folderspec の最後のパス コンポーネントにはワイルドカード文字を含むことができます。</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">force</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">省略可能。 読み取り専用属性が設定されているフォルダーを削除する場合は、 Trueを指定するブール値。False(既定値)。</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<div class="title">注釈</div>
<p>DeleteFolder メソッドでは、内容を持つフォルダーと内容を持たないフォルダーは区
別されません。 指定されたフォルダーは、内容を持つかどうかにかかわらず削除され
ます。</p>
</div>
<div class="paragraph">
<p>一致するフォルダーが見つからない場合は、エラーが発生します。 いずれかのエラー
が発生した時点で DeleteFolder メソッドの実行は停止されます。 エラーが発生する
前に行われた変更内容のロールバックまたは取り消しは行われません。</p>
</div>
</div>
<div class="sect3">
<h4 id="_drive_exists_メソッド">16.1.8. drive exists メソッド</h4>
<div class="paragraph">
<p>指定したドライブが存在する場合は True、それ以外の場合は False を返します。</p>
</div>
<div class="listingblock">
<div class="title">構文</div>
<div class="content">
<pre class="highlight"><code class="language-vbscript" data-lang="vbscript">object.DriveExists (drivespec)</code></pre>
</div>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 20%;">
<col style="width: 80%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">パーツ</th>
<th class="tableblock halign-left valign-top">説明</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">object</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">必須です。 常に FileSystemObject の名前。</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">drivespec</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">必須。 ドライブのルートのドライブ文字またはパスの指定。</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<div class="title">注釈</div>
<p>リムーバブル メディアを使用するドライブの場合、DriveExists メソッドはメディア
が存在しなくても True を返します。 ドライブの準備ができているかどうかを判断す
るには、 drive オブジェクトのisreadyプロパティを使用します。</p>
</div>
</div>
<div class="sect3">
<h4 id="_fileexists_メソッド">16.1.9. FileExists メソッド</h4>
<div class="paragraph">
<p>指定したファイルが存在する場合は True を返します。存在しない場合は False を返
します。</p>
</div>
<div class="listingblock">
<div class="title">構文</div>
<div class="content">
<pre class="highlight"><code class="language-vbscript" data-lang="vbscript">object.FileExists (filespec)</code></pre>
</div>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 20%;">
<col style="width: 80%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">パーツ</th>
<th class="tableblock halign-left valign-top">説明</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">object</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">必須です。 常に FileSystemObject の名前。</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">filespec</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">必須。 存在するかどうかを調べるファイルの名前を指定します。 ファイ
ルが現在のフォルダー内にないことが想定される場合は、完全なパス (絶対パスまたは
相対パス) を指定する必要があります。</p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect3">
<h4 id="_folderexists_メソッド">16.1.10. FolderExists メソッド</h4>
<div class="paragraph">
<p>指定したフォルダーが存在する場合は、True を返します。存在しない場合は、False
を返します。</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-vbscript" data-lang="vbscript">object.FolderExists (folderspec)</code></pre>
</div>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 20%;">
<col style="width: 80%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">パーツ</th>
<th class="tableblock halign-left valign-top">説明</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">object</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">必須です。 常に FileSystemObject の名前。</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">folderspec</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">必ず指定します。 存在するかどうかを調べるフォルダーの名前を指定し
ます。 フォルダーが現在のフォルダーにないと予想される場合は、完全なパス (絶対
パスまたは相対パス) を指定する必要があります。</p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect3">
<h4 id="_getabsolutepathname_メソッド">16.1.11. GetAbsolutePathName メソッド</h4>
<div class="paragraph">
<p>指定したパス仕様から完全で明確なパスを返します。</p>
</div>
<div class="listingblock">
<div class="title">構文</div>
<div class="content">
<pre class="highlight"><code class="language-vbscript" data-lang="vbscript">object.GetAbsolutePathName (pathspec)</code></pre>
</div>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 20%;">
<col style="width: 80%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">パーツ</th>
<th class="tableblock halign-left valign-top">説明</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">object</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">必須です。 常に FileSystemObject の名前。</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">pathspec</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">必ず指定します。 完全で明確なパスに変更するパス仕様です。</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<div class="title">注釈</div>
<p>指定したドライブのルートから完全な参照を提供しているパスは、完全で明確です。
完全なパスは、マップされたドライブのルートフォルダー*<strong>* を指定している場合にの
み、パス区切り文字 (</strong>) で終わることができます。</p>
</div>
<div class="paragraph">
<p>次の表は、現在のディレクトリが c:\mydocuments\reports と仮定した場合の
GetAbsolutePathName メソッドの動作を示しています。</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 20%;">
<col style="width: 80%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">pathspec</th>
<th class="tableblock halign-left valign-top">返されるパス</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">"c:"</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">"c:\mydocuments\reports"</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">"c:.."</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">"c:\mydocuments"</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">"c:\"</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">"c:"</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">"c:. \ @ 97</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">"c:\mydocuments\reports と仮定*/@ 97"</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">"region1"</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">"c:\mydocuments\reports\region1"</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">"c:&#8230;&#8203;.\mydocuments "</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">"c:\mydocuments"</p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect3">
<h4 id="_getbasenameメソッド">16.1.12. ★GetBaseNameメソッド</h4>
<div class="paragraph">
<p>パスの最後のコンポーネントのファイル拡張子を除くベース名を含む文字列を返します。</p>
</div>
<div class="listingblock">
<div class="title">構文</div>
<div class="content">
<pre class="highlight"><code class="language-vbscript" data-lang="vbscript">object.GetBaseName (path)</code></pre>
</div>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 20%;">
<col style="width: 80%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">パーツ</th>
<th class="tableblock halign-left valign-top">説明</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">object</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">必須です。 常に FileSystemObject の名前。</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">path</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">必須。 ベース名を返すコンポーネントのパス指定。</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<div class="title">注釈</div>
<p>GetBaseName メソッドは、path 引数に一致するコンポーネントがない場合は、長さ 0
の文字列 ("") を返します。</p>
</div>
</div>
<div class="sect3">
<h4 id="_getdrive_メソッド">16.1.13. GetDrive メソッド</h4>
<div class="paragraph">
<p>指定されたパスのドライブに対応する Drive オブジェクトを返します。</p>
</div>
<div class="listingblock">
<div class="title">構文</div>
<div class="content">
<pre class="highlight"><code class="language-vbscript" data-lang="vbscript">object.GetDrive (drivespec)</code></pre>
</div>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 20%;">
<col style="width: 80%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">パーツ</th>
<th class="tableblock halign-left valign-top">説明</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">object</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">必須です。 常に FileSystemObject の名前。</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">drivespec</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">必須。 _Drivespec_引数には、ドライブ文字 (c)、コロン (:) が追加されたドライブ文字、コロンとパスの区切り記号が追加されたドライブ文字 ()c:、または任意の\ネットワーク共有仕様 (computer2\share1) を使用できます。</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<div class="title">注釈</div>
<p>ネットワーク共有の場合、共有が存在するかどうかが調べられます。</p>
</div>
<div class="paragraph">
<p>drivespec が許容されるどの形式にも従っていない場合、または存在しない場合は、エ
ラーが発生します。</p>
</div>
<div class="paragraph">
<p>GetDrive メソッドを通常のパス文字列で呼び出すには、次のシーケンスを使用して、
drivespec として使用するのに適した文字列を取得します。</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-vbscript" data-lang="vbscript">DriveSpec = GetDriveName(GetAbsolutePathName(Path))</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_getdrivename_メソッド">16.1.14. GetDriveName メソッド</h4>
<div class="paragraph">
<p>指定されたパスのドライブ名を含む文字列を返します。</p>
</div>
<div class="listingblock">
<div class="title">構文</div>
<div class="content">
<pre class="highlight"><code class="language-vbscript" data-lang="vbscript">object.GetDriveName (path)</code></pre>
</div>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 20%;">
<col style="width: 80%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">パーツ</th>
<th class="tableblock halign-left valign-top">説明</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">object</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">必須です。 常に FileSystemObject の名前。</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">path</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">必須。 ドライブ名を取得するコンポーネントのパスを指定します。</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<div class="title">注釈</div>
<p>GetDriveName メソッドは、ドライブを特定できない場合には長さ 0 の文字列 ("") を
返します。</p>
</div>
</div>
<div class="sect3">
<h4 id="_getextensionname_メソッド">16.1.15. GetExtensionName メソッド</h4>
<div class="paragraph">
<p>パスの最後の構成要素の拡張子名が含まれる文字列を返します。</p>
</div>
<div class="listingblock">
<div class="title">構文</div>
<div class="content">
<pre class="highlight"><code class="language-vbscript" data-lang="vbscript">object.GetExtensionName (path)</code></pre>
</div>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 20%;">
<col style="width: 80%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">パーツ</th>
<th class="tableblock halign-left valign-top">説明</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">object</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">必須です。 常に FileSystemObject の名前。</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">path</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">必須。 拡張子名を返すべき構成要素のパス指定。</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<div class="title">注釈</div>
<p>ネットワークドライブの場合、ルートディレクトリ (**) はコンポーネントと見なされ
ます。</p>
</div>
<div class="paragraph">
<p>path 引数と一致する構成要素がない場合、GetExtensionName メソッドは長さ 0 の文
字列 ("") を返します。</p>
</div>
</div>
<div class="sect3">
<h4 id="_getfile_メソッド">16.1.16. GetFile メソッド</h4>
<div class="paragraph">
<p>指定したパスのファイルに対応する<strong>file</strong> オブジェクトを返します。</p>
</div>
<div class="listingblock">
<div class="title">構文</div>
<div class="content">
<pre class="highlight"><code class="language-vbscript" data-lang="vbscript">object.GetFile (filespec)</code></pre>
</div>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 20%;">
<col style="width: 80%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">パーツ</th>
<th class="tableblock halign-left valign-top">説明</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">object</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">必須です。 常に FileSystemObject の名前。</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">filespec</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">必須。 filespec は、特定のファイルへのパス (絶対または相対) です。</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<div class="title">注釈</div>
<p>指定されたファイルが存在しない場合は、エラーが発生します。</p>
</div>
</div>
<div class="sect3">
<h4 id="_getfilename_メソッド">16.1.17. ★GetFileName メソッド</h4>
<div class="paragraph">
<p>指定したパスの最後のコンポーネントを、ドライブの指定の一部ではないものとして返
します。</p>
</div>
<div class="listingblock">
<div class="title">構文</div>
<div class="content">
<pre class="highlight"><code class="language-vbscript" data-lang="vbscript">object.GetFileName (pathspec)</code></pre>
</div>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 20%;">
<col style="width: 80%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">パーツ</th>
<th class="tableblock halign-left valign-top">説明</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">object</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">必須です。 常に FileSystemObject の名前。</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">pathspec</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">必須。 特定のファイルのパス (絶対または相対)。</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<div class="title">注釈</div>
<p>pathspec が名前付きのコンポーネントで終了していない場合、GetFileName メソッド
は長さがゼロの文字列 ("") を返します。</p>
</div>
</div>
<div class="sect3">
<h4 id="_getfolder_メソッド">16.1.18. GetFolder メソッド</h4>
<div class="paragraph">
<p>指定したパス内のフォルダーに対応する<strong>folder</strong> オブジェクトを返します。</p>
</div>
<div class="listingblock">
<div class="title">構文</div>
<div class="content">
<pre class="highlight"><code class="language-vbscript" data-lang="vbscript">object.GetFolder (folderspec)</code></pre>
</div>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 20%;">
<col style="width: 80%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">パーツ</th>
<th class="tableblock halign-left valign-top">説明</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">object</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">必須です。 常に FileSystemObject の名前。</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">folderspec</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">必須。 folderspec は、特定のフォルダーへのパス (絶対または相対) です。</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<div class="title">注釈</div>
<p>指定されたフォルダーが存在しない場合は、エラーが発生します。</p>
</div>
</div>
<div class="sect3">
<h4 id="_getparentfoldername_メソッド">16.1.19. ★GetParentFolderName メソッド</h4>
<div class="paragraph">
<p>指定したパスにある最後のコンポーネントの親フォルダー名が含まれる文字列を返します。</p>
</div>
<div class="listingblock">
<div class="title">構文</div>
<div class="content">
<pre class="highlight"><code class="language-vbscript" data-lang="vbscript">object.GetParentFolderName (path)</code></pre>
</div>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 20%;">
<col style="width: 80%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">パーツ</th>
<th class="tableblock halign-left valign-top">説明</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">object</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">必須です。 常に FileSystemObject の名前。</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">path</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">必ず指定します。 返される親フォルダー名のコンポーネントのパス仕様です。</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<div class="title">注釈</div>
<p>path 引数で指定されたコンポーネントの親フォルダーがない場合、
GetParentFolderName メソッドは、長さ 0 の文字列 ("") を返します。</p>
</div>
</div>
<div class="sect3">
<h4 id="_getspecialfolder_メソッド">16.1.20. GetSpecialFolder メソッド</h4>
<div class="paragraph">
<p>指定された特殊フォルダーを返します。</p>
</div>
<div class="listingblock">
<div class="title">構文</div>
<div class="content">
<pre class="highlight"><code class="language-vbscript" data-lang="vbscript">object.GetSpecialFolder (folderspec)</code></pre>
</div>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 20%;">
<col style="width: 80%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">パーツ</th>
<th class="tableblock halign-left valign-top">説明</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">object</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">必須です。 常に FileSystemObject の名前。</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">folderspec</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">必須。 取得する特殊フォルダーの名前です。 「設定値」に示した任意の定数を指定できます。</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<div class="title">Settings</div>
<p>folderspec 引数には、次のいずれかの値を指定できます。</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 28.5714%;">
<col style="width: 14.2857%;">
<col style="width: 57.1429%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">定数</th>
<th class="tableblock halign-left valign-top">値</th>
<th class="tableblock halign-left valign-top">説明</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">WindowsFolder</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">.0</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Windows オペレーティング システムによってインストールされたファイルが格納されている Windows フォルダー。</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">SystemFolder</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1-d</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">ライブラリ、フォント、およびデバイス ドライバーが格納されている System フォルダー。</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">TemporaryFolder</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">pbm-2</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">一時ファイルの格納に使用される Temp フォルダー。 このパスは TMP 環境変数で指定されています。</p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect3">
<h4 id="_gettempname_メソッド">16.1.21. GetTempName メソッド</h4>
<div class="paragraph">
<p>一時ファイルまたはフォルダーを必要とする演算を実行するのに役立つ、ランダムに生
成された一時ファイルまたはフォルダーの名前を返します。</p>
</div>
<div class="listingblock">
<div class="title">構文</div>
<div class="content">
<pre class="highlight"><code class="language-vbscript" data-lang="vbscript">object.GetTempName</code></pre>
</div>
</div>
<div class="paragraph">
<p>オプションの_object_は、常に<strong>FileSystemObject</strong> の名前です。</p>
</div>
<div class="paragraph">
<div class="title">注釈</div>
<p>GetTempName メソッドでは、ファイルが作成されません。 このメソッドでは、ファイ
ルを作成する CreateTextFile で使用できる一時ファイルの名前を提供するだけです。</p>
</div>
</div>
<div class="sect3">
<h4 id="_movefile_メソッド">16.1.22. MoveFile メソッド</h4>
<div class="paragraph">
<p>1 つまたは複数のファイルを別の場所に移動します。</p>
</div>
<div class="listingblock">
<div class="title">構文</div>
<div class="content">
<pre class="highlight"><code class="language-vbscript" data-lang="vbscript">object.MoveFile source, destination</code></pre>
</div>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 20%;">
<col style="width: 80%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">パーツ</th>
<th class="tableblock halign-left valign-top">説明</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">object</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">必ず指定します。 常に FileSystemObject の名前。</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">source</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">必須。 移動するファイルのパス。 source 引数として指定する文字列では、パスの最後の構成要素に限ってワイルドカード文字を使用できます。</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">destination</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">必須です。 ファイルの移動先のパス。 destination 引数には、ワイルドカード文字を使用できません。</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<div class="title">解説</div>
<p>source でワイルドカード文字を使用した場合、または destination がパスの区切り文
字 ( <strong>*</strong> ) で終わっている場合、destination は、該当するファイルを移動する既存
のフォルダーを指定していると見なされます。 それ以外の場合、destination は作成
する移動先ファイルの名前であると見なされます。 いずれの場合も、個々のファイル
の移動時に起こり得ることは 3 つあります。</p>
</div>
<div class="ulist">
<ul>
<li>
<p>destination が存在しない場合は、そのファイルが移動されます。 これは通常のケースです。</p>
</li>
<li>
<p>destination が既存のファイルの場合は、エラーが発生します。</p>
</li>
<li>
<p>destination がディレクトリの場合は、エラーが発生します。</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>source で使用したワイルドカード文字がどのファイルとも一致しなかった場合も、エ
ラーが発生します。 MoveFile メソッドは、最初のエラーが発生した時点で処理を中止
します。 エラーが発生するまでに行われた変更を取り消したり元に戻したりする処理
は一切行われません。</p>
</div>
</div>
<div class="sect3">
<h4 id="_movefolder_メソッド">16.1.23. MoveFolder メソッド</h4>
<div class="paragraph">
<p>1 つまたは複数のフォルダーを別の場所に移動します。</p>
</div>
<div class="listingblock">
<div class="title">構文</div>
<div class="content">
<pre class="highlight"><code class="language-vbscript" data-lang="vbscript">object.MoveFolder (source, destination)</code></pre>
</div>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 20%;">
<col style="width: 80%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">パーツ</th>
<th class="tableblock halign-left valign-top">説明</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">object</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">必ず指定します。 常に FileSystemObject の名前。</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">source</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">必須。 移動するフォルダーのパス。 source 引数として指定する文字列では、パスの最後の構成要素に限ってワイルドカード文字を使用できます。</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">destination</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">必須です。 フォルダーの移動先のパス。 destination 引数には、ワイルドカード文字を使用できません。</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<div class="title">解説</div>
<p>source でワイルドカード文字を使用した場合、または destination がパスの区切り文
字 ( <strong>*</strong> ) で終わっている場合、destination は、該当するファイルを移動する既存
のフォルダーを指定していると見なされます。 それ以外の場合、destination は作成
する移動先フォルダーの名前であると見なされます。 いずれの場合も、個々のフォル
ダーの移動時に起こり得ることは 3 つあります。</p>
</div>
<div class="ulist">
<ul>
<li>
<p>destination が存在しない場合は、そのフォルダーが移動されます。 これが通常の場合です。</p>
</li>
<li>
<p>destination が既存のファイルの場合は、エラーが発生します。</p>
</li>
<li>
<p>destination がディレクトリの場合は、エラーが発生します。</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>source で使用したワイルドカード文字がどのフォルダーとも一致しなかった場合も、
エラーが発生します。 MoveFolder メソッドは、最初のエラーが発生した時点で処理を
中止します。 エラーが発生するまでに行われた変更を取り消したり元に戻したりする
処理は一切行われません。</p>
</div>
</div>
<div class="sect3">
<h4 id="_opentextfile_メソッド">16.1.24. OpenTextFile メソッド</h4>
<div class="paragraph">
<p>指定したファイルを開き、開いたファイルの読み取り、書き込み、または追加書き込み
に使用できる TextStream オブジェクトを返します。</p>
</div>
<div class="listingblock">
<div class="title">構文</div>
<div class="content">
<pre class="highlight"><code class="language-vbscript" data-lang="vbscript">object.OpenTextFile (filename, [ iomode, [ create, [ format ]]])</code></pre>
</div>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 20%;">
<col style="width: 80%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">パーツ</th>
<th class="tableblock halign-left valign-top">説明</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">object</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">必須です。 常に FileSystemObject の名前。</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">filename</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">必須です。 開くファイルを識別する文字列式です。</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">iomode</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">省略可能。 入力/出力モードを示します。 ForReading、ForWriting、または ForAppending のいずれかの定数を指定できます。</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">create</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">省略可能。 filename で指定したファイルが存在しない場合に新しいファイルを作成できるかどうかを示す ブール値です。 新しいファイルを作成する場合は True、作成しない場合は False を指定します。 既定値は False です。</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">format</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">省略可能。 開くファイルの形式を示す Tristate の 3 つの値のいずれかです。 省略すると、ASCII 形式でファイルが開きます。</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<div class="title">設定</div>
<p>iomode 引数には、次のいずれかを設定できます。</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 28.5714%;">
<col style="width: 14.2857%;">
<col style="width: 57.1429%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">定数</th>
<th class="tableblock halign-left valign-top">値</th>
<th class="tableblock halign-left valign-top">説明</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">ForReading</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1-d</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">ファイルを読み取り専用として開きます。 このファイルには書き込むことはできません。</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">ForWriting</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">pbm-2</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">ファイルを書き込み専用として開きます。 既存のファイルを新しいデータで置き換える場合はこのモードを使用します。 このファイルからの読み取りはできません。</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">ForAppending</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">8</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">ファイルを開き、ファイルの最後に書き込みます。 このファイルからの読み取りはできません。</p></td>
</tr>
</tbody>
</table>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 28.5714%;">
<col style="width: 14.2857%;">
<col style="width: 57.1429%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">定数</th>
<th class="tableblock halign-left valign-top">値</th>
<th class="tableblock halign-left valign-top">説明</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">TristateUseDefault</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">-2</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">システムの既定の設定でファイルを開きます。</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">TristateTrue</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">-1</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Unicode 形式でファイルを開きます。</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">TristateFalse</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">.0</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Ascii 形式でファイルを開きます。</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<div class="title">解説</div>
<p>次のコードは、テキストを追加するために、 OpenTextFile メソッドを使用してファイ
ルを開く方法を示しています。</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-vbscript" data-lang="vbscript">Sub OpenTextFileTest
    Const ForReading = 1, ForWriting = 2, ForAppending = 8
    Dim fs, f
    Set fs = CreateObject("Scripting.FileSystemObject")
    Set f = fs.OpenTextFile("c:\testfile.txt", ForAppending, TristateFalse)
    f.Write "Hello world!"
    f.Close
End Sub</code></pre>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_プロパティ">16.2. プロパティ</h3>
<div class="sect3">
<h4 id="_drives_プロパティ">16.2.1. Drives プロパティ</h4>
<div class="paragraph">
<p>ローカルコンピューターで使用できるすべての<strong>Drive</strong> オブジェクトで構成される
<strong>Drives</strong> コレクションを返します。</p>
</div>
<div class="listingblock">
<div class="title">構文</div>
<div class="content">
<pre class="highlight"><code class="language-vbscript" data-lang="vbscript">object.Drives

The object is always a FileSystemObject.</code></pre>
</div>
</div>
<div class="paragraph">
<div class="title">解説</div>
<p>Drives コレクションには、メディアが挿入されていない場合でも、リムーバブル メデ
ィア ドライブが表示されます。</p>
</div>
<div class="literalblock">
<div class="content">
<pre> For Each... を使用して、Drives コレクションのメンバーを反復処理することが
できます。 次のコードに示されているように、次のコンストラクト。</pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-vbscript" data-lang="vbscript">Sub ShowDriveList
    Dim fs, d, dc, s, n
    Set fs = CreateObject("Scripting.FileSystemObject")
    Set dc = fs.Drives
    For Each d in dc
        s = s &amp; d.DriveLetter &amp; " - "
        If d.DriveType = 3 Then
            n = d.ShareName
        Else
            n = d.VolumeName
        End If
        s = s &amp; n &amp; vbCrLf
    Next
    MsgBox s
End Sub</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_name_プロパティ">16.2.2. Name プロパティ</h4>
<div class="paragraph">
<p>指定したファイルまたはフォルダーの名前を設定または取得します。 値の取得と設定
が可能です。</p>
</div>
<div class="listingblock">
<div class="title">構文</div>
<div class="content">
<pre class="highlight"><code class="language-vbscript" data-lang="vbscript">object.Name [ = newname ]</code></pre>
</div>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 20%;">
<col style="width: 80%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">パーツ</th>
<th class="tableblock halign-left valign-top">説明</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">object</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">必須です。 常に、ファイル または<strong>Folder</strong> オブジェクトの名前を指定します。</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">newname</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">省略可能。 指定した場合、newname が、指定した object の新しい名前になります。</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<div class="title">注釈</div>
<p>次のコードは、 Nameプロパティの使用方法を示しています。</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-vbscript" data-lang="vbscript">Sub ShowFileAccessInfo(filespec)
    Dim fs, f, s
    Set fs = CreateObject("Scripting.FileSystemObject")
    Set f = fs.GetFile(filespec)
    s = f.Name &amp; " on Drive " &amp; UCase(f.Drive) &amp; vbCrLf
    s = s &amp; "Created: " &amp; f.DateCreated &amp; vbCrLf
    s = s &amp; "Last Accessed: " &amp; f.DateLastAccessed &amp; vbCrLf
    s = s &amp; "Last Modified: " &amp; f.DateLastModified
    MsgBox s, 0, "File Access Info"
End Sub</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_textstream_オブジェクト">17. TextStream オブジェクト</h2>
<div class="sectionbody">
<div class="paragraph">
<p>ファイルへの一連のアクセスを容易にします。</p>
</div>
<div class="listingblock">
<div class="title">構文</div>
<div class="content">
<pre class="highlight"><code class="language-vbscript" data-lang="vbscript">TextStream. { property | method }</code></pre>
</div>
</div>
<div class="paragraph">
<p>property 引数と method 引数は、TextStream オブジェクトに関連付けられている任意
のプロパティとメソッドになることができます。 実際の使用時に、TextStream は、
FileSystemObject から返される TextStream オブジェクトを表す変数プレースホルダ
ーに置き換えられます。</p>
</div>
<div class="paragraph">
<div class="title">解説</div>
<p>次のコードで、a は、FileSystemObject 上の CreateTextFile メソッドによって返さ
れる TextStream オブジェクトです。WriteLine と Close は、TextStream オブジェク
トの 2 つのメソッドです。</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-vbscript" data-lang="vbscript">Set fs = CreateObject("Scripting.FileSystemObject")
Set a = fs.CreateTextFile("c:\testfile.txt", True)
a.WriteLine("This is a test.")
a.Close</code></pre>
</div>
</div>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 8. メソッド</caption>
<colgroup>
<col style="width: 20%;">
<col style="width: 80%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">メソッド</th>
<th class="tableblock halign-left valign-top">説明</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Close</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">開いている TextStream ファイルを閉じます。</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Read</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">指定した文字数を TextStream ファイルから読み取り、結果を返します。</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">ReadAll</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">TextStream ファイル全体を読み取り、結果を返します。</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">ReadLine</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">TextStream ファイルから 1 行を読み取り、結果を返します。</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Skip</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">TextStream ファイルを読み取るときに、指定した文字数をスキップします。</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">SkipLine</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">TextStream ファイルを読み取るときに、次の行をスキップします。</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Write</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">指定したテキストを TextStream ファイルに書き込みます。</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">WriteBlankLines</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">指定した数の改行文字を TextStream ファイルに書き込みます。</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">WriteLine</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">指定したテキストと改行文字を TextStream ファイルに書き込みます。</p></td>
</tr>
</tbody>
</table>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 9. プロパティ</caption>
<colgroup>
<col style="width: 20%;">
<col style="width: 80%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">プロパティ</th>
<th class="tableblock halign-left valign-top">説明</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">AtEndOfLine</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">TextStream ファイルの行末マーカーの直前にファイル ポインターがある場合は true を返し、そうでない場合は false を返します。</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">AtEndOfStream</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">TextStream の最後にファイル ポインターがある場合は true を返し、そうでない場合は false を返します。</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Column</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">入力ストリーム内の現在の文字位置の列番号を返します。</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Line</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">TextStream ファイル内の現在の行番号を返します。</p></td>
</tr>
</tbody>
</table>
<div class="sect2">
<h3 id="_メソッド_2">17.1. メソッド</h3>
<div class="sect3">
<h4 id="_close_メソッド">17.1.1. Close メソッド</h4>
<div class="paragraph">
<p>開いている<strong>TextStream</strong> ファイルを閉じます。</p>
</div>
<div class="listingblock">
<div class="title">構文</div>
<div class="content">
<pre class="highlight"><code class="language-vbscript" data-lang="vbscript">object.Close</code></pre>
</div>
</div>
<div class="paragraph">
<p>object は常に TextStream オブジェクトの名前となります。</p>
</div>
</div>
<div class="sect3">
<h4 id="_read_メソッド">17.1.2. Read メソッド</h4>
<div class="paragraph">
<p>TextStream ファイルから指定した数の文字を読み取って、結果の文字列を戻します。</p>
</div>
<div class="listingblock">
<div class="title">構文</div>
<div class="content">
<pre class="highlight"><code class="language-vbscript" data-lang="vbscript">object.Read (characters)</code></pre>
</div>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 20%;">
<col style="width: 80%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">パーツ</th>
<th class="tableblock halign-left valign-top">説明</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">object</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">必須です。 常に<strong>TextStream</strong> オブジェクトの名前を指定します。</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">characters</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">必須。 ファイルから読み取る文字数を指定します。</p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect3">
<h4 id="_readall_メソッド">17.1.3. ReadAll メソッド</h4>
<div class="paragraph">
<p>TextStream ファイル全体を読み取って、結果の文字列を返します。</p>
</div>
<div class="listingblock">
<div class="title">構文</div>
<div class="content">
<pre class="highlight"><code class="language-vbscript" data-lang="vbscript">object.ReadAll</code></pre>
</div>
</div>
<div class="paragraph">
<p>object は常に TextStream オブジェクトの名前となります。</p>
</div>
<div class="paragraph">
<div class="title">解説</div>
<p>大きなファイルで ReadAll メソッドを使用すると、メモリ リソースを大量に使用しま
す。 ファイルを1行ずつ読み取るなど、他の手法を使用してファイルを入力する必要が
あります。</p>
</div>
</div>
<div class="sect3">
<h4 id="_readline_メソッド">17.1.4. ReadLine メソッド</h4>
<div class="paragraph">
<p>TextStream ファイルから行全体 (改行文字の前まで) を読み取り、その文字列を返します。</p>
</div>
<div class="listingblock">
<div class="title">構文</div>
<div class="content">
<pre class="highlight"><code class="language-vbscript" data-lang="vbscript">object.ReadLine</code></pre>
</div>
</div>
<div class="paragraph">
<p>_Object_引数は常に<strong>TextStream</strong> オブジェクトの名前です。</p>
</div>
</div>
<div class="sect3">
<h4 id="_skip_メソッド">17.1.5. Skip メソッド</h4>
<div class="paragraph">
<p>TextStream を読み込むときに、指定された数の文字をスキップします。</p>
</div>
<div class="listingblock">
<div class="title">構文</div>
<div class="content">
<pre class="highlight"><code class="language-vbscript" data-lang="vbscript">object.Skip (characters)</code></pre>
</div>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 20%;">
<col style="width: 80%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">パーツ</th>
<th class="tableblock halign-left valign-top">説明</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">object</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">必須です。 常に<strong>TextStream</strong> オブジェクトの名前を指定します。</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">characters</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">必須。 ファイルを読み込むときにスキップする文字数。</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<div class="title">注釈</div>
<p>スキップした文字は破棄されます。</p>
</div>
</div>
<div class="sect3">
<h4 id="_skipline_メソッド">17.1.6. SkipLine メソッド</h4>
<div class="paragraph">
<p>TextStream ファイルを読むときに、次の行をスキップします。</p>
</div>
<div class="listingblock">
<div class="title">構文</div>
<div class="content">
<pre class="highlight"><code class="language-vbscript" data-lang="vbscript">object.SkipLine</code></pre>
</div>
</div>
<div class="paragraph">
<p>object は常に TextStream オブジェクトの名前となります。</p>
</div>
<div class="paragraph">
<div class="title">解説</div>
<p>行をスキップするとは、次の改行文字まで、その改行文字を含め、行内のすべての文字
を読み取って破棄することを意味します。</p>
</div>
<div class="paragraph">
<p>ファイルが読み取り用に開かれていない場合、エラーが発生します。</p>
</div>
</div>
<div class="sect3">
<h4 id="_write_メソッド">17.1.7. Write メソッド</h4>
<div class="paragraph">
<p>指定した文字列を TextStream ファイルに書き込みます。</p>
</div>
<div class="listingblock">
<div class="title">構文</div>
<div class="content">
<pre class="highlight"><code class="language-vbscript" data-lang="vbscript">object.Write (string)</code></pre>
</div>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 20%;">
<col style="width: 80%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">パーツ</th>
<th class="tableblock halign-left valign-top">説明</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">object</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">必須です。 常に<strong>TextStream</strong> オブジェクトの名前を指定します。</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">string</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">必須。 ファイルに書き込むテキストです。</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<div class="title">注釈</div>
<p>文字列を複数指定した場合、各文字列がスペースや文字で区切られずに続けて書き込ま
れます。 改行文字や最後が改行文字で終わる文字列を書き込む場合は、WriteLine メ
ソッドを使用します。</p>
</div>
</div>
<div class="sect3">
<h4 id="_write空白行メソッド">17.1.8. Write空白行メソッド</h4>
<div class="paragraph">
<p>指定した数の改行文字を、TextStream ファイルに書き込みます。</p>
</div>
<div class="listingblock">
<div class="title">構文</div>
<div class="content">
<pre class="highlight"><code class="language-vbscript" data-lang="vbscript">object.WriteBlankLines (lines)</code></pre>
</div>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 20%;">
<col style="width: 80%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">パーツ</th>
<th class="tableblock halign-left valign-top">説明</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">object</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">必須です。 常に<strong>TextStream</strong> オブジェクトの名前を指定します。</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">lines</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">必須。 ファイルに書き込む改行文字の数。</p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect3">
<h4 id="_writeline_メソッド">17.1.9. WriteLine メソッド</h4>
<div class="paragraph">
<p>指定された文字列および改行文字を TextStream ファイルに書き込みます。</p>
</div>
<div class="listingblock">
<div class="title">構文</div>
<div class="content">
<pre class="highlight"><code class="language-vbscript" data-lang="vbscript">object.WriteLine ([ string ])</code></pre>
</div>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 20%;">
<col style="width: 80%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">パーツ</th>
<th class="tableblock halign-left valign-top">説明</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">object</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">必須です。 常に<strong>TextStream</strong> オブジェクトの名前を指定します。</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">string</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">省略可能。 ファイルに書き込むテキスト。 省略した場合は、改行文字がファ
イルに書き込まれます。</p></td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="sect2">
<h3 id="_プロパティ_2">17.2. プロパティ</h3>
<div class="sect3">
<h4 id="_atendofline_プロパティ">17.2.1. AtEndOfLine プロパティ</h4>
<div class="paragraph">
<p>TextStream ファイルの行末マーカーの直前にファイル ポインターがある場合は True
を返す読み取り専用のプロパティです。ない場合は False を返します。</p>
</div>
<div class="listingblock">
<div class="title">構文</div>
<div class="content">
<pre class="highlight"><code class="language-vbscript" data-lang="vbscript">object.AtEndOfLine</code></pre>
</div>
</div>
<div class="paragraph">
<p>object は常に TextStream オブジェクトの名前となります。</p>
</div>
<div class="paragraph">
<div class="title">解説</div>
<p>AtEndOfLine プロパティは、読み取りを行うように開いた TextStream ファイルに対し
てのみ使用できます。それ以外の場合は、エラーが発生します。</p>
</div>
<div class="paragraph">
<p>次のコードは、AtEndOfLine プロパティの使用例を示しています。</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-vbscript" data-lang="vbscript">Dim fs, a, retstring
Set fs = CreateObject("Scripting.FileSystemObject")
Set a = fs.OpenTextFile("c:\testfile.txt", ForReading, False)
Do While a.AtEndOfLine &lt;&gt; True
    retstring = a.Read(1)
    ...
Loop
a.Close</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_atendofstream_プロパティ">17.2.2. AtEndOfStream プロパティ</h4>
<div class="paragraph">
<p>TextStream ファイルの末尾にファイル ポインターがある場合は True を返す読み取り
専用のプロパティです。ない場合は False を返します。</p>
</div>
<div class="listingblock">
<div class="title">構文</div>
<div class="content">
<pre class="highlight"><code class="language-vbscript" data-lang="vbscript">object.AtEndOfStream</code></pre>
</div>
</div>
<div class="paragraph">
<p>object は常に TextStream オブジェクトの名前となります。</p>
</div>
<div class="paragraph">
<div class="title">解説</div>
<p>AtEndOfStream プロパティは、読み取りを行うように開いた TextStream ファイルに対
してのみ使用できます。それ以外の場合は、エラーが発生します。</p>
</div>
<div class="paragraph">
<p>次のコードは、AtEndOfStream プロパティの使用例を示しています。</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-vbscript" data-lang="vbscript">Dim fs, a, retstring
Set fs = CreateObject("Scripting.FileSystemObject")
Set a = fs.OpenTextFile("c:\testfile.txt", ForReading, False)
Do While a.AtEndOfStream &lt;&gt; True
    retstring = a.ReadLine
    ...
Loop
a.Close</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_column_プロパティ">17.2.3. Column プロパティ</h4>
<div class="paragraph">
<p>TextStream ファイル内の現在の文字位置の列番号を返す読み取り専用プロパティです。</p>
</div>
<div class="listingblock">
<div class="title">構文</div>
<div class="content">
<pre class="highlight"><code class="language-vbscript" data-lang="vbscript">object.Column</code></pre>
</div>
</div>
<div class="paragraph">
<p>object は常に TextStream オブジェクトの名前となります。</p>
</div>
<div class="paragraph">
<div class="title">解説</div>
<p>改行文字が書き込まれた後から、その他の文字が書き込まれる前まで、Column は 1 と
等しくなります。</p>
</div>
</div>
<div class="sect3">
<h4 id="_line_プロパティ">17.2.4. Line プロパティ</h4>
<div class="paragraph">
<p>TextStream ファイル内の現在の行番号を返す読み取り専用のプロパティ。</p>
</div>
<div class="listingblock">
<div class="title">構文</div>
<div class="content">
<pre class="highlight"><code class="language-vbscript" data-lang="vbscript">object.Line</code></pre>
</div>
</div>
<div class="paragraph">
<p>object は常に TextStream オブジェクトの名前となります。</p>
</div>
<div class="paragraph">
<div class="title">解説</div>
<p>ファイルを初めて開き、書き込みを行う前は、Line は 1 です。</p>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_userform">18. UserForm</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_listbox">18.1. ListBox</h3>
<div class="listingblock">
<div class="title">クリア</div>
<div class="content">
<pre class="highlight"><code class="language-vbscript" data-lang="vbscript">ListBox1.Clear</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">追加</div>
<div class="content">
<pre class="highlight"><code class="language-vbscript" data-lang="vbscript">ListBox1.Additem "This is a pen"</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">追加選択</div>
<div class="content">
<pre class="highlight"><code class="language-vbscript" data-lang="vbscript">ListBox1.Additem "This is a pen"
ListBox1.Selected(ListBox1.ListCount -1) = True</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">全選択</div>
<div class="content">
<pre class="highlight"><code class="language-vbscript" data-lang="vbscript">ListBox1.MultiSelect = fmmultiselectextended
Dim i As Long
For i = 0 To ListBox1.ListCount -1
    ListBox1.Selected(i) = True
Next</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">選択行表示</div>
<div class="content">
<pre class="highlight"><code class="language-vbscript" data-lang="vbscript">For i= 0 To ListBox1.ListCount -1
    If ListBox1.Selected(i)  Then
        Debug.Print ListBox1.List(i)
    End If
Next</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">複数列追加</div>
<div class="content">
<pre class="highlight"><code class="language-vbscript" data-lang="vbscript">ListBox1.ColumnCount = 2
ListBox1.ColumnWidths = "100:50"
ListBox1.AddItem ""
ListBox1.List(ListBox1.ListCount -1, 0) = "左"
ListBox1.List(ListBox1.ListCount -1, 1) = "右"</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">選択行取得</div>
<div class="content">
<pre class="highlight"><code class="language-vbscript" data-lang="vbscript">' 選択されていない場合は -1
ListBox1.ListIndex
ListBox1.List(ListBox1.ListIndex)</code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_collection_dictionary">19. Collection, Dictionary</h2>
<div class="sectionbody">
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 11.1111%;">
<col style="width: 44.4444%;">
<col style="width: 44.4445%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top"></th>
<th class="tableblock halign-left valign-top">Collection</th>
<th class="tableblock halign-left valign-top">Dictionary</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">宣言</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Dim c As New Collection</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Dim d As New Scripting.Dictionary</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">追加</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">c.Add Item:=100,key:="This is a pen."<br>
c.Add 200."This"<br>
<span class="red">item, key</span></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">d.Add key:="Orange",Item:=100<br>
d.Add "Apple",200<br>
<span class="red">key, item</span></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">item取得</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Dim i As Long<br>
For i = 1 To c.Count<br>
    Debug.Peint c(i)<br>
Next<br>
<span class="red">1から始まる</span></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Dim i As Long<br>
Dim Kwys As Variant, Items As Variant<br>
Keys = d.keys<br>
Items = d.Items<br>
Fpr i = 0 To d.Count -1<br>
    Debug.Print d.item(Keys(i))<br>
    Debug.Print d.items(i)<br>
Next<br>
<span class="red">0から始まる</span></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Dim v As Variant<br>
For Each v In c<br>
Debug.Print v<br>
Next</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Dim v As Variant<br>
For Each v In d<br>
Debug.Print d.item(v)<br>
Next</p></td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="sect1">
<h2 id="_疑似collection">20. 疑似collection</h2>
<div class="sectionbody">
<div class="ulist">
<ul>
<li>
<p><a href="https://imihito.hatenablog.jp/entry/2017/05/13/010848">VBS用配列ラッパークラス - imihitoのブログ</a></p>
</li>
</ul>
</div>
<div class="dlist">
<div class="title">実装メンバー</div>
<dl>
<dt class="hdlist1">Clear</dt>
<dd>
<p>初期化用。</p>
</dd>
<dt class="hdlist1">Add</dt>
<dd>
<p>要素を末尾に追加。</p>
</dd>
<dt class="hdlist1">Item</dt>
<dd>
<p>添え字で要素を取得。 上記のコードでは添え字は1からはじまる。 範囲外アクセス時
の動作は保証しない。</p>
</dd>
<dt class="hdlist1">Count</dt>
<dd>
<p>要素数。1から数えた場合の数。</p>
</dd>
<dt class="hdlist1">Remove</dt>
<dd>
<p>指定された添え字の要素を除去する。 除去したらその分自動で詰める。</p>
</dd>
<dt class="hdlist1">InitByArray</dt>
<dd>
<p>指定した配列で初期化する。 適当実装。</p>
</dd>
<dt class="hdlist1">ToArray</dt>
<dd>
<p>配列化する。 For Eachの場合や配列そのものが欲しい場合なんかに。</p>
</dd>
</dl>
</div>
<div class="listingblock">
<div class="title">使用例</div>
<div class="content">
<pre class="highlight"><code class="language-vbscript" data-lang="vbscript">Option Explicit
Dim myArray 'As ArrayCol
Set myArray = New ArrayCol

With myArray
    .Add 1
    .Add 3.14
    .Add "文字列"
    .Add Now()
    .Add WScript.ScriptFullName
    .Add New ArrayCol
End With    'myArray
MsgBox myArray(1)
Dim buf: buf = ""
Dim tmp
For Each tmp In myArray.ToArray()
    If IsObject(tmp) Then
        buf = buf &amp; TypeName(tmp) &amp; vbCrLf
    Else
        buf = buf &amp; tmp &amp; vbCrLf
    End If
Next 'tmp

MsgBox buf

'Class ArrayCol
'～


' Class ArrayCol
Class Collection
    '内部格納の配列
    Private clsArray 'As Variant

    '現在の要素数
    Private UsedCount 'As Long

    Private Sub Class_Initialize()
        Call Me.Clear
    End Sub

    Public Sub Clear()
        UsedCount = 0
        ReDim clsArray(4)
    End Sub

    '配列の下限
    Private Property Get ARRAY_BASE() 'As Long
        ARRAY_BASE = 1
    End Property

    '添え字変換
    Private Function UserIndexToRealIndex(Index) 'As Long
        UserIndexToRealIndex = Index - ARRAY_BASE
    End Function

    '要素を追加する。
    Public Sub Add(iItem)
        If UBound(clsArray) = UserIndexToRealIndex(UsedCount) Then Call ArrayExpand
        AssignVal clsArray(UsedCount), iItem
        UsedCount = UsedCount + 1
    End Sub

    Private Sub ArrayExpand()
        ReDim Preserve clsArray(UBound(clsArray) * 2)
    End Sub

    '代入簡略化処理
    Private Sub AssignVal(ByRef o, i)
        If IsObject(i) Then
            Set o = i
        Else
            o = i
        End If
    End Sub

    Public Default Property Get Item(ByVal Index) 'As Variant
        AssignVal Item, clsArray(UserIndexToRealIndex(Index))
    End Property

    Public Property Let Item(ByVal Index, Value)
        clsArray(UserIndexToRealIndex(Index)) = Value
    End Property

    Public Property Set Item(ByVal Index, Value)
        Set clsArray(UserIndexToRealIndex(Index)) = Value
    End Property

    Public Property Get Count() 'As Long
        Count = UsedCount
    End Property

    Public Sub Remove(ByVal Index)
        Dim i
        For i = UserIndexToRealIndex(Index) To UserIndexToRealIndex(UsedCount - 1)
            AssignVal clsArray(i), clsArray(i + 1)
        Next 'i
        clsArray(UserIndexToRealIndex(UsedCount)) = Empty
        UsedCount = UsedCount - 1
    End Sub

    '既存の配列で初期化する。
    Public Sub InitByArray(BaseArray)
        If Not IsArray(BaseArray) Then Err.Raise 5

        Me.Clear
        Dim tmp
        For Each tmp In BaseArray
            Me.Add tmp
        Next 'tmp
    End Sub

    Public Function ToArray() 'As Variant
        Dim buf:    buf = clsArray
        ReDim Preserve buf(UserIndexToRealIndex(UsedCount))
        ToArray = buf
    End Function
End Class</code></pre>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_collection_オブジェクト">21. Collection オブジェクト</h2>
<div class="sectionbody">
<div class="paragraph">
<p><a href="https://docs.microsoft.com/ja-jp/office/vba/language/reference/user-interface-help/collection-object">Collection オブジェクト | Microsoft Docs</a></p>
</div>
<div class="paragraph">
<p>Collection オブジェクトは、アイテムの順序が指定されたセットであり、1 つの単位
として参照できます。</p>
</div>
<div class="paragraph">
<div class="title">注釈</div>
<p>Collection オブジェクトを使用すると、関連性のあるアイテムのグループを 1 つのオ
ブジェクトとして簡単に参照できます。 コレクション内のアイテムつまりメンバーは、
コレクションに存在するという事実のみによって関連付けられる必要があります。 コ
レクションのメンバーは同じデータ型を共有する必要はありません。</p>
</div>
<div class="paragraph">
<p>コレクションは他のオブジェクトと同じ方法で作成できます。 以下に例を示します。</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-vbscript" data-lang="vbscript">Dim X As New Collection</code></pre>
</div>
</div>
<div class="paragraph">
<p>コレクションを作成した後は、 Add メソッドを使用してメンバーを追加し、 Remove
メソッドを使用して削除できます。 特定のメンバーは、 Item メソッドを使用してコ
レクションから返すことができますが、For Each を使用してコレクション全体を反復
処理することもできます。 Next ステートメント。</p>
</div>
<div class="paragraph">
<div class="title">例</div>
<p>この例では、コレクションオブジェクトMyClasses() を作成し、ユーザーがコレクショ
ンにオブジェクトを追加できるダイアログボックスを作成します。</p>
</div>
<div class="paragraph">
<p>この動作を確認するには、[挿入] メニューから*<strong>*</strong> InstanceName[クラスモジュール]
コマンドを選択しInstanceName 、Class1 のモジュールレベルで呼び出されるパブリッ
ク変数を宣言して、各インスタンスの名前を保持します。 Leave the default name as
Class1. Copy and paste the following code into the General section of another
module, and then start it with the statement ClassNamer in another procedure.</p>
</div>
<div class="paragraph">
<p>(This example only works with host applications that support classes.)</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-vbscript" data-lang="vbscript">Sub ClassNamer()
    Dim MyClasses As New Collection    ' Create a Collection object.
    Dim Num    ' Counter for individualizing keys.
    Dim Msg As String    ' Variable to hold prompt string.
    Dim TheName, MyObject, NameList    ' Variants to hold information.
    Do
        Dim Inst As New Class1    ' Create a new instance of Class1.
        Num = Num + 1    ' Increment Num, then get a name.
        Msg = "Please enter a name for this object." &amp; vbNewLine _
         &amp; "Press Cancel to see names in collection."
        TheName = InputBox(Msg, "Name the Collection Items")
        Inst.InstanceName = TheName    ' Put name in object instance.
        ' If user entered name, add it to the collection.
        If Inst.InstanceName &lt;&gt; "" Then
            ' Add the named object to the collection.
            MyClasses.Add item := Inst, key := CStr(Num)
        End If
        ' Clear the current reference in preparation for next one.
        Set Inst = Nothing
    Loop Until TheName = ""
    For Each MyObject In MyClasses    ' Create list of names.
        NameList = NameList &amp; MyObject.InstanceName &amp; vbNewLine
    Next MyObject
    ' Display the list of names in a message box.
    MsgBox NameList, , "Instance Names In MyClasses Collection"

    For Num = 1 To MyClasses.Count    ' Remove name from the collection.
        MyClasses.Remove 1    ' Since collections are reindexed automatically, remove the first member on each iteration.
    Next
End Sub</code></pre>
</div>
</div>
<div class="sect2">
<h3 id="_add_メソッド_vba">21.1. Add メソッド (VBA)</h3>
<div class="paragraph">
<p>Collection オブジェクトにメンバーを追加します。</p>
</div>
<div class="listingblock">
<div class="title">構文</div>
<div class="content">
<pre class="highlight"><code class="language-vbscript" data-lang="vbscript">object.Add item, key, before, after</code></pre>
</div>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 20%;">
<col style="width: 80%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">パーツ</th>
<th class="tableblock halign-left valign-top">説明</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">object</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">必須。 評価結果が [適用先] リストのオブジェクトになるオブジェクト式です。</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">item</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">必須です。 コレクションに追加するメンバーを指定する任意の型の式です。</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">key</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">省略可能。 コレクションのメンバーにアクセスするために位置インデックスの代わりに使用できるキー文字列を指定する一意の文字列式です。</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">before</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">省略可能。 コレクション内の相対位置を指定する式です。 追加するメンバーは、before 引数によって識別されたメンバーの前のコレクション内に配置します。 数式の場合、before には、1 以上からコレクションの Count プロパティ値までの数値を指定する必要があります。 文字列式の場合、before は参照されているメンバーがコレクションに追加されたときに指定された key 引数に対応している必要があります。 before または after のどちらの位置でも指定できますが、両方を指定することはできません。</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">after</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">省略可能。 コレクション内の相対位置を指定する式です。 追加するメンバーは、after 引数によって識別されたメンバーの後のレクション内に配置します。 数式の場合、after には、1 以上からコレクションの Count プロパティ値までの数値を指定する必要があります。 文字列の場合、after は、参照されているメンバーがコレクションに追加されたときに指定される key 引数に対応している必要があります。 before 位置または after 位置を指定できますが、両方とも指定することはできません。</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<div class="title">解説</div>
<p>before 引数と after 引数は、文字列式であっても数式であっても、コレクションの既
存のメンバーを参照している必要があります。参照していない場合はエラーが発生しま
す。</p>
</div>
<div class="paragraph">
<p>指定した key がコレクションの既存のメンバーの key と重複している場合もエラーが
発生します。</p>
</div>
<div class="paragraph">
<div class="title">例</div>
<p>この例では、Add メソッドを使用して、Inst オブジェクト (パブリック変数
InstanceName を含む Class1 と呼ばれるクラスのインスタンス) を MyClasses と呼ば
れるコレクションに追加します。 このしくみを確認するには、クラス モジュールを挿
入し、InstanceName と呼ばれるパブリック変数を Class1 のモジュール レベルで宣言
して (Public InstanceName 型)、各インスタンスの名前を保持します。 名前は既定の
Class1 のままとします。 次のコードをコピーして、フォーム モジュールの
Form_Load イベント プロシージャに貼り付けます。</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-vbscript" data-lang="vbscript">Dim MyClasses As New Collection    ' Create a Collection object.
Dim Num As Integer    ' Counter for individualizing keys.
Dim Msg
Dim TheName    ' Holder for names user enters.
Do
    Dim Inst As New Class1    ' Create a new instance of Class1.
    Num = Num + 1    ' Increment Num, then get a name.
    Msg = "Please enter a name for this object." &amp; Chr(13) _
     &amp; "Press Cancel to see names in collection."
    TheName = InputBox(Msg, "Name the Collection Items")
    Inst.InstanceName = TheName    ' Put name in object instance.
    ' If user entered name, add it to the collection.
    If Inst.InstanceName &lt;&gt; "" Then
        ' Add the named object to the collection.
        MyClasses. Add item := Inst, key := CStr(Num)
    End If
    ' Clear the current reference in preparation for next one.
    Set Inst = Nothing
Loop Until TheName = ""
For Each x In MyClasses
    MsgBox x.instancename, , "Instance Name"
Next</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_item_メソッド">21.2. Item メソッド</h3>
<div class="paragraph">
<p>Collection オブジェクトの特定のメンバーを位置またはキー別に返します。</p>
</div>
<div class="listingblock">
<div class="title">構文</div>
<div class="content">
<pre class="highlight"><code class="language-vbscript" data-lang="vbscript">object.Item(index)</code></pre>
</div>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 20%;">
<col style="width: 80%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">パーツ</th>
<th class="tableblock halign-left valign-top">説明</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">object</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">必須。 評価結果が [適用先] リストのオブジェクトになるオブジェクト式です。</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">index</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">必須です。 コレクションのメンバーの位置を式で指定します。 数式の場合、index には、1 以上からコレクションの Count プロパティ値までの数値を指定します。 文字列式の場合、index は参照されているメンバーがコレクションに追加されたときに指定された_キー_引数に対応している必要があります。</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<div class="title">解説</div>
<p>index として指定された値がコレクションの既存のどのメンバーとも一致しない場合は、
エラーが発生します。 Item メソッドは、コレクションの既定のメソッドです。 その
ため、次のコード行は同じです。</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-vbscript" data-lang="vbscript">Print MyCollection(1)
Print MyCollection.Item(1)</code></pre>
</div>
</div>
<div class="paragraph">
<div class="title">例</div>
<p>この例では、Item メソッドを使用して、コレクション内のオブジェクトへの参照を取
得します。 Birthdays が Collection オブジェクトであると仮定した場合、次のコー
ドでは、"SmithBill" キーと "SmithAdam" キーが index 引数として使用され、コレク
ションから Bill Smith の誕生日と Adam Smith の誕生日を表すオブジェクトへの参照
が取得されます。</p>
</div>
<div class="paragraph">
<p>なお、最初の呼び出しでは Item メソッドが明示的に指定されていますが、2 つ目では
そのように指定されていません。 Item メソッドは Collection オブジェクトの既定で
あるため、いずれの呼び出しでも機能します。 Set で割り当てられている
SmithBillBD と SmithAdamBD への参照は、指定したオブジェクトのプロパティとメソ
ッドにアクセスするために使用できます。</p>
</div>
<div class="paragraph">
<p>このコードを実行するには、コレクションを作成し、それに少なくとも 2 つの参照メ
ンバーを挿入します。</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-vbscript" data-lang="vbscript">Dim SmithBillBD As Object
Dim SmithAdamBD As Object
Dim Birthdays
Set SmithBillBD = Birthdays.Item("SmithBill")
Set SmithAdamBD = Birthdays("SmithAdam")</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_remove_メソッド_vba">21.3. Remove メソッド (VBA)</h3>
<div class="paragraph">
<p>Collection オブジェクトからメンバーを削除します。</p>
</div>
<div class="listingblock">
<div class="title">構文</div>
<div class="content">
<pre class="highlight"><code class="language-vbscript" data-lang="vbscript">object.Remove (index)</code></pre>
</div>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 20%;">
<col style="width: 80%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">パーツ</th>
<th class="tableblock halign-left valign-top">説明</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">object</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">必須。 評価結果が [適用先] リストのオブジェクトになるオブジェクト式です。</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">index</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">必須です。 コレクションのメンバーの位置を式で指定します。 数式の場合、index には、1 以上からコレクションの Count プロパティ値までの数値を指定します。 文字列式の場合、index は参照されているメンバーがコレクションに追加されたときに指定された_キー_引数に対応している必要があります。</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<div class="title">解説</div>
<p>index の値がコレクションの既存のメンバーのいずれとも一致しない場合は、エラーが
発生します。</p>
</div>
<div class="paragraph">
<div class="title">例</div>
<p>次の例では、Remove メソッドを使用して Collection オブジェクト MyClasses からオ
ブジェクトを削除しています。 このコードは、ループの反復ごとに、インデックスが
1 のオブジェクトを削除します。</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-vbscript" data-lang="vbscript">Dim Num, MyClasses
For Num = 1 To MyClasses.Count
    MyClasses.Remove 1    ' Remove the first object each time
            ' through the loop until there are
            ' no objects left in the collection.
Next Num</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_count_プロパティ_vba">21.4. Count プロパティ (VBA)</h3>
<div class="paragraph">
<p>コレクション内のオブジェクト数を含む Long (長整数型) を返します。 読み取り専用
です。</p>
</div>
<div class="paragraph">
<div class="title">例</div>
<p>この例では、コレクション オブジェクトのCountプロパティを使用して、と呼ばれる
MyClassesコレクションのすべての要素を削除するために必要な反復回数を指定します。
コレクションの数値インデックスは、既定で 1 から始まります。 コレクションは削除
されたときに自動的に再インデックス化れるため、次のコードでは、各反復の最初のメ
ンバーを削除します。</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-vbscript" data-lang="vbscript">Dim Num, MyClasses
For Num = 1 To MyClasses.Count    ' Remove name from the collection.
    MyClasses.Remove 1    ' Default collection numeric indexes
Next    ' begin at 1.</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_collectionのソート">21.5. Collectionのソート</h3>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-vbscript" data-lang="vbscript">Sub sample()
    Dim c As New Collection, v As Variant
    Dim cs As New Collection

    c.Add Item:="xyz"
    c.Add Item:="def"
    c.Add Item:="abc"
    Set cs = SortCollection(c)
    For Each v In cs: Debug.Print v;: Next

End Sub

Function SortCollection(c As Collection) As Collection
    Dim v As Variant, r As New Collection
    Dim i As Long

    With CreateObject("System.Collections.ArrayList")
        For Each v In c
            .Add v
        Next
        .Sort
        For Each v In .toarray
            r.Add v
        Next
    End With

    Set SortCollection = r
End Function</code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_dictionary_オブジェクト_microsoft_docs">22. <a href="https://docs.microsoft.com/ja-jp/office/vba/language/reference/user-interface-help/dictionary-object">Dictionary オブジェクト | Microsoft Docs</a></h2>
<div class="sectionbody">
<div class="paragraph">
<p>データ キー/アイテムのペアを保存するオブジェクト。</p>
</div>
<div class="listingblock">
<div class="title">構文</div>
<div class="content">
<pre class="highlight"><code class="language-vbscript" data-lang="vbscript">Scripting.Dictionary</code></pre>
</div>
</div>
<div class="paragraph">
<div class="title">解説</div>
<p>Dictionary オブジェクトは PERL 連想配列に相当します。 アイテムには任意の形式の
データを使用でき、配列に格納されます。 各アイテムは一意のキーに関連付けられま
す。 キーは、個々のアイテムを取得するために使用され、通常は整数または文字列と
なりますが、配列以外の任意の形式を使用できます。</p>
</div>
<div class="paragraph">
<p>次のコードは、Dictionary オブジェクトを作成する方法を示しています。</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-vbscript" data-lang="vbscript">Dim d                   'Create a variable
Set d = CreateObject("Scripting.Dictionary")
d.Add "a", "Athens"     'Add some keys and items
d.Add "b", "Belgrade"
d.Add "c", "Cairo"
...</code></pre>
</div>
</div>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 10. メソッド</caption>
<colgroup>
<col style="width: 20%;">
<col style="width: 80%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">メソッド</th>
<th class="tableblock halign-left valign-top">説明</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Add</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Dictionary オブジェクトに新しいキー/アイテムのペアを追加します。</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Exists</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">指定したキーが Dictionary オブジェクト内に存在するかどうかを示すブール値を返します。</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Items</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Dictionary オブジェクト内のすべてのアイテムの配列を返します。</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Keys</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Dictionary オブジェクト内のすべてのキーの配列を返します。</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Remove</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Dictionary オブジェクトから、指定したキー/アイテムのいずれかのペアを削除します。</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">RemoveAll</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Dictionary オブジェクト内のすべてのキー/アイテムのペアを削除します。</p></td>
</tr>
</tbody>
</table>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 11. プロパティ</caption>
<colgroup>
<col style="width: 20%;">
<col style="width: 80%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">プロパティ</th>
<th class="tableblock halign-left valign-top">説明</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">CompareMode</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Dictionary オブジェクト内でキーを比較するために比較モードを設定するか返します。</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Count</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Dictionary オブジェクト内のキー/アイテムのペアの数を返します。</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Item</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Dictionary オブジェクト内のアイテムの値を設定するか返します。</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Key</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Dictionary オブジェクト内の既存のキー値に対して新しいキー値を設定します。</p></td>
</tr>
</tbody>
</table>
<div class="sect2">
<h3 id="_メソッド_3">22.1. メソッド</h3>
<div class="sect3">
<h4 id="_add_メソッド">22.1.1. Add メソッド</h4>
<div class="paragraph">
<p>Dictionary オブジェクトにキーとアイテムのペアを追加します。</p>
</div>
<div class="listingblock">
<div class="title">構文</div>
<div class="content">
<pre class="highlight"><code class="language-vbscript" data-lang="vbscript">object.Add key, item</code></pre>
</div>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 20%;">
<col style="width: 80%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">パーツ</th>
<th class="tableblock halign-left valign-top">説明</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">object</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">必須です。 常に Dictionary オブジェクトの名前です。</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">key</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">必ず指定します。 アイテムに関連付けられた追加するキーを指定します。</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">item</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">必須。 キーに関連付けられた追加するアイテムを指定します。</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<div class="title">注釈</div>
<p>key が既に存在する場合は、エラーが発生します。</p>
</div>
</div>
<div class="sect3">
<h4 id="_exists_メソッド">22.1.2. Exists メソッド</h4>
<div class="paragraph">
<p>指定したキーが<strong>Dictionary</strong> オブジェクトに存在する場合はTrueを返します。False
の場合は False。</p>
</div>
<div class="listingblock">
<div class="title">構文</div>
<div class="content">
<pre class="highlight"><code class="language-vbscript" data-lang="vbscript">object.Exists (key)</code></pre>
</div>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 20%;">
<col style="width: 80%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">パーツ</th>
<th class="tableblock halign-left valign-top">説明</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">object</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">必須です。 常に Dictionary オブジェクトの名前です。</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">key</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">必須。 Dictionary オブジェクト内で検索する Key の値。</p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect3">
<h4 id="_items_メソッド">22.1.3. Items メソッド</h4>
<div class="paragraph">
<p>Dictionary オブジェクト内のすべてのアイテムを含む配列を返します。</p>
</div>
<div class="listingblock">
<div class="title">構文</div>
<div class="content">
<pre class="highlight"><code class="language-vbscript" data-lang="vbscript">object.Items</code></pre>
</div>
</div>
<div class="paragraph">
<div class="title">注釈</div>
<p>次のコードは、Items メソッドの使用方法を示しています。</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-vbscript" data-lang="vbscript">Dim a, d, i             'Create some variables
Set d = CreateObject("Scripting.Dictionary")
d.Add "a", "Athens"     'Add some keys and items
d.Add "b", "Belgrade"
d.Add "c", "Cairo"
a = d.Items             'Get the items
For i = 0 To d.Count -1 'Iterate the array
    Print a(i)          'Print item
Next
...</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_keys_メソッド">22.1.4. Keys メソッド</h4>
<div class="paragraph">
<p>Dictionary オブジェクト内のすべての既存のキーを含む配列を返します。</p>
</div>
<div class="listingblock">
<div class="title">構文</div>
<div class="content">
<pre class="highlight"><code class="language-vbscript" data-lang="vbscript">object.Keys</code></pre>
</div>
</div>
<div class="paragraph">
<div class="title">注釈</div>
<p>次のコードは、Keys メソッドの使用方法を示しています。</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-vbscript" data-lang="vbscript">Dim a, d, i             'Create some variables
Set d = CreateObject("Scripting.Dictionary")
d.Add "a", "Athens"     'Add some keys and items.
d.Add "b", "Belgrade"
d.Add "c", "Cairo"
a = d.keys              'Get the keys
For i = 0 To d.Count -1 'Iterate the array
    Print a(i)          'Print key
Next
...</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_remove_メソッド">22.1.5. Remove メソッド</h4>
<div class="paragraph">
<p>Dictionary オブジェクトからキーとアイテムのペアを削除します。</p>
</div>
<div class="listingblock">
<div class="title">構文</div>
<div class="content">
<pre class="highlight"><code class="language-vbscript" data-lang="vbscript">object.Remove (key)</code></pre>
</div>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 20%;">
<col style="width: 80%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">指定項目</th>
<th class="tableblock halign-left valign-top">説明</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">object</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">必須です。 常に Dictionary オブジェクトの名前です。</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">key</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">必須。 Dictionaryオブジェクトから削除するキー/アイテムのペアに関連付けら
れている_キー_です。</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<div class="title">注釈</div>
<p>指定したキー/アイテムのペアが存在しない場合は、エラーが発生します。</p>
</div>
<div class="paragraph">
<p>次のコードは、 Removeメソッドの使用方法を示しています。</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-vbscript" data-lang="vbscript">Public Sub Start()

    Dim d As Object
    Set d = CreateObject("Scripting.Dictionary")

    d.Add "a", "Athens"
    d.Add "b", "Belgrade"
    d.Add "c", "Cairo"

    Debug.Print "Keys, before using Remove."
    PrintKeys d

    d.Remove "b"

    Debug.Print "Keys, after removing key 'b'."
    PrintKeys d

End Sub

Private Sub PrintKeys(ByVal d As Object)

    Dim k As Variant
    For Each k In d.Keys
        Debug.Print k
    Next k

End Sub

' The example displays the following output:
' Keys, before using Remove.
' a
' b
' c
' Keys, after removing key 'b'.
' a
' c</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_removeall_メソッド">22.1.6. RemoveAll メソッド</h4>
<div class="paragraph">
<p>RemoveAllメソッドは、 Dictionary オブジェクトから、キーとアイテムのすべてのペ
アを削除します。</p>
</div>
<div class="listingblock">
<div class="title">構文</div>
<div class="content">
<pre class="highlight"><code class="language-vbscript" data-lang="vbscript">object.RemoveAll</code></pre>
</div>
</div>
<div class="paragraph">
<p>object は常に Dictionary オブジェクトの名前です。</p>
</div>
<div class="paragraph">
<div class="title">注釈</div>
<p>次のコードは、 RemoveAllメソッドの使用方法を示しています。</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-vbscript" data-lang="vbscript">Dim a, d, i             'Create some variables
Set d = CreateObject("Scripting.Dictionary")
d.Add "a", "Athens"     'Add some keys and items
d.Add "b", "Belgrade"
d.Add "c", "Cairo"
...
a = d.RemoveAll         'Clear the dictionary</code></pre>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_プロパティ_3">22.2. プロパティ</h3>
<div class="sect3">
<h4 id="_comparemode_プロパティ">22.2.1. CompareMode プロパティ</h4>
<div class="paragraph">
<p>Dictionary オブジェクト内の文字列キーを比較するための比較モードを設定および取
得します。</p>
</div>
<div class="listingblock">
<div class="title">構文</div>
<div class="content">
<pre class="highlight"><code class="language-vbscript" data-lang="vbscript">object.CompareMode [ = compare ]</code></pre>
</div>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 20%;">
<col style="width: 80%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">パーツ</th>
<th class="tableblock halign-left valign-top">説明</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">object</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">必須です。 常に、Dictionary オブジェクトの名前です。</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">compare</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">省略可能。 指定した場合、 _compare_は、 StrComp などの関数で使用され
る比較モードを表す値です。</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<div class="title">設定</div>
<p>compare 引数には、次の値を指定できます。</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 20%;">
<col style="width: 80%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">定数</th>
<th class="tableblock halign-left valign-top">値</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">説明</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">vbUseCompareOption</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">-1</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Option Compare ステートメントの設定を使用して比較を実
行します。</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">vbBinaryCompare</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">.0</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">バイナリ比較を実行します。</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">vbTextCompare</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">1-d</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">テキスト比較を実行します。</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">vbDatabaseCompare</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">pbm-2</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<div class="title">注釈</div>
<p>データが既に含まれる Dictionary オブジェクトの比較モードの変更を試みた場合、エ
ラーが発生します。</p>
</div>
<div class="paragraph">
<p>CompareMode プロパティは、StrComp 関数の compare 引数と同じ値を使用します。 2
より大きい値は、特定のロケール Id (LCID) を使用して比較を参照するために使用で
きます。</p>
</div>
</div>
<div class="sect3">
<h4 id="_count_プロパティ">22.2.2. Count プロパティ</h4>
<div class="paragraph">
<p>コレクションまたは<strong>Dictionary</strong> オブジェクト内の項目数を含む長整数型 (long)
の値を返します。 読み取り専用です。</p>
</div>
<div class="listingblock">
<div class="title">構文</div>
<div class="content">
<pre class="highlight"><code class="language-vbscript" data-lang="vbscript">object.Count</code></pre>
</div>
</div>
<div class="paragraph">
<p>_オブジェクト_は、常に、Applies To リストの 1 つの項目名です。</p>
</div>
<div class="paragraph">
<div class="title">解説</div>
<p>次のコードは、Count プロパティの使用例です。</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-vbscript" data-lang="vbscript">Dim a, d, i             'Create some variables
Set d = CreateObject("Scripting.Dictionary")
d.Add "a", "Athens"     'Add some keys and items.
d.Add "b", "Belgrade"
d.Add "c", "Cairo"
a = d.Keys              'Get the keys
For i = 0 To d.Count -1 'Iterate the array
    Print a(i)          'Print key
Next
...</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_item_プロパティ">22.2.3. Item プロパティ</h4>
<div class="paragraph">
<p>Dictionary オブジェクト内の指定した_キー_の_アイテム_を設定または取得します。
コレクションについては、指定した key に基づいて item を取得します。 値の取得と
設定が可能です。</p>
</div>
<div class="listingblock">
<div class="title">構文</div>
<div class="content">
<pre class="highlight"><code class="language-vbscript" data-lang="vbscript">object.Item (key) [ = newitem ]</code></pre>
</div>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 20%;">
<col style="width: 80%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">パーツ</th>
<th class="tableblock halign-left valign-top">説明</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">object</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">必須です。 コレクション またはDictionaryオブジェクトの名前を常に指定
します。</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">key</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">必須。 取得または追加された項目に関連付けられた Key です。</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">newitem</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">省略可能。 Dictionaryオブジェクトのみに使用されます。コレクションに
対するアプリケーションがありません。 指定した場合、 <em>newitem_は指定した_キー</em>
に関連付けられている新しい値です。</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<div class="title">注釈</div>
<p>item を変更するときに key がない場合は、指定した newitem で新しい key が作成さ
れます。 既存の項目を返そうとしたときに key がない場合は、新しい key が作成さ
れ、対応する項目は空のままになります。</p>
</div>
</div>
<div class="sect3">
<h4 id="_key_プロパティ">22.2.4. Key プロパティ</h4>
<div class="paragraph">
<p>Dictionary オブジェクトに_キー_を設定します。</p>
</div>
<div class="listingblock">
<div class="title">構文</div>
<div class="content">
<pre class="highlight"><code class="language-vbscript" data-lang="vbscript">object.Key (key) = newkey</code></pre>
</div>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 20%;">
<col style="width: 80%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">パーツ</th>
<th class="tableblock halign-left valign-top">説明</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">object</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">必須です。 常に Dictionary オブジェクトの名前です。</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">key</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">必須。 変更されている_キー_の値を指定します。</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">newkey</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">必ず指定します。 指定した__ キーを置き換える新しい値です。</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<div class="title">注釈</div>
<p><em> キーを変更するとき、</em> キーが見つからない場合は、実行時エラーが発生します。</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_dictionaryのソート">22.3. Dictionaryのソート</h3>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-vbscript" data-lang="vbscript">Function SortCollection(c As Collection) As Collection
    Dim v As Variant, r As New Collection
    Dim i As Long

    With CreateObject("System.Collections.ArrayList")
        For Each v In c
            .Add v
        Next
        .Sort
        For Each v In .ToArray
            r.Add v
        Next
    End With

    Set SortCollection = r
End Function

Function SortDictionary(d As Scripting.Dictionary) As Dictionary
    Dim v As Variant, r As New Scripting.Dictionary
    With CreateObject("System.Collections.ArrayList")
        For Each v In d.Keys
            .Add v
        Next
        .Sort
        For Each v In .ToArray
            Debug.Print d.Item(v)
            r.Add v, d.Item(v)
        Next
    End With
    Set SortDictionary = r
End Function</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_dictionaryにclassを追加">22.4. DictionaryにClassを追加</h3>
<div class="paragraph">
<p>独自の構造体？ユーザ定義型?を配列にするよりリストにしたいときは以下を使用する</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">参照設定</dt>
<dd>
<p>Microsoft Scripting Runtime</p>
</dd>
</dl>
</div>
<div class="dlist">
<div class="title">クラスモジュール</div>
<dl>
<dt class="hdlist1">クラス名のオブジェクト名</dt>
<dd>
<p>PointF</p>
</dd>
</dl>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-vbscript" data-lang="vbscript">Public Keyword As String
Public Width As Single
Public Height As Single</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">標準モジュール</div>
<div class="content">
<pre class="highlight"><code class="language-vbscript" data-lang="vbscript">Sub sample()
    Dim d As New Scripting.Dictionary

    Dim i As Long

    For i = 2 To 10
        Dim c As New PointF
        Set c = New PointF
        c.Keyword = CStr(i)
        c.Width = i * 0.2
        c.Height = i * 0.4

        d.Add c.Keyword, c
    Next

    Dim v As Variant

    For Each v In d
        Debug.Print v, d(v).Keyword, d(v).Width, d(v).Height
    Next

End Sub</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_ユーザ定義型">22.5. ユーザ定義型</h3>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-vbscript" data-lang="vbscript">x	y
87.46262547	93.74511603
14.68437308	45.9871718
15.84922519	37.55625453
20.61633409	98.4689104
59.2607724	92.96599402
53.36464653	23.2974936
63.87788748	26.76635907
55.97209731	6.687294902
67.2954545	31.49184379


Type PointF
    x As Double
    y As Double
End Type

Sub sample()
    Dim p() As PointF
    Dim i As Long

    For i = 2 To 10
        ReDim Preserve p(i - 2)
        p(i - 2).x = Cells(i, 24)
        p(i - 2).y = Cells(i, 25)
    Next

Stop
End Sub</code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_グラフ">23. グラフ</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_グラフ作成">23.1. グラフ作成</h3>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-VBSCRIPT" data-lang="VBSCRIPT">Dim rng As Range

    Set rng = Range("C1").CurrentRegion

With ActiveSheet.Shapes.AddChart.Chart
    .ChartType = xlXYScatterLines
    .SetSourceData rng
End With</code></pre>
</div>
</div>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 12. Xlcharttype クラス列挙 (Excel)</caption>
<colgroup>
<col style="width: 44.4444%;">
<col style="width: 11.1111%;">
<col style="width: 44.4445%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">名前</th>
<th class="tableblock halign-left valign-top">値</th>
<th class="tableblock halign-left valign-top">説明</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">xl3DArea</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">-4098</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">3-D 面</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">xl3DAreaStacked</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">78</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">3-D 積み上げ面</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">xl3DAreaStacked100</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">79</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">100% 積み上げ面</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">xl3DBarClustered</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">60</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">3-D 集合横棒</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">xl3DBarStacked</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">61</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">3-D 積み上げ横棒</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">xl3DBarStacked100</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">62</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">3-D 100% 積み上げ横棒</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">xl3DColumn</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">-4100</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">3-D 縦棒</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">xl3DColumnClustered</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">54</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">3-D 集合縦棒</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">xl3DColumnStacked</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">55</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">3-D 積み上げ縦棒</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">xl3DColumnStacked100</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">56</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">3-D 100% 積み上げ縦棒</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">xl3DLine</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">-4101</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">3-D 折れ線</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">xl3DPie</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">-4102</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">3-D 円</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">xl3DPieExploded</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">70</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">分割 3-D 円</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">xlArea</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1-d</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">分野</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Xlた積み上げ</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">76</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">積み上げ面</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">xlAreaStacked100</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">77</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">100% 積み上げ面</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">xlBarClustered</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">57</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">集合横棒</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">xlBarOfPie</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">71</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">補助縦棒グラフ付き円</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">xlBarStacked</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">58</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">積み上げ横棒</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">xlBarStacked100</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">59</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">100% 積み上げ横棒</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">xlBubble</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">約</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">バブル</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">xlBubble3DEffect</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">87</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">3-D 効果付きバブル</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">xlColumnClustered</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">51</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">集合縦棒</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">xlColumnStacked</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">52</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">積み上げ縦棒</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">xlColumnStacked100</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">53</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">100% 積み上げ縦棒</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">xlConeBarClustered</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">102</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">集合円錐型横棒</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">xlConeBarStacked</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">103</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">積み上げ円錐型横棒</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">xlConeBarStacked100</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">104</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">100% 積み上げ円錐型横棒</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">xlConeCol</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">105</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">3-D 円錐型縦棒</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">xlConeColClustered</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">99</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">集合円錐型縦棒</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">xlConeColStacked</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">100</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">積み上げ円錐型縦棒</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">xlConeColStacked100</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">101</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">100% 積み上げ円錐型縦棒</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">xlCylinderBarClustered</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">95</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">集合円柱型横棒</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">xlCylinderBarStacked</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">96</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">積み上げ円柱型横棒</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">xlCylinderBarStacked100</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">97</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">100% 積み上げ円柱型横棒</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">xlCylinderCol</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">98</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">3-D 円柱型縦棒</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">xlCylinderColClustered</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">92</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">集合円錐型縦棒</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">xlCylinderColStacked</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">93</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">積み上げ円錐型縦棒</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">xlCylinderColStacked100</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">94</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">100% 積み上げ円柱型縦棒</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">xlDoughnut</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">-4120</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">ドーナツ</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">xlDoughnutExploded</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">80</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">分割ドーナツ</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">xlLine</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">2/4</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">折れ線</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">xlLineMarkers</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">65</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">マーカー付き折れ線</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">xlLineMarkersStacked</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">66</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">マーカー付き積み上げ折れ線</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">xlLineMarkersStacked100</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">67</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">マーカー付き 100% 積み上げ折れ線</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">xlLineStacked</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">63</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">積み上げ折れ線</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">xlLineStacked100</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">64</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">100% 積み上げ折れ線</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">xlPie</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">5</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">円</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">xlPieExploded</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">69</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">分割円</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">xlPieOfPie</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">68</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">補助円グラフ付き円</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">xlPyramidBarClustered</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">109</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">集合ピラミッド型横棒</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">xlPyramidBarStacked</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">110</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">積み上げピラミッド型横棒</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">xlPyramidBarStacked100</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">111</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">100% 積み上げピラミッド型横棒</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">xlPyramidCol</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">112</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">3-D ピラミッド型縦棒</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">xlPyramidColClustered</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">106</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">集合ピラミッド型縦棒</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">xlPyramidColStacked</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">107</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">積み上げピラミッド型縦棒</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">xlPyramidColStacked100</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">108</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">100% 積み上げピラミッド型横棒</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">xlRadar</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">-4151</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">レーダー</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Xlレーダー Ar塗りつぶし</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">82</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">塗りつぶしレーダー</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Xlレーダー Arマーカー</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">81</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">データ マーカー付きレーダー</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">xlRegionMap</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">140</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">マップグラフ。</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">xlStockHLC</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">88</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">高値 - 安値 - 終値</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">xlStockOHLC</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">89</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">始値 - 高値 - 安値 - 終値</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">xlStockVHLC</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">90</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">出来高 - 高値 - 安値 - 終値</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">xlStockVOHLC</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">91</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">出来高 - 始値 - 高値 - 安値 - 終値</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">xlSurface</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">83</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">3-D 表面</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">xlSurfaceTopView</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">85</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">表面 (トップ ビュー)</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">xlSurfaceTopViewWireframe</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">86</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">表面 (トップ ビュー - ワイヤーフレーム)</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">xlSurfaceWireframe</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">84</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">3-D 表面 (ワイヤーフレーム)</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">xlXYScatter</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">-4169</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">散布図</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">xlXYScatterLines</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">74</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">折れ線付き散布図</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">xlXYScatterLinesNoMarkers</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">75</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">折れ線付き散布図 (データ マーカーなし)</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">xlXYScatterSmooth</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">72</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">平滑線付き散布図</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">xlXYScatterSmoothNoMarkers</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">73</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">平滑線付き散布図 (データ マーカーなし)</p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect2">
<h3 id="_グラフの系列追加">23.2. グラフの系列追加</h3>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 16.6666%;">
<col style="width: 16.6666%;">
<col style="width: 16.6666%;">
<col style="width: 16.6666%;">
<col style="width: 16.6666%;">
<col style="width: 16.667%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top"></th>
<th class="tableblock halign-left valign-top">A</th>
<th class="tableblock halign-left valign-top">B</th>
<th class="tableblock halign-left valign-top">C</th>
<th class="tableblock halign-left valign-top">D</th>
<th class="tableblock halign-left valign-top">E</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">1</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">3.5</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">3.4</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">3.4</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">3.4</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">2</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">hoge1</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">2.4</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">3</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">hoge2</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">2.3</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">4</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">hoge3</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">3.5</p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">5</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">hoge4</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">2.4</p></td>
</tr>
</tbody>
</table>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-vbscript" data-lang="vbscript">    Dim i As Long
    Dim s As Series
    Dim rng As Range
    Dim s_row As Long, row_Count As Long
    Dim s_col As Long, e_col As Long

    Range("F2").Select
    Selection.CurrentRegion.Select
    Set rng = Selection
    Debug.Print rng.Column, rng.Row, rng.Columns.Count, rng.Rows.Count
    s_row = rng.Row
    row_Count = rng.Rows.Count - 1
    s_col = rng.Column
    e_col = rng.Column + rng.Columns.Count - 1

    ActiveSheet.ChartObjects(1).Select
    For i = 1 To row_Count
        Set s = ActiveChart.SeriesCollection.NewSeries
        With s
            .ChartType = xlXYScatter    ' 分布図
            .XValues = Range(Cells(s_row, s_col + 1), Cells(s_row, e_col))
            .Values = Range(Cells(s_row + i, s_col + 1), Cells(s_row + i, e_col))
            .Name = Cells(s_row + i, s_col)
        End With
    Next</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_グラフのタイトル変更">23.3. グラフのタイトル変更</h3>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-VBSCRIPT" data-lang="VBSCRIPT">With ActiveSheet.ChartObjects(1).Chart
    .HasTitle = True	'　まずは有効にしてから内容を指定する
    .ChartTitle.Text = "タイトル"
End With


With ActiveChart
	.HasTitle = True
	.ChartTitle.Caption = "=cells(sum,1)"
End With</code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-VBSCRIPT" data-lang="VBSCRIPT">ActiveSheet.ChartObjects(1).Select
With ActiveChart
    .HasTitle = True	'　まずは有効にしてから内容を指定する
    .ChartTitle.Caption = "title"
End With</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_グラフ移動">23.4. グラフ移動</h3>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-vbscript" data-lang="vbscript">ActiveChart.ChartArea.Left = Cells(6, DstColmn).Left
ActiveChart.ChartArea.Top = Cells(6, DstColmn).Top</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_グラフ行列入れ替え">23.5. グラフ行列入れ替え</h3>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-vbscript" data-lang="vbscript">ActiveChart.PlotBy = xlRows
ActiveChart.PlotBy = xlColumns</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_軸の設定">23.6. 軸の設定</h3>
<div class="sect3">
<h4 id="_軸のタイトル">23.6.1. 軸のタイトル</h4>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-VBSCRIPT" data-lang="VBSCRIPT">' グラフのX軸(横軸)のタイトルを設定
ActiveChart.Axes(xlCategory, xlPrimary).HasTitle = True
ActiveChart.Axes(xlCategory, xlPrimary).AxisTitle.Characters.Text = "X軸タイトル"</code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-VBSCRIPT" data-lang="VBSCRIPT">' グラフのY軸(縦軸)のタイトルを設定
ActiveChart.Axes(xlValue, xlPrimary).HasTitle = True
ActiveChart.Axes(xlValue, xlPrimary).AxisTitle.Characters.Text = "Y軸タイトル"</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_横軸の最小値最大値">23.6.2. 横軸？の最小値、最大値</h4>

</div>
</div>
<div class="sect2">
<h3 id="_マーカー設定">23.7. マーカー設定</h3>
<div class="dlist">
<dl>
<dt class="hdlist1">markersize</dt>
<dd>
<p>2 から 72</p>
<div class="ulist">
<ul>
<li>
<p>XlMarkerStyle 列挙 (Excel)
折れ線グラフ、散布図、またはレーダー チャートで、データ要素またはデータ系列の
マーカーのスタイルを設定します。</p>
</li>
</ul>
</div>
</dd>
</dl>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 44.4444%;">
<col style="width: 11.1111%;">
<col style="width: 44.4445%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">名前</th>
<th class="tableblock halign-left valign-top">値</th>
<th class="tableblock halign-left valign-top">説明</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">xlMarkerStyleAutomatic</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">-4105</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">自動マーカー</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">xlMarkerStyleCircle</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">~</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">円形のマーカー</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">xlMarkerStyleDash</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">-4115</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">長い棒のマーカー</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">xlMarkerStyleDiamond</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">pbm-2</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">ひし形のマーカー</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">xlMarkerStyleDot</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">-4118</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">短い棒のマーカー</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">xlMarkerStyleNone</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">-4142</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">マーカーなし</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">xlMarkerStylePicture</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">-4147</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">画像マーカー</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">xlMarkerStylePlus</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">i-9</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">正符号 (+) 付きの四角形のマーカー</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">xlMarkerStyleSquare</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1-d</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">四角形のマーカー</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">xlMarkerStyleStar</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">5</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">アスタリスク (*) 付きの四角形のマーカー</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">xlMarkerStyleTriangle</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1/3</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">三角形のマーカー</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">xlMarkerStyleX</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">-4168</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">X 印付きの四角形のマーカー</p></td>
</tr>
</tbody>
</table>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-VBSCRIPT" data-lang="VBSCRIPT">Dim Co As ChartObject
Dim Sc As Series

For Each Co In ActiveSheet.ChartObjects
    Debug.Print Co.Name

    For Each Sc In Co.Chart.SeriesCollection
        Debug.Print Sc.MarkerSize
        Debug.Print Sc.MarkerStyle

        Sc.MarkerSize = 12
        Sc.MarkerStyle
    Next
Next</code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_正規表現で1行を空白で分割">24. 正規表現で1行を空白で分割</h2>
<div class="sectionbody">
<div class="dlist">
<dl>
<dt class="hdlist1">産業設定</dt>
<dd>
<p>Microsoft VBscript Reguler Expressions 5.5</p>
</dd>
</dl>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-vbscript" data-lang="vbscript">Sub sample()

    Dim re As New RegExp
    Set re = CreateObject("VBScript.RegExp")

    Dim s As String: s = "This is a              pen."
    Dim ms As MatchCollection
    Dim m As Match

    re.Pattern = "\S+"
    re.Global = True
    Debug.Print s
    Set ms = re.Execute(s)
    For Each m In ms
        Debug.Print m
    Next

End Sub

'This is a              pen.
'This
'is
'a
'pen.</code></pre>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_donotupdate">25. DoNotUpdate</h2>
<div class="sectionbody">
<div class="paragraph">
<div class="title">classに追加する</div>
<p>クラスモジュール</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-vbscript" data-lang="vbscript">Private Sub Class_Initialize()
    With Application
        .ScreenUpdating = False
        .Calculation = xlCalculationManual
        .EnableEvents = False
        .PrintCommunication = False
        .Cursor = xlWait
    End With
End Sub

Private Sub Class_Terminate()
    With Application
        .ScreenUpdating = True
        .Calculation = xlCalculationAutomatic
        .EnableEvents = True
        .PrintCommunication = True
        .Cursor = xlDefault
    End With

End Sub</code></pre>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_indirect関数を使う">26. INDIRECT関数を使う</h2>
<div class="sectionbody">
<div class="paragraph">
<div class="title">INDIRECT関数の他シート参照例</div>
<p>A1セルに"Sheet2"、B1セルに"A1"と入っているとします。</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-vbscript" data-lang="vbscript">=INDIRECT(A1&amp;"!"&amp;B1)</code></pre>
</div>
</div>
<div class="paragraph">
<p>この結果は、Sheet2のA1セルの値が出力されます。</p>
</div>
<div class="paragraph">
<div class="title">INDIRECT関数の範囲指定例</div>
<p>A列に数値が入っていて、C1セルA2、C2セルA5と入っているとします。</p>
</div>
<div class="paragraph">
<p>=SUM(INDIRECT(C1&amp;":" &amp;C2))</p>
</div>
<div class="paragraph">
<p>この結果は、A2～A5の合計になります。</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-vbscript" data-lang="vbscript">	A	B	C
1	1		A2
2	2		A5
3	3		=SUM(INDIRECT(C1&amp;":" &amp;C2))
4	4
5	5
6	6
7	7
8	8</code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-vbscript" data-lang="vbscript">  A    b
1 hoge A1
2
|
 ------
| hoge | Sheet1
 ------ ---------

=INDIRECT(A1 &amp; "!" &amp; B1)</code></pre>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_配列を使うのに役立つ4つの関数arraylbounduboundsplitの使い方">27. 配列を使うのに役立つ4つの関数――Array、LBound、UBound、Splitの使い方</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_array_関数_visual_basic_for_applications_microsoft_docs">27.1. <a href="https://docs.microsoft.com/ja-jp/office/vba/language/reference/user-interface-help/array-function">Array 関数 (Visual Basic for Applications) | Microsoft Docs</a></h3>
<div class="paragraph">
<p>配列を含む Variant を返します。</p>
</div>
<div class="listingblock">
<div class="title">構文</div>
<div class="content">
<pre class="highlight"><code class="language-vbscript" data-lang="vbscript">Array(arglist)</code></pre>
</div>
</div>
<div class="paragraph">
<p>必須の arglist 引数は、Variant に含まれている配列の要素に割り当てられる値のコ
ンマ区切りのリストです。 引数を指定しない場合は長さ 0 の配列が作成されます。</p>
</div>
<div class="paragraph">
<div class="title">解説</div>
<p>配列の要素を参照するために使用される表記は、変数 名とそれに続く括弧で構成され、
括弧の中には目的の要素を示すインデックス番号が入ります。</p>
</div>
<div class="paragraph">
<p>次の例では、最初のステートメントにより、Variant として「A」という名前の変数が
作成されます。 2 つ目のステートメントにより、変数 A に配列が割り当てられます。
最後のステートメントにより、2 つ目の配列要素に含まれる値が別の変数に割り当てら
れます。</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-vbscript" data-lang="vbscript">Dim A As Variant, B As Long, i As Long
A = Array(10, 20, 30)  ' A is a three element list by default indexed 0 to 2
B = A(2)               ' B is now 30
ReDim Preserve A(4)    ' Extend A's length to five elements
A(4) = 40              ' Set the fifth element's value
For i = LBound(A) To UBound(A)
    Debug.Print "A(" &amp; i &amp; ") = " &amp; A(i)
Next i</code></pre>
</div>
</div>
<div class="paragraph">
<p>Array 関数を使用して作成した配列の下限は、Array がタイプ ライブラリの名前で修
飾 (VBA.Array など) されていない限り、Option Base ステートメントで指定した下限
によって決まります。 タイプ ライブラリの名前で修飾されている場合は、Array は
Option Base の影響を受けません。</p>
</div>
<div class="admonitionblock caution">
<table>
<tr>
<td class="icon">
<i class="fa icon-caution" title="Caution"></i>
</td>
<td class="content">
配列として宣言されていない Variant には、配列を含めることができます。 Variant
変数には、固定長の文字列とユーザー定義の型を除き、あらゆる型の配列を含めること
ができます。 配列が含まれている Variant は要素の型が Variant の配列とは概念的
に異なりますが、配列要素には同じ方法でアクセスされます。
</td>
</tr>
</table>
</div>
<div class="paragraph">
<div class="title">例</div>
<p>この例では、 Array 関数を使用して、配列を含む Variant を返します。</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-vbscript" data-lang="vbscript">Dim MyWeek, MyDay
MyWeek = Array("Mon", "Tue", "Wed", "Thu", "Fri", "Sat", "Sun")
' Return values assume lower bound set to 1 (using Option Base
' statement).
MyDay = MyWeek(2)    ' MyDay contains "Tue".
MyDay = MyWeek(4)    ' MyDay contains "Thu".</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_lbound_関数_visual_basic_for_applications_microsoft_docs">27.2. <a href="https://docs.microsoft.com/ja-jp/office/vba/language/reference/user-interface-help/lbound-function">LBound 関数 (Visual Basic for Applications) | Microsoft Docs</a></h3>
<div class="paragraph">
<p>配列の指定ディメンションに対して使用できる最小下付き文字が含まれる長整数型
(Long) の値を返します。</p>
</div>
<div class="listingblock">
<div class="title">構文</div>
<div class="content">
<pre class="highlight"><code class="language-vbscript" data-lang="vbscript">LBound(arrayname, [ dimension ])</code></pre>
</div>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 20%;">
<col style="width: 80%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">パーツ</th>
<th class="tableblock halign-left valign-top">説明</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">arrayname</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">必須です。 配列変数の名前を指定します。標準の変数の名前付け規則に
従います。</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">dimension</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">省略可能。Variant (Long)。 どの次元の下限が返されるかを示す整数。
最初の次元には1、2番目の次元では2というように使用します。 _次元_を省略すると、
1が想定されます。</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<div class="title">注釈</div>
<p>LBound関数を使用して、 配列のサイズを決定します。 UBound 関数は、配列のディメ
ンションの上限を確認する目的で使用します。</p>
</div>
<div class="paragraph">
<p>LBound は、次のディメンションの配列に対して、次の表に示す値を返します。</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 20%;">
<col style="width: 80%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Statement</th>
<th class="tableblock halign-left valign-top">戻り値</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">LBound(A, 1)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1-d</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">LBound(A, 2)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">.0</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">LBound(A, 3)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">-3</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>任意の次元の下限の既定値は、 Option Base ステートメントの設定に応じて0または1
のいずれかになります。 Array 関数を使用して作成された配列のベースが0です。
Option Baseによる影響はありません。</p>
</div>
<div class="paragraph">
<p>Dim、 Private、 Public、 ReDim、またはStaticステートメントでTo句を使用してディ
メンションが設定されている配列は、下限として任意の整数値を持つことができます。</p>
</div>
<div class="paragraph">
<div class="title">例</div>
<p>次の例では、LBound 関数を使用して、配列の指定ディメンションに対して使用できる
最小下付き文字を決定します。 また、Option Base ステートメントを使用して、既定
のベース配列の下付き文字の値 0 を上書きします。</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-vbscript" data-lang="vbscript">Dim Lower
Dim MyArray(1 To 10, 5 To 15, 10 To 20)     ' Declare array variables.
Dim AnyArray(10)
Lower = Lbound(MyArray, 1)     ' Returns 1.
Lower = Lbound(MyArray, 3)    ' Returns 10.
Lower = Lbound(AnyArray)    ' Returns 0 or 1, depending on
    ' setting of Option Base.</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_ubound_関数_visual_basic_for_applications_microsoft_docs">27.3. <a href="https://docs.microsoft.com/ja-jp/office/vba/language/reference/user-interface-help/ubound-function">UBound 関数 (Visual Basic for Applications) | Microsoft Docs</a></h3>
<div class="paragraph">
<p>配列の指定した次元で使用できる添字の最大値を含むLongデータ型を返します。</p>
</div>
<div class="listingblock">
<div class="title">構文</div>
<div class="content">
<pre class="highlight"><code class="language-vbscript" data-lang="vbscript">UBound(arrayname, [ dimension ])</code></pre>
</div>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 20%;">
<col style="width: 80%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">パーツ</th>
<th class="tableblock halign-left valign-top">説明</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">arrayname</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">必須です。 配列変数の名前を指定します。標準の変数の名前付け規則に
従います。</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">dimension</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">省略可能。Variant (Long)。 取得する次元の上限を示す整数。 最初の次
元には1、2番目の次元では2というように使用します。 _次元_を省略すると、1が想定
されます。</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<div class="title">注釈</div>
<p>UBound関数は、配列のサイズを決定するために<strong>LBound</strong> 関数と共に使用されます。
配列の次元の下限を調べる場合は LBound 関数を使用します。</p>
</div>
<div class="paragraph">
<p>配列の次元と UBound が返す値の関係を次に示します。</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 20%;">
<col style="width: 80%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Statement</th>
<th class="tableblock halign-left valign-top">戻り値</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">UBound(A, 1)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">100</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">UBound(A, 2)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1/3</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">UBound(A, 3)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">2/4</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<div class="title">例</div>
<p>次の例では、UBound 関数を使用して、配列の指定した次元で使用できる下付き文字の
最大値を調べます。</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-vbscript" data-lang="vbscript">Dim Upper
Dim MyArray(1 To 10, 5 To 15, 10 To 20)    ' Declare array variables.
Dim AnyArray(10)
Upper = UBound(MyArray, 1)    ' Returns 10.
Upper = UBound(MyArray, 3)    ' Returns 20.
Upper = UBound(AnyArray)      ' Returns 10.</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_split_関数_visual_basic_for_applications_microsoft_docs">27.4. <a href="https://docs.microsoft.com/ja-jp/office/vba/language/reference/user-interface-help/split-function">Split 関数 (Visual Basic for Applications) | Microsoft Docs</a></h3>
<div class="paragraph">
<p>指定された数のサブ文字列が含まれる 0 ベースの 1 次元配列を返します。</p>
</div>
<div class="listingblock">
<div class="title">構文</div>
<div class="content">
<pre class="highlight"><code class="language-vbscript" data-lang="vbscript">Split(expression, [ delimiter, [ limit, [ compare ]]])</code></pre>
</div>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 20%;">
<col style="width: 80%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">指定項目</th>
<th class="tableblock halign-left valign-top">説明</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">expression</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">必ず指定します。 サブ文字列と区切り記号が含まれる文字列式です。
expression が長さ 0 の文字列 ("") の場合、Split は、空の配列、つまり、要素とデ
ータのない配列を返します。</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">delimiter</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">オプション。 サブ文字列の制限を識別するために使用する文字列です。
省略すると、空白文字 (" ") が delimiter とみなされます。 _Delimiter_が長さ0の
文字列である場合は、_式_の文字列全体を含む単一要素の配列が返されます。</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">limit</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">省略可能です。 返されるサブ文字列の数。-1 は、すべてのサブ文字列が返さ
れることを示します。</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">compare</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">省略可能。 サブ文字列を評価するときに使用する比較の種類を示す数値で
す。 値については、「設定」セクションを参照してください。</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<div class="title">設定</div>
<p>compare 引数には、次の値を指定できます。</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 33.3333%;">
<col style="width: 33.3334%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">定数</th>
<th class="tableblock halign-left valign-top">値</th>
<th class="tableblock halign-left valign-top">説明</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">vbUseCompareOption</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">-1</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Option Compare ステートメントの設定を使用して比較を実行します。</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">vbBinaryCompare</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">.0</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">バイナリ比較を実行します。</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">vbTextCompare</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1-d</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">テキスト比較を実行します。</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">vbDatabaseCompare</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">pbm-2</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Microsoft Access のみ。 データベース内の情報に基づいて比較を実行します。</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<div class="title">例</div>
<p>この例では、 Split関数の使用方法を示します。</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-vbscript" data-lang="vbscript">Dim strFull As String
Dim arrSplitStrings1() As Variant
Dim arrSplitStrings2() As Variant
Dim strSingleString1 As String
Dim strSingleString2 As String
Dim strSingleString3 As String
Dim i As Long

strFull = "Some - Old - Hags - Can - Always - Hide - Their - Old - Age"    ' String that will be used.

arrSplitStrings1 = Split(strFull, "-")      ' arrSplitStrings1 will be an array from 0 To 8.
                                            ' arrSplitStrings1(0) = "Some " and arrSplitStrings1(1) = " Old ".
                                            ' The delimiter did not include spaces, so the spaces in strFull will be included in the returned array values.

arrSplitStrings2 = Split(strFull, " - ")    ' arrSplitStrings2 will be an array from 0 To 8.
                                            ' arrSplitStrings2(0) = "Some" and arrSplitStrings2(1) = "Old".
                                            ' The delimiter includes the spaces, so the spaces will not be included in the returned array values.

'Multiple examples of how to return the value "Can" (array position 3).

strSingleString1 = arrSplitStrings2(3)      ' strSingleString1 = "Can".

strSingleString2 = Split(strFull, " - ")(3) ' strSingleString2 = "Can".
                                            ' This syntax can be used if the entire array is not needed, and the position in the returned array for the desired value is known.

For i = LBound(arrSplitStrings2, 1) To UBound(arrSplitStrings2, 1)
    If InStr(1, arrSplitStrings2(i), "Can", vbTextCompare) &gt; 0 Then
        strSingleString3 = arrSplitStrings2(i)
        Exit For
    End If
Next i</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_join_関数_visual_basic_for_applications_microsoft_docs">27.5. <a href="https://docs.microsoft.com/ja-jp/office/vba/language/reference/user-interface-help/join-function">Join 関数 (Visual Basic for Applications) | Microsoft Docs</a></h3>
<div class="paragraph">
<p>配列に含まれている数多くのサブ文字列を結合して作成した文字列を返します。</p>
</div>
<div class="listingblock">
<div class="title">構文</div>
<div class="content">
<pre class="highlight"><code class="language-vbscript" data-lang="vbscript">Join(sourcearray, [ delimiter ])</code></pre>
</div>
</div>
<div class="paragraph">
<p>Join 関数の構文には、次の名前付き引数があります。</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 13. 構文</caption>
<colgroup>
<col style="width: 20%;">
<col style="width: 80%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">パーツ</th>
<th class="tableblock halign-left valign-top">説明</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">sourcearray</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">必須。 結合するサブ文字列を含む 1 次元配列。</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">delimiter</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">省略可能。 返される文字列内のサブ文字列の区切り文字。 省略した場合は、空白文字 (" ") が使用されます。 _Delimiter_が長さ0の文字列 ("") の場合、リスト内のすべてのアイテムは区切り文字なしで連結されます。</p></td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_配列の内容をセルにコピー">28. 配列の内容をセルにコピー</h2>
<div class="sectionbody">
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-vbscript" data-lang="vbscript">Dim a(0 To 3) As String
Dim i As Long

'abc
'bob
'alice
'nancy

For i = 0 To 3
a(i) = Cells(i + 1, 1)
Next

Range(Cells(1, 3), Cells(1, 3 + 3)) = a
' abc bob alice   nancy</code></pre>
</div>
</div>
<div class="sect2">
<h3 id="_1次元配列ソート">28.1. 1次元配列ソート</h3>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-vbscript" data-lang="vbscript">Call quick_sort(data, LBound(data), UBound(data))


Sub quick_sort(ByRef argAry() As Variant, _
    ByVal lngMin As Long, _
    ByVal lngMax As Long)
    Dim i As Long
    Dim j As Long
    Dim vBase As Variant
    Dim vSwap As Variant
    vBase = argAry(Int((lngMin + lngMax) / 2))
    i = lngMin
    j = lngMax
    Do
        Do While argAry(i) &lt; vBase
            i = i + 1
        Loop
        Do While argAry(j) &gt; vBase
            j = j - 1
        Loop
        If i &gt;= j Then Exit Do
            vSwap = argAry(i)
            argAry(i) = argAry(j)
            argAry(j) = vSwap
            i = i + 1
            j = j - 1
    Loop
    If (lngMin &lt; i - 1) Then
        Call quick_sort(argAry, lngMin, i - 1)
    End If
    If (lngMax &gt; j + 1) Then
        Call quick_sort(argAry, j + 1, lngMax)
    End If
End Sub</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_2次元配列ソート">28.2. 2次元配列ソート</h3>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-vbscript" data-lang="vbscript">'       最終引数はソート基準位置
' '引数の最後の,1がキー位置の指定
Call quick_sort(data, LBound(data), UBound(data), 1)

Sub quick_sort(ByRef argAry() As Variant, _
    ByVal lngMin As Long, _
    ByVal lngMax As Long, _
    ByVal keyPos As Long)
    Dim i As Long
    Dim j As Long
    Dim k As Long
    Dim vBase As Variant
    Dim vSwap As Variant
    vBase = argAry(Int((lngMin + lngMax) / 2), keyPos)
    i = lngMin
    j = lngMax
    Do
        Do While argAry(i, keyPos) &lt; vBase
            i = i + 1
        Loop
        Do While argAry(j, keyPos) &gt; vBase
            j = j - 1
        Loop
        If i &gt;= j Then Exit Do
        For k = LBound(argAry, 2) To UBound(argAry, 2)
            vSwap = argAry(i, k)
            argAry(i, k) = argAry(j, k)
            argAry(j, k) = vSwap
        Next
        i = i + 1
        j = j - 1
    Loop
    If (lngMin &lt; i - 1) Then
        Call quick_sort(argAry, lngMin, i - 1, keyPos)
    End If
    If (lngMax &gt; j + 1) Then
        Call quick_sort(argAry, j + 1, lngMax, keyPos)
    End If
End Sub</code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_罫線">29. 罫線</h2>
<div class="sectionbody">
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-vbscript" data-lang="vbscript">Range("A1").Select
Selection.CurrentRegion.Select
Selection.Borders.LineStyle = True</code></pre>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_borders_オブジェクト_excel_microsoft_docs">30. <a href="https://docs.microsoft.com/ja-jp/office/vba/api/excel.borders">Borders オブジェクト (Excel) | Microsoft Docs</a></h2>
<div class="sectionbody">
<div class="paragraph">
<p>Range オブジェクトまたは<strong>Style</strong> オブジェクトの4つの罫線を表す、4つの
<strong>Border</strong> オブジェクトのコレクションです。</p>
</div>
<div class="paragraph">
<div class="title">注釈</div>
<p>4 つの罫線すべてが属している Borders コレクションを取得するには、Borders プロ
  パティを使用します。</p>
</div>
<div class="paragraph">
<p>輪郭の辺ごとに扱えるのは、Range オブジェクトと Style オブジェクトだけです。 誤
差範囲や区分線など、輪郭がある他のオブジェクトは、辺の数にかかわらず、1 つのエ
ンティティとして扱われます。 このオブジェクトは、輪郭全体を 1 単位としてプロパ
ティを取得、設定する必要があります。 詳細については、Border オブジェクトを参照
してください。</p>
</div>
<div class="paragraph">
<div class="title">例</div>
<p>次の使用例は、ワークシート 1 のセル A1 の下側の罫線を二重線に設定します。</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-vbscript" data-lang="vbscript">Worksheets(1).Range("A1").Borders.LineStyle = xlDouble</code></pre>
</div>
</div>
<div class="paragraph">
<p>罫線*<strong>*</strong> (インデックス) を使用して、1つのborderオブジェクトを取得するには、_引
数 index_に罫線を指定します。 次の使用例は、セル範囲 A1: G1 ~ 赤の下罫線の色を
設定します。</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-vbscript" data-lang="vbscript">Worksheets("Sheet1").Range("A1:G1"). _
 Borders(xlEdgeBottom).Color = RGB(255, 0, 0)</code></pre>
</div>
</div>
<div class="paragraph">
<p>_Index_には、次の<strong>xlbordersindex</strong> 定数のいずれかを指定できます:
xlDiagonalDown、使用できる、 xxlEdgeLeft gebottom、 <strong>*</strong>*、 x ger視覚、
xledgebottom、 xledgebottom、またはxlinsidevertical。</p>
</div>
<div class="ulist">
<div class="title">Properties</div>
<ul>
<li>
<p>Application</p>
</li>
<li>
<p>Color</p>
</li>
<li>
<p>ColorIndex</p>
</li>
<li>
<p>Count</p>
</li>
<li>
<p>Creator</p>
</li>
<li>
<p>Item</p>
</li>
<li>
<p>LineStyle</p>
</li>
<li>
<p>Parent</p>
</li>
<li>
<p>ThemeColor</p>
</li>
<li>
<p>TintAndShade</p>
</li>
<li>
<p>Value</p>
</li>
<li>
<p>Weight</p>
</li>
</ul>
</div>
<div class="sect2">
<h3 id="_borders_プロパティ_excel_microsoft_docs">30.1. <a href="https://docs.microsoft.com/ja-jp/office/vba/api/excel.borders.linestyle">Borders プロパティ (Excel) | Microsoft Docs</a></h3>
<div class="paragraph">
<p>罫線または輪郭線の種類を設定します。 XlLineStyle、 xlGray25、 xlGray50、
xlGray75、または 、xlautomaticを読み取り/書き込み。</p>
</div>
<div class="listingblock">
<div class="title">構文</div>
<div class="content">
<pre class="highlight"><code class="language-vbscript" data-lang="vbscript">expression.LineStyle</code></pre>
</div>
</div>
<div class="paragraph">
<p>式Borders オブジェクトを表す変数を取得します。</p>
</div>
<div class="paragraph">
<div class="title">例</div>
<p>次の使用例は、グラフ 1 のグラフ エリアおよびプロット エリアに輪郭線を設定しま
す。</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-vbscript" data-lang="vbscript">With Charts("Chart1")
 .ChartArea.Border.LineStyle = xlDashDot
 With .PlotArea.Border
 .LineStyle = xlDashDotDot
 .Weight = xlThick
 End With
End With</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_xllinestyle_列挙_excel_microsoft_docs">30.2. <a href="https://docs.microsoft.com/ja-jp/office/vba/api/excel.xllinestyle">XlLineStyle 列挙 (Excel) | Microsoft Docs</a></h3>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 66.6666%;">
<col style="width: 16.6666%;">
<col style="width: 16.6668%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">名前</th>
<th class="tableblock halign-left valign-top">値</th>
<th class="tableblock halign-left valign-top">説明</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">xlcontinuous</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">実線</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">xlDash</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">-4115</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">破線</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">xlDashDot</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">4</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">一点鎖線</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">xlDashDotDot</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">5</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">ニ点鎖線</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">xldot</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">-4118</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">点線</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">xlDouble</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">-4119</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">2 本線</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">xlLineStyleNone</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">-4142</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">線なし</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">xlslantdashdot は、</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">13</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">斜破線</p></td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_ディレクティブ_microsoft_docs">31. <a href="https://docs.microsoft.com/ja-jp/office/vba/language/reference/directives">ディレクティブ | Microsoft Docs</a></h2>
<div class="sectionbody">

</div>
</div>
<div class="sect1">
<h2 id="_イベント_visual_basic_for_applications_microsoft_docs">32. <a href="https://docs.microsoft.com/ja-jp/office/vba/language/reference/events-visual-basic-for-applications">イベント (Visual Basic for Applications) | Microsoft Docs</a></h2>
<div class="sectionbody">

</div>
</div>
<div class="sect1">
<h2 id="_関数_visual_basic_for_applications_microsoft_docs">33. <a href="https://docs.microsoft.com/ja-jp/office/vba/language/reference/functions-visual-basic-for-applications">関数 (Visual Basic for Applications) | Microsoft Docs</a></h2>
<div class="sectionbody">
<div class="ulist">
<div class="title">変換関数</div>
<ul>
<li>
<p><a href="#Asc">Asc</a></p>
</li>
<li>
<p><a href="#Chr">Chr</a></p>
</li>
<li>
<p><a href="#CVErr">CVErr</a></p>
</li>
<li>
<p><a href="#Format">Format</a></p>
</li>
<li>
<p><a href="#Hex">Hex</a></p>
</li>
<li>
<p><a href="#Oct">Oct</a></p>
</li>
<li>
<p><a href="#Str">Str</a></p>
</li>
<li>
<p><a href="#Val">Val</a></p>
</li>
</ul>
</div>
<div class="ulist">
<div class="title">数学関数</div>
<ul>
<li>
<p><a href="#Abs">Abs</a></p>
</li>
<li>
<p><a href="#Atn">Atn</a></p>
</li>
<li>
<p><a href="#Cos">Cos</a></p>
</li>
<li>
<p>Derived Math</p>
</li>
<li>
<p><a href="#Exp">Exp</a></p>
</li>
<li>
<p><a href="#IntFix">Int Fix</a></p>
</li>
<li>
<p><a href="#Log">Log</a></p>
</li>
<li>
<p><a href="#Rnd">Rnd</a></p>
</li>
<li>
<p><a href="#Sgn">Sgn</a></p>
</li>
<li>
<p><a href="#Sin">Sin</a></p>
</li>
<li>
<p><a href="#Sqr">Sqr</a></p>
</li>
<li>
<p><a href="#Tan">Tan</a></p>
</li>
</ul>
</div>
<div class="ulist">
<div class="title">データ型変換関数</div>
<ul>
<li>
<p>データ型変換関数</p>
</li>
</ul>
</div>
<div class="ulist">
<div class="title">その他の関数</div>
<ul>
<li>
<p>Array</p>
</li>
<li>
<p>CallByName</p>
</li>
<li>
<p>Choose</p>
</li>
<li>
<p>コマンド</p>
</li>
<li>
<p>CreateObject</p>
</li>
<li>
<p>CurDir</p>
</li>
<li>
<p>Date</p>
</li>
<li>
<p>DateAdd</p>
</li>
<li>
<p>DateDiff</p>
</li>
<li>
<p>DatePart</p>
</li>
<li>
<p>DateSerial</p>
</li>
<li>
<p>DateValue</p>
</li>
<li>
<p>Day</p>
</li>
<li>
<p>DDB</p>
</li>
<li>
<p>Dir</p>
</li>
<li>
<p>DoEvents</p>
</li>
<li>
<p>Environ</p>
</li>
<li>
<p>EOF</p>
</li>
<li>
<p>Error</p>
</li>
<li>
<p>FileAttr</p>
</li>
<li>
<p>FileDateTime</p>
</li>
<li>
<p>FileLen</p>
</li>
<li>
<p>Filter</p>
</li>
<li>
<p>FormatCurrency</p>
</li>
<li>
<p>FormatDateTime</p>
</li>
<li>
<p>FormatNumber</p>
</li>
<li>
<p>FormatPercent</p>
</li>
<li>
<p>FreeFile</p>
</li>
<li>
<p>FV</p>
</li>
<li>
<p>GetAllSettings</p>
</li>
<li>
<p>GetAttr</p>
</li>
<li>
<p>GetObject</p>
</li>
<li>
<p>GetSetting</p>
</li>
<li>
<p>Hour</p>
</li>
<li>
<p>IIf</p>
</li>
<li>
<p>IMEStatus</p>
</li>
<li>
<p>Input</p>
</li>
<li>
<p>InputBox</p>
</li>
<li>
<p>InStr</p>
</li>
<li>
<p>InStrRev</p>
</li>
<li>
<p>IPmt</p>
</li>
<li>
<p>IRR</p>
</li>
<li>
<p>IsArray</p>
</li>
<li>
<p>IsDate</p>
</li>
<li>
<p>IsEmpty</p>
</li>
<li>
<p>IsError</p>
</li>
<li>
<p>IsMissing</p>
</li>
<li>
<p>IsNull</p>
</li>
<li>
<p>IsNumeric</p>
</li>
<li>
<p>IsObject</p>
</li>
<li>
<p>Join</p>
</li>
<li>
<p>LBound</p>
</li>
<li>
<p>LCase</p>
</li>
<li>
<p>Left</p>
</li>
<li>
<p>Len</p>
</li>
<li>
<p>Loc</p>
</li>
<li>
<p>LOF</p>
</li>
<li>
<p>LTrim、RTrim、および Trim</p>
</li>
<li>
<p>MacID</p>
</li>
<li>
<p>MacScript</p>
</li>
<li>
<p>Mid</p>
</li>
<li>
<p>Minute</p>
</li>
<li>
<p>MIRR</p>
</li>
<li>
<p>Month</p>
</li>
<li>
<p>MonthName</p>
</li>
<li>
<p>MsgBox</p>
</li>
<li>
<p>Now</p>
</li>
<li>
<p>NPer</p>
</li>
<li>
<p>NPV</p>
</li>
<li>
<p>Partition</p>
</li>
<li>
<p>Pmt</p>
</li>
<li>
<p>PPmt</p>
</li>
<li>
<p>PV</p>
</li>
<li>
<p>QBColor</p>
</li>
<li>
<p>Rate</p>
</li>
<li>
<p>Replace</p>
</li>
<li>
<p>RGB</p>
</li>
<li>
<p>Right</p>
</li>
<li>
<p>Round</p>
</li>
<li>
<p>Second</p>
</li>
<li>
<p>Seek</p>
</li>
<li>
<p>Shell</p>
</li>
<li>
<p>SLN</p>
</li>
<li>
<p>Space</p>
</li>
<li>
<p>Spc</p>
</li>
<li>
<p>Split</p>
</li>
<li>
<p>StrComp</p>
</li>
<li>
<p>StrConv</p>
</li>
<li>
<p>String</p>
</li>
<li>
<p>StrReverse</p>
</li>
<li>
<p>Switch</p>
</li>
<li>
<p>SYD</p>
</li>
<li>
<p>Tab</p>
</li>
<li>
<p>Time</p>
</li>
<li>
<p>Timer</p>
</li>
<li>
<p>TimeSerial</p>
</li>
<li>
<p>TimeValue</p>
</li>
<li>
<p>TypeName</p>
</li>
<li>
<p>UBound</p>
</li>
<li>
<p>UCase</p>
</li>
<li>
<p>VarType</p>
</li>
<li>
<p>Weekday</p>
</li>
<li>
<p>WeekdayName</p>
</li>
<li>
<p>Year</p>
</li>
</ul>
</div>
<div class="sect2">
<h3 id="_変換関数">33.1. 変換関数</h3>
<div class="sect3">
<h4 id="Asc">33.1.1. Asc 関数</h4>
<div class="paragraph">
<p>文字列の最初の文字に対応した文字コードを示す整数を返します。</p>
</div>
<div class="listingblock">
<div class="title">構文</div>
<div class="content">
<pre class="highlight"><code class="language-vbscript" data-lang="vbscript">Asc(string)</code></pre>
</div>
</div>
<div class="paragraph">
<p>必須の string 引数は、任意の有効な文字列式です。 string に文字が含まれていない
場合、実行時エラーが発生します。</p>
</div>
<div class="paragraph">
<div class="title">解説</div>
<p>戻り値の範囲は、非 DBCS システムでは 0–255 ですが、DBCS システムでは -32768–
32767 です。</p>
</div>
<div class="admonitionblock caution">
<table>
<tr>
<td class="icon">
<i class="fa icon-caution" title="Caution"></i>
</td>
<td class="content">
AscB 関数は、文字列に含まれるバイト データの場合に使用します。 先頭の
文字の文字コードを返す代わりに、AscB は最初のバイトを返します。 AscW 関数は、
Unicode 文字コードを返します。ただし、Unicode がサポートされていないプラットフ
ォームでは、Asc 関数と同じ動作になります。
</td>
</tr>
</table>
</div>
<div class="admonitionblock caution">
<table>
<tr>
<td class="icon">
<i class="fa icon-caution" title="Caution"></i>
</td>
<td class="content">
Visual Basic for the Macintosh では、Unicode 文字列をサポートしていま
せん。 このため、Windows 環境とは異なり、AscW (n) は 128 – 65,535 の範囲の n
の値に対するすべての Unicode 文字を返すことができません。 代わりに、AscW (n)
は、127 より大きい Unicode 値 n について "最適なものを推測" します。 したがっ
て、Macintosh 環境では、AscW を使用してはいけません。。
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>関数<strong>Chr ()、ChrB ()、および ChrW ()</strong> は、 Asc ()、ascb ()、ascb () の逆です。 Chr () 関数は、整数を文字列に変換します。</p>
</div>
<div class="paragraph">
<div class="title">例</div>
<p>この例では、Asc 関数を使って、文字列の先頭の文字に対応する文字コードを返します。</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-vbscript" data-lang="vbscript">Dim MyNumber
MyNumber = Asc("A")    ' Returns 65.
MyNumber = Asc("a")    ' Returns 97.
MyNumber = Asc("Apple")    ' Returns 65.</code></pre>
</div>
</div>
<div class="literalblock">
<div class="title">関連項目</div>
<div class="content">
<pre>関数 (Visual Basic for Applications)
Chr ()、ChrB ()、および ChrW () 関数</pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="Chr">33.1.2. Chr 関数</h4>
<div class="paragraph">
<p>指定した文字コードと関連付けられている文字を含む String を返します。</p>
</div>
<div class="listingblock">
<div class="title">構文</div>
<div class="content">
<pre class="highlight"><code class="language-vbscript" data-lang="vbscript">Chr(charcode)
ChrB(charcode)
ChrW(charcode)</code></pre>
</div>
</div>
<div class="paragraph">
<p>必須の charcode 引数は、文字を識別する Long です。</p>
</div>
<div class="paragraph">
<div class="title">解説</div>
<p>0 から 31 の数値は、標準の印刷できない ASCII コードと同じです。 たとえば、
  Chr(10) は改行文字を返します。 charcode の通常の範囲は 0 から 255 です。 た
だし、DBCS システムでは、charcode の実際の範囲は -32768 から 65535 です。</p>
</div>
<div class="admonitionblock caution">
<table>
<tr>
<td class="icon">
<i class="fa icon-caution" title="Caution"></i>
</td>
<td class="content">
ChrB関数は、String に含まれるバイト データの場合に使用します。 ChrBは、
1 バイトまたは 2 バイトの文字ではなく、常に 1 バイトを返します。
</td>
</tr>
</table>
</div>
<div class="admonitionblock caution">
<table>
<tr>
<td class="icon">
<i class="fa icon-caution" title="Caution"></i>
</td>
<td class="content">
ChrW 関数は、Unicode 文字を含む String を返します。ただし、Unicode が
サポートされていないプラットフォームでは、Chr 関数と同じ動作になります。
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>注意
CAUTION: Visual Basic for the Macintosh では、Unicode 文字列をサポートしていま
せん。 このため、Windows 環境とは異なり、ChrW(n) は 128 から 65,535 の範囲の n
の値に対するすべての Unicode 文字を返すことができません。 代わりに、ChrW(n) は、
127 より大きい Unicode 値 n について "最適なものを推測" します。 したがって、
Macintosh 環境では、ChrW を使用する必要はありません。</p>
</div>
<div class="paragraph">
<p>関数 Asc()、AscB()、および AscW() は Chr()、ChrB()、および ChrW() の反対です。
Asc() 関数は、文字列を整数に変換します。</p>
</div>
<div class="paragraph">
<div class="title">例</div>
<p>次の例では、Chr 関数を使用して、指定した文字コードと関連付けられている文字を返
します。</p>
</div>
<div class="paragraph">
<p>VB</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-vbscript" data-lang="vbscript">Dim MyChar
MyChar = Chr(65)    ' Returns A.
MyChar = Chr(97)    ' Returns a.
MyChar = Chr(62)    ' Returns &gt;.
MyChar = Chr(37)    ' Returns %.</code></pre>
</div>
</div>
<div class="literalblock">
<div class="title">関連項目</div>
<div class="content">
<pre>文字セット (0 - 127)
文字セット (128 - 255)
関数 (Visual Basic for Applications)
Asc()、AscB()、および AscW() 関数</pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="CVErr">33.1.3. CVErr 関数</h4>
<div class="paragraph">
<p>ユーザーによって指定されたエラー番号を含むサブタイプ Error の Variant を返しま
す。</p>
</div>
<div class="listingblock">
<div class="title">構文</div>
<div class="content">
<pre class="highlight"><code class="language-vbscript" data-lang="vbscript">CVErr(errornumber)</code></pre>
</div>
</div>
<div class="paragraph">
<p>必須の errornumber 引数は、任意の有効なエラー番号です。</p>
</div>
<div class="paragraph">
<div class="title">解説</div>
<p>CVErr 関数は、ユーザーが作成するプロシージャでユーザー定義のエラーを作成するた
めに使用されます。 たとえば、複数の引数を受け取って普通に文字列を返す関数を作
成する場合は、関数で入力引数を評価し、受け付けられる範囲内の値であることを確認
できます。 そうでない場合、関数は期待する結果を返しません。 このような場合、
CVErr を使用することで、実行する処理の内容を通知するエラー番号を返すことができ
ます。</p>
</div>
<div class="paragraph">
<p>Error の暗黙的な変換はできないことに注意してください。 たとえば、CVErr の戻り
値を、Variant ではない変数に直接割り当てることはできません。 ただし、CVErr に
よって返される値の明示的な変換を実行し (CInt、CDbl などを使用)、それを適切なデ
ータ型の変数に割り当てることはできます。</p>
</div>
<div class="paragraph">
<div class="title">例</div>
<p>次の例では、CVErr 関数を使用して、VarType が vbError (10) である Variant を返
します。 ユーザー定義関数 CalculateDouble は、渡された引数が数値でない場合にエ
ラーを返します。 CVErr を使用して、ユーザー定義プロシージャからユーザー定義エ
ラーを返すことも、実行時エラーの処理を遅らせることもできます。 値がエラーを表
しているかどうかを調べるには、IsError 関数を使用します。</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-vbscript" data-lang="vbscript">' Call CalculateDouble with an error-producing argument.
Sub Test()
    Debug.Print CalculateDouble("345.45robert")
End Sub
' Define CalculateDouble Function procedure.
Function CalculateDouble(Number)
    If IsNumeric(Number) Then
        CalculateDouble = Number * 2    ' Return result.
    Else
        CalculateDouble = CVErr(2001)    ' Return a user-defined error
    End If    ' number.
End Function</code></pre>
</div>
</div>
<div class="literalblock">
<div class="title">関連項目</div>
<div class="content">
<pre>関数 (Visual Basic for Applications)</pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="Format">33.1.4. Format 関数</h4>
<div class="paragraph">
<p>書式指定式の指示に従って書式設定される式を含む Variant (String) を戻します。</p>
</div>
<div class="paragraph">
<div class="title">注意</div>
<p>複数のプラットフォーム間で Office エクスペリエンスを拡張するソリューションを開
発することに関心がありますか? 新しい Office アドイン モデルを参照してください。
Office アドインは、VSTO アドインやソリューションに比べてフットプリントが小さく、
HTML5、JavaScript、CSS3、XML などのほぼすべてのWeb プログラミング テクノロジー
を使用して構築できます。</p>
</div>
<div class="listingblock">
<div class="title">構文</div>
<div class="content">
<pre class="highlight"><code class="language-vbscript" data-lang="vbscript">Format(Expression, [Format], [FirstDayOfWeek], [FirstWeekOfYear])</code></pre>
</div>
</div>
<div class="paragraph">
<p>Format 関数の構文には、次の指定項目があります。</p>
</div>
<div class="paragraph">
<div class="title">構文</div>
<p>指定項目 	説明
Expression 	必須。 必ず指定します。任意の有効な式。
Format 	省略可能。 有効な名前を持つ、またはユーザー定義の書式指定式。
FirstDayOfWeek 	省略可能。 週の最初の曜日を指定する定数です。
FirstWeekOfYear 	省略可能。 年内で、最初の週を指定する定数です。</p>
</div>
<div class="paragraph">
<div class="title">設定</div>
<p>firstdayofweek 引数の設定は次のとおりです。</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 14. 設定</caption>
<colgroup>
<col style="width: 44.4444%;">
<col style="width: 11.1111%;">
<col style="width: 44.4445%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">定数</th>
<th class="tableblock halign-left valign-top">値</th>
<th class="tableblock halign-left valign-top">説明</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">vbUseSystem</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">NLS API 設定を使用します。</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">vbSunday</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">日曜日 (既定)</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">vbMonday</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">2</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">月曜日</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">vbTuesday</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">3</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">火曜日</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">vbWednesday</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">4</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">水曜日</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">vbThursday</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">5</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">木曜日</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">vbFriday</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">6</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">金曜日</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">vbSaturday</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">7</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">土曜日</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>firstweekofyear 引数の設定は次のとおりです。</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 44.4444%;">
<col style="width: 11.1111%;">
<col style="width: 44.4445%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">定数</th>
<th class="tableblock halign-left valign-top">値</th>
<th class="tableblock halign-left valign-top">説明</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">vbUseSystem</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">NLS API 設定を使用します。</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">vbFirstJan1</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1 月 1 日が含まれる週から開始します (既定)。</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">vbFirstFourDays</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">2</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">4 日以上が含まれる最初の週が年の第 1 週目になります。</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">vbFirstFullWeek</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">3</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1 週間全体が含まれる最初の週がその年の第 1 週目になります。</p></td>
</tr>
</tbody>
</table>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 66.6667%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">書式設定の対象</th>
<th class="tableblock halign-left valign-top">説明</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">数値</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">定義済みの名前付き数値書式を使用するか、ユーザー定義の数値書式を作成します。</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">日付と時刻</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">定義済みの名前付き日付/時刻書式を使用するか、ユーザー定義の日付/時刻書式を作成します。</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">日付と時刻の連続番号</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">日付および時間書式または数値書式を使用します。</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">文字列</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">自分のユーザー定義文字列書式を作成します。</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>Format は、format を 257 文字に切り捨てます。</p>
</div>
<div class="paragraph">
<p>format を指定せずに数値を書式設定する場合、Format は Str 関数と同様の、ただし
国際対応がされた機能を提供します。 しかし、Format を使用して文字列として書式設
定された正の数値には、値の記号用に予約済みの先頭のスペースは含まれません。Str
を使用して変換された数値では、先頭のスペースは保持されます。</p>
</div>
<div class="paragraph">
<p>ローカライズされていない数値文字列を書式設定する場合、目的の書式を実現するには、
ユーザー定義数値書式を使用する必要があります。</p>
</div>
<div class="admonitionblock caution">
<table>
<tr>
<td class="icon">
<i class="fa icon-caution" title="Caution"></i>
</td>
<td class="content">
Calendar プロパティの設定が Gregorian で、format が日付書式を指定する
場合、指定する expression は Gregorian である必要があります。 Visual Basic
Calendar プロパティ設定が Hijri である場合、指定する expression は Hijri であ
る必要があります。
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>カレンダーがグレゴリオ暦である場合、format 式記号の意味は変わりません。 カレン
ダーがイスラム暦の場合、すべての日付書式記号 (たとえば、dddd、mmmm、yyyy) は同
じ意味を持ちますが、イスラム暦に適用されます。 書式記号は英語のままです。テキ
スト表示 (たとえば、AM や PM) になる記号では、その記号に対応する文字列 (英語ま
たはアラビア語) が表示されます。 カレンダーがイスラム暦の場合、特定の記号の範
囲は変わります。</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 20%;">
<col style="width: 80%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">記号</th>
<th class="tableblock halign-left valign-top">範囲</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">d</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1 〜 31 (前に 0 を付けない、月の日付)</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">dd</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">01 〜 31 (前に 0 を付ける、月の日付)</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">w</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1 〜 7 (週の曜日。土曜日 = 1 から開始)</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">ww</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1 〜 53 (1 年のうちで何週目かを表す数値。前に 0 を付けず、1 月 1 日から開始。)</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">m</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1 〜 12 (月。前に 0 を付けず、1 月 = 1 から開始。)</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">mm</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">01 〜 12 (月。前に 0 を付け、1 月 = 01 から開始。)</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">mmm</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">月の省略名を表示 (イスラム暦の月の名前には省略形はありません)</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">mmmm</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">完全な月名を表示</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">y</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1 〜 366 (1 年のうちで何日目かを表す数値)</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">yy</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">00 〜 99 (西暦年の下 2 桁)</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">yyyy</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">100 〜 9999 (3 桁または 4 桁の西暦年)</p></td>
</tr>
</tbody>
</table>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 44.4444%;">
<col style="width: 11.1111%;">
<col style="width: 44.4445%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">記号</th>
<th class="tableblock halign-left valign-top">範囲</th>
<th class="tableblock halign-left valign-top">h</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">0 〜 23 (「AM」または「PM」を追加した 1 〜 12 の数値) (前に 0 を付けない、1 日の中の時間)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">hh</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">00 〜 23 (「AM」または「PM」を追加した 01 〜 12 の数値) (前に 0 を付ける、1 日の中の時間)</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">n</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0 〜 59 (前に 0 を付けない、1 時間の中の分)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">nn</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">00 〜 59 (前に 0 を付ける、1 時間の中の分)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">m</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0 〜 59 (前に 0 を付けない、1 時間の中の分) h または hh が先行する場合のみ</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">mm</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">00 〜 59 (前に 0 を付ける、1 時間の中の分) h または hh が先行する場合のみ</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">s</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">0 〜 59 (前に 0 を付けない、1分の中の秒)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">ss</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">00 〜 59 (前に 0 を付ける、1分の中の秒)</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<div class="title">使用例</div>
<p>この例では、名前付き書式とユーザー定義書式の両方を使用して値の書式設定を行う、
Format 関数のさまざまな使用例を示します。 日付の区切り記号 ( / )、時間の区切り
記号 (<strong> :</strong> )、リテラルの AM/PM、およびシステムで表示される実際の書式設定され
る出力は、コードが実行中のロケール設定に基づきます。 時間と日付が開発環境で表
示されるとき、コード ロケールでの短い時間形式と短い日付形式が使用されます。 コ
ードの実行により表示される場合は、システム ロケールの短い時間形式と短い日付形
式が使用されます。これはコード ロケールとは異なることがあります。 この例では、
English/U.S. を使用します。 MyTime と MyDate が、現在のシステムでの短い時間設
定と短い日付設定を使用して、開発環境で表示されます。</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-vbscript" data-lang="vbscript">Dim MyTime, MyDate, MyStr
MyTime = #17:04:23#
MyDate = #January 27, 1993#

' Returns current system time in the system-defined long time format.
MyStr = Format(Time, "Long Time")

' Returns current system date in the system-defined long date format.
MyStr = Format(Date, "Long Date")

MyStr = Format(MyTime, "h:m:s")    ' Returns "17:4:23".
MyStr = Format(MyTime, "hh:mm:ss am/pm")    ' Returns "05:04:23 pm".
MyStr = Format(MyTime, "hh:mm:ss AM/PM")    ' Returns "05:04:23 PM".
MyStr = Format(MyDate, "dddd, mmm d yyyy")    ' Returns "Wednesday, Jan 27 1993".
' If format is not supplied, a string is returned.
MyStr = Format(23)    ' Returns "23".

' User-defined formats.
MyStr = Format(5459.4, "##,##0.00")    ' Returns "5,459.40".
MyStr = Format(334.9, "###0.00")    ' Returns "334.90".
MyStr = Format(5, "0.00%")    ' Returns "500.00%".
MyStr = Format("HELLO", "&lt;")    ' Returns "hello".
MyStr = Format("This is it", "&gt;")    ' Returns "THIS IS IT".</code></pre>
</div>
</div>
<div class="paragraph">
<p>さまざまな数値のさまざまな書式</p>
</div>
<div class="paragraph">
<p>ユーザー定義の数値書式指定 式は、セミコロンで区切られた 1 から 4 のセクションを持つことができます。 書式引数に名前付き数値書式が含まれる場合は、1 つのセクションのみが許可されます。
さまざまな数値のさまざまな書式
使用するセクション数 	結果</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>セクションのみ 	書式指定式はすべての値に適用されます。
2 セクション 	最初のセクションは正の値と 0 に適用され、第 2 のセクションは負の値に適用されます。
3 セクション 	最初のセクションは正の値、第 2 のセクションは負の値、第 3 のセクションは 0 に適用されます。
4 セクション 	最初のセクションは正の値、第 2 のセクションは負の値、第 3 のセクションは 0、第 4 のセクションは Null 値に適用されます。
VB</p>
</li>
</ol>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-vbscript" data-lang="vbscript">"$#,##0;($#,##0)"</code></pre>
</div>
</div>
<div class="paragraph">
<p>間に何も入れずに複数のセミコロンを含めた場合、欠けているセクションは、正の値の
書式を使用して出力されます。 たとえば、以下の書式は、最初のセクションで書式を
使用して正と負の値を表示し、値が 0 の場合は、"Zero" を表示します。</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-vbscript" data-lang="vbscript">"$#,##0;;\Z\e\r\o"</code></pre>
</div>
</div>
<div class="paragraph">
<p>さまざまな文字列値のさまざまな書式</p>
</div>
<div class="paragraph">
<p>文字列の書式指定式は、セミコロン (;) で区切られた 1 つまたは 2 つのセクションを持つことができます。
さまざまな文字列値のさまざまな書式
使用するセクション数 	結果
1 セクションのみ 	書式はすべての文字列データに適用されます。
2 セクション 	最初のセクションは文字列データに適用され、第 2 のセクションは Null 値と長さ 0 の文字列 ("") に適用されます。
名前付き日付/時刻書式</p>
</div>
<div class="paragraph">
<p>以下の表は、定義済みの日付および時間の書式名を示します。</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 15. 名前付き日付/時刻書式</caption>
<colgroup>
<col style="width: 20%;">
<col style="width: 80%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">書式名</th>
<th class="tableblock halign-left valign-top">説明</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">General Date</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">日付と時刻のどちらか、または両方を表示します (例: 4/3/93 05:34 PM)。 小数の部分がない場合、日付だけを表示します (例: 4/3/93)。 整数の部分がない場合、時間のみを表示します(例: 05:34 PM)。 日付表示はシステム設定に依存します。</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Long Date</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">システムの長い日付形式の書式に従って日付を表示します。</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Medium Date</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">ホスト アプリケーションの言語バージョンで適切な、中間の長さの日付書式を使用して日付を表示します。</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Short Date</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">システムの短い日付書式を使用して日付を表示します。</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Long Time</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">システムの長い時間形式を使用して時間を表示します。時間、分、秒が含まれます。</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Medium Time</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">時間と分を、12 時間の書式と AM/PM を使用して表示します。</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Short Time</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">24 時間の形式を使用して時間を表示します (例: 17: 45)。</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<div class="title">名前付き数値書式</div>
<p>以下の表は、定義済みの数値の書式名を示します。</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 44.4444%;">
<col style="width: 11.1111%;">
<col style="width: 44.4445%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">書式名</th>
<th class="tableblock halign-left valign-top">説明</th>
<th class="tableblock halign-left valign-top">General Number</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">桁区切り記号を付けずに数を表示します。</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Currency</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">適切な場合は、桁区切り記号を付けて数を表示します。小数点記号の右 2 桁を表示します。 出力はシステム ロケール設定に基づきます。</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Fixed</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">少なくとも整数部 1 桁、小数部 2 桁を表示します。</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Standard</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">区切り記号を付けて、少なくとも整数部 1 桁、小数部 2 桁を表示します。</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Percent</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">数値を 100 倍して、右側にパーセント記号 (%) を付けて表示します。小数部は常に 2 桁です。</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Scientific</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">標準の指数表記を使用します。</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Yes/No</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">数値が 0 の場合は No を表示します。それ以外の場合は Yes を表示します。</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">True/False</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">数値が 0 の場合は False を表示します。それ以外の場合は True を表示します。</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>ユーザー定義文字列書式</p>
</div>
<div class="paragraph">
<p>以下の文字を使用して、文字列の書式指定式を作成できます。</p>
</div>
<div class="paragraph">
<div class="title">ユーザー定義文字列書式</div>
<p>文字 	説明
@ 	文字プレースホルダー。 文字またはスペースを表示します。 書式文字列でアット マーク (@ ) の表示位置に文字がある文字列の場合は、その文字が表示されます。それ以外の場合は、その位置にスペースが表示されます。 書式文字列に感嘆符 (<strong> !</strong> ) がある場合を除き、プレースホルダーは右側から左側に向かって埋められます。
&amp; 	文字プレースホルダー。 文字が表示されるか、または何も表示されません。 アンパサンド (&amp;) の表示位置に文字がある文字列の場合は、その文字が表示されます。それ以外の場合は、何も表示されません。 書式文字列に感嘆符 (<strong> !</strong> ) がある場合を除き、プレースホルダーは右側から左側に向かって埋められます。
&lt; 	強制的に小文字にします。 すべての文字を小文字で表示します。
&gt; 	強制的に大文字にします。 すべての文字を大文字で表示します。
! 	プレースホルダーを左から右に向かって埋めるように強制的に設定します。 既定では、プレースホルダーは右から左に向かって埋めように設定されています。
ユーザー定義日付/時刻書式</p>
</div>
<div class="paragraph">
<p>以下の表は、ユーザー定義日付/時刻書式の作成に使用できる文字を示します。
ユーザー定義日付/時刻書式
文字 	説明
(:) 	時刻の区切り記号。 一部のロケールでは、時刻区切り文字を表す目的で他の文字が使用されることがあります。 時刻の値が書式設定されるときに、時刻区切り文字によって時、分、および秒が区切られます。 書式設定された出力で時刻区切り文字として使用される実際の文字は、システム設定によって決まります。
(/) 	日付の区切り記号。 一部のロケールでは、日付区切り文字を表す目的で他の文字が使用されることがあります。 日付値の書式が設定されている場合、日付、月、および年は、日付の区切り記号によって区切られます。 書式設定された出力で、日付の区切り文字として実際に使用される文字は、システム設定によって決まります。
c 	日付を ddddd、時刻を ttttt 形式で、日付、時刻の順序で表示します。 日付の連続数値に小数部がない場合は、日付情報だけを表示します。時刻に整数部がない場合は、時刻情報のみを表示します。
d 	日を先頭に 0 のない数値 (1 〜 31) で表示します。
dd 	日を先頭に 0 のある数値 (01 〜 31) で表示します。
ddd 	日を曜日の省略形 (日〜 土) で表示します。 ローカライズされています。
dddd 	日を曜日の完全な名前 (日曜日〜 土曜日) で表示します。 ローカライズされています。
ddddd 	日付を完全な日付 (日、月、および年を含む) で表示します。表示形式は各システムの短い日付形式の設定に従っています。 既定の短縮日付フォーマットは、m/d/yy です。
dddddd 	日付の連続数値を完全な日付 (日、月、および年を含む) で表示します。表示形式は各システムが認識する長い日付形式の設定に従っています。 既定の長い日付形式は、mmmm dd, yyyy です。
w 	曜日を数値 (日曜日が 1 で土曜日が 7) で表示します。
ww 	1 年のうちの何週目であるかを数値 (1 〜 54) で表示します。
m 	月を先頭に 0 のない数値 (1 〜 12) で表示します。 h または hh の直後に m が続く場合は、月ではなく分が表示されます。
mm 	月を先頭に 0 のある数値 (01 〜 12) で表示します。 h または hh の直後に m が続く場合は、月ではなく分が表示されます。
mmm 	月を月名の省略形 (1 月〜 12 月) で表示します。 ローカライズされています。
mmmm 	月を完全な月名 (1 月〜 12 月) で表示します。 ローカライズされています。
q 	1 年の四半期を数値 (1 〜 4) で表示します。
y 	1 年の何日目かを数値 (1 〜 366) で表示します。
yy 	西暦の年を下 2 桁の数値 (00 〜 99) で表示します。
yyyy 	西暦の年を 4 桁の数値 (100 〜 9999) で表示します。
h 	時を先頭に 0 のない数値 (0 〜 23) で表示します。
Hh 	時を先頭に 0 のある数値 (00 〜 23) で表示します。
n 	分を先頭に 0 のない数値 (0 〜 59) で表示します。
nn 	分を先頭に 0 のある数値 (00 〜 59) で表示します。
s 	秒を先頭に 0 のない数値 (0 〜 59) で表示します。
ss 	秒を先頭に 0 のある数値 (00 〜 59) で表示します。
ttttt 	時刻を完全な時刻 (時間、分、および秒を含む) で表示します。表示形式は、各システムが認識する時刻書式で定義された時刻区切り文字を使用します。 先頭に 0 を付ける形式が選択されていて、時刻が午前 10:00 または 午後 10:00 より前の場合は、時刻の前に 0 を表示します。 既定の時刻書式は、h:mm:ss です。
AM/PM 	12 時間形式を使用します。正午までの時間に大文字の AM を、正午から午後 11:59 時までの時間に大文字の PM を付けて表示します。
am/pm 	12 時間形式を使用します。正午までの時間に小文字の AM を、正午から午後 11:59 時までの時間に小文字の PM を付けて表示します。
A/P 	12 時間形式を使用します。正午までの時間に大文字の A を、正午から午後 11:59 時までの時間に大文字の P を付けて表示します。
a/p 	12 時間形式を使用します。正午までの時間に小文字の a を、正午から午後 11:59 時までの時間に小文字の p を付けて表示します。
AMPM 	12 時間形式を使用します。正午までの時間にはシステムで定義された AM 文字列リテラルを、正午から午後 11:59 時までの時間にはシステムで定義された PM 文字列リテラルを付けて表示します。 AMPM は大文字、小文字のどちらでもかまいません。ただし、表示される文字列の大文字、小文字の区別は、システムの設定で定義した文字列に一致します。 既定の形式は AM/PM です。 システムで 24 時間時計に設定されている場合は、文字列は通常、長さ 0 の文字列に設定されます。
ユーザー定義数値書式</p>
</div>
<div class="paragraph">
<p>以下の表は、ユーザー定義数値書式の作成に使用できる文字を示します。
ユーザー定義数値書式
文字 	説明
なし 	書式指定なしで数値を表示します。
(0) 	桁のプレースホルダーです。 1 桁の数または 0 を表示します。 式で、書式指定文字列で 0 が指定されている場所に 1 桁の数字がある場合は、その数字が表示されます。それ以外の場合は、その場所に 0 を表示します。数値の整数部または小数部の桁数が、書式指定式内の 0 の桁数より少ない場合は、先行ゼロまたは後置ゼロを表示します。 数値の小数部の桁数が、書式指定式の小数部で指定されている 0 の数より多い場合は、0 の数と同じ桁数に数値が丸められます。 数値の整数部の桁数が、書式指定式の整数部の 0 の数より多い場合は、桁をそのまま表示します。
(<mark>) 	桁のプレースホルダーです。 1 桁の数字または 0 を表示します。 式で、書式指定文字列で # が指定されている場所に該当する桁がある場合は、その数字が表示されます。それ以外の場合は、その場所には何も表示されません。 この記号は 0 桁プレースホルダーと同様の機能を持ちます。ただし、数値の桁数が、書式指定式の整数部および小数部にある # 記号よりも同じか少ない場合でも、先頭および末尾に 0 が表示されません。
(.) 	小数点のプレースホルダーです。 ロケールによっては、小数点の区切り記号としてコンマが使用されます。 小数点のプレースホルダーは、整数部および小数部に表示する桁数を決定します。 書式指定式でこの記号の左に # 記号だけがある場合、1 未満の数値の先頭は小数点区切り記号になります。 小数値の先頭に 0 を表示するには、整数部の最初の桁のプレースホルダーとして 0 を使用します。 書式指定結果で小数点のプレースホルダーとして実際に使用される記号は、システムで認識される数値書式によって異なります。
(%) 	パーセントのプレースホルダーです。 式を 100 倍します。 書式指定文字列の表示位置にパーセント記号 ( % ) が挿入されます。
(,) 	1,000 単位の区切り記号。 ロケールによっては、桁区切り記号としてピリオドが使用されます。 桁区切り記号は、整数部に 4 桁以上ある数値の百の位と千の位を区切ります。 書式にある桁区切り記号が桁のプレースホルダー (0 または #) で囲まれている場合は、桁区切り記号の標準使用が指定されます。 小数部の指定の有無にかかわらず、小数点のすぐ左に、桁区切り記号が 2 つ隣接する場合や、桁区切り記号がある場合は、"数値を 1000 で割って、必要に応じて丸める" ことを意味します。 たとえば、書式指定文字列 "</mark>#0,," を使用して、1 億を 100 として表せます。 百万より小さい数字は 0 として表示されます。 小数点のすぐ左以外の位置に 2 つの隣接する区切り記号がある場合は、通常の桁区切り記号を指定したものとして処理されます。 書式指定された出力で、実際に桁区切り記号として使用される記号は、システムで認識される数値書式によって異なります。
(:) 	時刻の区切り記号。 一部のロケールでは、時刻区切り文字を表す目的で他の文字が使用されることがあります。 時刻の値が書式設定されるときに、時刻区切り文字によって時、分、および秒が区切られます。 書式設定された出力で時刻区切り文字として使用される実際の文字は、システム設定によって決まります。
(/) 	日付の区切り記号。 一部のロケールでは、日付区切り文字を表す目的で他の文字が使用されることがあります。 日付値の書式が設定されている場合、日付、月、および年は、日付の区切り記号によって区切られます。 書式設定された出力で、日付の区切り文字として実際に使用される文字は、システム設定によって決まります。
(E- E+ e- e+) 	指数形式。 書式指定式で、E-、E+、e-、または e+ の左に少なくとも 1 つの桁プレースホルダー ( 0 または # ) がある場合、数値は、数値と指数部の間に E または e を挿入して指数形式で表示されます。 右にある桁プレースホルダーの数で、指数の桁数が決まります。 負の指数にマイナス記号を挿入するには、E- または e- を使用します。 負の指数にマイナス記号を入れて、正の指数にプラス記号を入れるには、E+ または e+ を使用します。
- + $ ( ) 	リテラル文字を表示します。 これ以外の文字をリテラルとして表示するには、その文字の前に円記号 (\) を付けるか、または二重引用符記号 (" ") で囲みます。
(\) 	書式指定文字列内の次の文字を表示します。 特殊な意味を持つ文字をリテラル文字として表示するには、その文字の前に円記号 (\) を付けます。 円記号自体は表示されません。 円記号を使用するのは、その文字を二重引用符記号で囲むことと同じです。 円記号自体を表示するには、円記号を 2 つ (\\) 使用します。 リテラル文字として表示できない文字には次のような文字があります。日付書式文字および時刻書式文字 (a、c、d、h、m、n、p、q、s、t、w、y、/、および :)、数値書式文字 (#、0、%、E、e、コンマ、およびピリオド)、および文字列書式文字 (@、&amp;、&lt;、&gt;、および !)。
("ABC") 	二重引用符 (" ") で囲まれた文字列を表示します。 コードから<strong>書式</strong> に文字列を含めるには、Chr(34) を使ってテキストを囲みます (34 は引用符 (") を表す文字コードです)。
関連項目</p>
</div>
<div class="literalblock">
<div class="content">
<pre>関数 (Visual Basic for Applications)</pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="Hex">33.1.5. Hex 関数</h4>
<div class="paragraph">
<p>数値を 16 進数で表す String を返します。</p>
</div>
<div class="listingblock">
<div class="title">構文</div>
<div class="content">
<pre class="highlight"><code class="language-vbscript" data-lang="vbscript">Hex(number)</code></pre>
</div>
</div>
<div class="paragraph">
<p>必須の number 引数は、任意の有効な数値式または文字列式です。</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 16. 構文</caption>
<colgroup>
<col style="width: 44.4444%;">
<col style="width: 11.1111%;">
<col style="width: 44.4445%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">number の値</th>
<th class="tableblock halign-left valign-top">Hex の戻り値</th>
<th class="tableblock halign-left valign-top">-2,147, 483,648 〜 2,147, 483,647</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">最大 8 桁の 16 進文字</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Null</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Null</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<div class="title">解説</div>
<p>number が整数ではない場合、最も近い整数に丸めてから評価されます。</p>
</div>
<div class="paragraph">
<p>16進数の逆にする場合は、16進数の値の前に &amp;Hを付けます。 たとえば、Hex(255) は
文字列 FF を返し、&amp;HFF は数値 255 を返します。</p>
</div>
<div class="paragraph">
<div class="title">例</div>
<p>次の例は、Hex 関数を使用して、数値の 16 進数値を返します。</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-vbscript" data-lang="vbscript">Dim MyHex
MyHex = Hex(5)    ' Returns 5.
MyHex = Hex(10)    ' Returns A.
MyHex = Hex(459)    ' Returns 1CB.</code></pre>
</div>
</div>
<div class="literalblock">
<div class="title">関連項目</div>
<div class="content">
<pre>関数 (Visual Basic for Applications)</pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="Oct">33.1.6. Oct 関数</h4>
<div class="paragraph">
<p>数値を 8 進数で表す Variant (String) を返します。</p>
</div>
<div class="listingblock">
<div class="title">構文</div>
<div class="content">
<pre class="highlight"><code class="language-vbscript" data-lang="vbscript">Oct(number)</code></pre>
</div>
</div>
<div class="paragraph">
<p>必須の number 引数は、任意の有効な数式または文字列式です。</p>
</div>
<div class="paragraph">
<div class="title">解説</div>
<p>number が整数ではない場合、最も近い整数に丸めてから評価されます。</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 44.4444%;">
<col style="width: 11.1111%;">
<col style="width: 44.4445%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">number の値</th>
<th class="tableblock halign-left valign-top">Oct の戻り値</th>
<th class="tableblock halign-left valign-top">Null</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Null</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">空</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">ゼロ (0)</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>適切な範囲の数値の前に &amp;O を付けて記述すると、値を直接 8 進数で表すことができ
ます。 たとえば、10 進数の 8 の場合は、&amp;O10 のように 8 進数で表記することがで
きます。</p>
</div>
<div class="paragraph">
<div class="title">例</div>
<p>次の例は、Oct 関数を使用して、数値の 8 進数値を返します。</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-vbscript" data-lang="vbscript">Dim MyOct
MyOct = Oct(4)     ' Returns 4.
MyOct = Oct(8)    ' Returns 10.
MyOct = Oct(459)    ' Returns 713.</code></pre>
</div>
</div>
<div class="literalblock">
<div class="title">関連項目</div>
<div class="content">
<pre>関数 (Visual Basic for Applications)</pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="Str">33.1.7. Str 関数</h4>
<div class="paragraph">
<p>数を示す Variant (String) を返します。</p>
</div>
<div class="listingblock">
<div class="title">構文</div>
<div class="content">
<pre class="highlight"><code class="language-vbscript" data-lang="vbscript">Str(number)</code></pre>
</div>
</div>
<div class="paragraph">
<p>必須の number 引数は、任意の有効な数式を含む Long です。
解説</p>
</div>
<div class="paragraph">
<p>数値が文字列に変換されるとき、先頭のスペースは number の符号用に常に予約されます。 number が正の場合、返される文字列には先頭のスペースが含まれ、プラス記号は省略されています。</p>
</div>
<div class="paragraph">
<p>日付、時刻、通貨、または他のユーザー定義書式として書式設定する数値を変換するには、Format 関数を使用します。 Str とは異なり、Format 関数は number の符号用に先頭のスペースを含みません。</p>
</div>
<div class="paragraph">
<p>注意</p>
</div>
<div class="paragraph">
<p>Str 関数は、有効な桁区切り記号としてピリオド (.) のみを 認識します。 他の桁区切り記号を使う場合は (国際アプリケーションの場合など)、CStr を使って数値を文字列に変換します。
例</p>
</div>
<div class="paragraph">
<p>この例では、Str 関数を使って、数値の文字列表現を返しています。 数値が文字列に変換されるとき、先頭のスペースは常に符号用に予約されます。
VB</p>
</div>
<div class="paragraph">
<p>Dim MyString
MyString = Str(459)    ' Returns " 459".
MyString = Str(-459.65)    ' Returns "-459.65".
MyString = Str(459.001)    ' Returns " 459.001".</p>
</div>
<div class="paragraph">
<p>関連項目</p>
</div>
<div class="literalblock">
<div class="content">
<pre>関数 (Visual Basic for Applications)</pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="Val">33.1.8. Val 関数</h4>
<div class="paragraph">
<p>文字列に含まれる数値を、適切な型の数値として返します。</p>
</div>
<div class="listingblock">
<div class="title">構文</div>
<div class="content">
<pre class="highlight"><code class="language-vbscript" data-lang="vbscript">Val(string)</code></pre>
</div>
</div>
<div class="paragraph">
<p>必須の string 引数は、任意の有効な文字列式です。</p>
</div>
<div class="paragraph">
<div class="title">解説</div>
<p>Val 関数は、数値の一部として認識できない最初の文字で、文字列の読み取りを中止し
ます。 数値の一部と見なされることが多い記号や文字 (ドル記号、コンマなど) は、
認識されません。</p>
</div>
<div class="paragraph">
<p>ただし、この関数は、基数プレフィックス &amp;O (8 進数) と &amp;H (16 進数) を認識しま
す。 空白、タブ、およびライン フィード文字は、引数から削除されます。</p>
</div>
<div class="paragraph">
<p>次の例では、値 1615198 が返されます。</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-vbscript" data-lang="vbscript">Val("    1615 198th Street N.E.")</code></pre>
</div>
</div>
<div class="paragraph">
<p>次のコード例の Val は、示されている 16 進数値の 10 進数値である -1 を返します。</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-vbscript" data-lang="vbscript">Val("&amp;HFFFF")</code></pre>
</div>
</div>
<div class="admonitionblock caution">
<table>
<tr>
<td class="icon">
<i class="fa icon-caution" title="Caution"></i>
</td>
<td class="content">
Val 関数は、ピリオド (.) のみを 有効な小数点の記号として認識します。
別の小数点の記号を使用する場合は (国際的なアプリケーションの場合など)、代わり
に CDbl を使用して文字列を数値に変換します。
</td>
</tr>
</table>
</div>
<div class="paragraph">
<div class="title">例</div>
<p>次の例では、Val 関数を使用して、文字列に含まれる数値を返します。</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-vbscript" data-lang="vbscript">Dim MyValue
MyValue = Val("2457")    ' Returns 2457.
MyValue = Val(" 2 45 7")    ' Returns 2457.
MyValue = Val("24 and 57")    ' Returns 24.</code></pre>
</div>
</div>
<div class="literalblock">
<div class="title">関連項目</div>
<div class="content">
<pre>関数 (Visual Basic for Applications)</pre>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_数学関数">33.2. 数学関数</h3>
<div class="sect3">
<h4 id="Abs">33.2.1. Abs 関数</h4>
<div class="paragraph">
<p>渡された値と同じ型で値の絶対値を返します。</p>
</div>
<div class="listingblock">
<div class="title">構文</div>
<div class="content">
<pre class="highlight"><code class="language-vbscript" data-lang="vbscript">Abs(number)</code></pre>
</div>
</div>
<div class="paragraph">
<p>必須の number 引数は、任意の有効な数式です。 number に Null が含まれる場合、
Null が返されます。また、初期化されていない変数の場合は、0 が返されます。</p>
</div>
<div class="paragraph">
<div class="title">解説</div>
<p>数値の絶対値は、その数値から符号を取り除いた値です。 たとえば、ABS(-1) と
ABS(1) は両方とも 1 を返します。</p>
</div>
<div class="paragraph">
<div class="title">例</div>
<p>次の例では、Abs 関数を使用して数値の絶対値を計算します。</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-vbscript" data-lang="vbscript">Dim MyNumber
MyNumber = Abs(50.3)    ' Returns 50.3.
MyNumber = Abs(-50.3)    ' Returns 50.3.</code></pre>
</div>
</div>
<div class="literalblock">
<div class="title">関連項目</div>
<div class="content">
<pre>関数 (Visual Basic for Applications)</pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="Arn">33.2.2. Atn 関数</h4>
<div class="paragraph">
<p>数値のアークタンジェントを指定する Double を返します。</p>
</div>
<div class="listingblock">
<div class="title">構文</div>
<div class="content">
<pre class="highlight"><code class="language-vbscript" data-lang="vbscript">Atn(number)</code></pre>
</div>
</div>
<div class="paragraph">
<p>必須の number 引数は、Double または任意の有効な数値式です。</p>
</div>
<div class="paragraph">
<div class="title">解説</div>
<p>Atn 関数は、直角三角形の 2 辺の比 (number) を取得し、対応する角度を返します。
2 辺の比は、指定した角の反対側の辺 (対辺) の長さを、指定した角に隣接する側の辺
の長さで割った値です。</p>
</div>
<div class="paragraph">
<p>結果の範囲は、-pi/2 から pi/2 (単位はラジアン) になります。 角度の単位を度から
ラジアンに変換するには、度に pi/180 を掛けます。 ラジアンから度に変換するには、
ラジアンに 180/pi を掛けます。</p>
</div>
<div class="admonitionblock caution">
<table>
<tr>
<td class="icon">
<i class="fa icon-caution" title="Caution"></i>
</td>
<td class="content">
Atnは、Tan の逆三角関数で、引数として角度を取得し、直角三角形の 2 辺
の比を返します。 Atn とコタンジェントを混同しないでください。コタンジェントは、
単にタンジェントの逆数 (1/タンジェント) です。
</td>
</tr>
</table>
</div>
<div class="paragraph">
<div class="title">例</div>
<p>次の例では、Atn 関数を使用して pi の値を計算しています。
VB</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-vbscript" data-lang="vbscript">Dim IntVar, StrVar, DateVar, MyCheck
' Initialize variables.
IntVar = 459: StrVar = "Hello World": DateVar = #2/12/69#
MyCheck = VarType(IntVar)    ' Returns 2.
MyCheck = VarType(DateVar)    ' Returns 7.
MyCheck = VarType(StrVar)    ' Returns 8.</code></pre>
</div>
</div>
<div class="literalblock">
<div class="title">関連項目</div>
<div class="content">
<pre>関数 (Visual Basic for Applications)</pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="Cos">33.2.3. Cos 関数</h4>
<div class="paragraph">
<p>角度の余弦 (コサイン) を示す (Double) の値を返します。</p>
</div>
<div class="listingblock">
<div class="title">構文</div>
<div class="content">
<pre class="highlight"><code class="language-vbscript" data-lang="vbscript">Cos(number)</code></pre>
</div>
</div>
<div class="paragraph">
<p>必須の number 引数は、Double または角度 (ラジアン) を示す任意の有効な数値式で
す。</p>
</div>
<div class="paragraph">
<div class="title">解説</div>
<p>Cos 関数は、角度を取得し、直角三角形の 2 辺の比を返します。 2 辺の比は、指定し
た角に隣接する側の辺の長さを、斜辺の長さで割った値です。結果は、-1 から 1 の範
囲内になります。</p>
</div>
<div class="paragraph">
<p>角度の単位を度からラジアンに変換するには、度に pi/180 を掛けます。 ラジアンか
ら度に変換するには、ラジアンに 180/pi を掛けます。</p>
</div>
<div class="paragraph">
<div class="title">例</div>
<p>次の例では、Cos 関数を使用して角度の余弦 (コサイン) を返します。
VB</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-vbscript" data-lang="vbscript">Dim MyAngle, MySecant
MyAngle = 1.3    ' Define angle in radians.
MySecant = 1 / Cos(MyAngle)    ' Calculate secant.</code></pre>
</div>
</div>
<div class="literalblock">
<div class="title">関連項目</div>
<div class="content">
<pre>関数 (Visual Basic for Applications)</pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_派生した数学関数">33.2.4. 派生した数学関数</h4>
<div class="paragraph">
<p>組み込みの数学関数から導くことができるその他の数学関数を次に示します。</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 17. 派生した数学関数</caption>
<colgroup>
<col style="width: 20%;">
<col style="width: 80%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">関数</th>
<th class="tableblock halign-left valign-top">導出式</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">正割</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Sec(X) = 1 / Cos(X)</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">余割</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Cosec(X) = 1 / Sin(X)</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">余接</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Cotan(X) = 1 / Tan(X)</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">逆正弦</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Arcsin(X) = Atn(X / Sqr(-X * X + 1))</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">逆余弦</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Arccos(X) = Atn(-X / Sqr(-X * X + 1)) + 2 * Atn(1)</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">逆正割</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Arcsec(X) = Atn(X / Sqr(X * X - 1)) + SgnX) - 1) * (2 * Atn(1</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">逆余割</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Arccosec(X) = Atn(X / Sqr(X * X - 1)) + (Sgn(X) - 1) * (2 * Atn(1))</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">逆余接</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Arccotan(X) = Atn(X) + 2 * Atn(1)</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">双曲線正弦</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">HSin(X) = (Exp(X) - Exp(-X)) / 2</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">双曲線余弦</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">HCos(X) = (Exp(X) + Exp(-X)) / 2</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">双曲線正接</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">HTan(X) = (Exp(X) - Exp(-X)) / (Exp(X) + Exp(-X))</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">双曲線正割</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">HSec(X) = 2 / (Exp(X) + Exp(-X))</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">双曲線余割</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">HCosec(X) = 2 / (Exp(X) - Exp(-X))</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">双曲線余接</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">HCotan(X) = (Exp(X) + Exp(-X)) / (Exp(X) - Exp(-X))</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">逆双曲線正弦</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">HArcsin(X) = Log(X + Sqr(X * X + 1))</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">逆双曲線余弦</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">HArccos(X) = Log(X + Sqr(X * X - 1))</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">逆双曲線正接</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">HArctan(X) = Log1 + X) / (1 - X / 2</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">逆双曲線正割</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">HArcsec(X) = Log((Sqr(-X * X + 1) + 1) / X)</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">逆双曲線余割</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">HArccosec(X) = Log((Sgn(X) * Sqr(X * X + 1) + 1) / X)</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">逆双曲線余接</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">HArccotan(X) = LogX + 1) / (X - 1 / 2</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">N を底とする対数</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">LogN(X) = Log(X) / Log(N)</p></td>
</tr>
</tbody>
</table>
<div class="literalblock">
<div class="title">関連項目</div>
<div class="content">
<pre>関数 (Visual Basic for Applications)</pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="Exp">33.2.5. Exp 関数</h4>
<div class="paragraph">
<p>e (自然対数の底) を底とする数値のべき乗を指定する Double を返します。</p>
</div>
<div class="listingblock">
<div class="title">構文</div>
<div class="content">
<pre class="highlight"><code class="language-vbscript" data-lang="vbscript">Exp(number)</code></pre>
</div>
</div>
<div class="paragraph">
<p>必須の number 引数は、Double または任意の有効な数値式です。</p>
</div>
<div class="paragraph">
<div class="title">解説</div>
<p>number の値が 709.782712893 を超えると、エラーが発生します。 定数 _e_は約
2.718282 です。</p>
</div>
<div class="admonitionblock caution">
<table>
<tr>
<td class="icon">
<i class="fa icon-caution" title="Caution"></i>
</td>
<td class="content">
Exp 関数は Log 関数の処理を補完し、真数と呼ばれることがあります。
</td>
</tr>
</table>
</div>
<div class="paragraph">
<div class="title">例</div>
<p>この例では、Exp 関数を使って e を底とする数値のべき乗を返します。
VB</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-vbscript" data-lang="vbscript">Dim MyAngle, MyHSin
' Define angle in radians.
MyAngle = 1.3
' Calculate hyperbolic sine.
MyHSin = (Exp(MyAngle) - Exp(-1 * MyAngle)) / 2</code></pre>
</div>
</div>
<div class="literalblock">
<div class="title">関連項目</div>
<div class="content">
<pre>関数 (Visual Basic for Applications)</pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="IntFix">33.2.6. Int、Fix 関数</h4>
<div class="paragraph">
<p>数値の整数部分を返します。</p>
</div>
<div class="listingblock">
<div class="title">構文</div>
<div class="content">
<pre class="highlight"><code class="language-vbscript" data-lang="vbscript">Int(数値)
Fix(数値)</code></pre>
</div>
</div>
<div class="paragraph">
<p>必須の_number_引数は、倍精度浮動小数点型 (Double) または任意の有効な数値式です。
number に Null が含まれている場合は Null が返されます。</p>
</div>
<div class="paragraph">
<div class="title">注釈</div>
<p>Int および Fix のどちらを使用した場合も、number の小数部分が取り除かれて、その
結果得られる整数値が返されます。</p>
</div>
<div class="paragraph">
<p>IntとFixの違いは、 _number_が負の場合、 intが_数値_以下の最初の負の整数値を返
すのに対して、 fixは、最初の負の整数より大きいまたは等しいを返します。数値。
たとえば、-8.4 は Int では -9 に変換されますが、 Fix では -8 に変換されます。</p>
</div>
<div class="paragraph">
<p>修正(数値) はSgn(数値) * Int(Abs(数値)) と同じです。</p>
</div>
<div class="paragraph">
<p>例</p>
</div>
<div class="paragraph">
<p>次の例では、Int 関数および Fix 関数によってどのように数値の整数部分が返される
かを説明しています。 引数が負の数値の場合、Int 関数では数値以下の最も大きい負
の整数が返されますが、Fix 関数では数値以上の最も小さい負の整数が返されます。
VB</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-vbscript" data-lang="vbscript">Dim MyNumber
MyNumber = Int(99.8)    ' Returns 99.
MyNumber = Fix(99.2)    ' Returns 99.

MyNumber = Int(-99.8)    ' Returns -100.
MyNumber = Fix(-99.8)    ' Returns -99.

MyNumber = Int(-99.2)    ' Returns -100.
MyNumber = Fix(-99.2)    ' Returns -99.</code></pre>
</div>
</div>
<div class="literalblock">
<div class="title">関連項目</div>
<div class="content">
<pre>Visual Basic エディター (VBE) の用語集
関数 (Visual Basic for Applications)</pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="Log">33.2.7. Log 関数</h4>
<div class="paragraph">
<p>数値の自然対数を表す倍精度浮動小数点型 (Double) の値を返します。</p>
</div>
<div class="listingblock">
<div class="title">構文</div>
<div class="content">
<pre class="highlight"><code class="language-vbscript" data-lang="vbscript">Log(数値)</code></pre>
</div>
</div>
<div class="paragraph">
<p>必須の_number_ 引数は、倍精度浮動小数点型 (Double) または0より大きい有効な数値
式です。</p>
</div>
<div class="paragraph">
<div class="title">注釈</div>
<p>自然対数とは、e を底とする対数です。 定数 _e_は約2.718282 です。</p>
</div>
<div class="paragraph">
<p>任意の数値 x の n を底とする対数は、次に示すように x の自然対数を n の自然対数
で割ることによって得られます。</p>
</div>
<div class="paragraph">
<p>Logn ( x) = ログ(x)/ログ(n)</p>
</div>
<div class="paragraph">
<p>次の例は、10 を底とする対数を計算するカスタム Function を表しています。
VB</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-vbscript" data-lang="vbscript">Static Function Log10(X)
    Log10 = Log(X) / Log(10#)
End Function</code></pre>
</div>
</div>
<div class="paragraph">
<div class="title">例</div>
<p>この例では、Log 関数を使用して、数値の自然対数を返します。
VB</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-vbscript" data-lang="vbscript">Dim MyAngle, MyLog
' Define angle in radians.
MyAngle = 1.3
' Calculate inverse hyperbolic sine.
MyLog = Log(MyAngle + Sqr(MyAngle * MyAngle + 1))</code></pre>
</div>
</div>
<div class="literalblock">
<div class="title">関連項目</div>
<div class="content">
<pre>関数 (Visual Basic for Applications)</pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="Rnd">33.2.8. Rnd 関数</h4>
<div class="paragraph">
<p>擬似乱数を含む単精度浮動小数点型 (single) の値を返します。</p>
</div>
<div class="listingblock">
<div class="title">構文</div>
<div class="content">
<pre class="highlight"><code class="language-vbscript" data-lang="vbscript">Rnd[(数値)]</code></pre>
</div>
</div>
<div class="paragraph">
<p>省略可能な_Number_ 引数は、単精度浮動小数点型 (Single) の数値式です。
.戻り値</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 20%;">
<col style="width: 80%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">_Number_が</th>
<th class="tableblock halign-left valign-top">Rnd が返す値</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">0 より小さい</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">常に同じ数値をシード_値_として使用します。</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">0 より大きい</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">擬似乱数シーケンスの次の番号。</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">0に等しい</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">最近生成された乱数。</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">省略</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">擬似乱数シーケンスの次の番号。</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<div class="title">注釈</div>
<p>Rnd 関数は、0 以上 1 未満の値を返します。</p>
</div>
<div class="paragraph">
<p>_Number_の値によって、 Rndが擬似乱数を生成する方法が決まります。</p>
</div>
<div class="ulist">
<ul>
<li>
<p>所定の初期シードの場合、同じ番号シーケンスが生成されます。これは、Rnd 関数を
連続して呼び出すたびに、シーケンス内の次の値のシードとして、前の値が使用され
るためです。</p>
</li>
<li>
<p>システム タイマーに基づくシードを使用して乱数ジェネレーターを初期化するには、
Rnd を呼び出す前に、引数を指定せずに Randomize ステートメントを使用します。</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>所定の範囲でランダムな整数を生成するには、次の式を使用します。
VB</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-vbscript" data-lang="vbscript">Int((upperbound - lowerbound + 1) * Rnd + lowerbound)</code></pre>
</div>
</div>
<div class="paragraph">
<p>ここで、<em> upperbound には範囲の上限の値を指定し、</em> lowerbound には範囲の下限
の値を指定します。</p>
</div>
<div class="paragraph">
<p>CAUTION:乱数のシーケンスを繰り返す場合は、数値の引数を指定した Randomize を使
用する直前に、負の引数を指定した Rnd を呼び出します。 _Number_に同じ値を指定し
てRandomizeを使用しても、前のシーケンスは繰り返されません。</p>
</div>
<div class="paragraph">
<div class="title">例</div>
<p>この例では、Rnd 関数を使用して、1 から 6 までのランダムな整数を生成します。
VB</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-vbscript" data-lang="vbscript">Dim MyValue As Integer
MyValue = Int((6 * Rnd) + 1)    ' Generate random value between 1 and 6.</code></pre>
</div>
</div>
<div class="literalblock">
<div class="title">関連項目</div>
<div class="content">
<pre>関数 (Visual Basic for Applications)</pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="Sgn">33.2.9. Sgn 関数</h4>
<div class="paragraph">
<p>数値の符号を示す、サブタイプが整数型 (Integer) であるバリアント型 (Variant) の
値を返します。</p>
</div>
<div class="listingblock">
<div class="title">構文</div>
<div class="content">
<pre class="highlight"><code class="language-vbscript" data-lang="vbscript">Sgn(数値)</code></pre>
</div>
</div>
<div class="paragraph">
<p>必須の number 引数は、任意の有効な数式です。</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 18. 戻り値</caption>
<colgroup>
<col style="width: 20%;">
<col style="width: 80%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">number の値</th>
<th class="tableblock halign-left valign-top">Sgn の戻り値</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">0 より大きい</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">0に等しい</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">0 より小さい</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">-1</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<div class="title">注釈</div>
<p>number 引数の符号により、Sgn 関数の戻り値が決まります。</p>
</div>
<div class="paragraph">
<div class="title">例</div>
<p>次の例では、Sgn 関数を使用して数値の符号を調べます。
VB</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-vbscript" data-lang="vbscript">Dim MyVar1, MyVar2, MyVar3, MySign
MyVar1 = 12: MyVar2 = -2.4: MyVar3 = 0
MySign = Sgn(MyVar1)    ' Returns 1.
MySign = Sgn(MyVar2)    ' Returns -1.
MySign = Sgn(MyVar3)    ' Returns 0.</code></pre>
</div>
</div>
<div class="literalblock">
<div class="title">関連項目</div>
<div class="content">
<pre>関数 (Visual Basic for Applications)</pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="Sin">33.2.10. Sin 関数</h4>
<div class="paragraph">
<p>角度のサインを指定する倍精度浮動小数点型 (Double) の値を返します。</p>
</div>
<div class="listingblock">
<div class="title">構文</div>
<div class="content">
<pre class="highlight"><code class="language-vbscript" data-lang="vbscript">Sin(数値)</code></pre>
</div>
</div>
<div class="paragraph">
<p>必須の number 引数は、Double または角度 (ラジアン) を示す任意の有効な数値式で
す。</p>
</div>
<div class="paragraph">
<div class="title">解説</div>
<p>Sin 関数は、角度を受け取り、直角三角形の 2 辺の比を返します。 2 辺の比は、角度
の反対側の辺の長さを斜辺の長さで割った値です。 結果は -1 ～ 1 の範囲になります。</p>
</div>
<div class="paragraph">
<p>度をラジアンに変換するには、度にπ/180 を掛けます。 ラジアンから度に変換するに
は、ラジアンに 180/pi を掛けます。</p>
</div>
<div class="paragraph">
<div class="title">例</div>
<p>次の例では、Sin 関数を使用して角度のサインを取得しています。
VB</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-vbscript" data-lang="vbscript">Dim MyAngle, MyCosecant
MyAngle = 1.3    ' Define angle in radians.
MyCosecant = 1 / Sin(MyAngle)    ' Calculate cosecant.</code></pre>
</div>
</div>
<div class="literalblock">
<div class="title">関連項目</div>
<div class="content">
<pre>関数 (Visual Basic for Applications)</pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="Sqr">33.2.11. Sqr 関数</h4>
<div class="paragraph">
<p>数値の平方根を示す Double を返します。</p>
</div>
<div class="listingblock">
<div class="title">構文</div>
<div class="content">
<pre class="highlight"><code class="language-vbscript" data-lang="vbscript">Sqr(数値)</code></pre>
</div>
</div>
<div class="paragraph">
<p>必須の_number_ 引数は、倍精度浮動小数点型 (Double) または0以上の有効な数値式で
す。</p>
</div>
<div class="paragraph">
<div class="title">例</div>
<p>この例では、Sqr 関数を使用して数値の平方根を計算します。
VB</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-vbscript" data-lang="vbscript">Dim MySqr
MySqr = Sqr(4)    ' Returns 2.
MySqr = Sqr(23)    ' Returns 4.79583152331272.
MySqr = Sqr(0)    ' Returns 0.
MySqr = Sqr(-4)    ' Generates a run-time error.</code></pre>
</div>
</div>
<div class="literalblock">
<div class="title">関連項目</div>
<div class="content">
<pre>関数 (Visual Basic for Applications)</pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="Tan">33.2.12. Tan 関数</h4>
<div class="paragraph">
<p>角度の正接を指定する Double を返します。</p>
</div>
<div class="listingblock">
<div class="title">構文</div>
<div class="content">
<pre class="highlight"><code class="language-vbscript" data-lang="vbscript">Tan(数値)</code></pre>
</div>
</div>
<div class="paragraph">
<p>必須の number 引数は、Double または角度 (ラジアン) を示す任意の有効な数値式で
す。</p>
</div>
<div class="paragraph">
<div class="title">解説</div>
<p>Tan は角度を取り、直角三角形の 2 辺の比率を返します。 この比率は、1 つの角の反
対側にある辺の長さを、その角に近接する辺の長さで除算することで得られます。</p>
</div>
<div class="paragraph">
<p>度をラジアンに変換するには、度にπ/180 を掛けます。 ラジアンから度に変換するに
は、ラジアンに 180/pi を掛けます。</p>
</div>
<div class="paragraph">
<div class="title">例</div>
<p>この例では、Tan 関数を使用して、角度の正接を返しています。
VB</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-vbscript" data-lang="vbscript">Dim MyAngle, MyCotangent
MyAngle = 1.3    ' Define angle in radians.
MyCotangent = 1 / Tan(MyAngle)    ' Calculate cotangent.</code></pre>
</div>
</div>
<div class="literalblock">
<div class="title">関連項目</div>
<div class="content">
<pre>関数 (Visual Basic for Applications)</pre>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_データ型変換関数">33.3. データ型変換関数</h3>
<div class="sect3">
<h4 id="_データ型変換関数_2">33.3.1. データ型変換関数</h4>
<div class="literalblock">
<div class="content">
<pre>2018/12/21</pre>
</div>
</div>
<div class="paragraph">
<p>この記事の内容</p>
</div>
<div class="literalblock">
<div class="content">
<pre>構文
戻り値の型
解説
CBool 関数の例
CByte 関数の例
CCur 関数の例
CDate 関数の例
CDbl 関数の例
CDec 関数の例
CInt 関数の例
CLng 関数の例
CSng 関数の例
CStr 関数の例
CVar 関数の例
関連項目</pre>
</div>
</div>
<div class="paragraph">
<p>各関数では、式が特定のデータ型に強制的に変換されます。</p>
</div>
<div class="ulist">
<div class="title">構文</div>
<ul>
<li>
<p>CBool(expression)</p>
</li>
<li>
<p>CByte(expression)</p>
</li>
<li>
<p>CCur(expression)</p>
</li>
<li>
<p>CDate(expression)</p>
</li>
<li>
<p>CDbl(expression)</p>
</li>
<li>
<p>CDec(expression)</p>
</li>
<li>
<p>CInt(expression)</p>
</li>
<li>
<p>CLng(expression)</p>
</li>
<li>
<p>CLngLng(expression) (64 ビットのプラットフォームでのみ有効)</p>
</li>
<li>
<p>CLngPtr(expression)</p>
</li>
<li>
<p>CSng(expression)</p>
</li>
<li>
<p>CStr(expression)</p>
</li>
<li>
<p>CVar(expression)</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>必須の expression 引数は、任意の文字列式または数値式です。</p>
</div>
<div class="paragraph">
<div class="title">戻り値の型</div>
<p>次に示すように、戻り値の型は関数名によって異なります。</p>
</div>
<div class="paragraph">
<p>戻り値の型</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 44.4444%;">
<col style="width: 11.1111%;">
<col style="width: 44.4445%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Function</th>
<th class="tableblock halign-left valign-top">戻り値の種類</th>
<th class="tableblock halign-left valign-top">expression 引数の範囲</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">CBool</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Boolean</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">任意の有効な文字列式または数式を指定します。</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">CByte</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Byte</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0 から 255。</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">CCur</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Currency</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">-922,337,203,685,477.5808 ～ 922,337,203,685,477.5807。</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">CDate</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Date</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">任意の有効な日付式。</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">CDbl</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Double</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">負の値の場合は -1.79769313486231E308 ～ -4.94065645841247E-324、正の値の場合は 4.94065645841247E-324 ～ 1.79769313486232E308。</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">CDec</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Decimal</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">ゼロスケールの値 (小数部分がない値) の場合は 79,228,162,514,264,337,593,543,950,335 です。 小数点以下が 28 桁の値の場合は 7.9228162514264337593543950335 です。 0 以外で可能な最小値は 0.0000000000000000000000000001 です。</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">CInt</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Integer</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">-32,768 から 32,767。小数点以下は丸められます。</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">CLng</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Long</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">-2,147,483,648 から 2,147,483,647。小数点以下は丸められます。</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">CLngLng</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">LongLong</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">-9,223,372,036,854,775,808 から 9,223,372,036,854,775,807。小数点以下は丸められます (64 ビット プラットフォームのみで有効)。</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">CLngPtr</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">LongPtr</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">32 ビットのシステムでは -2,147,483,648 ～ 2,147,483,647、64 ビットのシステムでは -9,223,372,036,854,775,808 ～ 9,223,372,036,854,775,807。32 ビットと 64 ビットのどちらのシステムでも、小数部分は丸められます。</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">CSng</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Single</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">負の値の場合は -3.402823E38 ～ -1.401298E-45、正の値の場合は 1.401298E-45 ～ 3.402823E38。</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">CStr</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">String</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">CStr の戻り値は、expression 引数に依存します。</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">CVar</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Variant</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">数値の場合は Double と同じ範囲です。 数値以外の場合は String と同じ範囲です。</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<div class="title">解説</div>
<p>関数に渡した expression 引数の値が変換されるデータ型の範囲を超える場合はエラー
が発生します。</p>
</div>
<div class="admonitionblock caution">
<table>
<tr>
<td class="icon">
<i class="fa icon-caution" title="Caution"></i>
</td>
<td class="content">
LongLong (64 ビットのプラットフォームの LongPtr を含む) をそれよりも
小さい整数型に明示的に代入するには、変換関数を使用する必要があります。
LongLong をそれよりも小さい整数に暗黙的に変換することはできません。
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>一般に、データ型の変換関数を使用してコードを文書化し、一部の演算の結果が既定の
データ型ではなく、特定のデータ型として表示されるように指定できます。 たとえば、
通常、単精度、倍精度、整数演算が発生する場合、CCur を使用して、通貨換算を強制
的に実行します。</p>
</div>
<div class="paragraph">
<p>国際的に通用する 1 つのデータ型から別のデータ型に変換するには、Val ではなく、
データ型の変換関数を使用する必要があります。 たとえば、CCur を使用すると、使用
しているコンピューターのロケールに応じて、異なる少数点の区切り文字や桁区切り記
号、さまざまな通貨オプションが適切に認識されます。</p>
</div>
<div class="paragraph">
<p>小数点以下が 0.5 の場合、CInt および CLng は、常に一番近い偶数に数値を丸めます。
たとえば、0.5 は 0 に、1.5 は 2 に丸められます。 Fix関数とInt関数は、小数部分
を丸めるのではなく切り捨てるので、CInt およびCLngとは異なります。 また、Fix お
よび Int は、常に渡されたのと同じ型の値を返します。</p>
</div>
<div class="paragraph">
<p>date を日付または時刻に変換できるかどうかを確認するには、IsDate 関数を使用しま
す。 CDate では、日付リテラルと時刻リテラルだけでなく、許容範囲内の日付に当て
はまる数字も認識されます。 数字を日付に変換すると、整数全体が日付に変換されま
す。 数字の分数の部分は、午前 12 時を起点にした時刻に変換されます。</p>
</div>
<div class="paragraph">
<p>CDate は、システムのロケール設定に基づいて日付の形式を認識します。 認識されて
いる日付設定以外の書式設定が提供されている場合、日、月、年の順番を正しく決定で
きないことがあります。 さらに、1 週間の文字列が含まれる場合、長い日付の書式設
定は認識されません。</p>
</div>
<div class="paragraph">
<p>Visual Basic の旧バージョンとの互換性のために、CVDate 関数も提供されています。
CVDate 関数の構文は CDate 関数と同じですが、CVDate では、実際の Date 型ではな
く、サブタイプが Date 型である Variant 型が返されます。 組み込みの Date 型が利
用できるようになったため、CVDate を使用する必要がなくなりました。 式を Date に
変換してから Variant に代入することで、同じ処理を行うことができます。 これは、
他のすべての組み込みタイプを同等のバリアント型サブタイプに変換する方法と同じで
す。</p>
</div>
<div class="admonitionblock caution">
<table>
<tr>
<td class="icon">
<i class="fa icon-caution" title="Caution"></i>
</td>
<td class="content">
CDec 関数は独立したデータ型を返しません。値が 10 進型サブタイプに変換
されたバリアント型を常に返します。
</td>
</tr>
</table>
</div>
<div class="paragraph">
<div class="title">CBool 関数の例</div>
<p>この例では、CBool 関数を使用して、式を Boolean に変換します。 式が 0 以外の値
に評価される場合は CBool から True が返され、それ以外の場合は False が返されま
す。
VB</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-vbscript" data-lang="vbscript">Dim A, B, Check
A = 5: B = 5 ' Initialize variables.
Check = CBool(A = B) ' Check contains True.

A = 0 ' Define variable.
Check = CBool(A) ' Check contains False.</code></pre>
</div>
</div>
<div class="paragraph">
<div class="title">CByte 関数の例</div>
<p>この例では、CByte 関数を使用して、式を Byte に変換します。
VB</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-vbscript" data-lang="vbscript">Dim MyDouble, MyByte
MyDouble = 125.5678 ' MyDouble is a Double.
MyByte = CByte(MyDouble) ' MyByte contains 126.</code></pre>
</div>
</div>
<div class="paragraph">
<div class="title">CCur 関数の例</div>
<p>この例では、CCur 関数を使用して、式を Currency に変換します。
VB</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-vbscript" data-lang="vbscript">Dim MyDouble, MyCurr
MyDouble = 543.214588 ' MyDouble is a Double.
MyCurr = CCur(MyDouble * 2) ' Convert result of MyDouble * 2
 ' (1086.429176) to a
 ' Currency (1086.4292).</code></pre>
</div>
</div>
<div class="paragraph">
<div class="title">CDate 関数の例</div>
<p>この例では CDate 関数を使用し、文字列を日付型に変換します。 一般に、この例で示すように、文字列として日付と時刻をハードコードするのはお勧めしません。 文字列の代わりに、<mark>2/12/1969</mark> や <mark>4:45:23 PM</mark> のような日付リテラルと時刻リテラルを使用してください。
VB</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-vbscript" data-lang="vbscript">Dim MyDate, MyShortDate, MyTime, MyShortTime
MyDate = "February 12, 1969" ' Define date.
MyShortDate = CDate(MyDate) ' Convert to Date data type.

MyTime = "4:35:47 PM" ' Define time.
MyShortTime = CDate(MyTime) ' Convert to Date data type.</code></pre>
</div>
</div>
<div class="paragraph">
<div class="title">CDbl 関数の例</div>
<p>この例では、CDbl 関数を使用して、式を Double に変換します。
VB</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-vbscript" data-lang="vbscript">Dim MyCurr, MyDouble
MyCurr = CCur(234.456784) ' MyCurr is a Currency.
MyDouble = CDbl(MyCurr * 8.2 * 0.01) ' Convert result to a Double.</code></pre>
</div>
</div>
<div class="paragraph">
<div class="title">CDec 関数の例</div>
<p>この例では、CDec 関数を使用して、値を Decimal に変換します。
VB</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-vbscript" data-lang="vbscript">Dim MyDecimal, MyCurr
MyCurr = 10000000.0587 ' MyCurr is a Currency.
MyDecimal = CDec(MyCurr) ' MyDecimal is a Decimal.</code></pre>
</div>
</div>
<div class="paragraph">
<div class="title">CInt 関数の例</div>
<p>この例では、CInt 関数を使用して、値を Integer に変換します。
VB</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-vbscript" data-lang="vbscript">Dim MyDouble, MyInt
MyDouble = 2345.5678 ' MyDouble is a Double.
MyInt = CInt(MyDouble) ' MyInt contains 2346.</code></pre>
</div>
</div>
<div class="paragraph">
<div class="title">CLng 関数の例</div>
<p>この例では、CLng 関数を使用して、値を Long に変換します。
VB</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-vbscript" data-lang="vbscript">Dim MyVal1, MyVal2, MyLong1, MyLong2
MyVal1 = 25427.45: MyVal2 = 25427.55 ' MyVal1, MyVal2 are Doubles.
MyLong1 = CLng(MyVal1) ' MyLong1 contains 25427.
MyLong2 = CLng(MyVal2) ' MyLong2 contains 25428.</code></pre>
</div>
</div>
<div class="paragraph">
<div class="title">CSng 関数の例</div>
<p>この例では、CSng 関数を使用して、値を Single に変換します。
VB</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-vbscript" data-lang="vbscript">Dim MyDouble1, MyDouble2, MySingle1, MySingle2
' MyDouble1, MyDouble2 are Doubles.
MyDouble1 = 75.3421115: MyDouble2 = 75.3421555
MySingle1 = CSng(MyDouble1) ' MySingle1 contains 75.34211.
MySingle2 = CSng(MyDouble2) ' MySingle2 contains 75.34216.</code></pre>
</div>
</div>
<div class="paragraph">
<div class="title">CStr 関数の例</div>
<p>この例では、CStr 関数を使用して、数値を String に変換します。
VB</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-vbscript" data-lang="vbscript">Dim MyDouble, MyString
MyDouble = 437.324 ' MyDouble is a Double.
MyString = CStr(MyDouble) ' MyString contains "437.324".</code></pre>
</div>
</div>
<div class="paragraph">
<div class="title">CVar 関数の例</div>
<p>この例では、CVar 関数を使用して、式を Variant に変換します。
VB</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-vbscript" data-lang="vbscript">Dim MyInt, MyVar
MyInt = 4534 ' MyInt is an Integer.
MyVar = CVar(MyInt &amp; 000) ' MyVar contains the string
 ' 4534000.</code></pre>
</div>
</div>
<div class="literalblock">
<div class="title">関連項目</div>
<div class="content">
<pre>データ型の概要
Visual Basic エディター (VBE) の用語集
Visual Basic の概念に関するトピック</pre>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_その他の関数">33.4. その他の関数</h3>
<div class="sect3">
<h4 id="Array">33.4.1. Array 関数</h4>
<div class="paragraph">
<p>配列を含む Variant を返します。</p>
</div>
<div class="listingblock">
<div class="title">構文</div>
<div class="content">
<pre class="highlight"><code class="language-vbscript" data-lang="vbscript">Array(arglist)</code></pre>
</div>
</div>
<div class="paragraph">
<p>必須の arglist 引数は、Variant に含まれている配列の要素に割り当てられる値のコ
ンマ区切りのリストです。 引数を指定しない場合は長さ 0 の配列が作成されます。</p>
</div>
<div class="paragraph">
<div class="title">解説</div>
<p>配列の要素を参照するために使用される表記は、変数 名とそれに続く括弧で構成され、
括弧の中には目的の要素を示すインデックス番号が入ります。</p>
</div>
<div class="paragraph">
<p>次の例では、最初のステートメントにより、Variant として「A」という名前の変数が
作成されます。 2 つ目のステートメントにより、変数 A に配列が割り当てられます。
最後のステートメントにより、2 つ目の配列要素に含まれる値が別の変数に割り当てら
れます。
VB</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-vbscript" data-lang="vbscript">Dim A As Variant, B As Long, i As Long
A = Array(10, 20, 30)  ' A is a three element list by default indexed 0 to 2
B = A(2)               ' B is now 30
ReDim Preserve A(4)    ' Extend A's length to five elements
A(4) = 40              ' Set the fifth element's value
For i = LBound(A) To UBound(A)
    Debug.Print "A(" &amp; i &amp; ") = " &amp; A(i)
Next i</code></pre>
</div>
</div>
<div class="paragraph">
<p>Array 関数を使用して作成した配列の下限は、Array がタイプ ライブラリの名前で修
飾 (VBA.Array など) されていない限り、Option Base ステートメントで指定した下限
によって決まります。 タイプ ライブラリの名前で修飾されている場合は、Array は
Option Base の影響を受けません。</p>
</div>
<div class="paragraph">
<p>注
CAUTION:配列として宣言されていない Variant には、配列を含めることができます。
Variant 変数には、固定長の文字列とユーザー定義の型を除き、あらゆる型の配列を含
めることができます。 配列が含まれている Variant は要素の型が Variant の配列と
は概念的に異なりますが、配列要素には同じ方法でアクセスされます。</p>
</div>
<div class="paragraph">
<div class="title">例</div>
<p>この例では、 Array 関数を使用して、配列を含む Variant を返します。
VB</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-vbscript" data-lang="vbscript">Dim MyWeek, MyDay
MyWeek = Array("Mon", "Tue", "Wed", "Thu", "Fri", "Sat", "Sun")
' Return values assume lower bound set to 1 (using Option Base
' statement).
MyDay = MyWeek(2)    ' MyDay contains "Tue".
MyDay = MyWeek(4)    ' MyDay contains "Thu".</code></pre>
</div>
</div>
<div class="literalblock">
<div class="title">関連項目</div>
<div class="content">
<pre>関数 (Visual Basic for Applications)</pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="CallByName">33.4.2. CallByName 関数</h4>
<div class="paragraph">
<p>オブジェクトのメソッドを実行するか、オブジェクトのプロパティを設定するか返しま
す。</p>
</div>
<div class="listingblock">
<div class="title">構文</div>
<div class="content">
<pre class="highlight"><code class="language-vbscript" data-lang="vbscript">CallByName (object, procname, calltype, [args()]))</code></pre>
</div>
</div>
<div class="paragraph">
<p>CallByName関数の構文に使用される名前付き引数は次のとおりです。</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 44.4444%;">
<col style="width: 11.1111%;">
<col style="width: 44.4445%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">パーツ</th>
<th class="tableblock halign-left valign-top">説明</th>
<th class="tableblock halign-left valign-top">object</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">必須。Variant (Object)。 関数を実行するオブジェクトの名前。</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">procname</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">必須。Variant (String)。 オブジェクトのプロパティまたはメソッドの名前を含む文字列式。</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">calltype</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">必須。定数。 呼び出されるプロシージャの型を表す vbCallType 型の定数。</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">args()</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<div class="title">解説</div>
<p>CallByName 関数は、実行時に文字列名を使用してプロパティを取得または設定するか、
メソッドを呼び出すために使用されます。</p>
</div>
<div class="paragraph">
<p>次の例では、1 行目で CallByName を使用してテキスト ボックスの MousePointer プ
ロパティを設定し、2 行目で MousePointer プロパティの値を取得し、3 行目で Move
メソッドを呼び出してテキスト ボックスを移動します。
VB</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-vbscript" data-lang="vbscript">CallByName Text1, "MousePointer", vbLet, vbCrosshair
Result = CallByName (Text1, "MousePointer", vbGet)
CallByName Text1, "Move", vbMethod, 100, 100</code></pre>
</div>
</div>
<div class="paragraph">
<div class="title">例</div>
<p>この例では、CallByName 関数を使用して、コマンド ボタンの Move メソッドを呼び出
します。</p>
</div>
<div class="paragraph">
<p>例ではまた、ボタン (Command1) とラベル (Label1) を含むフォーム (Form1) を使用
します。 フォームが読み込まれると、ラベルの Caption プロパティが、呼び出すメソ
ッドの名前に設定されます (この例では "Move")。 ボタンをクリックすると、
CallByName 関数によって、ボタンの位置を変更するメソッドが呼び出されます。
VB</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-vbscript" data-lang="vbscript">Option Explicit

Private Sub Form_Load()
    Label1.Caption = "Move"        ' Name of Move method.
End Sub

Private Sub Command1_Click()
    If Command1.Left &lt;&gt; 0 Then
        CallByName Command1, Label1.Caption, vbMethod, 0, 0
    Else
        CallByName Command1, Label1.Caption, vbMethod, 500, 500
    End If</code></pre>
</div>
</div>
<div class="literalblock">
<div class="title">関連項目</div>
<div class="content">
<pre>関数 (Visual Basic for Applications)</pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="Choose">33.4.3. Choose 関数</h4>
<div class="paragraph">
<p>引数の一覧から値を選択し、返します。</p>
</div>
<div class="listingblock">
<div class="title">構文</div>
<div class="content">
<pre class="highlight"><code class="language-vbscript" data-lang="vbscript">Choose(index, choice-1, [ choice-2, ..., [ choice-n ]] )</code></pre>
</div>
</div>
<div class="paragraph">
<p>Choose 関数の構文には、次の指定項目があります。</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 20%;">
<col style="width: 80%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">パーツ</th>
<th class="tableblock halign-left valign-top">説明</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">index</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">必ず指定します。 1 から選択肢の数までの値になる 数式またはフィールドです。</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">choice</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">必須です。 可能性のある選択肢のいずれか 1 つが含まれる バリアント型の式 です。</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<div class="title">解説</div>
<p>Choose は、index の値に基づいて選択肢の一覧から値を返します。 index が 1 の場
合、Choose は一覧の 1 つ目の選択肢を返します。index が 2 の場合は 2 つ目という
ようになります。</p>
</div>
<div class="paragraph">
<p>Choose を使って、可能性の一覧に含まれる値を検索することができます。 たとえば、
index が 3 で、choice-1 = "1"、choice-2 = "2"、choice-3 = "3" と評価した場合、
Choose は "3" を返します。 この機能は、index がオプション グループの値を示す場
合に特に便利です。</p>
</div>
<div class="paragraph">
<p>Choose は、一覧の選択肢すべてを評価しますが、その 1 つだけが返されます。 その
ため、望ましくない副作用が生じないように注意する必要があります。 すべての選択
肢において、式 の一部として MsgBox 関数を使用する場合、メッセージ ボックスは評
価される各選択肢に対して表示されますが、Choose はそのうちの 1 つだけを返します。</p>
</div>
<div class="paragraph">
<p>もし index が 1 以下または一覧にある選択肢の数を超える場合、Choose 関数は Null
を返します。</p>
</div>
<div class="paragraph">
<p>index が整数ではない場合、最も近い整数に丸めてから評価されます。
.l例</p>
</div>
<div class="paragraph">
<p>この例では、Choose 関数を使って、Ind パラメーターのプロシージャに渡される index に応じた名前を表示します。
VB</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-vbscript" data-lang="vbscript">Function GetChoice(Ind As Integer)
    GetChoice = Choose(Ind, "Speedy", "United", "Federal")
End Function</code></pre>
</div>
</div>
<div class="literalblock">
<div class="title">関連項目</div>
<div class="content">
<pre>関数 (Visual Basic for Applications)</pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="Command">33.4.4. Command</h4>
<div class="paragraph">
<p>Microsoft Visual Basic または Visual Basic で開発された実行可能なプログラムの
起動に使用されるコマンド ラインの引数部分を返します。 Visual Basic の関数機能
は、Microsoft Office のアプリケーションでは使用できません。</p>
</div>
<div class="listingblock">
<div class="title">構文</div>
<div class="content">
<pre class="highlight"><code class="language-vbscript" data-lang="vbscript">Command</code></pre>
</div>
</div>
<div class="paragraph">
<div class="title">解説</div>
<p>コマンドラインから Visual Basic が起動された場合、/cmd に続くすべてのコマンド
ライン部分がコマンドライン引数として、プログラムに渡されます。 次のコマンドラ
インの例で、cmdlineargs は、コマンド関数によって返される引数情報を表しています。</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-vbscript" data-lang="vbscript">VB /cmd cmdlineargs</code></pre>
</div>
</div>
<div class="paragraph">
<p>Visual Basic で開発され、.exe ファイルにコンパイルされたアプリケーションでは、
Command によって、コマンド ラインのアプリケーション名の後に表示されるすべての
引数が返されます。 次に例を示します。</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-vbscript" data-lang="vbscript">MyApp cmdlineargs</code></pre>
</div>
</div>
<div class="paragraph">
<p>使用しているアプリケーションのユーザー インターフェイスでのコマンド ライン引数
の変更方法の詳細については、ヘルプの「コマンド ライン引数」を参照してください。
.例</p>
</div>
<div class="paragraph">
<p>この例では、配列を含む Variant でコマンド ライン引数を返す関数内で、Command 関
数を使用してコマンド ライン引数を取得しています。 Microsoft Office では使用で
きません。
VB</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-vbscript" data-lang="vbscript">Function GetCommandLine(Optional MaxArgs)
    'Declare variables.
    Dim C, CmdLine, CmdLnLen, InArg, I, NumArgs
    'See if MaxArgs was provided.
    If IsMissing(MaxArgs) Then MaxArgs = 10
    'Make array of the correct size.
    ReDim ArgArray(MaxArgs)
    NumArgs = 0: InArg = False
    'Get command line arguments.
    CmdLine = Command()
    CmdLnLen = Len(CmdLine)
    'Go thru command line one character
    'at a time.
    For I = 1 To CmdLnLen
        C = Mid(CmdLine, I, 1)
        'Test for space or tab.
        If (C &lt;&gt; " " And C &lt;&gt; vbTab) Then
            'Neither space nor tab.
            'Test if already in argument.
            If Not InArg Then
            'New argument begins.
            'Test for too many arguments.
                If NumArgs = MaxArgs Then Exit For
                NumArgs = NumArgs + 1
                InArg = True
            End If
            'Concatenate character to current argument.
            ArgArray(NumArgs) = ArgArray(NumArgs) &amp; C
        Else
            'Found a space or tab.
            'Set InArg flag to False.
            InArg = False
        End If
    Next I
    'Resize array just enough to hold arguments.
    ReDim Preserve ArgArray(NumArgs)
    'Return Array in Function name.
    GetCommandLine = ArgArray()
End Function</code></pre>
</div>
</div>
<div class="literalblock">
<div class="title">関連項目</div>
<div class="content">
<pre>関数 (Visual Basic for Applications)</pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_instr_関数">33.4.5. InStr 関数</h4>
<div class="paragraph">
<p>ある文字列が別の文字列の中で最初に現れる位置を指定するVariant（Long）を返しま
す。</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_is関数">33.5. is関数</h3>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 19. is関数</caption>
<colgroup>
<col style="width: 20%;">
<col style="width: 80%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">IsArray 関数</th>
<th class="tableblock halign-left valign-top">変数が配列かどうかを示す Boolean 値を返します。</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">IsDate 関数</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">式が日付であるか、有効な日付または時刻として認識可能な場合にはTrue を返し、それ以外の場合には False を返します。</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">IsEmpty 関数</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">変数が初期化されているかどうかを示す Boolean 値を返します。</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">IsError 関数</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">式がエラー値かどうかを示すブール型 (Boolean) の値を返します。</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">IsMissing 関数</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">省略可能なVariant 引数がプロシージャに渡されたかどうかを示すブール型 (Boolean ) の値を返します。</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">IsNull 関数</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">式に無効なデータ (Null) が含まれていないかどうかを示すブール型 (Boolean) の値を返します。</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">IsNumeric 関数</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">式を数値として評価できるかどうかを示すブール型 (Boolean) の値を返します。</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">IsObject 関数</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">識別子がオブジェクト変数を表しているかどうかを示す Boolean 値を返します。</p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect2">
<h3 id="_isarray_関数_visual_basic_for_applications_microsoft_docs">33.6. <a href="https://docs.microsoft.com/ja-jp/office/vba/language/reference/user-interface-help/isarray-function">IsArray 関数 (Visual Basic for Applications) | Microsoft Docs</a></h3>
<div class="paragraph">
<p>変数が配列かどうかを示す Boolean 値を返します。</p>
</div>
<div class="listingblock">
<div class="title">構文</div>
<div class="content">
<pre class="highlight"><code class="language-vbscript" data-lang="vbscript">IsArray(varname)</code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_ステートメント_microsoft_docs">34. <a href="https://docs.microsoft.com/ja-jp/office/vba/language/reference/statements">ステートメント | Microsoft Docs</a></h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_close_ステートメント">34.1. <a id="Close"></a>Close ステートメント</h3>
<div class="paragraph">
<p><a href="#Open">Open</a> ステートメントを使用して開いたファイルへの入力/出力 (I/O) を終了します。</p>
</div>
<div class="listingblock">
<div class="title">構文</div>
<div class="content">
<pre class="highlight"><code class="language-vbscript" data-lang="vbscript">Close [ filenumberlist ]</code></pre>
</div>
</div>
<div class="paragraph">
<p>filenumberlist 引数はオプションであり、1 つまたは複数の ファイル番号を指定でき
ます。次の構文を使用します。filenumber は有効なファイル番号です: [[ # ]
filenumber ] [ , [ # ] filenumber ] . . .</p>
</div>
<div class="paragraph">
<div class="title">注釈</div>
<p>filenumberlist を省略すると、Open ステートメントで開いたすべてのアクティブなフ
ァイルが閉じられます。</p>
</div>
<div class="paragraph">
<p>出力または追加のために開かれたファイルを閉じると、出力の最終バッファーが、オペ
レーティング システムのそのファイル用のバッファーに書き込まれます。 閉じられた
ファイルに関連付けられているすべてのバッファー領域が解放されます。</p>
</div>
<div class="paragraph">
<p>Close ステートメントを実行すると、ファイルとそのファイル番号の関連付けが終了し
ます。</p>
</div>
<div class="paragraph">
<div class="title">例</div>
<p>この例では、<a href="#Close">Close</a> ステートメントを使用して、出力用に開いていた 3 つのファイル
をすべて閉じます。</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-vbscript" data-lang="vbscript">Dim I, FileName
For I = 1 To 3 ' Loop 3 times.
    FileName = "TEST" &amp; I ' Create file name.
    Open FileName For Output As #I ' Open file.
    Print #I, "This is a test." ' Write string to file.
Next I
Close ' Close all 3 open files.</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_doloop_ステートメント">34.2. Do&#8230;&#8203;Loop ステートメント</h3>
<div class="paragraph">
<p>条件が True の間または True になるまで、一連のステートメントを繰り返し実行しま
す。</p>
</div>
<div class="listingblock">
<div class="title">構文</div>
<div class="content">
<pre class="highlight"><code class="language-vbscript" data-lang="vbscript">Do [{ While | Until } condition ]
[ statements ]
[ Exit Do ]
[ statements ]
Loop</code></pre>
</div>
</div>
<div class="paragraph">
<p>次の構文も使用できます。</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-vbscript" data-lang="vbscript">Do
[ statements ]
[ Exit Do ]
[ statements ]
Loop [{ While | Until } condition ]</code></pre>
</div>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 20%;">
<col style="width: 80%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">パーツ</th>
<th class="tableblock halign-left valign-top">説明</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">condition</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">省略可能。 True または False の数式または文字列式。 condition が
Null である場合、condition は False として処理されます。</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">statements</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">condition が True の間または True になるまで繰り返し実行される 1
つ以上のステートメント。</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<div class="title">注釈</div>
<p>Do…Loop を終了する代替方法として、Do…Loop 内の任意の場所に任意の数の Exit Do
ステートメントを配置できます。 Exit Do ステートメントに到達すると、Loop の直後
にあるステートメントに制御が移される Exit Do は、If…Then など、何らかの条件を
評価した後によく使用されます。</p>
</div>
<div class="paragraph">
<p>入れ子になった Do…Loop ステートメント内で Exit Do を使用する場合は、Exit Do
に到達したループの 1 つ上のレベルのループに制御が移ります。</p>
</div>
<div class="paragraph">
<div class="title">例</div>
<p>次の例では、Do&#8230;&#8203;Loop ステートメントの使用方法を示します。 内部 Do&#8230;&#8203;Loop ステ
ートメントは 10 回ループされ、ユーザーに継続するかどうかをたずね、ユーザーが
No を選択すると、フラグの値を False に設定し、Exit Do ステートメントを使用して、
処理途中で終了します。 外側のループは、フラグの値を確認して直ちに終了します。</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-vbscript" data-lang="vbscript">Public Sub LoopExample()
    Dim Check As Boolean, Counter As Long, Total As Long
    Check = True: Counter = 0: Total = 0 ' Initialize variables.
    Do ' Outer loop.
        Do While Counter &lt; 20 ' Inner Loop
            Counter = Counter + 1 ' Increment Counter.
            If Counter Mod 10 = 0 Then ' Check in with the user on every multiple of 10.
                Check = (MsgBox("Keep going?", vbYesNo) = vbYes) ' Stop when user click's on No
                If Not Check Then Exit Do ' Exit inner loop.
            End If
        Loop
        Total = Total + Counter ' Exit Do Lands here.
        Counter = 0
    Loop Until Check = False ' Exit outer loop immediately.
    MsgBox "Counted to: " &amp; Total
End Sub</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_for_eachnext_ステートメント">34.3. For Each&#8230;&#8203;Next ステートメント</h3>
<div class="paragraph">
<p>配列またはコレクションの各要素に対して、ステートメントのグループを繰り返します。</p>
</div>
<div class="listingblock">
<div class="title">構文</div>
<div class="content">
<pre class="highlight"><code class="language-vbscript" data-lang="vbscript">For Each element In group
[ statements ]
[ Exit For ]
[ statements ]
Next [ element ]</code></pre>
</div>
</div>
<div class="paragraph">
<p>For&#8230;&#8203;Each&#8230;&#8203;Next ステートメントの構文には、次の指定項目があります。</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-vbscript" data-lang="vbscript">|パーツ |説明
|element |必須。 コレクションまたは配列の要素を反復処理するために使用される 変数です。 コレクションの場合、_要素_には、バリアント型 の変数、汎用オブジェクト変数、または特定のオブジェクト変数のみを指定できます。 配列の場合は、element に使用できるのは Variant 変数だけです。
|group |必須。 オブジェクトのコレクションまたは配列の名前です (ユーザー定義型の配列を除きます)。
|statements |省略可能。 group の各アイテムに対して実行される 1 つ以上のステートメントです。</code></pre>
</div>
</div>
<div class="paragraph">
<div class="title">注釈</div>
<p>group に少なくとも 1 つの要素がある場合、For…Each ブロックに入ります。 ループ
が入力されると、ループ内のすべてのステートメントが_グループ_内の最初の要素に対
して実行されます。 group にさらに要素がある場合、各要素に対してループ内のステ
ートメントの実行が続けられます。 group にそれ以上要素がなくなると、ループは終
了し、Next ステートメントの後のステートメントから実行が続けられます。</p>
</div>
<div class="paragraph">
<p>ループ内の任意の数の<strong>exit</strong> ステートメントは、別の方法で終了することができま
す。 Exit For は、何らかの条件 (たとえば If…Then ) を評価した後、 Next の直後
のステートメントに制御を移す場合によく使用されます。</p>
</div>
<div class="paragraph">
<p>For…Each…Next ループを別のループの内部に置くことによって、For&#8230;&#8203;Each&#8230;&#8203;Next
ループを入れ子にできます。 ただし、各ループの element が一意である必要がありま
す。</p>
</div>
<div class="admonitionblock caution">
<table>
<tr>
<td class="icon">
<i class="fa icon-caution" title="Caution"></i>
</td>
<td class="content">
Next ステートメント内の element を省略すると、element が含まれ
る場合と同じように実行が続けられます。 対応する For ステートメントの前で Next
ステートメントが検出された場合は、エラーが発生します。
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Variant はユーザー定義型を含むことができないため、ユーザー定義型の配列では
For&#8230;&#8203;Each&#8230;&#8203;Next ステートメントを使用できません。</p>
</div>
<div class="paragraph">
<div class="title">例</div>
<p>次の例では、For Each&#8230;&#8203;Next ステートメントを使用して、コレクション内のすべての
要素の Text プロパティで文字列 "Hello" があるかどうか検索しています。 この例で
は、MyObject はテキストに関するオブジェクトであり、MyCollection コレクションの
要素です。 どちらも例示のみを目的として使用されている汎用名です。</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-vbscript" data-lang="vbscript">Dim Found, MyObject, MyCollection
Found = False    ' Initialize variable.
For Each MyObject In MyCollection    ' Iterate through each element.
    If MyObject.Text = "Hello" Then    ' If Text equals "Hello".
        Found = True    ' Set Found to True.
        Exit For    ' Exit loop.
    End If
Next</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_fornext_ステートメント">34.4. For&#8230;&#8203;Next ステートメント</h3>
<div class="paragraph">
<p>指定した回数だけ、一連のステートメントを繰り返します。</p>
</div>
<div class="listingblock">
<div class="title">構文</div>
<div class="content">
<pre class="highlight"><code class="language-vbscript" data-lang="vbscript">For counter = start To end [ Step step ]
[ statements ]
[ Exit For ]
[ statements ]
Next [ counter ]</code></pre>
</div>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 20%;">
<col style="width: 80%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">パーツ</th>
<th class="tableblock halign-left valign-top">説明</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">counter</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">必須です。 ループ カウンターとして使用する数値変数を指定します。 こ
の変数には、ブール値または配列要素を指定できません。</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">start</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">必須です。 counter の初期値を指定します。</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">end</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">必須。 counter の最終値を指定します。</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">step</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">オプション。 ループを繰り返すたびに、counter の数が変更されます。 省略
されると、step は既定値の 0 になります。</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">statements</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">省略可能。 指定した回数だけ実行さ*<strong>*</strong> れる、との間の1 つ以上のス
テートメント。</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<div class="title">注釈</div>
<p>引数_step_ は、正または負のいずれかを指定できます。 引数_step_の値は、次のよう
にループ処理を決定します。</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 20%;">
<col style="width: 80%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">値</th>
<th class="tableblock halign-left valign-top">ループの実行条件</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">正の数または 0</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">counter &#8656; end</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">負の数</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">counter &gt;= end</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>ループ内のすべてのステートメントが実行されると、step の値が counteｒ に加算さ
れます。 この時点で、(ループを最初に実行した同じテストに基づいて) ループ内のス
テートメントが再び実行されるか、ループを抜け出して Next ステートメントの次のス
テートメントから実行が継続されます。</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
ループ内で counteｒ の値を変更すると、コードの解読とデバッグが困難にな
る可能性があります。
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>ループ内の任意の数の<strong>exit</strong> ステートメントは、別の方法で終了することができま
す。 <strong><strong>* 通常は、何らかの条件を評価した後に、たとえば &#8230;&#8203; 次に、その直後のス
テートメントに制御を</strong></strong>* 転送します。</p>
</div>
<div class="paragraph">
<p>For&#8230;&#8203;Next ループの内部に別の For&#8230;&#8203;Next ループを入れて、For&#8230;&#8203;Next ループをネ
ストできます。 各ループには、counter として一意の変数名を指定してください。 以
下に正しい構造を示します。</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-vbscript" data-lang="vbscript">For I = 1 To 10
    For J = 1 To 10
        For K = 1 To 10
         ...
        Next K
    Next J
Next I</code></pre>
</div>
</div>
<div class="admonitionblock caution">
<table>
<tr>
<td class="icon">
<i class="fa icon-caution" title="Caution"></i>
</td>
<td class="content">
Next ステートメントの counter を省略しても、実行は_counter_ が
指定されているのと同様に継続されます。 対応する For ステートメントの前に Next
ステートメントを指定すると、エラーが発生します。
</td>
</tr>
</table>
</div>
<div class="paragraph">
<div class="title">例</div>
<p>この例では、を使用します。Next statement を使用して、0から9までの数値の10個の
インスタンスを含む文字列を作成します。各文字列は、1つのスペースで区切られてい
ます。 外側のループでは、ループを実行するたびにデクリメントされるループカウン
ター変数を使用します。</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-vbscript" data-lang="vbscript">Dim Words, Chars, MyString
For Words = 10 To 1 Step -1 ' Set up 10 repetitions.
    For Chars = 0 To 9 ' Set up 10 repetitions.
        MyString = MyString &amp; Chars ' Append number to string.
    Next Chars ' Increment counter
    MyString = MyString &amp; " " ' Append a space.
Next Words</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_function">34.5. Function</h3>
<div class="sect3">
<h4 id="_配列を引数として渡す">34.5.1. 配列を引数として渡す</h4>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-vbscript" data-lang="vbscript">Sub main()

    Dim arr(2) As Long
    arr(0) = 1
    arr(1) = 2
    arr(2) = 3

    Call test(arr())

End Sub


Sub test(ByRef arr() As Long)

    Dim val As Variant
    For Each val In arr
        Debug.Print val
    Next

End Sub</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_配列を戻り値として受け取る">34.5.2. 配列を戻り値として受け取る</h4>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-vbscript" data-lang="vbscript">Sub main()

    Dim arr() As Long
    arr() = test()

    Dim val As Variant
    For Each val In arr
        Debug.Print val
    Next

End Sub

Function test() As Long()

    Dim arr(2) As Long
    arr(0) = 1
    arr(1) = 2
    arr(2) = 3

    test = arr()

End Function</code></pre>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_ifthenelse_ステートメント">34.6. If&#8230;&#8203;Then&#8230;&#8203;Else ステートメント</h3>
<div class="paragraph">
<p>式の値に基づいて、条件に応じてステートメントのグループを実行します。</p>
</div>
<div class="listingblock">
<div class="title">構文</div>
<div class="content">
<pre class="highlight"><code class="language-vbscript" data-lang="vbscript">If condition Then [ statements ] [ Else elsestatements ]</code></pre>
</div>
</div>
<div class="paragraph">
<p>または、ブロック形式の構文を使用できます。</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-vbscript" data-lang="vbscript">If condition Then
[ statements ]
[ ElseIf condition-n Then
[ elseifstatements ]]
[ Else
[ elsestatements ]]
End If</code></pre>
</div>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 20%;">
<col style="width: 80%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">パーツ</th>
<th class="tableblock halign-left valign-top">説明</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">condition</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">必須。 次の 2 種類の式の 1 つ以上を指定します。<br>
<br>
True または False に評価される数値式または文字列式です。 condition が Null の場合は、condition が False として処理されます。<br></p>
<p class="tableblock">TypeOf objectname Is objecttype 形式の式。 objectname は任意のオブジェクト参照<br>
であり、objecttype は任意の有効なオブジェクト タイプです。 _objectname_が<br>
objecttype で指定されたオブジェクトの種類のいずれかである場合、式は True です。+
それ以外の場合は False です。</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">statements</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">ブロック形式では省略可能で、Else 句がない 1 行形式では必要です。
condition が Trueの場合にコロンで区切られる、または実行されるステートメントを
指定します。</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">condition-n</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">省略可能です。 condition と同じです。</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">elseifstatements</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">省略可能。 関連する condition-n が True の場合に実行される
ステートメントを指定します。</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">elsestatements</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">省略可能です。 以前の condition または condition-n 式がどれも
True でない場合に実行されるステートメントを指定します。</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<div class="title">注釈</div>
<p>短く簡単なテストに 1 行形式 (最初の構文) を使用できます。 しかし、ブロック形式
(2 番目の構文) では、1 行形式よりも構造化され柔軟性に富みます。一般的に、読み
やすくなり保守とデバッグが簡単になります。</p>
</div>
<div class="admonitionblock caution">
<table>
<tr>
<td class="icon">
<i class="fa icon-caution" title="Caution"></i>
</td>
<td class="content">
1 行の形式でも、If&#8230;&#8203;Then 判定の結果として実行される複数のステ
ートメントを指定できます。 次のステートメントのように、すべてのステートメント
は同じ行にコロンで区切って記述する必要があります。
</td>
</tr>
</table>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-vbscript" data-lang="vbscript">If A &gt; 10 Then A = A + 1 : B = B + A : C = C + B</code></pre>
</div>
</div>
<div class="paragraph">
<p>ブロック形式 If ステートメントは行の最初のステートメントである必要があります。
ステートメントの Else、 ElseIf、End If の部分には、行番号またはその前の行ライ
ンのみを含めることができます。 ブロック If は End If ステートメントで終了する
必要があります。</p>
</div>
<div class="paragraph">
<p>ステートメントがブロック If かどうかを判断するには、Then キーワードの後に何が
指定されているかを確認します。 同じ行の Then の後に表示されるコメント以外の場
合、ステートメントは 1 行形式の If ステートメントとして処理されます。</p>
</div>
<div class="paragraph">
<p>Else 句と ElseIf 句は、省略可能です。 ブロック If では必要なだけ ElseIf 句を含
めることができますが、Else 句の後には何も表示されません。 ブロック If ステート
メントはネストできます。つまりそれぞれに含まれます。</p>
</div>
<div class="paragraph">
<p>ブロック If (2 番目の構文) を実行するときに、condition がテストされます。
condition が True の場合は、Then に続くステートメントが実行されます。
condition が False の場合は、代わりに ElseIf で指定した各条件 (ある場合) が評
価されます。 True 条件が見つかると、関連する Then の直後のステートメントが実行
されます。 ElseIf 条件が True でなければ (または ElseIf 句がなければ)、Else に
続くステートメントが実行されます。 Then または Else に続くステートメントを実行
した後は、End If に続くステートメントから実行が続けられます。</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
TipSelect Case は、いくつかの可能性のあるアクションを持つ 1 つの式を評
価する際にさらに役立ちます。 ただし、TypeOf objectname Is objecttype 節は、
Select Case ステートメントで使用できません。
</td>
</tr>
</table>
</div>
<div class="admonitionblock caution">
<table>
<tr>
<td class="icon">
<i class="fa icon-caution" title="Caution"></i>
</td>
<td class="content">
TypeOf は、Object 以外の Long、Integer などのハード データの種
類では使用できません。
</td>
</tr>
</table>
</div>
<div class="paragraph">
<div class="title">例</div>
<p>この例では、If&#8230;&#8203;Then&#8230;&#8203;Else ステートメントのブロック形式と 1 行形式の両方を示
します。 If TypeOf&#8230;&#8203;Then&#8230;&#8203;Else の使用方法も示します。</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-vbscript" data-lang="vbscript">Dim Number, Digits, MyString
Number = 53 ' Initialize variable.
If Number &lt; 10 Then
    Digits = 1
ElseIf Number &lt; 100 Then
' Condition evaluates to True so the next statement is executed.
    Digits = 2
Else
    Digits = 3
End If

' Assign a value using the single-line form of syntax.
If Digits = 1 Then MyString = "One" Else MyString = "More than one"</code></pre>
</div>
</div>
<div class="paragraph">
<p>If TypeOf 構造を使用して、プロシージャに渡されたコントロールがテキスト ボック
スかどうかを判断します。</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-vbscript" data-lang="vbscript">Sub ControlProcessor(MyControl As Control)
    If TypeOf MyControl Is CommandButton Then
        Debug.Print "You passed in a " &amp; TypeName(MyControl)
    ElseIf TypeOf MyControl Is CheckBox Then
        Debug.Print "You passed in a " &amp; TypeName(MyControl)
    ElseIf TypeOf MyControl Is TextBox Then
        Debug.Print "You passed in a " &amp; TypeName(MyControl)
    End If
End Sub</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_redim_ステートメント">34.7. ReDim ステートメント</h3>
<div class="paragraph">
<p>プロシージャレベルで使用され、動的配列変数の記憶領域を再割り当てします。</p>
</div>
<div class="listingblock">
<div class="title">構文</div>
<div class="content">
<pre class="highlight"><code class="language-vbscript" data-lang="vbscript">ReDim [ Preserve ] varname ( subscripts ) [ As type ], [ varname ( subscripts ) [ As type ]] . . .</code></pre>
</div>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 20%;">
<col style="width: 80%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">パーツ</th>
<th class="tableblock halign-left valign-top">説明</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Preserve</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">オプション。 最後のディメンションのサイズを変更するとき、既存の配列のデータを保持する際に使用されるキーワードです。</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">varname</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">必須。 変数の名前です。標準の変数の名前付け規則に従ってください。</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">subscripts</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">必須です。 配列変数の次元です。最大 60 までの多次元を宣言できます。
添字引数には、次の構文を使用します。<br></p>
<p class="tableblock">[source,vbscript]
----
[ lowerTo ] upper [ , [ lowerTo ] upper ] . . .
----</p>
<p class="tableblock">lower で明示的に指定していないときには、配列の下限が Option Base ステートメントによって制御されます。 Option Base ステートメントが存在しない場合、下限は 0 になります。</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">type</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">省略可能。 変数のデータ型です。Byte、 Boolean、 Integer、 Long、
Currency、 Single、 Double、 Decimal (現時点ではサポートされていません)、日付、
文字列(可変長文字列の場合) 、文字列の_長さ_(固定長文字列の場合)、 object、
Variant、ユーザー定義型、またはオブジェクト型。<br>
<br>
定義する変数*<strong>*</strong> ごとに、 <em>type_句を個別に使用します。 配列を含むバリアント型 (variant _</em> ) の場合は、配列の各要素の型を説明しますが、バリアント型 ( variant ) は他の型には変更しません。</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<div class="title">解説</div>
<p>ReDimステートメントは、 Private、 Public、または<strong>Dim</strong> ステートメント (次元の
添字なし) を使用して、既に正式に宣言されている動的配列のサイズを変更したり、サ
イズを変更したりするために使用します。</p>
</div>
<div class="paragraph">
<p>ReDimステートメントを繰り返し使用して、配列内の要素と次元の数を変更できます。
ただし、配列がバリアント型 ( Variant) に含まれていない場合は、1つのデータ型の
配列を宣言してから、 ReDimを使用して配列を別のデータ型に変更することはできませ
ん。 配列がVariantに含まれている場合、 As _type_句を使用して要素の型を変更でき
ます。ただし、 Preserveキーワードを使用していない場合は、データ型の変更は許可
されません。</p>
</div>
<div class="paragraph">
<p>Preserveキーワードを使用した場合、最後の配列の次元のサイズのみを変更でき、次元
の数を変更することはできません。 たとえば、配列にディメンションが1つしかない場
合は、ディメンションのサイズを変更することができます。 ただし、配列に2つ以上の
次元がある場合は、最後の次元のサイズのみを変更して、配列の内容を保持することが
できます。</p>
</div>
<div class="paragraph">
<p>次の例は、配列に含まれる既存のデータを消去することなく、動的配列の最後の次元の
サイズを拡大する方法を示しています。</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-vbscript" data-lang="vbscript">ReDim X(10, 10, 10)
. . .
ReDim Preserve X(10, 10, 15)</code></pre>
</div>
</div>
<div class="paragraph">
<p>同様に、Preserve を使用する場合、配列のサイズを変更するには、必ず上限を変更す
る必要があります。下限を変更すると、エラーが発生します。</p>
</div>
<div class="paragraph">
<p>配列を元のサイズよりも小さくすると、排除された要素のデータは失われます。</p>
</div>
<div class="paragraph">
<p>変数の初期化時に、数値変数は 0 に、可変長文字列は長さ 0 の文字列 ("") に、固定
長文字列は 0 で埋められた文字列に初期化されます。 Variant 変数は、Empty に初期
化されます。 ユーザー定義型変数の各要素は、それぞれの要素が個別の変数であるも
のとして初期化されます。</p>
</div>
<div class="paragraph">
<p>オブジェクトを参照する変数には、 Set ステートメントを使用して既存のオブジェク
トを割り当てる必要があります。その場合は、そのオブジェクトを使用できます。 オ
ブジェクトが割り当てられるまで、宣言されたオブジェクト変数には<strong>Nothing</strong> とい
う特殊な値が含まれています。これは、オブジェクトの特定のインスタンスを参照して
いないことを示します。</p>
</div>
<div class="paragraph">
<p>ReDimステートメントは、宣言された変数がモジュールレベルまたはプロシージャレベ
ルに存在しない場合、宣言ステートメントとして機能します。 後で同じ名前を持つ別
の変数が作成されると、 ReDimは以降の変数を参照します。 Option Explicit が有効に
なっていても、必ずしもコンパイルエラーを引き起こすことはありません。 このよう
な競合を回避するには、 ReDimを宣言的なステートメントとして使用しないでください。
ただし、単に配列を再設定する必要があります。</p>
</div>
<div class="admonitionblock caution">
<table>
<tr>
<td class="icon">
<i class="fa icon-caution" title="Caution"></i>
</td>
<td class="content">
バリアント型 (Variant) に含まれる配列のサイズを変更するには、
その配列のサイズ変更を試みる前に、バリアント型 (Variant) 変数を明示的に宣言す
る必要があります。
</td>
</tr>
</table>
</div>
<div class="paragraph">
<div class="title">例</div>
<p>この例では、ReDim ステートメントを使用して、動的配列変数に対する記憶域の容量の
割り当ておよび再割り当てを行っています。 Option Base は 1 であることを前提とし
ています。</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-vbscript" data-lang="vbscript">Dim MyArray() As Integer ' Declare dynamic array.
Redim MyArray(5) ' Allocate 5 elements.
For I = 1 To 5 ' Loop 5 times.
 MyArray(I) = I ' Initialize array.
Next I</code></pre>
</div>
</div>
<div class="paragraph">
<p>次のステートメントは、配列のサイズを変更し、要素を消去します。</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-vbscript" data-lang="vbscript">Redim MyArray(10) ' Resize to 10 elements.
For I = 1 To 10 ' Loop 10 times.
 MyArray(I) = I ' Initialize array.
Next I</code></pre>
</div>
</div>
<div class="paragraph">
<p>次のステートメントは、配列のサイズを変更し、要素は消去しません。</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-vbscript" data-lang="vbscript">Redim Preserve MyArray(15) ' Resize to 15 elements.</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_open_ステートメント">34.8. <a id="Open"></a>Open ステートメント</h3>
<div class="paragraph">
<p>ファイルへの入出力 (I/O) を有効にします。</p>
</div>
<div class="listingblock">
<div class="title">構文</div>
<div class="content">
<pre class="highlight"><code class="language-vbscript" data-lang="vbscript">Open pathname For mode [ Access access ] [ lock ] As [ # ] filenumber [ Len = reclength ]</code></pre>
</div>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 44.4444%;">
<col style="width: 11.1111%;">
<col style="width: 44.4445%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">指定項目</th>
<th class="tableblock halign-left valign-top">説明</th>
<th class="tableblock halign-left valign-top">pathname</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">必須です。 ファイル名を指定する文字列式です。ディレクトリまたはフォ
ルダーとドライブを含めることもできます。</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">mode</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">必須。 ファイル モードを指定するキーワード (Append、Binary、Input、
Output、または Random) です。 指定していない場合、ファイルは Random アクセス用
に開かれます。</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">access</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">省略可能です。 開いたファイルに対して許可される操作を指定するキーワー
ド (Read、Write、または Read Write) です。</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">lock</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">省略可能。 開いたファイルに対する他のプロセスからの操作の制限を指定する
キーワード (Shared、Lock Read、Lock Write、および Lock Read Write) です。</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">filenumber</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">必須。 範囲が 1 以上 511 以下の有効なファイル番号です。 次に使用
可能なファイル番号を取得するには、FreeFile 関数を使用します。</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<div class="title">解説</div>
<p>ファイルに対する I/O 操作を実行する場合は、その前にファイルを開いておく必要が
あります。 Open により、ファイルへの I/O のためのバッファーが割り当てられて、
そのバッファーで使用するアクセス モードが決まります。</p>
</div>
<div class="paragraph">
<p>pathname で指定したファイルが存在しない場合に、Append、Binary、Output、または
Random モードでファイルを開くと、そのファイルが作成されます。</p>
</div>
<div class="paragraph">
<p>ファイルが別のプロセスで開かれていて、指定した種類のアクセスが許可されていない
場合は、Open 操作が失敗してエラーが発生します。</p>
</div>
<div class="paragraph">
<p>mode が Binary の場合、Len 句は無視されます。</p>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
Binary、Input、および Random モードでは、別のファイル番号を使
用することで、先にファイルを閉じていなくてもファイルを開くことができます。
Append および Output モードでは、別のファイル番号でファイルを開く前に、そのフ
ァイルを閉じておく必要があります。
</td>
</tr>
</table>
</div>
<div class="paragraph">
<div class="title">例</div>
<p>この例では、ファイルへの入出力を有効にする Open ステートメントの使用方法を示し
ます。</p>
</div>
<div class="paragraph">
<p>次のコードでは、シーケンシャル入力モードでファイルを開きます。</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-vbscript" data-lang="vbscript">Open "TESTFILE" For Input As #1
' Close before reopening in another mode.
Close #1</code></pre>
</div>
</div>
<div class="paragraph">
<p>この例では、書き込み操作のためにのみ Binary モードでファイルを開きます。</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-vbscript" data-lang="vbscript">Open "TESTFILE" For Binary Access Write As #1
' Close before reopening in another mode.
Close #1</code></pre>
</div>
</div>
<div class="paragraph">
<p>次の例では、Random モードでファイルを開きます。 ファイルには、ユーザー定義型の
レコードが格納されています。</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-vbscript" data-lang="vbscript">Type Record ' Define user-defined type.
 ID As Integer
 Name As String * 20
End Type


Dim MyRecord As Record ' Declare variable.
Open "TESTFILE" For Random As #1 Len = Len(MyRecord)
' Close before reopening in another mode.
Close #1</code></pre>
</div>
</div>
<div class="paragraph">
<p>このコード例では、シーケンシャル出力のためにファイルを開きます。どのプロセスか
らでもファイルの読み取りまたは書き込みを実行できます。</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-vbscript" data-lang="vbscript">Open "TESTFILE" For Output Shared As #1
' Close before reopening in another mode.
Close #1</code></pre>
</div>
</div>
<div class="paragraph">
<p>このコード例では、読み取りのために Binary モードでファイルを開きます。このファ
イルは別のプロセスから読み取ることができなくなります。</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-vbscript" data-lang="vbscript">Open "TESTFILE" For Binary Access Read Lock Read As #1</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_unload_ステートメント">34.9. Unload ステートメント</h3>
<div class="paragraph">
<p>メモリからオブジェクトを削除します。</p>
</div>
<div class="listingblock">
<div class="title">構文</div>
<div class="content">
<pre class="highlight"><code class="language-vbscript" data-lang="vbscript">Unload object</code></pre>
</div>
</div>
<div class="paragraph">
<p>必須の object プレースホルダーは、[次に適用] リスト内のオブジェクトに評価され
るオブジェクト式を表します。</p>
</div>
<div class="paragraph">
<div class="title">解説</div>
<p>オブジェクトは、アンロード時にメモリから削除され、そのオブジェクトに関連付けら
れていたすべてのメモリが解放されます。 Load ステートメントを使用して再度メモリ
に配置されるまで、ユーザーはオブジェクトを操作できなくなり、プログラムでオブジ
ェクトを操作することもできなくなります。</p>
</div>
<div class="paragraph">
<div class="title">例</div>
<p>次の例は、プログラム内に 2 つの UserForm があると仮定しています。 UserForm1 の
初期化イベントで、UserForm2 が読み込まれて表示されます。 UserForm2 はユーザー
がクリックしたときにアンロードされ、UserForm1 が表示されます。 その後で
UserForm1 をクリックすると、それがアンロードされます。</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-vbscript" data-lang="vbscript">' This is the Initialize event procedure for UserForm1
Private Sub UserForm_Initialize()
 Load UserForm2
 UserForm2.Show
End Sub
' This is the Click event for UserForm2
Private Sub UserForm_Click()
 Unload UserForm2
End Sub

' This is the Click event for UserForm1
Private Sub UserForm_Click()
 Unload UserForm1
End Sub</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_whilewend_ステートメント">34.10. While&#8230;&#8203;Wend ステートメント</h3>
<div class="paragraph">
<p>特定の条件が True である限り一連のステートメントを実行します。</p>
</div>
<div class="listingblock">
<div class="title">構文</div>
<div class="content">
<pre class="highlight"><code class="language-vbscript" data-lang="vbscript">While condition [ statements ] Wend</code></pre>
</div>
</div>
<div class="paragraph">
<p>While&#8230;&#8203;Wend ステートメントの構文には、次の指定項目があります。</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 20. 構文</caption>
<colgroup>
<col style="width: 20%;">
<col style="width: 80%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">パーツ</th>
<th class="tableblock halign-left valign-top">説明</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">condition</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">必須。 True または False に評価される数値式または文字列式です。
condition が Null の場合は、condition が False として処理されます。</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">statements</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">省略可能。 条件が True の間に実行される 1 つ以上のステートメント
です。</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<div class="title">解説</div>
<p>condition が True の場合は、Wend ステートメントにたどり着くまで、すべての
statements が実行されます。 その後で、制御は While ステートメントに戻って、
condition が再度チェックされます。 condition が True のままの場合は、処理が繰
り返されます。 True ではない場合、プログラムの実行は Wend ステートメントの次の
ステートメントから再開されます。</p>
</div>
<div class="paragraph">
<p>While&#8230;&#8203;Wend ループは、どのレベルまででも入れ子にできます。 それぞれの Wend は
直前の While に対応します。</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
Do&#8230;&#8203;Loop ステートメントを使用すると、より構造化された柔軟な方法でルー
プを実行できます。
</td>
</tr>
</table>
</div>
<div class="paragraph">
<div class="title">例</div>
<p>この例では、While&#8230;&#8203;Wend ステートメントを使用してカウンター変数の値を増やして
います。 ループ内のステートメントは、条件が True に評価されなくなるまで実行さ
れます。</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-vbscript" data-lang="vbscript">Dim Counter
Counter = 0 ' Initialize variable.
While Counter &lt; 20 ' Test value of Counter.
 Counter = Counter + 1 ' Increment Counter.
Wend ' End While loop when Counter &gt; 19.
Debug.Print Counter ' Prints 20 in the Immediate window.</code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_sleep関数を使う">35. sleep関数を使う</h2>
<div class="sectionbody">
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-vbscript" data-lang="vbscript">#If VBA7 Then
    Private Declare PtrSafe Sub Sleep Lib "kernel32" (ByVal ms As LongPtr)
#Else
    Private Declare Sub Sleep Lib "kernel32" (ByVal ms As Long)
#End If


Sleep 500</code></pre>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_エクセルシート関数">36. エクセルシート関数</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_シート名取得">36.1. シート名取得</h3>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-vbscript" data-lang="vbscript">=RIGHT(CELL("filename",A1),LEN(CELL("filename",A1))-FIND("]",CELL("filename",A1)))</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_ファイル名取得">36.2. ファイル名取得</h3>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-vbscript" data-lang="vbscript">=MID(CELL("filename",A2),FIND("[",CELL("filename",A2))+1,FIND("]",CELL("filename",A2))-(FIND("[",CELL("filename",A2))+1))</code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_visual_basic_言語リファレンス">37. Visual Basic 言語リファレンス</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Visual Basic 言語 (すべてのメソッド、プロパティ、ステートメント、関数、演算子、
およびオブジェクト) に関するドキュメントが用意されています。</p>
</div>
<div class="ulist">
<ul>
<li>
<p>文字セット</p>
</li>
<li>
<p>定数</p>
</li>
<li>
<p>データ型</p>
</li>
<li>
<p>ディレクティブ</p>
</li>
<li>
<p>イベント</p>
</li>
<li>
<p>関数</p>
</li>
<li>
<p>キーワード</p>
</li>
<li>
<p>Microsoft Forms</p>
</li>
<li>
<p>オブジェクト</p>
</li>
<li>
<p>Operators</p>
</li>
<li>
<p>ステートメント</p>
</li>
<li>
<p>Visual Basic アドイン モデル</p>
</li>
</ul>
</div>
<div class="ulist">
<div class="title">関連項目</div>
<ul>
<li>
<p>メソッドとプロパティ (オブジェクトの下になりました)</p>
</li>
<li>
<p>オブジェクト ブラウザー</p>
</li>
<li>
<p>Visual Basic ユーザー インターフェイスのヘルプ</p>
</li>
<li>
<p>Office 用オブジェクト ライブラリ リファレンス (メンバー、プロパティ、メソッド)</p>
</li>
<li>
<p>Office クライアントの開発リファレンス</p>
</li>
</ul>
</div>
<div class="sect2">
<h3 id="_文字セット">37.1. 文字セット</h3>
<div class="ulist">
<ul>
<li>
<p>文字セット (0 から 127)</p>
</li>
<li>
<p>文字セット (128 から 255)</p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="_定数_visual_basic_for_applications">37.2. 定数 (Visual Basic for Applications)</h3>
<div class="sect3">
<h4 id="_vba_定数">37.2.1. VBA 定数</h4>
<div class="sect4">
<h5 id="_カレンダー定数">37.2.1.1. カレンダー定数</h5>
<div class="paragraph">
<div class="title">関連項目</div>
<p>次の定数は、コード内の任意の場所で実際の値の代わりに使用できます。</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 20%;">
<col style="width: 80%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">定数</th>
<th class="tableblock halign-left valign-top">値</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">説明</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">vbCalGreg</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">.0</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">グレゴリオ暦を使用することを示します。</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">vbCalHijri</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1-d</p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect4">
<h5 id="_calltype_定数">37.2.1.2. CallType 定数</h5>
<div class="paragraph">
<p>次の定数は、コード内の任意の場所で実際の値の代わりに使用できます。</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 16.6666%;">
<col style="width: 16.6666%;">
<col style="width: 66.6668%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">定数</th>
<th class="tableblock halign-left valign-top">値</th>
<th class="tableblock halign-left valign-top">説明</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">vbMethod</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1-d</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">メソッドが呼び出されることを指定します。</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">vbGet</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">pbm-2</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Property Get プロシージャを示します。</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">vbLet</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">2/4</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Property Let プロシージャを示します。</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">vbSet</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">8</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Property Set プロシージャを示します。</p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect4">
<h5 id="_カラー定数">37.2.1.3. カラー定数</h5>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 42.8571%;">
<col style="width: 42.8571%;">
<col style="width: 14.2858%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">定数</th>
<th class="tableblock halign-left valign-top">値</th>
<th class="tableblock halign-left valign-top">説明</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">vbBlack</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0x0</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">黒</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">vbRed</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0xFF</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">赤</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">vbGreen</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0xFF00</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">緑</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">vbYellow</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0xFFFF</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">黄</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">vbBlue</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0xFF0000</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">青</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">vbMagenta</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0xFF00FF</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">紫</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">vbCyan</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0xFFFF00</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">シアン</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">vbWhite</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0xFFFFFF</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">白</p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect4">
<h5 id="_比較定数">37.2.1.4. 比較定数</h5>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 28.5714%;">
<col style="width: 14.2857%;">
<col style="width: 57.1429%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">定数</th>
<th class="tableblock halign-left valign-top">値</th>
<th class="tableblock halign-left valign-top">説明</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">vbUseCompareOption</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">-1</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Option Compare ステートメントの設定を使用して比較を実行します。</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">vbBinaryCompare</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">.0</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">バイナリ比較を実行します。</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">vbTextCompare</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1-d</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">テキスト比較を実行します。</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">vbDatabaseCompare</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">pbm-2</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Microsoft Access (Windows のみ) で、データベースに格納されている情報に基づいて比較を実行します。</p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect4">
<h5 id="_date_定数">37.2.1.5. Date 定数</h5>
<div class="paragraph">
<p>次の定数は、コード内の任意の場所で実際の値の代わりに使用できます。</p>
</div>
<div class="paragraph">
<div class="title">引数の値</div>
<p>firstdayofweek 引数には、次の値があります。</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 44.4444%;">
<col style="width: 11.1111%;">
<col style="width: 44.4445%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">定数</th>
<th class="tableblock halign-left valign-top">値</th>
<th class="tableblock halign-left valign-top">説明</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">vbUseSystem</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">.0</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">NLS API 設定を使用します。</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">vbSunday</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1-d</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">日曜日 (既定)</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">vbMonday</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">pbm-2</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">月曜日</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">vbTuesday</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1/3</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">火曜日</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">vbWednesday</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">2/4</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">水曜日</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">vbThursday</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">5</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">木曜日</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">vbFriday</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">シックス</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">金曜日</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">vbSaturday</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">7</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">土曜日</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>firstdayofyear 引数には、次の値があります。</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 44.4444%;">
<col style="width: 11.1111%;">
<col style="width: 44.4445%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">定数</th>
<th class="tableblock halign-left valign-top">値</th>
<th class="tableblock halign-left valign-top">説明</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">vbUseSystem</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">.0</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">NLS API 設定を使用します。</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">VbUseSystemDayOfWeek</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">.0</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">システム設定で週の 1 日目に指定された曜日を使用します。</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">vbFirstJan1</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1-d</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1 月 1 日が含まれる週から開始します (既定)。</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">vbFirstFourDays</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">pbm-2</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">新年で少なくとも 4 日ある最初の週から開始します。</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">vbFirstFullWeek</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1/3</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1 週間全体が含まれる最初の週がその年の第 1 週目になります。</p></td>
</tr>
</tbody>
</table>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 21. 戻り値</caption>
<colgroup>
<col style="width: 44.4444%;">
<col style="width: 11.1111%;">
<col style="width: 44.4445%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">定数</th>
<th class="tableblock halign-left valign-top">値</th>
<th class="tableblock halign-left valign-top">説明</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">vbSunday</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1-d</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">日曜日</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">vbMonday</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">pbm-2</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">月曜日</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">vbTuesday</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1/3</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">火曜日</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">vbWednesday</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">2/4</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">水曜日</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">vbThursday</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">5</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">木曜日</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">vbFriday</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">シックス</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">金曜日</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">vbSaturday</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">7</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">土曜日</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<div class="title">関連項目</div>
<p>定数 (Visual Basic for Applications)</p>
</div>
</div>
<div class="sect4">
<h5 id="_日付形式の定数">37.2.1.6. 日付形式の定数</h5>
<div class="paragraph">
<p>この定数は、この定数の定義を含む適切なタイプ ライブラリがプロジェクトで明示的
に参照される場合にのみ使用できます。</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 44.4444%;">
<col style="width: 11.1111%;">
<col style="width: 44.4445%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">定数</th>
<th class="tableblock halign-left valign-top">値</th>
<th class="tableblock halign-left valign-top">説明</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">vbGeneralDate</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">.0</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">日付と時刻のどちらか、または両方を表示します。 実数の場合、日付と時刻を表示します。 小数の部分がない場合、日付だけを表示します。 整数部がない場合は、時刻のみを表示します。 日付と時刻の表示は、システムの設定によって決定されます。</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">vbLongDate</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1-d</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">コンピューターの地域の設定で指定されている長い日付形式を使用して日付を表示します。</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">vbShortDate</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">pbm-2</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">コンピューターの地域の設定で指定されている短い日付形式を使用して日付を表示します。</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">vbLongTime</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1/3</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">コンピューターの地域の設定で指定されている長い時刻形式を使用して時刻を表示します。</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">vbShortTime</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">2/4</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">コンピューターの地域の設定で指定されている短い時刻形式を使用して時刻を表示します。</p></td>
</tr>
</tbody>
</table>
<div class="literalblock">
<div class="title">関連項目</div>
<div class="content">
<pre>定数 (Visual Basic for Applications)</pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="_dirgetattrおよび_setattr_定数">37.2.1.7. Dir、GetAttr、および SetAttr 定数</h5>
<div class="paragraph">
<p>次の定数は、コード内の任意の場所で実際の値の代わりに使用できます。</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 44.4444%;">
<col style="width: 11.1111%;">
<col style="width: 44.4445%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">定数</th>
<th class="tableblock halign-left valign-top">値</th>
<th class="tableblock halign-left valign-top">説明</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">vbNormal</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">.0</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">標準 (Dir および SetAttr の既定値)</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">vbReadOnly</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1-d</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">読み取り専用</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">vbHidden</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">pbm-2</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">非表示</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">vbSystem</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">2/4</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">システム ファイル</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">vbVolume</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">8</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">ボリューム ラベル</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">vbDirectory</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">16</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">ディレクトリまたはフォルダー</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">vbArchive</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">32</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">ファイルが前回のバックアップ以降に変更されている</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">vbAlias</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">64</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Macintosh では識別子はエイリアス</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>Macintosh では vbNormal、vbReadOnly、vbHidden、および vbAlias のみが使用できま
す。</p>
</div>
<div class="paragraph">
<p>関連項目</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="#Dir">Dir 関数</a></p>
</li>
<li>
<p><a href="#GetAttr">GetAttr 関数</a></p>
</li>
<li>
<p><a href="#SetArre">SetAttr ステートメント</a></p>
</li>
<li>
<p>定数 (Visual Basic for Applications)</p>
</li>
</ul>
</div>
</div>
<div class="sect4">
<h5 id="_drivetype_定数">37.2.1.8. DriveType 定数</h5>
<div class="paragraph">
<p>この定数は、この定数の定義を含む適切なタイプ ライブラリがプロジェクトで明示的
に参照される場合にのみ使用できます。</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 28.5714%;">
<col style="width: 14.2857%;">
<col style="width: 57.1429%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">定数</th>
<th class="tableblock halign-left valign-top">値</th>
<th class="tableblock halign-left valign-top">説明</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Unknown</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">ドライブの種類を特定できません。</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Removable</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">ドライブにリムーバブル メディアがあります。 これには、すべてのフロッピー ドライブと他のさまざまな種類のストレージ デバイスが含まれます。</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Fixed</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">2</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">ドライブに、固定 (取り外しできない) メディアがあります。 これには、取り外し可能なハード ドライブを含むすべてのハード ドライブが含まれます。</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Remote</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">3</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">ネットワーク ドライブです。 これには、ネットワーク上のどこでも共有できるドライブが含まれます。</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">CDROM</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">4</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">ドライブは、CD-ROM です。 読み取り専用 CD-ROM ドライブと、読み取り/書き込み可能な CD-ROM ドライブの区別はされません。</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">RAMDisk</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">5</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">ディスク ドライブのように動作するローカル コンピューター上のランダム アクセス メモリ (RAM) のブロックによるドライブです。</p></td>
</tr>
</tbody>
</table>
<div class="literalblock">
<div class="title">関連項目</div>
<div class="content">
<pre>定数 (Visual Basic for Applications)</pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="_file_attribute定数">37.2.1.9. File Attribute定数</h5>
<div class="paragraph">
<p>この定数は、この定数の定義を含む適切なタイプ ライブラリがプロジェクトで明示的
に参照される場合にのみ使用できます。</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 28.5714%;">
<col style="width: 14.2857%;">
<col style="width: 57.1429%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">定数</th>
<th class="tableblock halign-left valign-top">値</th>
<th class="tableblock halign-left valign-top">説明</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Normal</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">標準のファイル。 属性は設定されません。</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">ReadOnly</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">読み取り専用ファイル。 属性は、読み取り/書き込み可能です。</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Hidden</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">2</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">隠しファイル。 属性は、読み取り/書き込み可能です。</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">System</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">4</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">システム ファイル。 属性は、読み取り/書き込み可能です。</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Volume</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">8</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">ディスク ドライブのボリューム ラベル。 属性は読み取り専用です。</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Directory</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">16</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">フォルダーまたはディレクトリ。 属性は読み取り専用です。</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Archive</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">32</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">前回のバックアップ以降に変更されているファイル。 属性は、読み取り/書き込み可能です。</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Alias</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">64</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">リンクまたはショートカット。 属性の値の取得のみ可能です。</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Compressed</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">128</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">圧縮ファイル。 属性は読み取り専用です。</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<div class="title">関連項目</div>
<p>定数 (Visual Basic for Applications)</p>
</div>
</div>
<div class="sect4">
<h5 id="_file_inputoutput定数">37.2.1.10. File Input/Output定数</h5>
<div class="paragraph">
<p>この定数は、この定数の定義を含む適切なタイプ ライブラリがプロジェクトで明示的
に参照される場合にのみ使用できます。</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 28.5714%;">
<col style="width: 14.2857%;">
<col style="width: 57.1429%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">定数</th>
<th class="tableblock halign-left valign-top">値</th>
<th class="tableblock halign-left valign-top">説明</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">ForReading</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">ファイルを読み取り専用として開きます。 このファイルには書き込むことはできません。</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">ForWriting</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">2</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">ファイルを書き込み用として開きます。 同じ名前のファイルが既に存在する場合、以前の内容が上書きされます。</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">ForAppending</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">8</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">ファイルを開き、ファイルの最後に書き込みます。</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<div class="title">関連項目</div>
<p>定数 (Visual Basic for Applications)</p>
</div>
</div>
<div class="sect4">
<h5 id="_form_定数">37.2.1.11. Form 定数</h5>
<div class="paragraph">
<p>次の定数は、コード内の任意の場所で実際の値の代わりに使用できます。</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 28.5714%;">
<col style="width: 14.2857%;">
<col style="width: 57.1429%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">定数</th>
<th class="tableblock halign-left valign-top">値</th>
<th class="tableblock halign-left valign-top">説明</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">vbModeless</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">UserForm はモードレスです。</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">vbModal</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">UserForm はモーダルです (既定値)。</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<div class="title">関連項目</div>
<p>定数 (Visual Basic for Applications)</p>
</div>
</div>
<div class="sect4">
<h5 id="_imestatus_定数">37.2.1.12. IMEStatus 定数</h5>
<div class="paragraph">
<p>次の定数は、コード内の任意の場所で実際の値の代わりに使用できます。</p>
</div>
<div class="paragraph">
<p>日本語のロケールの定数は次のとおりです。</p>
</div>
<div class="paragraph">
<p>テーブル 1</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 44.4444%;">
<col style="width: 11.1111%;">
<col style="width: 44.4445%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">定数</th>
<th class="tableblock halign-left valign-top">値</th>
<th class="tableblock halign-left valign-top">説明</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">vbIMEModeNoControl</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">IME を制御しません (既定)</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">vbIMEModeOn</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">IME をオンにします。</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">vbIMEModeOff</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">2</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">IME がオフ</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">vbIMEModeDisable</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">3</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">IME は無効になっています。</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">vbIMEModeHiragana</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">4</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">全角ひらがなモードです。</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">vbIMEModeKatakana</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">5</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">全角カタカナ モードです。</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">vbIMEModeKatakanaHalf</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">6</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">半角カタカナ モードです。</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">vbIMEModeAlphaFull</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">7</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">全角英数字モードです。</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">vbIMEModeAlpha</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">8</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">半角英数字モードです。</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>韓国語のロケールの定数値は次のとおりです。</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 44.4444%;">
<col style="width: 11.1111%;">
<col style="width: 44.4445%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">定数</th>
<th class="tableblock halign-left valign-top">値</th>
<th class="tableblock halign-left valign-top">説明</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">vbIMEModeNoControl</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">IME を制御しません (既定値)。</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">vbIMEModeAlphaFull</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">7</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">全角英数字モードです。</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">vbIMEModeAlpha</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">8</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">半角英数字モード</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">vbIMEModeHangulFull</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">9</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">全角ハングル モードです。</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">vbIMEModeHangul</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">10</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">半角ハングル モードです。</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>中国語のロケールの定数値は次のとおりです。</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 44.4444%;">
<col style="width: 11.1111%;">
<col style="width: 44.4445%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">定数</th>
<th class="tableblock halign-left valign-top">値</th>
<th class="tableblock halign-left valign-top">説明</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">vbIMEModeNoControl</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">IME を制御しません (既定)</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">vbIMEModeOn</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">IME をオンにします。</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">vbIMEModeOff</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">2</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">IME をオフにします。</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<div class="title">関連項目</div>
<p>定数 (Visual Basic for Applications)</p>
</div>
</div>
<div class="sect4">
<h5 id="_keycode_定数">37.2.1.13. Keycode 定数</h5>
<div class="paragraph">
<p>次の定数は、コード内の任意の場所で実際の値の代わりに使用できます。</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 22. Keycode 定数</caption>
<colgroup>
<col style="width: 44.4444%;">
<col style="width: 11.1111%;">
<col style="width: 44.4445%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">定数</th>
<th class="tableblock halign-left valign-top">値</th>
<th class="tableblock halign-left valign-top">説明</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">VBKeyLButton</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0x1</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">左マウス ボタン</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">VBKeyRButton</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0x2</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">右マウス ボタン</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">VBKeyCancel</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0x3</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Cancel キー</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">VBKeyMButton</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0x4</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">マウスの中央ボタン</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">VBKeyBack</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0x8</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Backspace</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">VBKeyTab</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0x9</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Tab キー</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">VBKeyClear</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0xC</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Clear</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">VBKeyReturn</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0xD</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Enter</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">VBKeyShift</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0x10</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Shift キーが押されました。</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">VBKeyControl</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0x11</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Ctrl キーが押されました。</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">VBKeyMenu</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0x12</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">メニュー キー</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">VBKeyPause</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0x13</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Pause</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">VBKeyCapital</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0x14</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Caps Lock</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">VBKeyEscape</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0x1B</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Esc キー</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">VBKeySpace</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0x20</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Space キー</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">VBKeyPageUp</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0x21</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">PageUp</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">VBKeyPageDown</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0x22</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">PageDown</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">VBKeyEnd</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0x23</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">End</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">VBKeyHome</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0x24</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Home</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">VBKeyLeft</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0x25</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">←</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">VBKeyUp</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0x26</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">↑</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">VBKeyRight</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0x27</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">→</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">VBKeyDown</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0x28</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">↓</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">VBKeySelect</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0x29</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Select</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">VBKeyPrint</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0x2A</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">PrintScreen</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">VBKeyExecute</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0x2B</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Execute</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">VBKeySnapshot</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0x2C</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Snapshot キー</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">VBKeyInsert</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0x2D</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Insert キー</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">VBKeyDelete</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0x2E</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Delete キー</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">VBKeyHelp</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0x2F</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Help</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">VBKeyNumlock</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0x90</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Num Lock</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<div class="title">キーと Z キー</div>
<p>A キーから Z キーは、ASCII の A から Z と同じです。</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 44.4444%;">
<col style="width: 11.1111%;">
<col style="width: 44.4445%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">定数</th>
<th class="tableblock halign-left valign-top">値</th>
<th class="tableblock halign-left valign-top">説明</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">vbKeyA</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">65</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">A キー</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">vbKeyB</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">66</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">B キー</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">vbKeyC</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">67</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">C キー</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">vbKeyD</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">68</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">D キー</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">vbKeyE</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">69</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">E キー</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">vbKeyF</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">70</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">F キー</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">vbKeyG</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">71</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">G キー</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">vbKeyH</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">72</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">H キー</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">vbKeyI</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">73</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">I キー</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">vbKeyJ</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">74</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">J キー</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">vbKeyK</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">75</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">K キー</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">vbKeyL</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">76</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">L キー</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">vbKeyM</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">77</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">M キー</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">vbKeyN</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">78</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">N キー</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">vbKeyO</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">79</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">O キー</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">vbKeyP</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">80</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">P キー</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">vbKeyQ</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">81</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Q キー</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">vbKeyR</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">82</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">R キー</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">vbKeyS</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">83</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">S キー</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">vbKeyT</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">84</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">T キー</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">vbKeyU</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">85</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">U キー</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">vbKeyV</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">86</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">V キー</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">vbKeyW</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">87</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">W キー</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">vbKeyX</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">88</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">X キー</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">vbKeyY</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">89</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Y キー</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">vbKeyZ</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">90</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Z キー</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<div class="title">0キー-9 キー</div>
<p>0 キーから 9 キーは ASCII の 0 から 9 と同じです。</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 44.4444%;">
<col style="width: 11.1111%;">
<col style="width: 44.4445%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">定数</th>
<th class="tableblock halign-left valign-top">値</th>
<th class="tableblock halign-left valign-top">説明</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">vbKey0</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">48</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0 キー</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">vbKey1</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">49</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1 キー</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">vbKey2</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">50</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">2 キー</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">vbKey3</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">51</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">3 キー</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">vbKey4</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">52</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">4 キー</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">vbKey5</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">53</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">5 キー</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">vbKey6</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">54</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">6 キー</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">vbKey7</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">55</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">7 キー</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">vbKey8</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">56</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">8 キー</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">vbKey9</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">57</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">9 キー</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<div class="title">テンキーキー</div>
<p>次の定数は、テンキーのキーを表します。</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 44.4444%;">
<col style="width: 11.1111%;">
<col style="width: 44.4445%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">定数</th>
<th class="tableblock halign-left valign-top">値</th>
<th class="tableblock halign-left valign-top">説明</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">vbKeyNumpad0</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0x60</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0 キー</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">vbKeyNumpad1</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0x61</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1 キー</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">vbKeyNumpad2</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0x62</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">2 キー</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">vbKeyNumpad3</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0x63</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">3 キー</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">vbKeyNumpad4</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0x64</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">4 キー</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">vbKeyNumpad5</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0x65</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">5 キー</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">vbKeyNumpad6</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0x66</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">6 キー</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">vbKeyNumpad7</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0x67</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">7 キー</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">vbKeyNumpad8</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0x68</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">8 キー</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">vbKeyNumpad9</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0x69</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">9 キー</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">vbKeyMultiply</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0x6A</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">乗算記号 (*) キー</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">vbKeyAdd</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0x6B</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">加算記号 (+) キー</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">vbKeySeparator</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0x6C</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Enter</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">vbKeySubtract</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0x6D</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">減算記号 (-) キー</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">vbKeyDecimal</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0x6E</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">小数点 (.) キー</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">vbKeyDivide</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0x6F</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">除算記号 (/) キー</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<div class="title">ファンクションキー</div>
<p>次の定数は、ファンクション キーを表します。</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 44.4444%;">
<col style="width: 11.1111%;">
<col style="width: 44.4445%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">定数</th>
<th class="tableblock halign-left valign-top">値</th>
<th class="tableblock halign-left valign-top">説明</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">vbKeyF1</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0x70</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">F1 キー</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">vbKeyF2</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0x71</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">F2 キー</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">vbKeyF3</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0x72</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">F3 キー</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">vbKeyF4</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0x73</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">F4 キー</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">vbKeyF5</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0x74</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">F5 キー</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">vbKeyF6</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0x75</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">F6 キー</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">vbKeyF7</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0x76</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">F7 キー</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">vbKeyF8</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0x77</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">F8 キー</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">vbKeyF9</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0x78</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">F9 キー</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">vbKeyF10</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0x79</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">F10 キー</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">vbKeyF11</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0x7A</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">F11 キー</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">vbKeyF12</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0x7B</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">F12 キー</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">vbKeyF13</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0x7C</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">F13 キー</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">vbKeyF14</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0x7D</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">F14 キー</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">vbKeyF15</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0x7E</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">F15 キー</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">vbKeyF16</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0x7F</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">F16 キー</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>関連項目</p>
</div>
<div class="paragraph">
<p>定数 (Visual Basic for Applications)</p>
</div>
</div>
<div class="sect4">
<h5 id="_その他の定数">37.2.1.14. その他の定数</h5>
<div class="paragraph">
<p>以下の定数は、Visual Basic for Applications のタイプ ライブラリで定義されてお
り、コードの任意の場所で実際の値の代わりに使用できます。</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 28.5714%;">
<col style="width: 14.2857%;">
<col style="width: 57.1429%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">定数</th>
<th class="tableblock halign-left valign-top">値</th>
<th class="tableblock halign-left valign-top">説明</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">vbCrLf</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Chr(13) + Chr(10)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">キャリッジ リターンとライン フィードの組み合わせ</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">vbCr</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Chr(13)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">キャリッジ リターン文字</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">vbLf</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Chr(10)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">ライン フィード文字</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">vbNewLine</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Chr(13) + Chr(10)。Macintosh の場合は、Chr(13)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">プラットフォーム固有の改行文字。現在のプラットフォームに対応する文字が使用されます。</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">vbNullChar</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Chr(0)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">値 0 を持つ文字</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">vbNullString</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">値が 0 の文字列</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">長さ 0 の文字列 ("") とは異なります。外部プロシージャの呼び出しに使用されます。</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">vbObjectError</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">-2147221504</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">ユーザー定義のエラー番号は、この値より大きい値である必要があります。 次に例を示します。+
Err.Raise Number = vbObjectError + 1000</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">vbTab</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Chr(9)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">タブ文字</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">vbBack</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Chr(8)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">バックスペース文字</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">vbFormFeed</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Chr(12)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Microsoft Windows または Macintosh では使用しません。</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">vbVerticalTab</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Chr(11)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Microsoft Windows または Macintosh では役に立たない</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>関連項目</p>
</div>
<div class="paragraph">
<p>定数 (Visual Basic for Applications)</p>
</div>
</div>
<div class="sect4">
<h5 id="_msgbox_定数">37.2.1.15. MsgBox 定数</h5>
<div class="paragraph">
<p>次の定数は、コード内の任意の場所で実際の値の代わりに使用できます。</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 23. MsgBox の引数</caption>
<colgroup>
<col style="width: 44.4444%;">
<col style="width: 11.1111%;">
<col style="width: 44.4445%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">定数</th>
<th class="tableblock halign-left valign-top">値</th>
<th class="tableblock halign-left valign-top">説明</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">vbOKOnly</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">[ OK ] ボタンのみ (既定値)</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">vbOKCancel</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">[OK] ボタンと [キャンセル] ボタン</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">vbAbortRetryIgnore</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">2</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">[ 中止 ]、[ 再試行 ]、[ 無視 ] の各ボタン</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">vbYesNoCancel</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">3</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">[ はい ]、[ いいえ ]、[ キャンセル ] の各ボタン</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">vbYesNo</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">4</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">[ はい ] ボタンと [ いいえ ] ボタン</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">vbRetryCancel</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">5</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">[ 再試行 ] ボタンと [ キャンセル ] ボタン</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">vbCritical</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">16</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">重大なメッセージ</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">vbQuestion</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">32</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">警告クエリ</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">vbExclamation</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">48</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">警告メッセージ</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">vbInformation</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">64</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">情報メッセージ</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">vbDefaultButton1</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">.0</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1 番目のボタンが既定 (既定値)</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">vbDefaultButton2</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">256</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">2 番目のボタンが既定</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">vbDefaultButton3</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">512</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">3 番目のボタンが既定</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">vbDefaultButton4</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">768</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">4 番目のボタンが既定</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">vbApplicationModal</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">.0</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">アプリケーションのモーダル メッセージ ボックス (既定値)</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">vbSystemModal</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">4096</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">システムのモーダル メッセージ ボックス</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">vbMsgBoxHelpButton</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">16384</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">メッセージ ボックスに [ヘルプ] ボタンを追加する</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">VbMsgBoxSetForeground</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">65536</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">メッセージ ボックス ウィンドウを手前のウィンドウにする</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">vbMsgBoxRight</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">524288</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">テキストを右揃えにする</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">vbMsgBoxRtlReading</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1048576</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">ヘブライ語とアラビア語のシステムでテキストが右から左に読む形式で表示されるようにする</p></td>
</tr>
</tbody>
</table>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 24. MsgBox の戻り値</caption>
<colgroup>
<col style="width: 44.4444%;">
<col style="width: 11.1111%;">
<col style="width: 44.4445%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">定数</th>
<th class="tableblock halign-left valign-top">値</th>
<th class="tableblock halign-left valign-top">説明</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">vbOK</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">[ OK ] ボタンが押された</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">vbCancel</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">2</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">[ キャンセル ] ボタンが押された</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">vbAbort</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">3</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">[ 中止 ] ボタンが押された</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">vbRetry</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">4</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">[ 再試行 ] ボタンが押された</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">vbIgnore</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">5</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">[ 無視 ] ボタンが押された</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">vbYes</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">6</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">[ はい ] ボタンが押された</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">vbNo</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">7</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">[いいえ] ボタンが押された</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<div class="title">関連項目</div>
<p>定数 (Visual Basic for Applications)</p>
</div>
</div>
<div class="sect4">
<h5 id="_queryclose_定数">37.2.1.16. QueryClose 定数</h5>
<div class="paragraph">
<p>次の定数は、コード内の任意の場所で実際の値の代わりに使用できます。</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 25. QueryClose 定数</caption>
<colgroup>
<col style="width: 44.4444%;">
<col style="width: 11.1111%;">
<col style="width: 44.4445%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">定数</th>
<th class="tableblock halign-left valign-top">値</th>
<th class="tableblock halign-left valign-top">説明</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">vbFormControlMenu</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">.0</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">ユーザーが、フォームのコントロールメニューで [閉じる] コマンドを選択しました。</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">vbFormCode</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1-d</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">コードから Unload ステートメントが呼び出されます。</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">vbAppWindows</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">pbm-2</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">現在の Microsoft Windows オペレーティング環境のセッションが終了しまします。</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">vbAppTaskManager</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1/3</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Windows タスク マネージャーがアプリケーションを閉じようとしています。</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<div class="title">関連項目</div>
<p>定数 (Visual Basic for Applications)</p>
</div>
</div>
<div class="sect4">
<h5 id="_shell_定数">37.2.1.17. shell 定数</h5>
<div class="paragraph">
<p>次の定数は、コード内の任意の場所で実際の値の代わりに使用できます。</p>
</div>
<div class="paragraph">
<p>シェル定数</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 44.4444%;">
<col style="width: 11.1111%;">
<col style="width: 44.4445%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">定数</th>
<th class="tableblock halign-left valign-top">値</th>
<th class="tableblock halign-left valign-top">説明</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">vbHide</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">ウィンドウは非表示で、フォーカスは非表示ウィンドウに渡されます。</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">vbNormalFocus</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">ウィンドウがフォーカスを持ち、元のサイズと位置に復元されます。</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">vbMinimizedFocus</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">2</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">ウィンドウがフォーカスを持ってアイコンとして表示されます。</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">vbMaximizedFocus</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">3</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">ウィンドウがフォーカスを持って最大化されます。</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">vbNormalNoFocus</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">4</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">ウィンドウは、最新のサイズと位置に復元されます。 現在アクティブなウィンドウはアクティブのままです。</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">vbMinimizedNoFocus</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">6</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">ウィンドウはアイコンとして表示されます。 現在アクティブなウィンドウはアクティブのままです。</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>Macintosh では、vbNormalFocus、vbMinimizedFocus、vbMaximizedFocus はすべて、ア
プリケーションをフォアグラウンドに配置します。vbHide、vbNoFocus、
vbMinimizedFocus はすべて、アプリケーションをバックグラウンドに配置します。</p>
</div>
<div class="paragraph">
<div class="title">関連項目</div>
<p>定数 (Visual Basic for Applications)</p>
</div>
</div>
<div class="sect4">
<h5 id="_specialfolder_定数">37.2.1.18. SpecialFolder 定数</h5>
<div class="paragraph">
<p>この定数は、この定数の定義を含む適切なタイプ ライブラリがプロジェクトで明示的
に参照される場合にのみ使用できます。</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 26. SpecialFolder 定数</caption>
<colgroup>
<col style="width: 44.4444%;">
<col style="width: 11.1111%;">
<col style="width: 44.4445%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">定数</th>
<th class="tableblock halign-left valign-top">値</th>
<th class="tableblock halign-left valign-top">説明</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">WindowsFolder</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Windows オペレーティング システムによってインストールされたファイルが格納されている Windows フォルダー。</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">SystemFolder</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">ライブラリ、フォント、およびデバイス ドライバーが格納されている System フォルダー。</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">TemporaryFolder</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">2</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">一時ファイルの格納に使用される Temp フォルダー。 このパスは TMP 環境変数で指定されています。</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<div class="title">関連項目</div>
<p>定数 (Visual Basic for Applications)</p>
</div>
</div>
<div class="sect4">
<h5 id="_strconv_定数">37.2.1.19. StrConv 定数</h5>
<div class="paragraph">
<p>次の定数は、コード内の任意の場所で実際の値の代わりに使用できます。</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 27. StrConv 定数</caption>
<colgroup>
<col style="width: 44.4444%;">
<col style="width: 11.1111%;">
<col style="width: 44.4445%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">定数</th>
<th class="tableblock halign-left valign-top">値</th>
<th class="tableblock halign-left valign-top">説明</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">vbUpperCase</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">文字列を大文字に変換します。</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">vbLowerCase</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">2</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">文字列を小文字に変換します。</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">vbProperCase</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">3</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">文字列のすべての単語の最初の文字を大文字に変換します。</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">vbWide</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">4</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">文字列の半角 (1 バイト) 文字を全角 (2 バイト) 文字に変換します。 東アジア ロケールに適用されます。</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">vbNarrow</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">8</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">文字列の全角 (2 バイト) 文字を半角 (1 バイト) 文字に変換します。 東アジア ロケールに適用されます。</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">vbKatakana</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">16</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">文字列のひらがなをカタカナに変換します。 日本のみに適用されます。</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">vbHiragana</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">32</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">文字列のカタカナをひらがなに変換します。 日本のみに適用されます。</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">vbUnicode</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">64</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">システムの既定のコード ページを使用して文字列を Unicode に変換します (Macintosh では使用できません)。</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">vbFromUnicode</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">128</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">文字列を Unicode からシステムの既定のコード ページに変換します (Macintosh では使用できません)。</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<div class="title">関連項目</div>
<p>定数 (Visual Basic for Applications)</p>
</div>
</div>
<div class="sect4">
<h5 id="_system_color_定数">37.2.1.20. system color 定数</h5>
<div class="paragraph">
<p>次の定数は、コード内の任意の場所で実際の値の代わりに使用できます。</p>
</div>
<div class="paragraph">
<p>システムカラー定数</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 44.4444%;">
<col style="width: 11.1111%;">
<col style="width: 44.4445%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">定数</th>
<th class="tableblock halign-left valign-top">値</th>
<th class="tableblock halign-left valign-top">説明</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">vbScrollBars</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0x80000000</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">スクロール バーの色</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">vbDesktop</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0x80000001</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">デスクトップの色</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">vbActiveTitleBar バー</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0x80000002</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">アクティブ ウィンドウのタイトル バーの色</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">vbInactiveTitleBar バー</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0x80000003</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">非アクティブ ウィンドウのタイトル バーの色</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">vbMenuBar</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0x80000004</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">メニューの背景色</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">vbWindowBackground</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0x80000005</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">ウィンドウの背景色</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">vbWindowFrame</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0x80000006</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">ウィンドウ枠の色</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">vbMenuText</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0x80000007</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">メニューの文字色</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">vbWindowText</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0x80000008</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">ウィンドウの文字色</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Vbタイトルバーテキスト</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0x80000009</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">キャプション、サイズ ボックス、およびスクロール矢印の文字色</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">vbActiveBorder</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0x8000000A</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">アクティブ ウィンドウの境界線の色</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">vbInactiveBorder</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0x8000000B</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">非アクティブ ウィンドウの境界線の色</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">vbApplicationWorkspace</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0x8000000C</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">マルチドキュメント インターフェイス (MDI) アプリケーションの背景色</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">vbHighlight 表示</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0x8000000D</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">コントロールで選択されているアイテムの背景色</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">vbHighlightText</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0x8000000E</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">コントロールで選択されているアイテムの文字色</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">vbButtonFace</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0x8000000F</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">コマンド ボタンの表面の網掛けの色</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">vbButtonShadow</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0x80000010</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">コマンド ボタンの端の網掛けの色</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Vbグレーのテキスト</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0x80000011</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">単色表示の (無効な) 文字</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">vbButtonText</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0x80000012</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">プッシュ ボタンの文字色</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">vbInactiveCaptionText</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0x80000013</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">非アクティブなキャプションの文字色</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">vb3DHighlight</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0x80000014</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">3D 表示の強調表示色</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">vb3DDKShadow</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0x80000015</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">3D 表示で最も濃い影に使用する色</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">vb3DLight</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0x80000016</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">3D 表示で使用する vb3DHighlight の次に明るい色</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Vbinテキスト</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0x80000017</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">ツール ヒントの文字色</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">vbInfoBackground</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0x80000018</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">ツール ヒントの背景色</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<div class="title">関連項目</div>
<p>定数 (Visual Basic for Applications)</p>
</div>
</div>
<div class="sect4">
<h5 id="_tristate_定数">37.2.1.21. Tristate 定数</h5>
<div class="paragraph">
<p>この定数は、この定数の定義を含む適切なタイプ ライブラリがプロジェクトで明示的
に参照される場合にのみ使用できます。</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 33.3333%;">
<col style="width: 33.3334%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">定数</th>
<th class="tableblock halign-left valign-top">値</th>
<th class="tableblock halign-left valign-top">説明</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">vbTrue</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">-1</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">True</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">vbFalse</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">;0</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">False</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">vbUseDefault</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">-2</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">既定の設定を使用</p></td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_データ型の概要_microsoft_docs">37.3. <a href="https://docs.microsoft.com/ja-jp/office/vba/language/reference/user-interface-help/data-type-summary">データ型の概要 | Microsoft Docs</a><a id="データ型の概要"></a></h3>
<div class="paragraph">
<p>データ型は、保持できるデータの種類を決定する変数の特性です。 データ型には、次
の表で示されているもの、ユーザー定義型、およびオブジェクトに固有の型が含まれま
す。</p>
</div>
<div class="paragraph">
<p>組み込みのデータ型を設定する</p>
</div>
<div class="paragraph">
<p>次の表では、サポートされる データ型および記憶域のサイズと範囲を示します。
組み込みのデータ型を設定する</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 33.3333%;">
<col style="width: 33.3334%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">データ型</th>
<th class="tableblock halign-left valign-top">記憶領域サイズ</th>
<th class="tableblock halign-left valign-top">範囲</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Boolean</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">2 バイト</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">True または False</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Byte</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1 バイト</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0 ～ 255</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Collection</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">不明</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">不明</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Currency (スケーリングされた整数)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">8 バイト</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">-922,337,203,685,477.5808 ～ 922,337,203,685,477.5807</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Date</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">8 バイト</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">100 年 1 月 1 日 から 9999 年 12 月 31 日</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Decimal</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">14 バイト</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">+/-79,228,162,514,264,337,593,543,950,335 (小数点なし)<br>
+/-7.9228162514264337593543950335 (小数点以下 28 桁)<br>
<br>
+/-0.0000000000000000000000000001 (0 ではない最小の値)<br></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Dictionary</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">不明</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">不明</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Double (倍精度浮動小数点数)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">8 バイト</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">-1.79769313486231E308 から-4.94065645841247E-324 (負の値)<br>
<br>
4.94065645841247E-324 から 1.79769313486232E308 (正の値)</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Integer</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">2 バイト</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">-32,768 〜 32,767</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Long (Long 整数)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">4 バイト</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">-2,147, 483,648 〜 2,147, 483,647</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">LongLong (LongLong 整数)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">8 バイト</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">-9,223,372,036,854,775,808 から 9,223,372, 036,854,775,807<br>
<br>
<span class="red">64 ビット プラットフォームでのみ有効。</span></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">LongPtr (32 ビット システムでは Long 整数、64 ビット システムでは LongLong 整数)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">32 ビット システムでは 4 バイト<br>
<br>
64 ビット システムでは 8 バイト</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">-2,147,483,648 から 2,147,483,647 (32 ビットシステム)<br>
<br>
-9,223,372,036,854,775,808 から 9,223,372,036,854,775,807 (64 ビット システム)</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Object</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">4 バイト</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">任意の Object 参照</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Single (単精度浮動小数点数)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">4 バイト</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">-3.402823E38 から -1.401298E-45 (負の値)<br>
<br>
1.401298E-45 から 3.402823E38 (正の値)</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">String (可変長)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">10 バイト + 文字列の長さ</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0 〜 約 20 億</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">文字列型 (String) (固定長)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">文字列の長さ</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1 〜 約 65,400</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Variant (数値)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">16 バイト</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">最大で Double の範囲までの任意の数値</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">バリアント型 (Variant) (文字)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">22 バイト + 文字列長 (64 ビット システムでは 24 バイト)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">可変長 文字列型 と同じ範囲</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">ユーザー定義 (Type を使用)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">要素に必要な数</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">各要素の範囲は、そのデータ型の範囲と同じです。</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<div class="title">データ型を変換する</div>
<p>式を特定のデータ型に強制変換する次の関数の使用方法の例については、「データ型変
換関数」をご覧ください。CBool、CByte、CCur、CDate、CDbl、CDec、CInt、CLng、
CLngLng、CLngPtr、CSng、CStr、CVar。</p>
</div>
<div class="paragraph">
<p>次の各関数については、それぞれのページをご覧ください。CVErr、Fix、Int。</p>
</div>
<div class="admonitionblock warning">
<table>
<tr>
<td class="icon">
<i class="fa icon-warning" title="Warning"></i>
</td>
<td class="content">
CLngLng は、64 ビット プラットフォームでのみ有効です。
</td>
</tr>
</table>
</div>
<div class="paragraph">
<div class="title">データ型を確認する</div>
<p>データ型を確認するには、以下の関数をご覧ください。</p>
</div>
<div class="ulist">
<ul>
<li>
<p>IsArray</p>
</li>
<li>
<p>IsDate</p>
</li>
<li>
<p>IsEmpty</p>
</li>
<li>
<p>IsError</p>
</li>
<li>
<p>IsMissing</p>
</li>
<li>
<p>IsNull</p>
</li>
<li>
<p>IsNumeric</p>
</li>
<li>
<p>IsObject</p>
</li>
</ul>
</div>
<div class="literalblock">
<div class="title">CStr の戻り値</div>
<div class="content">
<pre> expression の値
CStr の戻り値</pre>
</div>
</div>
<div class="paragraph">
<p>:-----------------
:-----------</p>
</div>
<div class="paragraph">
<p>Boolean
True または False を含む文字列。</p>
</div>
<div class="paragraph">
<p>Date
システムの短い日付形式の日付を含む文字列。</p>
</div>
<div class="paragraph">
<p>Empty
長さ 0 の文字列 ("")。</p>
</div>
<div class="paragraph">
<p>Error
Error という単語とエラー番号を含む文字列。</p>
</div>
<div class="paragraph">
<p>Null
実行時エラー。</p>
</div>
<div class="paragraph">
<p>その他の数値
数字を含む文字列。</p>
</div>
<div class="sect3">
<h4 id="_type_conversion_関数type_conversion">37.3.1. Type Conversion 関数[[Type Conversion]]</h4>
<div class="paragraph">
<p>各関数では、式が特定のデータ型に強制的に変換されます。</p>
</div>
<div class="ulist">
<div class="title">構文</div>
<ul>
<li>
<p>CBool(expression)</p>
</li>
<li>
<p>CByte(expression)</p>
</li>
<li>
<p>CCur(expression)</p>
</li>
<li>
<p>CDate(expression)</p>
</li>
<li>
<p>CDbl(expression)</p>
</li>
<li>
<p>CDec(expression)</p>
</li>
<li>
<p>CInt(expression)</p>
</li>
<li>
<p>CLng(expression)</p>
</li>
<li>
<p>CLngLng(expression) (64 ビットのプラットフォームでのみ有効)</p>
</li>
<li>
<p>CLngPtr(expression)</p>
</li>
<li>
<p>CSng(expression)</p>
</li>
<li>
<p>CStr(expression)</p>
</li>
<li>
<p>CVar(expression)</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>必須の expression 引数は、任意の文字列式または数値式です。</p>
</div>
<div class="paragraph">
<div class="title">戻り値の型</div>
<p>次に示すように、戻り値の型は関数名によって異なります。</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 16.6666%;">
<col style="width: 16.6666%;">
<col style="width: 66.6668%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Function</th>
<th class="tableblock halign-left valign-top">戻り値の種類</th>
<th class="tableblock halign-left valign-top">expression 引数の範囲</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">CBool</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Boolean</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">任意の有効な文字列式または数式を指定します。</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">CByte</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Byte</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0 から 255。</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">CCur</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Currency</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">-922,337,203,685,477.5808 ～ 922,337,203,685,477.5807。</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">CDate</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Date</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">任意の有効な日付式。</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">CDbl</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Double</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">負の値の場合は -1.79769313486231E308 ～ -4.94065645841247E-324、正の値の場合は 4.94065645841247E-324 ～ 1.79769313486232E308。</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">CDec</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Decimal</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">ゼロスケールの値 (小数部分がない値) の場合は 79,228,162,514,264,337,593,543,950,335 です。 小数点以下が 28 桁の値の場合は 7.9228162514264337593543950335 です。 0 以外で可能な最小値は 0.0000000000000000000000000001 です。</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">CInt</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Integer</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">-32,768 から 32,767。小数点以下は丸められます。</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">CLng</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Long</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">-2,147,483,648 から 2,147,483,647。小数点以下は丸められます。</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">CLngLng</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">LongLong</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">-9,223,372,036,854,775,808 から 9,223,372,036,854,775,807。小数点以下は丸められます (64 ビット プラットフォームのみで有効)。</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">CLngPtr</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">LongPtr</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">32 ビットのシステムでは -2,147,483,648 ～ 2,147,483,647、64 ビットのシステムでは -9,223,372,036,854,775,808 ～ 9,223,372,036,854,775,807。32 ビットと 64 ビットのどちらのシステムでも、小数部分は丸められます。</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">CSng</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Single</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">負の値の場合は -3.402823E38 ～ -1.401298E-45、正の値の場合は 1.401298E-45 ～ 3.402823E38。</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">CStr</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">String</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">CStr の戻り値は、expression 引数に依存します。</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">CVar</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Variant</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">数値の場合は Double と同じ範囲です。 数値以外の場合は String と同じ範囲です。</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<div class="title">解説</div>
<p>関数に渡した expression 引数の値が変換されるデータ型の範囲を超える場合はエラー
が発生します。</p>
</div>
<div class="admonitionblock warning">
<table>
<tr>
<td class="icon">
<i class="fa icon-warning" title="Warning"></i>
</td>
<td class="content">
LongLong (64 ビットのプラットフォームの LongPtr を含む) をそれ
よりも小さい整数型に明示的に代入するには、変換関数を使用する必要があります。
LongLong をそれよりも小さい整数に暗黙的に変換することはできません。
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>一般に、データ型の変換関数を使用してコードを文書化し、一部の演算の結果が既定の
データ型ではなく、特定のデータ型として表示されるように指定できます。 たとえば、
通常、単精度、倍精度、整数演算が発生する場合、CCur を使用して、通貨換算を強制
的に実行します。</p>
</div>
<div class="paragraph">
<p>国際的に通用する 1 つのデータ型から別のデータ型に変換するには、Val ではなく、
データ型の変換関数を使用する必要があります。 たとえば、CCur を使用すると、使用
しているコンピューターのロケールに応じて、異なる少数点の区切り文字や桁区切り記
号、さまざまな通貨オプションが適切に認識されます。</p>
</div>
<div class="paragraph">
<p>小数点以下が 0.5 の場合、CInt および CLng は、常に一番近い偶数に数値を丸めます。
たとえば、0.5 は 0 に、1.5 は 2 に丸められます。 <a href="#Fix Int">Fix関数とInt関数</a>
は、小数部分を丸めるのではなく切り捨てるので、CInt およびCLngとは異なります。
また、Fix および Int は、常に渡されたのと同じ型の値を返します。</p>
</div>
<div class="paragraph">
<p>date を日付または時刻に変換できるかどうかを確認するには、IsDate 関数を使用しま
す。 CDate では、日付リテラルと時刻リテラルだけでなく、許容範囲内の日付に当て
はまる数字も認識されます。 数字を日付に変換すると、整数全体が日付に変換されま
す。 数字の分数の部分は、午前 12 時を起点にした時刻に変換されます。</p>
</div>
<div class="paragraph">
<p>CDate は、システムのロケール設定に基づいて日付の形式を認識します。 認識されて
いる日付設定以外の書式設定が提供されている場合、日、月、年の順番を正しく決定で
きないことがあります。 さらに、1 週間の文字列が含まれる場合、長い日付の書式設
定は認識されません。</p>
</div>
<div class="paragraph">
<p>Visual Basic の旧バージョンとの互換性のために、CVDate 関数も提供されています。
CVDate 関数の構文は CDate 関数と同じですが、CVDate では、実際の Date 型ではな
く、サブタイプが Date 型である Variant 型が返されます。 組み込みの Date 型が利
用できるようになったため、CVDate を使用する必要がなくなりました。 式を Date に
変換してから Variant に代入することで、同じ処理を行うことができます。 これは、
他のすべての組み込みタイプを同等のバリアント型サブタイプに変換する方法と同じで
す。</p>
</div>
<div class="admonitionblock warning">
<table>
<tr>
<td class="icon">
<i class="fa icon-warning" title="Warning"></i>
</td>
<td class="content">
CDec 関数は独立したデータ型を返しません。値が 10 進型サブタイ
プに変換されたバリアント型を常に返します。
</td>
</tr>
</table>
</div>
<div class="paragraph">
<div class="title">CBool 関数の例</div>
<p>この例では、CBool 関数を使用して、式を Boolean に変換します。 式が 0 以外の値
に評価される場合は CBool から True が返され、それ以外の場合は False が返されま
す。</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-vbscript" data-lang="vbscript">Dim A, B, Check
A = 5: B = 5 ' Initialize variables.
Check = CBool(A = B) ' Check contains True.

A = 0 ' Define variable.
Check = CBool(A) ' Check contains False.</code></pre>
</div>
</div>
<div class="paragraph">
<div class="title">CByte 関数の例</div>
<p>この例では、CByte 関数を使用して、式を Byte に変換します。</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-vbscript" data-lang="vbscript">Dim MyDouble, MyByte
MyDouble = 125.5678 ' MyDouble is a Double.
MyByte = CByte(MyDouble) ' MyByte contains 126.</code></pre>
</div>
</div>
<div class="paragraph">
<div class="title">CCur 関数の例</div>
<p>この例では、CCur 関数を使用して、式を Currency に変換します。</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-vbscript" data-lang="vbscript">Dim MyDouble, MyCurr
MyDouble = 543.214588 ' MyDouble is a Double.
MyCurr = CCur(MyDouble * 2) ' Convert result of MyDouble * 2
 ' (1086.429176) to a
 ' Currency (1086.4292).</code></pre>
</div>
</div>
<div class="paragraph">
<div class="title">CDate 関数の例</div>
<p>この例では CDate 関数を使用し、文字列を日付型に変換します。 一般に、この例で示すように、文字列として日付と時刻をハードコードするのはお勧めしません。 文字列の代わりに、<mark>2/12/1969</mark> や <mark>4:45:23 PM</mark> のような日付リテラルと時刻リテラルを使用してください。</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-vbscript" data-lang="vbscript">Dim MyDate, MyShortDate, MyTime, MyShortTime
MyDate = "February 12, 1969" ' Define date.
MyShortDate = CDate(MyDate) ' Convert to Date data type.

MyTime = "4:35:47 PM" ' Define time.
MyShortTime = CDate(MyTime) ' Convert to Date data type.</code></pre>
</div>
</div>
<div class="paragraph">
<div class="title">CDbl 関数の例</div>
<p>この例では、CDbl 関数を使用して、式を Double に変換します。</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-vbscript" data-lang="vbscript">Dim MyCurr, MyDouble
MyCurr = CCur(234.456784) ' MyCurr is a Currency.
MyDouble = CDbl(MyCurr * 8.2 * 0.01) ' Convert result to a Double.</code></pre>
</div>
</div>
<div class="paragraph">
<div class="title">CDec 関数の例</div>
<p>この例では、CDec 関数を使用して、値を Decimal に変換します。</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-vbscript" data-lang="vbscript">Dim MyDecimal, MyCurr
MyCurr = 10000000.0587 ' MyCurr is a Currency.
MyDecimal = CDec(MyCurr) ' MyDecimal is a Decimal.</code></pre>
</div>
</div>
<div class="paragraph">
<div class="title">CInt 関数の例</div>
<p>この例では、CInt 関数を使用して、値を Integer に変換します。</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-vbscript" data-lang="vbscript">Dim MyDouble, MyInt
MyDouble = 2345.5678 ' MyDouble is a Double.
MyInt = CInt(MyDouble) ' MyInt contains 2346.</code></pre>
</div>
</div>
<div class="paragraph">
<div class="title">CLng 関数の例</div>
<p>この例では、CLng 関数を使用して、値を Long に変換します。</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-vbscript" data-lang="vbscript">Dim MyVal1, MyVal2, MyLong1, MyLong2
MyVal1 = 25427.45: MyVal2 = 25427.55 ' MyVal1, MyVal2 are Doubles.
MyLong1 = CLng(MyVal1) ' MyLong1 contains 25427.
MyLong2 = CLng(MyVal2) ' MyLong2 contains 25428.</code></pre>
</div>
</div>
<div class="paragraph">
<div class="title">CSng 関数の例</div>
<p>この例では、CSng 関数を使用して、値を Single に変換します。</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-vbscript" data-lang="vbscript">Dim MyDouble1, MyDouble2, MySingle1, MySingle2
' MyDouble1, MyDouble2 are Doubles.
MyDouble1 = 75.3421115: MyDouble2 = 75.3421555
MySingle1 = CSng(MyDouble1) ' MySingle1 contains 75.34211.
MySingle2 = CSng(MyDouble2) ' MySingle2 contains 75.34216.</code></pre>
</div>
</div>
<div class="paragraph">
<div class="title">CStr 関数の例</div>
<p>この例では、CStr 関数を使用して、数値を String に変換します。</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-vbscript" data-lang="vbscript">Dim MyDouble, MyString
MyDouble = 437.324 ' MyDouble is a Double.
MyString = CStr(MyDouble) ' MyString contains "437.324".</code></pre>
</div>
</div>
<div class="paragraph">
<div class="title">CVar 関数の例</div>
<p>この例では、CVar 関数を使用して、式を Variant に変換します。</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-vbscript" data-lang="vbscript">Dim MyInt, MyVar
MyInt = 4534 ' MyInt is an Integer.
MyVar = CVar(MyInt &amp; 000) ' MyVar contains the string
 ' 4534000.</code></pre>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_ディレクティブ">37.4. ディレクティブ</h3>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 42.8571%;">
<col style="width: 57.1429%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">コンパイラ ディレクティブ</th>
<th class="tableblock halign-left valign-top">操作</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#Const ディレクティブ">Const ディレクティブ</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">コンパイラ定数を定義します。</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="If&.html#8230;&#8203;Then&#8230;&#8203;Else ディレクティブ">If&#8230;&#8203;Then&#8230;&#8203;Else ディレクティブ</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">選択したコード ブロックをコンパイルします。</p></td>
</tr>
</tbody>
</table>
<div class="sect3">
<h4 id="_const_ディレクティブ">37.4.1. #Const ディレクティブ</h4>
<div class="paragraph">
<p>Visual Basic の 条件付きコンパイラ定数を定義するために使用されます。</p>
</div>
<div class="listingblock">
<div class="title">構文</div>
<div class="content">
<pre class="highlight"><code class="language-vbscript" data-lang="vbscript">#Const constname = expression</code></pre>
</div>
</div>
<div class="paragraph">
<p>#Const コンパイラ ディレクティブの構文には、次の指定項目があります。</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 20%;">
<col style="width: 80%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">パーツ</th>
<th class="tableblock halign-left valign-top">説明</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">constname</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">必須。Variant (String)。 定数の名前です。変数の名前付け規則に従います。</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">expression</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">必須。 リテラル、その他の条件付きコンパイラ定数、またはを除くすべての算術演算子または論理演算子を含む組み合わせ。</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<div class="title">注釈</div>
<p>条件付きコンパイラ定数は常に、定義されているモジュールの Private 定数になりま
す。 #Constディレクティブを使用して、パブリックコンパイラ定数を作成することは
できません。 Public コンパイラ定数は、ユーザー インターフェイスでのみ作成でき
ます。</p>
</div>
<div class="paragraph">
<p>expression で使用できるのは、条件付きコンパイラ定数とリテラルだけです。 Const
を使用して定義された標準の定数を使用したり、未定義の定数を使用したりすると、エ
ラーが発生します。 反対に、 #Const キーワードを使用して定義された定数は、条件
付きコンパイルにのみ使用できます。</p>
</div>
<div class="paragraph">
<p>条件付きコンパイラ定数は、コード内の位置に関わらず、常にモジュール レベルで評
価されます。</p>
</div>
<div class="paragraph">
<div class="title">例</div>
<p>この例では、#Const ディレクティブを使用して、#If&#8230;&#8203;#Else&#8230;&#8203;#End If コンストラ
クトで使用するための条件付きコンパイラ定数を宣言します。</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-vbscript" data-lang="vbscript">#Const DebugVersion = 1 ' Will evaluate true in #If block.</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_ifthenelse_ディレクティブ">37.4.2. #If&#8230;&#8203;Then&#8230;&#8203;#Else ディレクティブ</h4>
<div class="paragraph">
<p>選択した Visual Basic コードのブロックを条件付きでコンパイルします。</p>
</div>
<div class="listingblock">
<div class="title">構文</div>
<div class="content">
<pre class="highlight"><code class="language-vbscript" data-lang="vbscript">#If expression Then
statements
[ #ElseIf expression-n Then
[ elseifstatements ]]
[ #Else
[ elsestatements ]]
#End If</code></pre>
</div>
</div>
<div class="paragraph">
<p>#If&#8230;&#8203;Then&#8230;&#8203;#Else ディレクティブの構文には、次の指定項目があります。</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 28. 構文</caption>
<colgroup>
<col style="width: 20%;">
<col style="width: 80%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">パーツ</th>
<th class="tableblock halign-left valign-top">説明</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">expression</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">必ず指定します。 1 つ以上の条件付きコンパイラ定数、リテラル、および演算子のみで構成された、True または False に評価される任意の式です。</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">statements</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">必須。 関連付けられている式が True の場合に評価される Visual Basic プログラムの行またはコンパイラ ディレクティブです。</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">expression-n</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">省略可能。 1 つ以上の条件付きコンパイラ定数、リテラル、および演算子のみで構成された、True または False に評価される任意の式です。</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">elseifstatements</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">省略可能。 expression-n が True の場合に評価される 1 つ以上のプログラム行またはコンパイラ ディレクティブです。</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">elsestatements</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">省略可能です。 前の expression および expression-n がいずれも True に評価されなかった場合に評価される 1 つ以上のプログラム行またはコンパイラ ディレクティブです。</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<div class="title">解説</div>
<p>#If&#8230;&#8203;Then&#8230;&#8203;#Else ディレクティブの動作は If&#8230;&#8203;Then&#8230;&#8203;Else ステートメントと同
じです。ただし、#If、#Else、#ElseIf、および #End If の各ディレクティブには単一
行の形式がありません。したがって、これらのディレクティブと同じ行に他のコードを
含めることはできません。</p>
</div>
<div class="paragraph">
<p>条件付きコンパイルは、通常、同じプログラムを異なるプラットフォーム用にコンパイ
ルするために使用されます。 また、実行可能なファイルにデバッグ コードが含まれな
いようにするためにも使用されます。 条件付きコンパイルで除外されたコードは、最
終的な実行可能ファイルから完全に削除されるため、サイズやパフォーマンスに影響を
与えることはありません。</p>
</div>
<div class="paragraph">
<p>各評価の結果に関係なく、すべての式が評価されます。 したがって、式で使用されて
いるすべての定数が定義されている必要があります。定義されていない定数は Empty
として評価されます。</p>
</div>
<div class="admonitionblock caution">
<table>
<tr>
<td class="icon">
<i class="fa icon-caution" title="Caution"></i>
</td>
<td class="content">
Option Compare ステートメントは、#If ステートメントと #ElseIf
ステートメントの式には影響を与えません。 条件付きコンパイラ ディレクティブの式
は常に Option Compare Text で評価されます。
</td>
</tr>
</table>
</div>
<div class="paragraph">
<div class="title">例</div>
<p>この例では、#If&#8230;&#8203;Then&#8230;&#8203;#Else コンストラクトで条件付きコンパイラ定数を参照し
て、特定のステートメントをコンパイルするかどうかを決定します。</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-vbscript" data-lang="vbscript">' If Mac evaluates as true, do the statements following the #If.
#If Mac Then
 '. Place exclusively Mac statements here.
 '.
 '.
' Otherwise, if it is a 32-bit Windows program, do this:
#ElseIf Win32 Then
 '. Place exclusively 32-bit Windows statements here.
 '.
 '.
' Otherwise, if it is neither, do this:
#Else
 '. Place other platform statements here.
 '.
 '.
#End If</code></pre>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_イベント_visual_basic_for_applications">37.5. イベント (Visual Basic for Applications)</h3>
<div class="ulist">
<ul>
<li>
<p><a href="#Activate、Deactivate">Activate、Deactivate</a></p>
</li>
<li>
<p><a href="#Initialize">Initialize</a></p>
</li>
<li>
<p><a href="#QueryClose">QueryClose</a></p>
</li>
<li>
<p><a href="#Resize">Resize</a></p>
</li>
<li>
<p><a href="#Terminate">Terminate</a></p>
</li>
</ul>
</div>
<div class="sect3">
<h4 id="_activate_イベントdeactivate_イベントactivatedeactivate">37.5.1. Activate イベント、Deactivate イベント[[Activate、Deactivate]]</h4>
<div class="paragraph">
<p>Activate イベントは、オブジェクトがアクティブ ウィンドウになると発生します。
Deactivate イベントは、オブジェクトがアクティブ ウィンドウでなくなると発生しま
す。</p>
</div>
<div class="listingblock">
<div class="title">構文</div>
<div class="content">
<pre class="highlight"><code class="language-vbscript" data-lang="vbscript">Private Sub object_Activate( )
Private Sub object_Deactivate( )</code></pre>
</div>
</div>
<div class="paragraph">
<p>object のプレースホルダーは、評価結果が [適用先] リストのオブジェクトとなるオ
ブジェクトの式を表します。</p>
</div>
<div class="paragraph">
<div class="title">解説</div>
<p>コードで Show メソッドを使用すると、オブジェクトをアクティブにできます。</p>
</div>
<div class="paragraph">
<p>Activate イベントは、オブジェクトが表示されている場合のみ発生します。 <a href="#Load">Load</a> で
読み込まれた <a href="#_userform">UserForm</a> は、<a href="#Show">Show</a> メソッドを使用しない限り
表示されません。</p>
</div>
<div class="paragraph">
<p>Activate イベントと Deactivate イベントは、アプリケーション内でフォーカスが移
動された場合のみ発生します。 別のアプリケーションで、オブジェクトからまたはオ
ブジェクトにフォーカスが移動されても、いずれのイベントもトリガーされません。</p>
</div>
<div class="paragraph">
<p>Deactivate イベントは、オブジェクトの読み込み解除では発生しません。</p>
</div>
<div class="paragraph">
<div class="title">例</div>
<p>次のコードでは、UserForm1 と UserForm2 の 2 つの UserForm を使用しています。
これらのプロシージャを UserForm1 モジュールにコピーしてから、UserForm2 を追加
します。 UserForm1 のキャプションが、その Activate イベント プロシージャに作成
されます。 ユーザーが UserForm1 のクライアント領域をクリックすると、UserForm2
が読み込まれて表示され、UserForm1 の Deactive イベントがトリガーされ、キャプシ
ョンが変更されます。</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-vbscript" data-lang="vbscript">' Activate event for UserForm1
Private Sub UserForm_Activate()
    UserForm1.Caption = "Click my client area"
End Sub

' Click event for UserForm1
Private Sub UserForm_Click()
    Load UserForm2
    UserForm2.StartUpPosition = 3
    UserForm2.Show
End Sub

' Deactivate event for UserForm1
Private Sub UserForm_Deactivate()
    UserForm1.Caption = "I just lost the focus!"
    UserForm2.Caption = "Focus just left UserForm1 and came to me"
End Sub</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_initialize_イベント">37.5.2. Initialize イベント<a id="Initialize"></a></h4>
<div class="paragraph">
<p>オブジェクトが読み込まれてから表示されるまでに発生します。</p>
</div>
<div class="listingblock">
<div class="title">構文</div>
<div class="content">
<pre class="highlight"><code class="language-vbscript" data-lang="vbscript">Private Subobject_Initialize( )</code></pre>
</div>
</div>
<div class="paragraph">
<p>object プレースホルダーは、[適用対象] リスト内のオブジェクトに評価されるオブジ
ェクト式を表します。</p>
</div>
<div class="paragraph">
<div class="title">解説</div>
<p>通常、Initialize イベントは、アプリケーションまたは UserForm を使用できるよう
に準備するために使用されます。変数には初期値が割り当てられ、コントロールは、初
期化データを収容できるように移動またはサイズ変更される場合があります。</p>
</div>
<div class="paragraph">
<div class="title">例</div>
<p>次の例は、プログラム内に 2 つの UserForm があると仮定しています。 UserForm1 の
Initialize イベントで、UserForm2 が読み込まれて表示されます。 ユーザーが
UserForm2 をクリックすると、UserForm2 は非表示となり、UserForm1 が表示されます。
UserForm1 がクリックされると、UserForm2 が再度表示されます。</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-vbscript" data-lang="vbscript">' This is the Initialize event procedure for UserForm1
Private Sub UserForm_Initialize()
    Load UserForm2
    UserForm2.Show
End Sub
' This is the Click event of UserForm2
Private Sub UserForm_Click()
    UserForm2.Hide
End Sub

' This is the click event for UserForm1
Private Sub UserForm_Click()
    UserForm2.Show
End Sub</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_queryclose_イベント">37.5.3. QueryClose イベント<a id="QueryClose"></a></h4>
<div class="paragraph">
<p>UserForm が閉じる前に発生します。</p>
</div>
<div class="listingblock">
<div class="title">構文</div>
<div class="content">
<pre class="highlight"><code class="language-vbscript" data-lang="vbscript">Private Sub UserForm_QueryClose(Cancel As Integer, CloseMode As Integer)</code></pre>
</div>
</div>
<div class="paragraph">
<p>QueryClose イベントの構文には、次の指定項目があります。</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 20%;">
<col style="width: 80%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">パーツ</th>
<th class="tableblock halign-left valign-top">説明</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Cancel</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">整数。 この引数を 0 以外の値に設定すると、読み込み済みのすべてのユーザー フォームで QueryClose イベントが停止され、UserForm とアプリケーションを閉じられなくなります。</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">CloseMode</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">QueryClose イベントの原因を示す値または定数です。</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<div class="title">戻り値</div>
<p>CloseMode 引数は、次の値を返します。</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 16.6666%;">
<col style="width: 16.6666%;">
<col style="width: 66.6668%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">定数</th>
<th class="tableblock halign-left valign-top">値</th>
<th class="tableblock halign-left valign-top">説明</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">vbFormControlMenu</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">.0</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">ユーザーが、UserForm のコントロールメニューで [閉じる] コマンドを選択しました。</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">vbFormCode</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1-d</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">コードから Unload ステートメントが呼び出されます。</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">vbAppWindows</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">pbm-2</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">現在の Windows オペレーティング環境セッションが終了しようとしています。</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">vbAppTaskManager</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1/3</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Windows タスク マネージャーがアプリケーションを閉じようとしています。</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>これらの定数は、オブジェクト ブラウザーの [Visual Basic for Applications] オブ
ジェクト ライブラリに一覧表示されます。 vbFormMDIForm もオブジェクト ブラウザ
ーで指定されますが、まだサポートされていません。</p>
</div>
<div class="paragraph">
<div class="title">解説</div>
<p>このイベントは通常、アプリケーションが閉じる前に、完了していないタスクがアプリ
ケーションのユーザー フォームに含まれていないかどうかを確認するために使用され
ます。 たとえば、ユーザーが UserForm 内の新しいデータを保存していない場合、デ
ータの保存を求めるプロンプトをアプリケーションで表示できます。</p>
</div>
<div class="paragraph">
<p>アプリケーションが閉じるときに、QueryClose イベント プロシージャを使用して
Cancel プロパティを True に設定することで、閉じるプロセスを停止できます。</p>
</div>
<div class="paragraph">
<div class="title">例</div>
<p>次のコードでは、UserFormクライアント領域をクリックして閉じるようにユーザーに強
制します。 ユーザーがタイトル バーの [閉じる] ボックスを使用しようとすると、
Cancel パラメーターが 0 以外の値に設定され、終了できなくなります。 一方、ユー
ザーがクライアント領域をクリックした場合は、CloseMode の値が 1 となり、Unload
Me が実行されます。</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-vbscript" data-lang="vbscript">Private Sub UserForm_Activate()
    Me.Caption = "You must Click me to kill me!"
End Sub

Private Sub UserForm_Click()
  Unload Me
End Sub

Private Sub UserForm_QueryClose(Cancel As Integer, CloseMode As Integer)
    'Prevent user from closing with the Close box in the title bar.
    If CloseMode &lt;&gt; 1 Then Cancel = 1
    Me.Caption = "The Close box won't work! Click me!"
End Sub</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_resize_イベント">37.5.4. Resize イベント<a id="Resize"></a></h4>
<div class="paragraph">
<p>ユーザー フォームのサイズが変更されると発生します。</p>
</div>
<div class="listingblock">
<div class="title">構文</div>
<div class="content">
<pre class="highlight"><code class="language-vbscript" data-lang="vbscript">Private Sub UserForm_Resize( )</code></pre>
</div>
</div>
<div class="paragraph">
<div class="title">解説</div>
<p>Resize イベント プロシージャを使用すると、親 UserForm のサイズが変更されたとき
に コントロールを移動したりそのサイズを変更したりすることができます。 このイベ
ント プロシージャを使用して、変数やプロパティを再計算することもできます。</p>
</div>
<div class="paragraph">
<div class="title">例</div>
<p>次の例では、Activate イベントと Click イベントを使用して、UserForm の Resize
イベントをトリガーする方法を示しています。 ユーザーがフォームのクライアント領
域をクリックすると、フォームが拡大または縮小してタイトル バーに新しい高さが示
されます。 Tag プロパティを使用して UserForm の最初の高さを格納しています。</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-vbscript" data-lang="vbscript">' Activate event for UserForm1
Private Sub UserForm_Activate()
    UserForm1.Caption = "Click me to make me taller!"
    Tag = Height    ' Save the initial height.
End Sub

' Click event for UserForm1
Private Sub UserForm_Click()
    Dim NewHeight As Single
    NewHeight = Height
    ' If the form is small, make it tall.
    If NewHeight = Val(Tag) Then
        Height = Val(Tag) * 2
    Else
    ' If the form is tall, make it small.
        Height = Val(Tag)
    End If
End Sub

' Resize event for UserForm1
Private Sub UserForm_Resize()
    UserForm1.Caption = "New Height: " &amp; Height &amp; "  " &amp; "Click to resize me!"
End Sub</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_terminate_イベント">37.5.5. Terminate イベント<a id="Terminate"></a></h4>
<div class="paragraph">
<p>オブジェクトを参照するすべての変数が Nothing に設定され、オブジェクトのインス
タンスへの参照がメモリからすべて削除されるか、オブジェクトへの最後の参照がスコ
ープ外になったときに発生します。</p>
</div>
<div class="listingblock">
<div class="title">構文</div>
<div class="content">
<pre class="highlight"><code class="language-vbscript" data-lang="vbscript">Private Sub object_Terminate( )</code></pre>
</div>
</div>
<div class="paragraph">
<p>object のプレースホルダーは、評価結果が [適用先] リストのオブジェクトとなるオ
ブジェクトの式を表します。</p>
</div>
<div class="paragraph">
<div class="title">解説</div>
<p>Terminate イベントは、オブジェクトの読み込み解除後に発生します。 メモリから
UserForm またはクラスのインスタンスが削除された場合、アプリケーションは異常終
了しているため、<strong>Terminate </strong> イベントはトリガーされません。</p>
</div>
<div class="paragraph">
<p>たとえば、クラスまたは UserForm の既存のすべてのインスタンスをメモリから削除す
る前にアプリケーションが End ステートメントを起動した場合、Terminate イベント
はそのクラスまたは UserForm に対してトリガーされません。</p>
</div>
<div class="paragraph">
<div class="title">例</div>
<p>ユーザーがフォームを閉じるためにクライアント領域をクリックすると、次のイベント
プロシージャにより UserForm で警告音が数秒間鳴ります。</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-vbscript" data-lang="vbscript">Private Sub UserForm_Activate()
    UserForm1.Caption = "Click me to kill me!"
End Sub

Private Sub UserForm_Click()
  Unload Me
End Sub

Private Sub UserForm_Terminate()
    Dim Count As Integer
    For Count = 1 To 100
        Beep
    Next
End Sub</code></pre>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_関数_visual_basic_for_applications">37.6. 関数 (Visual Basic for Applications)</h3>
<div class="ulist">
<div class="title">変換関数</div>
<ul>
<li>
<p><a href="#Asc">Asc</a></p>
</li>
<li>
<p><a href="#Chr">Chr</a></p>
</li>
<li>
<p><a href="#CVErr">CVErr</a></p>
</li>
<li>
<p><a href="#Format">Format</a></p>
</li>
<li>
<p>16 進数</p>
</li>
<li>
<p><a href="#Oct">Oct</a></p>
</li>
<li>
<p><a href="#Str">Str</a></p>
</li>
<li>
<p><a href="#Val">Val</a></p>
</li>
</ul>
</div>
<div class="ulist">
<div class="title">数学関数</div>
<ul>
<li>
<p><a href="#Abs">Abs</a></p>
</li>
<li>
<p><a href="#Atn">Atn</a></p>
</li>
<li>
<p><a href="#Cos">Cos</a></p>
</li>
<li>
<p><a href="#Derived Math">Derived Math</a></p>
</li>
<li>
<p><a href="#Exp">Exp</a></p>
</li>
<li>
<p><a href="#Int">Int</a>、<a href="#Fix">Fix</a></p>
</li>
<li>
<p><a href="#Log">Log</a></p>
</li>
<li>
<p><a href="#Rnd">Rnd</a></p>
</li>
<li>
<p><a href="#Sgn">Sgn</a></p>
</li>
<li>
<p><a href="#Sin">Sin</a></p>
</li>
<li>
<p><a href="#Sqr">Sqr</a></p>
</li>
<li>
<p><a href="#Tan">Tan</a></p>
</li>
</ul>
</div>
<div class="ulist">
<div class="title">データ型変換関数</div>
<ul>
<li>
<p>データ型変換関数</p>
</li>
</ul>
</div>
<div class="ulist">
<div class="title">その他の関数</div>
<ul>
<li>
<p><a href="#Array">Array</a></p>
</li>
<li>
<p><a href="#CallByName">CallByName</a></p>
</li>
<li>
<p><a href="#Choose">Choose</a></p>
</li>
<li>
<p><a href="#Command">Command</a></p>
</li>
<li>
<p><a href="#CreateObject">CreateObject</a></p>
</li>
<li>
<p><a href="#CurDir">CurDir</a></p>
</li>
<li>
<p><a href="#Date">Date</a></p>
</li>
<li>
<p><a href="#DateAdd">DateAdd</a></p>
</li>
<li>
<p><a href="#DateDiff">DateDiff</a></p>
</li>
<li>
<p><a href="#DatePart">DatePart</a></p>
</li>
<li>
<p><a href="#DateSerial">DateSerial</a></p>
</li>
<li>
<p><a href="#DateValue">DateValue</a></p>
</li>
<li>
<p><a href="#Day">Day</a></p>
</li>
<li>
<p><a href="#DDB">DDB</a></p>
</li>
<li>
<p><a href="#Dir">Dir</a></p>
</li>
<li>
<p><a href="#DoEvents">DoEvents</a></p>
</li>
<li>
<p><a href="#Environ">Environ</a></p>
</li>
<li>
<p><a href="#EOF">EOF</a></p>
</li>
<li>
<p><a href="#Error">Error</a></p>
</li>
<li>
<p><a href="#FileAttr">FileAttr</a></p>
</li>
<li>
<p><a href="#FileDateTime">FileDateTime</a></p>
</li>
<li>
<p><a href="#FileLen">FileLen</a></p>
</li>
<li>
<p><a href="#Filter">Filter</a></p>
</li>
<li>
<p><a href="#FormatCurrency">FormatCurrency</a></p>
</li>
<li>
<p><a href="#FormatDateTime">FormatDateTime</a></p>
</li>
<li>
<p><a href="#FormatNumber">FormatNumber</a></p>
</li>
<li>
<p><a href="#FormatPercent">FormatPercent</a></p>
</li>
<li>
<p><a href="#FreeFile">FreeFile</a></p>
</li>
<li>
<p><a href="#FV">FV</a></p>
</li>
<li>
<p><a href="#GetAllSettings">GetAllSettings</a></p>
</li>
<li>
<p><a href="#GetAttr">GetAttr</a></p>
</li>
<li>
<p><a href="#GetObject">GetObject</a></p>
</li>
<li>
<p><a href="#GetSetting">GetSetting</a></p>
</li>
<li>
<p><a href="#Hour">Hour</a></p>
</li>
<li>
<p><a href="#IIf">IIf</a></p>
</li>
<li>
<p><a href="#IMEStatus">IMEStatus</a></p>
</li>
<li>
<p><a href="#Input">Input</a></p>
</li>
<li>
<p><a href="#InputBox">InputBox</a></p>
</li>
<li>
<p><a href="#InStr">InStr</a></p>
</li>
<li>
<p><a href="#InStrRev">InStrRev</a></p>
</li>
<li>
<p><a href="#IPmt">IPmt</a></p>
</li>
<li>
<p><a href="#IRR">IRR</a></p>
</li>
<li>
<p><a href="#IsArray">IsArray</a></p>
</li>
<li>
<p><a href="#IsDate">IsDate</a></p>
</li>
<li>
<p><a href="#IsEmpty">IsEmpty</a></p>
</li>
<li>
<p><a href="#IsError">IsError</a></p>
</li>
<li>
<p><a href="#IsMissing">IsMissing</a></p>
</li>
<li>
<p><a href="#IsNull">IsNull</a></p>
</li>
<li>
<p><a href="#IsNumeric">IsNumeric</a></p>
</li>
<li>
<p><a href="#IsObject">IsObject</a></p>
</li>
<li>
<p><a href="#Join">Join</a></p>
</li>
<li>
<p><a href="#LBound">LBound</a></p>
</li>
<li>
<p><a href="#LCase">LCase</a></p>
</li>
<li>
<p><a href="#Left">Left</a></p>
</li>
<li>
<p><a href="#Len">Len</a></p>
</li>
<li>
<p><a href="#Loc">Loc</a></p>
</li>
<li>
<p><a href="#LOF">LOF</a></p>
</li>
<li>
<p><a href="#LTrim">LTrim</a>、<a href="#RTrim">RTrim</a>、および <a href="#Trim">Trim</a></p>
</li>
<li>
<p><a href="#MacID">MacID</a></p>
</li>
<li>
<p><a href="#MacScript">MacScript</a></p>
</li>
<li>
<p><a href="#Mid">Mid</a></p>
</li>
<li>
<p><a href="#Minute">Minute</a></p>
</li>
<li>
<p><a href="#MIRR">MIRR</a></p>
</li>
<li>
<p><a href="#Month">Month</a></p>
</li>
<li>
<p><a href="#MonthName">MonthName</a></p>
</li>
<li>
<p><a href="#MsgBox">MsgBox</a></p>
</li>
<li>
<p><a href="#Now">Now</a></p>
</li>
<li>
<p><a href="#NPer">NPer</a></p>
</li>
<li>
<p><a href="#NPV">NPV</a></p>
</li>
<li>
<p><a href="#Partition">Partition</a></p>
</li>
<li>
<p><a href="#Pmt">Pmt</a></p>
</li>
<li>
<p><a href="#PPmt">PPmt</a></p>
</li>
<li>
<p><a href="#PV">PV</a></p>
</li>
<li>
<p><a href="#QBColor">QBColor</a></p>
</li>
<li>
<p><a href="#Rate">Rate</a></p>
</li>
<li>
<p><a href="#Replace">Replace</a></p>
</li>
<li>
<p><a href="#RGB">RGB</a></p>
</li>
<li>
<p><a href="#Right">Right</a></p>
</li>
<li>
<p><a href="#Round">Round</a></p>
</li>
<li>
<p><a href="#Second">Second</a></p>
</li>
<li>
<p><a href="#Seek">Seek</a></p>
</li>
<li>
<p><a href="#Shell">Shell</a></p>
</li>
<li>
<p><a href="#SLN">SLN</a></p>
</li>
<li>
<p><a href="#Space">Space</a></p>
</li>
<li>
<p><a href="#Spc">Spc</a></p>
</li>
<li>
<p><a href="#Split">Split</a></p>
</li>
<li>
<p><a href="#StrComp">StrComp</a></p>
</li>
<li>
<p><a href="#StrConv">StrConv</a></p>
</li>
<li>
<p><a href="#String">String</a></p>
</li>
<li>
<p><a href="#StrReverse">StrReverse</a></p>
</li>
<li>
<p><a href="#Switch">Switch</a></p>
</li>
<li>
<p><a href="#SYD">SYD</a></p>
</li>
<li>
<p><a href="#Tab">Tab</a></p>
</li>
<li>
<p><a href="#Time">Time</a></p>
</li>
<li>
<p><a href="#Timer">Timer</a></p>
</li>
<li>
<p><a href="#TimeSerial">TimeSerial</a></p>
</li>
<li>
<p><a href="#TimeValue">TimeValue</a></p>
</li>
<li>
<p><a href="#TypeName">TypeName</a></p>
</li>
<li>
<p><a href="#UBound">UBound</a></p>
</li>
<li>
<p><a href="#UCase">UCase</a></p>
</li>
<li>
<p><a href="#VarType">VarType</a></p>
</li>
<li>
<p><a href="#Weekday">Weekday</a></p>
</li>
<li>
<p><a href="#WeekdayName">WeekdayName</a></p>
</li>
<li>
<p><a href="#Year">Year</a></p>
</li>
</ul>
</div>
<div class="sect3">
<h4 id="_array_関数">37.6.1. Array 関数<a id="Array"></a></h4>
<div class="listingblock">
<div class="title">構文</div>
<div class="content">
<pre class="highlight"><code class="language-vbscript" data-lang="vbscript">Array(arglist)</code></pre>
</div>
</div>
<div class="paragraph">
<p>必須の arglist 引数は、Variant に含まれている配列の要素に割り当てられる値のコ
ンマ区切りのリストです。 引数を指定しない場合は長さ 0 の配列が作成されます。</p>
</div>
<div class="paragraph">
<div class="title">解説</div>
<p>配列の要素を参照するために使用される表記は、変数 名とそれに続く括弧で構成され、
括弧の中には目的の要素を示すインデックス番号が入ります。</p>
</div>
<div class="paragraph">
<p>次の例では、最初のステートメントにより、Variant として「A」という名前の変数が
作成されます。 2 つ目のステートメントにより、変数 A に配列が割り当てられます。
最後のステートメントにより、2 つ目の配列要素に含まれる値が別の変数に割り当てら
れます。</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-vbscript" data-lang="vbscript">Dim A As Variant, B As Long, i As Long
A = Array(10, 20, 30)  ' A is a three element list by default indexed 0 to 2
B = A(2)               ' B is now 30
ReDim Preserve A(4)    ' Extend A's length to five elements
A(4) = 40              ' Set the fifth element's value
For i = LBound(A) To UBound(A)
    Debug.Print "A(" &amp; i &amp; ") = " &amp; A(i)
Next i</code></pre>
</div>
</div>
<div class="paragraph">
<p>Array 関数を使用して作成した配列の下限は、Array がタイプ ライブラリの名前で修
飾 (VBA.Array など) されていない限り、Option Base ステートメントで指定した下限
によって決まります。 タイプ ライブラリの名前で修飾されている場合は、Array は
Option Base の影響を受けません。</p>
</div>
<div class="admonitionblock caution">
<table>
<tr>
<td class="icon">
<i class="fa icon-caution" title="Caution"></i>
</td>
<td class="content">
配列として宣言されていない Variant には、配列を含めることがで
きます。 Variant 変数には、固定長の文字列とユーザー定義の型を除き、あらゆる型
の配列を含めることができます。 配列が含まれている Variant は要素の型が Variant
の配列とは概念的に異なりますが、配列要素には同じ方法でアクセスされます。
</td>
</tr>
</table>
</div>
<div class="paragraph">
<div class="title">例</div>
<p>この例では、 Array 関数を使用して、配列を含む Variant を返します。</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-vbscript" data-lang="vbscript">Dim MyWeek, MyDay
MyWeek = Array("Mon", "Tue", "Wed", "Thu", "Fri", "Sat", "Sun")
' Return values assume lower bound set to 1 (using Option Base
' statement).
MyDay = MyWeek(2)    ' MyDay contains "Tue".
MyDay = MyWeek(4)    ' MyDay contains "Thu".</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_callbyname_関数">37.6.2. CallByName 関数<a id="CallByName"></a></h4>
<div class="paragraph">
<p>オブジェクトのメソッドを実行するか、オブジェクトのプロパティを設定するか返しま
す。</p>
</div>
<div class="listingblock">
<div class="title">構文</div>
<div class="content">
<pre class="highlight"><code class="language-vbscript" data-lang="vbscript">CallByName (object, procname, calltype, [args()]))</code></pre>
</div>
</div>
<div class="paragraph">
<p>CallByName関数の構文に使用される名前付き引数は次のとおりです。</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 20%;">
<col style="width: 80%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">パーツ</th>
<th class="tableblock halign-left valign-top">説明</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">object</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">必須。Variant (Object)。 関数を実行するオブジェクトの名前。</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">procname</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">必須。Variant (String)。 オブジェクトのプロパティまたはメソッドの名前を含む文字列式。</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">calltype</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">必須。定数。 呼び出されるプロシージャの型を表す vbCallType 型の定数。</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">args()</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">省略可能。Variant (Array)。</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<div class="title">解説</div>
<p>CallByName 関数は、実行時に文字列名を使用してプロパティを取得または設定するか、
メソッドを呼び出すために使用されます。</p>
</div>
<div class="paragraph">
<p>次の例では、1 行目で CallByName を使用してテキスト ボックスの MousePointer プ
ロパティを設定し、2 行目で MousePointer プロパティの値を取得し、3 行目で Move
メソッドを呼び出してテキスト ボックスを移動します。</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-vbscript" data-lang="vbscript">CallByName Text1, "MousePointer", vbLet, vbCrosshair
Result = CallByName (Text1, "MousePointer", vbGet)
CallByName Text1, "Move", vbMethod, 100, 100</code></pre>
</div>
</div>
<div class="paragraph">
<div class="title">例</div>
<p>この例では、CallByName 関数を使用して、コマンド ボタンの Move メソッドを呼び出
します。</p>
</div>
<div class="paragraph">
<p>例ではまた、ボタン (Command1) とラベル (Label1) を含むフォーム (Form1) を使用
します。 フォームが読み込まれると、ラベルの Caption プロパティが、呼び出すメソ
ッドの名前に設定されます (この例では "Move")。 ボタンをクリックすると、
CallByName 関数によって、ボタンの位置を変更するメソッドが呼び出されます。</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-vbscript" data-lang="vbscript">Option Explicit

Private Sub Form_Load()
    Label1.Caption = "Move"        ' Name of Move method.
End Sub

Private Sub Command1_Click()
    If Command1.Left &lt;&gt; 0 Then
        CallByName Command1, Label1.Caption, vbMethod, 0, 0
    Else
        CallByName Command1, Label1.Caption, vbMethod, 500, 500
    End If</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_choose_関数">37.6.3. Choose 関数<a id="Choose"></a></h4>
<div class="paragraph">
<p>引数の一覧から値を選択し、返します。</p>
</div>
<div class="listingblock">
<div class="title">構文</div>
<div class="content">
<pre class="highlight"><code class="language-vbscript" data-lang="vbscript">Choose(index, choice-1, [ choice-2, ..., [ choice-n ]] )</code></pre>
</div>
</div>
<div class="paragraph">
<p>Choose 関数の構文には、次の指定項目があります。</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 20%;">
<col style="width: 80%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">パーツ</th>
<th class="tableblock halign-left valign-top">説明</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">index</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">必ず指定します。 1 から選択肢の数までの値になる 数式またはフィールドです。</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">choice</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">必須です。 可能性のある選択肢のいずれか 1 つが含まれる バリアント型の式 です。</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<div class="title">解説</div>
<p>Choose は、index の値に基づいて選択肢の一覧から値を返します。 index が 1 の場
合、Choose は一覧の 1 つ目の選択肢を返します。index が 2 の場合は 2 つ目という
ようになります。</p>
</div>
<div class="paragraph">
<p>Choose を使って、可能性の一覧に含まれる値を検索することができます。 たとえば、
index が 3 で、choice-1 = "1"、choice-2 = "2"、choice-3 = "3" と評価した場合、
Choose は "3" を返します。 この機能は、index がオプション グループの値を示す場
合に特に便利です。</p>
</div>
<div class="paragraph">
<p>Choose は、一覧の選択肢すべてを評価しますが、その 1 つだけが返されます。 その
ため、望ましくない副作用が生じないように注意する必要があります。 すべての選択
肢において、式 の一部として MsgBox 関数を使用する場合、メッセージ ボックスは評
価される各選択肢に対して表示されますが、Choose はそのうちの 1 つだけを返します。</p>
</div>
<div class="paragraph">
<p>もし index が 1 以下または一覧にある選択肢の数を超える場合、Choose 関数は Null
を返します。</p>
</div>
<div class="paragraph">
<p>index が整数ではない場合、最も近い整数に丸めてから評価されます。</p>
</div>
<div class="paragraph">
<div class="title">例</div>
<p>この例では、Choose 関数を使って、Ind パラメーターのプロシージャに渡される
index に応じた名前を表示します。</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-vbscript" data-lang="vbscript">Function GetChoice(Ind As Integer)
    GetChoice = Choose(Ind, "Speedy", "United", "Federal")
End Function</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_command">37.6.4. Command<a id="Command"></a></h4>
<div class="paragraph">
<p>Microsoft Visual Basic または Visual Basic で開発された実行可能なプログラムの
起動に使用されるコマンド ラインの引数部分を返します。 Visual Basic の関数機能
は、Microsoft Office のアプリケーションでは使用できません。</p>
</div>
<div class="listingblock">
<div class="title">構文</div>
<div class="content">
<pre class="highlight"><code class="language-vbscript" data-lang="vbscript">Command</code></pre>
</div>
</div>
<div class="paragraph">
<div class="title">解説</div>
<p>コマンドラインから Visual Basic が起動された場合、/cmd に続くすべてのコマンド
ライン部分がコマンドライン引数として、プログラムに渡されます。 次のコマンドラ
インの例で、cmdlineargs は、コマンド関数によって返される引数情報を表しています。</p>
</div>
<div class="paragraph">
<p>VB /cmd cmdlineargs</p>
</div>
<div class="paragraph">
<p>Visual Basic で開発され、.exe ファイルにコンパイルされたアプリケーションでは、
Command によって、コマンド ラインのアプリケーション名の後に表示されるすべての
引数が返されます。 次に例を示します。</p>
</div>
<div class="paragraph">
<p>MyApp cmdlineargs</p>
</div>
<div class="paragraph">
<p>使用しているアプリケーションのユーザー インターフェイスでのコマンド ライン引数
の変更方法の詳細については、ヘルプの「コマンド ライン引数」を参照してください。</p>
</div>
<div class="paragraph">
<div class="title">例</div>
<p>この例では、配列を含む Variant でコマンド ライン引数を返す関数内で、Command 関
数を使用してコマンド ライン引数を取得しています。 Microsoft Office では使用で
きません。</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-vbscript" data-lang="vbscript">Function GetCommandLine(Optional MaxArgs)
    'Declare variables.
    Dim C, CmdLine, CmdLnLen, InArg, I, NumArgs
    'See if MaxArgs was provided.
    If IsMissing(MaxArgs) Then MaxArgs = 10
    'Make array of the correct size.
    ReDim ArgArray(MaxArgs)
    NumArgs = 0: InArg = False
    'Get command line arguments.
    CmdLine = Command()
    CmdLnLen = Len(CmdLine)
    'Go thru command line one character
    'at a time.
    For I = 1 To CmdLnLen
        C = Mid(CmdLine, I, 1)
        'Test for space or tab.
        If (C &lt;&gt; " " And C &lt;&gt; vbTab) Then
            'Neither space nor tab.
            'Test if already in argument.
            If Not InArg Then
            'New argument begins.
            'Test for too many arguments.
                If NumArgs = MaxArgs Then Exit For
                NumArgs = NumArgs + 1
                InArg = True
            End If
            'Concatenate character to current argument.
            ArgArray(NumArgs) = ArgArray(NumArgs) &amp; C
        Else
            'Found a space or tab.
            'Set InArg flag to False.
            InArg = False
        End If
    Next I
    'Resize array just enough to hold arguments.
    ReDim Preserve ArgArray(NumArgs)
    'Return Array in Function name.
    GetCommandLine = ArgArray()
End Function</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_変換関数_2">37.6.5. 変換関数</h4>
<div class="sect4">
<h5 id="_変換関数_3">37.6.5.1. 変換関数</h5>
<div class="ulist">
<ul>
<li>
<p><a href="#Asc">Asc 関数</a></p>
</li>
<li>
<p><a href="#Chr">Chr 関数</a></p>
</li>
<li>
<p><a href="#CVErr">CVErr 関数</a></p>
</li>
<li>
<p><a href="#Format">Format 関数</a></p>
</li>
<li>
<p><a href="#Hex">Hex 関数</a></p>
</li>
<li>
<p><a href="#Oct">Oct 関数</a></p>
</li>
<li>
<p><a href="#Str">Str 関数</a></p>
</li>
<li>
<p><a href="#Val">Val 関数</a></p>
</li>
</ul>
</div>
<div class="paragraph">
<div class="title">Type Conversion 関数</div>
<p>式を特定のデータ型に変換する関数については、<a href="#Type Conversion">Type Conversion
関数</a>ページを参照してください。</p>
</div>
<div class="ulist">
<ul>
<li>
<p>CBool 関数</p>
</li>
<li>
<p>CByte 関数</p>
</li>
<li>
<p>CCur 関数</p>
</li>
<li>
<p>CDate 関数</p>
</li>
<li>
<p>CDec 関数</p>
</li>
<li>
<p>CDbl 関数</p>
</li>
<li>
<p>CInt 関数</p>
</li>
<li>
<p>CLng 関数</p>
</li>
<li>
<p>CLngLng 関数</p>
</li>
<li>
<p>CLngPtr 関数</p>
</li>
<li>
<p>CSng 関数</p>
</li>
<li>
<p>CStr 関数</p>
</li>
<li>
<p>CVar 関数</p>
</li>
</ul>
</div>
</div>
<div class="sect4">
<h5 id="_asc_関数">37.6.5.2. Asc 関数<a id="Asc"></a></h5>
<div class="paragraph">
<p>文字列の最初の文字に対応した文字コードを示す整数を返します。</p>
</div>
<div class="listingblock">
<div class="title">構文</div>
<div class="content">
<pre class="highlight"><code class="language-vbscript" data-lang="vbscript">Asc(string)</code></pre>
</div>
</div>
<div class="paragraph">
<p>必須の string 引数は、任意の有効な文字列式です。 string に文字が含まれていない
場合、実行時エラーが発生します。</p>
</div>
<div class="paragraph">
<div class="title">解説</div>
<p>戻り値の範囲は、非 DBCS システムでは 0–255 ですが、DBCS システムでは -32768–
32767 です。</p>
</div>
<div class="admonitionblock caution">
<table>
<tr>
<td class="icon">
<i class="fa icon-caution" title="Caution"></i>
</td>
<td class="content">
AscB 関数は、文字列に含まれるバイト データの場合に使用します。 先頭の文字の文
字コードを返す代わりに、AscB は最初のバイトを返します。 AscW 関数は、Unicode
文字コードを返します。ただし、Unicode がサポートされていないプラットフォームで
は、Asc 関数と同じ動作になります。
</td>
</tr>
</table>
</div>
<div class="admonitionblock caution">
<table>
<tr>
<td class="icon">
<i class="fa icon-caution" title="Caution"></i>
</td>
<td class="content">
Visual Basic for the Macintosh では、Unicode 文字列をサポート
していません。 このため、Windows 環境とは異なり、AscW (n) は 128 – 65,535 の
範囲の n の値に対するすべての Unicode 文字を返すことができません。 代わりに、
AscW (n) は、127 より大きい Unicode 値 n について "最適なものを推測" します。
したがって、Macintosh 環境では、AscW を使用してはいけません。。
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>関数<a href="#Chr">Chr ()、ChrB ()、および ChrW ()</a> は、 Asc ()、ascb ()、ascb () の逆
です。Chr () 関数は、整数を文字列に変換します。</p>
</div>
<div class="paragraph">
<div class="title">例</div>
<p>この例では、Asc 関数を使って、文字列の先頭の文字に対応する文字コードを返します。</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-vbscript" data-lang="vbscript">Dim MyNumber
MyNumber = Asc("A")    ' Returns 65.
MyNumber = Asc("a")    ' Returns 97.
MyNumber = Asc("Apple")    ' Returns 65.</code></pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="_chr_関数">37.6.5.3. Chr 関数<a id="Chr"></a></h5>
<div class="paragraph">
<p>指定した文字コードと関連付けられている文字を含む String を返します。</p>
</div>
<div class="listingblock">
<div class="title">構文</div>
<div class="content">
<pre class="highlight"><code class="language-vbscript" data-lang="vbscript">Chr(charcode)
ChrB(charcode)
ChrW(charcode)</code></pre>
</div>
</div>
<div class="paragraph">
<p>必須の charcode 引数は、文字を識別する Long です。</p>
</div>
<div class="paragraph">
<div class="title">解説</div>
<p>0 から 31 の数値は、標準の印刷できない ASCII コードと同じです。 たとえば、
  Chr(10) は改行文字を返します。 charcode の通常の範囲は 0 から 255 です。 た
だし、DBCS システムでは、charcode の実際の範囲は -32768 から 65535 です。</p>
</div>
<div class="admonitionblock caution">
<table>
<tr>
<td class="icon">
<i class="fa icon-caution" title="Caution"></i>
</td>
<td class="content">
ChrB関数は、String に含まれるバイト データの場合に使用します。
ChrBは、1 バイトまたは 2 バイトの文字ではなく、常に 1 バイトを返します。
ChrW 関数は、Unicode 文字を含む String を返します。ただし、Unicode がサポート
されていないプラットフォームでは、Chr 関数と同じ動作になります。
</td>
</tr>
</table>
</div>
<div class="admonitionblock caution">
<table>
<tr>
<td class="icon">
<i class="fa icon-caution" title="Caution"></i>
</td>
<td class="content">
Visual Basic for the Macintosh では、Unicode 文字列をサポート
していません。 このため、Windows 環境とは異なり、ChrW(n) は 128 から 65,535 の
範囲の n の値に対するすべての Unicode 文字を返すことができません。 代わりに、
ChrW(n) は、127 より大きい Unicode 値 n について "最適なものを推測" します。
したがって、Macintosh 環境では、ChrW を使用する必要はありません。
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>関数 <a href="#Asc">Asc()、AscB()、および AscW()</a> は Chr()、ChrB()、および ChrW() の反対です。
Asc() 関数は、文字列を整数に変換します。</p>
</div>
<div class="paragraph">
<div class="title">例</div>
<p>次の例では、Chr 関数を使用して、指定した文字コードと関連付けられている文字を返
します。</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-vbscript" data-lang="vbscript">Dim MyChar
MyChar = Chr(65)    ' Returns A.
MyChar = Chr(97)    ' Returns a.
MyChar = Chr(62)    ' Returns &gt;.
MyChar = Chr(37)    ' Returns %.</code></pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="_cverr_関数">37.6.5.4. CVErr 関数<a id="CVErr"></a></h5>
<div class="paragraph">
<p>ユーザーによって指定されたエラー番号を含むサブタイプ Error の Variant を返しま
す。</p>
</div>
<div class="listingblock">
<div class="title">構文</div>
<div class="content">
<pre class="highlight"><code class="language-vbscript" data-lang="vbscript">CVErr(errornumber)</code></pre>
</div>
</div>
<div class="paragraph">
<p>必須の errornumber 引数は、任意の有効なエラー番号です。</p>
</div>
<div class="paragraph">
<div class="title">解説</div>
<p>CVErr 関数は、ユーザーが作成するプロシージャでユーザー定義のエラーを作成するた
めに使用されます。 たとえば、複数の引数を受け取って普通に文字列を返す関数を作
成する場合は、関数で入力引数を評価し、受け付けられる範囲内の値であることを確認
できます。 そうでない場合、関数は期待する結果を返しません。 このような場合、
CVErr を使用することで、実行する処理の内容を通知するエラー番号を返すことができ
ます。</p>
</div>
<div class="paragraph">
<p>Error の暗黙的な変換はできないことに注意してください。 たとえば、CVErr の戻り
値を、Variant ではない変数に直接割り当てることはできません。 ただし、CVErr に
よって返される値の明示的な変換を実行し (CInt、CDbl などを使用)、それを適切なデ
ータ型の変数に割り当てることはできます。</p>
</div>
<div class="paragraph">
<div class="title">例</div>
<p>次の例では、CVErr 関数を使用して、VarType が vbError (10) である Variant を返
します。 ユーザー定義関数 CalculateDouble は、渡された引数が数値でない場合にエ
ラーを返します。 CVErr を使用して、ユーザー定義プロシージャからユーザー定義エ
ラーを返すことも、実行時エラーの処理を遅らせることもできます。 値がエラーを表
しているかどうかを調べるには、IsError 関数を使用します。</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-vbscript" data-lang="vbscript">' Call CalculateDouble with an error-producing argument.
Sub Test()
    Debug.Print CalculateDouble("345.45robert")
End Sub
' Define CalculateDouble Function procedure.
Function CalculateDouble(Number)
    If IsNumeric(Number) Then
        CalculateDouble = Number * 2    ' Return result.
    Else
        CalculateDouble = CVErr(2001)    ' Return a user-defined error
    End If    ' number.
End Function</code></pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="_format_関数">37.6.5.5. Format 関数<a id="Format"></a></h5>
<div class="paragraph">
<p>書式指定式の指示に従って書式設定される式を含む Variant (String) を戻します。</p>
</div>
<div class="admonitionblock caution">
<table>
<tr>
<td class="icon">
<i class="fa icon-caution" title="Caution"></i>
</td>
<td class="content">
複数のプラットフォーム間で Office エクスペリエンスを拡張するソ
リューションを開発することに関心がありますか? 新しい Office アドイン モデルを
参照してください。 Office アドインには、VSTO アドインおよびソリューションと比
較して、小さな設置面積があります。 HTML5、JavaScript、CSS3、XML など、ほぼすべ
ての web プログラミングテクノロジを使用して構築できます。
</td>
</tr>
</table>
</div>
<div class="listingblock">
<div class="title">構文</div>
<div class="content">
<pre class="highlight"><code class="language-vbscript" data-lang="vbscript">Format(Expression, [Format], [FirstDayOfWeek], [FirstWeekOfYear])</code></pre>
</div>
</div>
<div class="paragraph">
<p>Format 関数の構文には、次の指定項目があります。</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 20%;">
<col style="width: 80%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">指定項目</th>
<th class="tableblock halign-left valign-top">説明</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Expression</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">必須。 必ず指定します。任意の有効な式。</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Format</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">省略可能。 有効な名前を持つ、またはユーザー定義の書式指定式。</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">FirstDayOfWeek</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">省略可能。 週の最初の曜日を指定する定数です。</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">FirstWeekOfYear</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">省略可能。 年内で、最初の週を指定する定数です。</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<div class="title">設定</div>
<p>firstdayofweek 引数の設定は次のとおりです。</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 16.6666%;">
<col style="width: 16.6666%;">
<col style="width: 66.6668%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">定数</th>
<th class="tableblock halign-left valign-top">値</th>
<th class="tableblock halign-left valign-top">説明</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">vbUseSystem</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">NLS API 設定を使用します。</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">vbSunday</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">日曜日 (既定)</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">vbMonday</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">2</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">月曜日</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">vbTuesday</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">3</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">火曜日</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">vbWednesday</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">4</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">水曜日</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">vbThursday</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">5</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">木曜日</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">vbFriday</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">6</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">金曜日</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">vbSaturday</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">7</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">土曜日</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>firstweekofyear 引数の設定は次のとおりです。</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 16.6666%;">
<col style="width: 16.6666%;">
<col style="width: 66.6668%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">定数</th>
<th class="tableblock halign-left valign-top">値</th>
<th class="tableblock halign-left valign-top">説明</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">vbUseSystem</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">NLS API 設定を使用します。</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">vbFirstJan1</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1 月 1 日が含まれる週から開始します (既定)。</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">vbFirstFourDays</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">2</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">4 日以上が含まれる最初の週が年の第 1 週目になります。</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">vbFirstFullWeek</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">3</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1 週間全体が含まれる最初の週がその年の第 1 週目になります。</p></td>
</tr>
</tbody>
</table>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 29. 解説</caption>
<colgroup>
<col style="width: 20%;">
<col style="width: 80%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">書式設定の対象</th>
<th class="tableblock halign-left valign-top">説明</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">数値</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">定義済みの名前付き数値書式を使用するか、ユーザー定義の数値書式を作成します。</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">日付と時刻</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">定義済みの名前付き日付/時刻書式を使用するか、ユーザー定義の日付/時刻書式を作成します。</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">日付と時刻の連続番号</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">日付および時間書式または数値書式を使用します。</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">文字列</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">自分のユーザー定義文字列書式を作成します。</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>Format は、format を 257 文字に切り捨てます。</p>
</div>
<div class="paragraph">
<p>format を指定せずに数値を書式設定する場合、Format は Str 関数と同様の、ただし
国際対応がされた機能を提供します。 しかし、Format を使用して文字列として書式設
定された正の数値には、値の記号用に予約済みの先頭のスペースは含まれません。Str
を使用して変換された数値では、先頭のスペースは保持されます。</p>
</div>
<div class="paragraph">
<p>ローカライズされていない数値文字列を書式設定する場合、目的の書式を実現するには、
ユーザー定義数値書式を使用する必要があります。</p>
</div>
<div class="paragraph">
<p>CAUTION:Calendar プロパティの設定が Gregorian で、format が日付書式を
指定する場合、指定する expression は Gregorian である必要があります。 Visual
Basic Calendar プロパティ設定が Hijri である場合、指定する expression は Hijri
である必要があります。</p>
</div>
<div class="paragraph">
<p>カレンダーがグレゴリオ暦である場合、format 式記号の意味は変わりません。 カレン
ダーがイスラム暦の場合、すべての日付書式記号 (たとえば、dddd、mmmm、yyyy) は同
じ意味を持ちますが、イスラム暦に適用されます。 書式記号は英語のままです。テキ
スト表示 (たとえば、AM や PM) になる記号では、その記号に対応する文字列 (英語ま
たはアラビア語) が表示されます。 カレンダーがイスラム暦の場合、特定の記号の範
囲は変わります。</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 30. 日付記号</caption>
<colgroup>
<col style="width: 20%;">
<col style="width: 80%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">記号</th>
<th class="tableblock halign-left valign-top">範囲</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">d</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1 〜 31 (前に 0 を付けない、月の日付)</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">dd</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">01 〜 31 (前に 0 を付ける、月の日付)</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">w</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1 〜 7 (週の曜日。土曜日 = 1 から開始)</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">ww</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1 〜 53 (1 年のうちで何週目かを表す数値。前に 0 を付けず、1 月 1 日から開始。)</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">m</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1 〜 12 (月。前に 0 を付けず、1 月 = 1 から開始。)</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">mm</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">01 〜 12 (月。前に 0 を付け、1 月 = 01 から開始。)</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">mmm</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">月の省略名を表示 (イスラム暦の月の名前には省略形はありません)</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">mmmm</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">完全な月名を表示</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">y</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1 〜 366 (1 年のうちで何日目かを表す数値)</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">yy</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">00 〜 99 (西暦年の下 2 桁)</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">yyyy</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">100 〜 9999 (3 桁または 4 桁の西暦年)</p></td>
</tr>
</tbody>
</table>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 31. 時間記号</caption>
<colgroup>
<col style="width: 20%;">
<col style="width: 80%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">記号</th>
<th class="tableblock halign-left valign-top">範囲</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">h</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0 〜 23 (「AM」または「PM」を追加した 1 〜 12 の数値) (前に 0 を付けない、1 日の中の時間)</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">hh</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">00 〜 23 (「AM」または「PM」を追加した 01 〜 12 の数値) (前に 0 を付ける、1 日の中の時間)</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">n</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0 〜 59 (前に 0 を付けない、1 時間の中の分)</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">nn</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">00 〜 59 (前に 0 を付ける、1 時間の中の分)</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">m</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0 〜 59 (前に 0 を付けない、1 時間の中の分) h または hh が先行する場合のみ</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">mm</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">00 〜 59 (前に 0 を付ける、1 時間の中の分) h または hh が先行する場合のみ</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">s</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0 〜 59 (前に 0 を付けない、1分の中の秒)</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">ss</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">00 〜 59 (前に 0 を付ける、1分の中の秒)</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<div class="title">使用例</div>
<p>この例では、名前付き書式とユーザー定義書式の両方を使用して値の書式設定を行う、
Format 関数のさまざまな使用例を示します。 日付の区切り記号 ( / )、時間の区切り
記号 (<strong> :</strong> )、リテラルの AM/PM、およびシステムで表示される実際の書式設定され
る出力は、コードが実行中のロケール設定に基づきます。 時間と日付が開発環境で表
示されるとき、コード ロケールでの短い時間形式と短い日付形式が使用されます。 コ
ードの実行により表示される場合は、システム ロケールの短い時間形式と短い日付形
式が使用されます。これはコード ロケールとは異なることがあります。 この例では、
English/U.S. を使用します。 MyTime と MyDate が、現在のシステムでの短い時間設
定と短い日付設定を使用して、開発環境で表示されます。</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-vbscript" data-lang="vbscript">Dim MyTime, MyDate, MyStr
MyTime = #17:04:23#
MyDate = #January 27, 1993#

' Returns current system time in the system-defined long time format.
MyStr = Format(Time, "Long Time")

' Returns current system date in the system-defined long date format.
MyStr = Format(Date, "Long Date")

MyStr = Format(MyTime, "h:m:s")    ' Returns "17:4:23".
MyStr = Format(MyTime, "hh:mm:ss am/pm")    ' Returns "05:04:23 pm".
MyStr = Format(MyTime, "hh:mm:ss AM/PM")    ' Returns "05:04:23 PM".
MyStr = Format(MyDate, "dddd, mmm d yyyy")    ' Returns "Wednesday, Jan 27 1993".
' If format is not supplied, a string is returned.
MyStr = Format(23)    ' Returns "23".

' User-defined formats.
MyStr = Format(5459.4, "##,##0.00")    ' Returns "5,459.40".
MyStr = Format(334.9, "###0.00")    ' Returns "334.90".
MyStr = Format(5, "0.00%")    ' Returns "500.00%".
MyStr = Format("HELLO", "&lt;")    ' Returns "hello".
MyStr = Format("This is it", "&gt;")    ' Returns "THIS IS IT".</code></pre>
</div>
</div>
<div class="paragraph">
<div class="title">さまざまな数値のさまざまな書式</div>
<p>ユーザー定義の数値書式指定 式は、セミコロンで区切られた 1 から 4 のセクション
を持つことができます。 書式引数に名前付き数値書式が含まれる場合は、1 つのセク
ションのみが許可されます。</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-vbscript" data-lang="vbscript">|使用するセクション数 |結果
|1 セクションのみ |書式指定式はすべての値に適用されます。
|2 セクション |最初のセクションは正の値と 0 に適用され、第 2 のセクションは負の値に適用されます。
|3 セクション |最初のセクションは正の値、第 2 のセクションは負の値、第 3 のセクションは 0 に適用されます。
|4 セクション |最初のセクションは正の値、第 2 のセクションは負の値、第 3 のセクションは 0、第 4 のセクションは Null 値に適用されます。</code></pre>
</div>
</div>
<div class="paragraph">
<p>"$<mark>,<mark>0;($</mark>,</mark>0)"</p>
</div>
<div class="paragraph">
<p>間に何も入れずに複数のセミコロンを含めた場合、欠けているセクションは、正の値の
書式を使用して出力されます。 たとえば、以下の書式は、最初のセクションで書式を
使用して正と負の値を表示し、値が 0 の場合は、"Zero" を表示します。</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-vbscript" data-lang="vbscript">"$#,##0;;\Z\e\r\o"</code></pre>
</div>
</div>
<div class="paragraph">
<p>さまざまな文字列値のさまざまな書式</p>
</div>
<div class="paragraph">
<p>文字列の書式指定式は、セミコロン (;) で区切られた 1 つまたは 2 つのセクション
を持つことができます。</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-vbscript" data-lang="vbscript">|使用するセクション数 |結果
|1 セクションのみ |書式はすべての文字列データに適用されます。
|2 セクション |最初のセクションは文字列データに適用され、第 2 のセクションは Null 値と長さ 0 の文字列 ("") に適用されます。</code></pre>
</div>
</div>
<div class="paragraph">
<div class="title">名前付き日付/時刻書式</div>
<p>以下の表は、定義済みの日付および時間の書式名を示します。</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 20%;">
<col style="width: 80%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">書式名</th>
<th class="tableblock halign-left valign-top">説明</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">General Date</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">日付と時刻のどちらか、または両方を表示します (例: 4/3/93 05:34 PM)。 小数の部分がない場合、日付だけを表示します (例: 4/3/93)。 整数の部分がない場合、時間のみを表示します(例: 05:34 PM)。 日付表示はシステム設定に依存します。</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Long Date</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">システムの長い日付形式の書式に従って日付を表示します。</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Medium Date</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">ホスト アプリケーションの言語バージョンで適切な、中間の長さの日付書式を使用して日付を表示します。</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Short Date</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">システムの短い日付書式を使用して日付を表示します。</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Long Time</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">システムの長い時間形式を使用して時間を表示します。時間、分、秒が含まれます。</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Medium Time</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">時間と分を、12 時間の書式と AM/PM を使用して表示します。</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Short Time</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">24 時間の形式を使用して時間を表示します (例: 17: 45)。</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<div class="title">名前付き数値書式</div>
<p>以下の表は、定義済みの数値の書式名を示します。</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-vbscript" data-lang="vbscript">|書式名 |説明
|General Number |桁区切り記号を付けずに数を表示します。
|Currency |適切な場合は、桁区切り記号を付けて数を表示します。小数点記号の右 2 桁を表示します。 出力はシステム ロケール設定に基づきます。
|Fixed |少なくとも整数部 1 桁、小数部 2 桁を表示します。
|Standard |区切り記号を付けて、少なくとも整数部 1 桁、小数部 2 桁を表示します。
|Percent |数値を 100 倍して、右側にパーセント記号 (%) を付けて表示します。小数部は常に 2 桁です。
|Scientific |標準の指数表記を使用します。
|Yes/No |数値が 0 の場合は No を表示します。それ以外の場合は Yes を表示します。
|True/False |数値が 0 の場合は False を表示します。それ以外の場合は True を表示します。
|On/Off |数値が 0 の場合は Off を表示します。それ以外の場合は On を表示します。</code></pre>
</div>
</div>
<div class="paragraph">
<div class="title">ユーザー定義文字列書式</div>
<p>以下の文字を使用して、文字列の書式指定式を作成できます。</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-vbscript" data-lang="vbscript">|文字 |説明
|@ |文字プレースホルダー。 文字またはスペースを表示します。 書式文字列でアット マーク (@ ) の表示位置に文字がある文字列の場合は、その文字が表示されます。それ以外の場合は、その位置にスペースが表示されます。 書式文字列に感嘆符 (** !** ) がある場合を除き、プレースホルダーは右側から左側に向かって埋められます。
|&amp; |文字プレースホルダー。 文字が表示されるか、または何も表示されません。 アンパサンド (&amp;) の表示位置に文字がある文字列の場合は、その文字が表示されます。それ以外の場合は、何も表示されません。 書式文字列に感嘆符 (** !** ) がある場合を除き、プレースホルダーは右側から左側に向かって埋められます。
|&lt; |強制的に小文字にします。 すべての文字を小文字で表示します。
|&gt; |強制的に大文字にします。 すべての文字を大文字で表示します。
|! |プレースホルダーを左から右に向かって埋めるように強制的に設定します。 既定では、プレースホルダーは右から左に向かって埋めように設定されています。</code></pre>
</div>
</div>
<div class="paragraph">
<div class="title">ユーザー定義日付/時刻書式</div>
<p>以下の表は、ユーザー定義日付/時刻書式の作成に使用できる文字を示します。</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-vbscript" data-lang="vbscript">|文字 |説明
|(:) |時刻の区切り記号。 一部のロケールでは、時刻区切り文字を表す目的で他の文字が使用されることがあります。 時刻の値が書式設定されるときに、時刻区切り文字によって時、分、および秒が区切られます。 書式設定された出力で時刻区切り文字として使用される実際の文字は、システム設定によって決まります。
|(/) |日付の区切り記号。 一部のロケールでは、日付区切り文字を表す目的で他の文字が使用されることがあります。 日付値の書式が設定されている場合、日付、月、および年は、日付の区切り記号によって区切られます。 書式設定された出力で、日付の区切り文字として実際に使用される文字は、システム設定によって決まります。
|c |日付を ddddd、時刻を ttttt 形式で、日付、時刻の順序で表示します。 日付の連続数値に小数部がない場合は、日付情報だけを表示します。時刻に整数部がない場合は、時刻情報のみを表示します。
|d |日を先頭に 0 のない数値 (1 〜 31) で表示します。
|dd |日を先頭に 0 のある数値 (01 〜 31) で表示します。
|ddd |日を曜日の省略形 (日〜 土) で表示します。 ローカライズされています。
|dddd |日を曜日の完全な名前 (日曜日〜 土曜日) で表示します。 ローカライズされています。
|ddddd |日付を完全な日付 (日、月、および年を含む) で表示します。表示形式は各システムの短い日付形式の設定に従っています。 既定の短縮日付フォーマットは、m/d/yy です。
|dddddd |日付の連続数値を完全な日付 (日、月、および年を含む) で表示します。表示形式は各システムが認識する長い日付形式の設定に従っています。 既定の長い日付形式は、mmmm dd, yyyy です。
|w |曜日を数値 (日曜日が 1 で土曜日が 7) で表示します。
|ww |1 年のうちの何週目であるかを数値 (1 〜 54) で表示します。
|m |月を先頭に 0 のない数値 (1 〜 12) で表示します。 h または hh の直後に m が続く場合は、月ではなく分が表示されます。
|mm |月を先頭に 0 のある数値 (01 〜 12) で表示します。 h または hh の直後に m が続く場合は、月ではなく分が表示されます。
|mmm |月を月名の省略形 (1 月〜 12 月) で表示します。 ローカライズされています。
|mmmm |月を完全な月名 (1 月〜 12 月) で表示します。 ローカライズされています。
|q |1 年の四半期を数値 (1 〜 4) で表示します。
|y |1 年の何日目かを数値 (1 〜 366) で表示します。
|yy |西暦の年を下 2 桁の数値 (00 〜 99) で表示します。
|yyyy |西暦の年を 4 桁の数値 (100 〜 9999) で表示します。
|h |時を先頭に 0 のない数値 (0 〜 23) で表示します。
|Hh |時を先頭に 0 のある数値 (00 〜 23) で表示します。
|n |分を先頭に 0 のない数値 (0 〜 59) で表示します。
|nn |分を先頭に 0 のある数値 (00 〜 59) で表示します。
|s |秒を先頭に 0 のない数値 (0 〜 59) で表示します。
|ss |秒を先頭に 0 のある数値 (00 〜 59) で表示します。
|ttttt |時刻を完全な時刻 (時間、分、および秒を含む) で表示します。表示形式は、各システムが認識する時刻書式で定義された時刻区切り文字を使用します。 先頭に 0 を付ける形式が選択されていて、時刻が午前 10:00 または 午後 10:00 より前の場合は、時刻の前に 0 を表示します。 既定の時刻書式は、h:mm:ss です。
|AM/PM |12 時間形式を使用します。正午までの時間に大文字の AM を、正午から午後 11:59 時までの時間に大文字の PM を付けて表示します。
|am/pm |12 時間形式を使用します。正午までの時間に小文字の AM を、正午から午後 11:59 時までの時間に小文字の PM を付けて表示します。
|A/P |12 時間形式を使用します。正午までの時間に大文字の A を、正午から午後 11:59 時までの時間に大文字の P を付けて表示します。
|a/p |12 時間形式を使用します。正午までの時間に小文字の a を、正午から午後 11:59 時までの時間に小文字の p を付けて表示します。
|AMPM |12 時間形式を使用します。正午までの時間にはシステムで定義された AM 文字列リテラルを、正午から午後 11:59 時までの時間にはシステムで定義された PM 文字列リテラルを付けて表示します。 AMPM は大文字、小文字のどちらでもかまいません。ただし、表示される文字列の大文字、小文字の区別は、システムの設定で定義した文字列に一致します。 既定の形式は AM/PM です。 システムで 24 時間時計に設定されている場合は、文字列は通常、長さ 0 の文字列に設定されます。</code></pre>
</div>
</div>
<div class="paragraph">
<div class="title">ユーザー定義数値書式</div>
<p>以下の表は、ユーザー定義数値書式の作成に使用できる文字を示します。</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-vbscript" data-lang="vbscript">|文字 |説明
|なし |書式指定なしで数値を表示します。
|(0) |桁のプレースホルダーです。 1 桁の数または 0 を表示します。 式で、書式指定文字列で 0 が指定されている場所に 1 桁の数字がある場合は、その数字が表示されます。それ以外の場合は、その場所に 0 を表示します。数値の整数部または小数部の桁数が、書式指定式内の 0 の桁数より少ない場合は、先行ゼロまたは後置ゼロを表示します。 数値の小数部の桁数が、書式指定式の小数部で指定されている 0 の数より多い場合は、0 の数と同じ桁数に数値が丸められます。 数値の整数部の桁数が、書式指定式の整数部の 0 の数より多い場合は、桁をそのまま表示します。
|(#) |桁のプレースホルダーです。 1 桁の数字または 0 を表示します。 式で、書式指定文字列で # が指定されている場所に該当する桁がある場合は、その数字が表示されます。それ以外の場合は、その場所には何も表示されません。 この記号は 0 桁プレースホルダーと同様の機能を持ちます。ただし、数値の桁数が、書式指定式の整数部および小数部にある # 記号よりも同じか少ない場合でも、先頭および末尾に 0 が表示されません。
|(.) |小数点のプレースホルダーです。 ロケールによっては、小数点の区切り記号としてコンマが使用されます。 小数点のプレースホルダーは、整数部および小数部に表示する桁数を決定します。 書式指定式でこの記号の左に # 記号だけがある場合、1 未満の数値の先頭は小数点区切り記号になります。 小数値の先頭に 0 を表示するには、整数部の最初の桁のプレースホルダーとして 0 を使用します。 書式指定結果で小数点のプレースホルダーとして実際に使用される記号は、システムで認識される数値書式によって異なります。
|(%) |パーセントのプレースホルダーです。 式を 100 倍します。 書式指定文字列の表示位置にパーセント記号 ( % ) が挿入されます。
|(,) |1,000 単位の区切り記号。 ロケールによっては、桁区切り記号としてピリオドが使用されます。 桁区切り記号は、整数部に 4 桁以上ある数値の百の位と千の位を区切ります。 書式にある桁区切り記号が桁のプレースホルダー (0 または #) で囲まれている場合は、桁区切り記号の標準使用が指定されます。 小数部の指定の有無にかかわらず、小数点のすぐ左に、桁区切り記号が 2 つ隣接する場合や、桁区切り記号がある場合は、"数値を 1000 で割って、必要に応じて丸める" ことを意味します。 たとえば、書式指定文字列 "##0,," を使用して、1 億を 100 として表せます。 百万より小さい数字は 0 として表示されます。 小数点のすぐ左以外の位置に 2 つの隣接する区切り記号がある場合は、通常の桁区切り記号を指定したものとして処理されます。 書式指定された出力で、実際に桁区切り記号として使用される記号は、システムで認識される数値書式によって異なります。
|(:) |時刻の区切り記号。 一部のロケールでは、時刻区切り文字を表す目的で他の文字が使用されることがあります。 時刻の値が書式設定されるときに、時刻区切り文字によって時、分、および秒が区切られます。 書式設定された出力で時刻区切り文字として使用される実際の文字は、システム設定によって決まります。
|(/) |日付の区切り記号。 一部のロケールでは、日付区切り文字を表す目的で他の文字が使用されることがあります。 日付値の書式が設定されている場合、日付、月、および年は、日付の区切り記号によって区切られます。 書式設定された出力で、日付の区切り文字として実際に使用される文字は、システム設定によって決まります。
|(E- E+ e- e+) |指数形式。 書式指定式で、E-、E+、e-、または e+ の左に少なくとも 1 つの桁プレースホルダー ( 0 または # ) がある場合、数値は、数値と指数部の間に E または e を挿入して指数形式で表示されます。 右にある桁プレースホルダーの数で、指数の桁数が決まります。 負の指数にマイナス記号を挿入するには、E- または e- を使用します。 負の指数にマイナス記号を入れて、正の指数にプラス記号を入れるには、E+ または e+ を使用します。
|- + $ ( ) |リテラル文字を表示します。 これ以外の文字をリテラルとして表示するには、その文字の前に円記号 (\) を付けるか、または二重引用符記号 (" ") で囲みます。
|(\) |書式指定文字列内の次の文字を表示します。 特殊な意味を持つ文字をリテラル文字として表示するには、その文字の前に円記号 (\) を付けます。 円記号自体は表示されません。 円記号を使用するのは、その文字を二重引用符記号で囲むことと同じです。 円記号自体を表示するには、円記号を 2 つ (\\) 使用します。 リテラル文字として表示できない文字には次のような文字があります。日付書式文字および時刻書式文字 (a、c、d、h、m、n、p、q、s、t、w、y、/、および :)、数値書式文字 (#、0、%、E、e、コンマ、およびピリオド)、および文字列書式文字 (@、&amp;、&lt;、&gt;、および !)。
|("ABC") |二重引用符 (" ") で囲まれた文字列を表示します。 コードから**書式** に文字列を含めるには、Chr(34) を使ってテキストを囲みます (34 は引用符 (") を表す文字コードです)。</code></pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="_hex_関数">37.6.5.6. Hex 関数<a id="Hex"></a></h5>
<div class="paragraph">
<p>数値を 16 進数で表す String を返します。</p>
</div>
<div class="listingblock">
<div class="title">構文</div>
<div class="content">
<pre class="highlight"><code class="language-vbscript" data-lang="vbscript">Hex(number)</code></pre>
</div>
</div>
<div class="paragraph">
<p>必須の number 引数は、任意の有効な数値式または文字列式です。</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 20%;">
<col style="width: 80%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">number の値</th>
<th class="tableblock halign-left valign-top">Hex の戻り値</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">-2,147, 483,648 〜 2,147, 483,647</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">最大 8 桁の 16 進文字</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Null</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Null</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">空</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">ゼロ (0)</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<div class="title">解説</div>
<p>number が整数ではない場合、最も近い整数に丸めてから評価されます。</p>
</div>
<div class="paragraph">
<p>16進数の逆にする場合は、16進数の値の前に &amp;Hを付けます。 たとえば、Hex(255) は
文字列 FF を返し、&amp;HFF は数値 255 を返します。</p>
</div>
<div class="paragraph">
<div class="title">例</div>
<p>次の例は、Hex 関数を使用して、数値の 16 進数値を返します。</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-vbscript" data-lang="vbscript">Dim MyHex
MyHex = Hex(5)    ' Returns 5.
MyHex = Hex(10)    ' Returns A.
MyHex = Hex(459)    ' Returns 1CB.</code></pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="_oct_関数">37.6.5.7. Oct 関数<a id="Oct"></a></h5>
<div class="paragraph">
<p>数値を 8 進数で表す Variant (String) を返します。</p>
</div>
<div class="listingblock">
<div class="title">構文</div>
<div class="content">
<pre class="highlight"><code class="language-vbscript" data-lang="vbscript">Oct(number)</code></pre>
</div>
</div>
<div class="paragraph">
<p>必須の number 引数は、任意の有効な数式または文字列式です。</p>
</div>
<div class="paragraph">
<div class="title">解説</div>
<p>number が整数ではない場合、最も近い整数に丸めてから評価されます。</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 20%;">
<col style="width: 80%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">number の値</th>
<th class="tableblock halign-left valign-top">Oct の戻り値</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Null</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Null</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">空</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">ゼロ (0)</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">それ以外の値</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">最大 11 桁の 8 進数</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>適切な範囲の数値の前に &amp;O を付けて記述すると、値を直接 8 進数で表すことができ
ます。 たとえば、10 進数の 8 の場合は、&amp;O10 のように 8 進数で表記することがで
きます。</p>
</div>
<div class="paragraph">
<div class="title">例</div>
<p>次の例は、Oct 関数を使用して、数値の 8 進数値を返します。</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-vbscript" data-lang="vbscript">Dim MyOct
MyOct = Oct(4)     ' Returns 4.
MyOct = Oct(8)    ' Returns 10.
MyOct = Oct(459)    ' Returns 713.</code></pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="_str_関数">37.6.5.8. Str 関数<a id="Str"></a></h5>
<div class="paragraph">
<p>数を示す Variant (String) を返します。</p>
</div>
<div class="listingblock">
<div class="title">構文</div>
<div class="content">
<pre class="highlight"><code class="language-vbscript" data-lang="vbscript">Str(number)</code></pre>
</div>
</div>
<div class="paragraph">
<p>必須の number 引数は、任意の有効な数式を含む Long です。</p>
</div>
<div class="paragraph">
<div class="title">解説</div>
<p>数値が文字列に変換されるとき、先頭のスペースは number の符号用に常に予約されま
す。 number が正の場合、返される文字列には先頭のスペースが含まれ、プラス記号は
省略されています。</p>
</div>
<div class="paragraph">
<p>日付、時刻、通貨、または他のユーザー定義書式として書式設定する数値を変換するに
は、Format 関数を使用します。 Str とは異なり、Format 関数は number の符号用に
先頭のスペースを含みません。</p>
</div>
<div class="admonitionblock caution">
<table>
<tr>
<td class="icon">
<i class="fa icon-caution" title="Caution"></i>
</td>
<td class="content">
Str 関数は、有効な桁区切り記号としてピリオド (.) のみを 認識し
ます。 他の桁区切り記号を使う場合は (国際アプリケーションの場合など)、CStr を
使って数値を文字列に変換します。
</td>
</tr>
</table>
</div>
<div class="paragraph">
<div class="title">例</div>
<p>この例では、Str 関数を使って、数値の文字列表現を返しています。 数値が文字列に
変換されるとき、先頭のスペースは常に符号用に予約されます。</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-vbscript" data-lang="vbscript">Dim MyString
MyString = Str(459)    ' Returns " 459".
MyString = Str(-459.65)    ' Returns "-459.65".
MyString = Str(459.001)    ' Returns " 459.001".</code></pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="_val_関数">37.6.5.9. Val 関数<a id="Val"></a></h5>
<div class="paragraph">
<p>文字列に含まれる数値を、適切な型の数値として返します。</p>
</div>
<div class="listingblock">
<div class="title">構文</div>
<div class="content">
<pre class="highlight"><code class="language-vbscript" data-lang="vbscript">Val(string)</code></pre>
</div>
</div>
<div class="paragraph">
<p>必須の string 引数は、任意の有効な文字列式です。</p>
</div>
<div class="paragraph">
<div class="title">解説</div>
<p>Val 関数は、数値の一部として認識できない最初の文字で、文字列の読み取りを中止し
ます。 数値の一部と見なされることが多い記号や文字 (ドル記号、コンマなど) は、
認識されません。</p>
</div>
<div class="paragraph">
<p>ただし、この関数は、基数プレフィックス &amp;O (8 進数) と &amp;H (16 進数) を認識しま
す。 空白、タブ、およびライン フィード文字は、引数から削除されます。</p>
</div>
<div class="paragraph">
<p>次の例では、値 1615198 が返されます。</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-vbscript" data-lang="vbscript">Val("    1615 198th Street N.E.")</code></pre>
</div>
</div>
<div class="paragraph">
<p>次のコード例の Val は、示されている 16 進数値の 10 進数値である -1 を返します。</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-vbscript" data-lang="vbscript">Val("&amp;HFFFF")</code></pre>
</div>
</div>
<div class="admonitionblock caution">
<table>
<tr>
<td class="icon">
<i class="fa icon-caution" title="Caution"></i>
</td>
<td class="content">
Val 関数は、ピリオド (.) のみを 有効な小数点の記号として認識し
ます。 別の小数点の記号を使用する場合は (国際的なアプリケーションの場合など)、
代わりに CDbl を使用して文字列を数値に変換します。
</td>
</tr>
</table>
</div>
<div class="paragraph">
<div class="title">例</div>
<p>次の例では、Val 関数を使用して、文字列に含まれる数値を返します。</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-vbscript" data-lang="vbscript">Dim MyValue
MyValue = Val("2457")    ' Returns 2457.
MyValue = Val(" 2 45 7")    ' Returns 2457.
MyValue = Val("24 and 57")    ' Returns 24.</code></pre>
</div>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_createobject_関数">37.6.6. CreateObject 関数<a id="CreateObject"></a></h4>
<div class="paragraph">
<p>ActiveX オブジェクトへの参照を作成して返します。</p>
</div>
<div class="listingblock">
<div class="title">構文</div>
<div class="content">
<pre class="highlight"><code class="language-vbscript" data-lang="vbscript">CreateObject(class, [ servername ])</code></pre>
</div>
</div>
<div class="paragraph">
<p>CreateObject 関数の構文は、次の指定項目があります。</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 20%;">
<col style="width: 80%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">指定項目</th>
<th class="tableblock halign-left valign-top">説明</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">class</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">必須。Variant (String)。 作成するオブジェクトのアプリケーション名とクラス。</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">servername</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">省略可能。Variant (String)。 オブジェクトを作成するネットワーク サーバーの名前。 servername は、空の文字列 ("") である場合、ローカル コンピューターが使用されます。</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>class 引数の構文は appname.objecttype で、指定項目は次のとおりです。</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 20%;">
<col style="width: 80%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">指定項目</th>
<th class="tableblock halign-left valign-top">説明</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">appname</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">必須。Variant (String)。 オブジェクトを提供するアプリケーションの名前。</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">objecttype</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">必須。Variant (String)。 作成するオブジェクトの型またはクラス。</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<div class="title">解説</div>
<p>オートメーションをサポートするアプリケーションはすべて、1 つ以上の型のオブジェ
クトを提供します。 たとえば、ワード プロセッシング アプリケーションでは、アプ
リケーション オブジェクト、文書オブジェクト、ツール バー オブジェクトが提供さ
れます。</p>
</div>
<div class="paragraph">
<p>ActiveX オブジェクトを作成するには、CreateObject によって返されたオブジェクト
をオブジェクト変数に割り当てます。</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-vbscript" data-lang="vbscript">' Declare an object variable to hold the object
' reference. Dim as Object causes late binding.
Dim ExcelSheet As Object
Set ExcelSheet = CreateObject("Excel.Sheet")</code></pre>
</div>
</div>
<div class="paragraph">
<p>このコードでは、オブジェクトを作成するアプリケーション (この場合は Microsoft
Excel のスプレッドシート) を起動します。 作成されたオブジェクトをコードで参照
するには、定義したオブジェクト変数を使用します。 次の例では、オブジェクト変数
ExcelSheet とその他の Excel オブジェクト (Application オブジェクト、Cells コレ
クションなど) を使用して、新しいオブジェクトのプロパティおよびメソッドにアクセ
スします。</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-vbscript" data-lang="vbscript">' Make Excel visible through the Application object.
ExcelSheet.Application.Visible = True
' Place some text in the first cell of the sheet.
ExcelSheet.Application.Cells(1, 1).Value = "This is column A, row 1"
' Save the sheet to C:\test.xls directory.
ExcelSheet.SaveAs "C:\TEST.XLS"
' Close Excel with the Quit method on the Application object.
ExcelSheet.Application.Quit
' Release the object variable.
Set ExcelSheet = Nothing</code></pre>
</div>
</div>
<div class="paragraph">
<p>As Object 句を使用してオブジェクト変数を宣言すると、任意の型のオブジェクトへの
参照を含めることができる変数が作成されます。 ただし、遅延バインディングの変数
を使用してオブジェクトにアクセスします。つまり、プログラムの実行時にバインドが
行われます。 事前バインドを発生させるオブジェクト変数を作成する、つまり、プロ
グラムがコンパイルされたときにバインドするには、特定のクラス ID を使用してオブ
ジェクト変数を宣言します。 たとえば、次のような Microsoft Excel の参照を宣言し
て作成することができます。</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-vbscript" data-lang="vbscript">Dim xlApp As Excel.Application
Dim xlBook As Excel.Workbook
Dim xlSheet As Excel.WorkSheet
Set xlApp = CreateObject("Excel.Application")
Set xlBook = xlApp.Workbooks.Add
Set xlSheet = xlBook.Worksheets(1)</code></pre>
</div>
</div>
<div class="paragraph">
<p>事前バインド変数を使用して参照すると、パフォーマンスは向上する可能性があります
が、宣言で指定したクラスへの参照しか含めることができません。</p>
</div>
<div class="paragraph">
<p>CreateObject 関数によって返されるオブジェクトを、オブジェクトを必要とする関数
に引数として渡すことができます。 たとえば、次のコードでは、Excel.Application
オブジェクトへの参照を作成して渡します。</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-vbscript" data-lang="vbscript">Call MySub (CreateObject("Excel.Application"))</code></pre>
</div>
</div>
<div class="paragraph">
<p>コンピューターの名前を CreateObject の servername 引数に渡して、ネットワーク接
続されたリモート コンピューターにオブジェクトを作成することができます。 この名
前は、共有名のコンピューター名の部分と同じです。共有名が "\MyServer\Public" の
場合、servername は "MyServer" です。</p>
</div>
<div class="paragraph">
<p>次のコードは、MyServer という名前のリモート コンピューターで実行されている
Excel のインスタンスのバージョン番号を返します。</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-vbscript" data-lang="vbscript">Dim xlApp As Object
Set xlApp = CreateObject("Excel.Application", "MyServer")
Debug.Print xlApp.Version</code></pre>
</div>
</div>
<div class="paragraph">
<p>このリモート サーバーが存在しない場合または使用できない場合は、実行時エラーが
発生します。</p>
</div>
<div class="admonitionblock caution">
<table>
<tr>
<td class="icon">
<i class="fa icon-caution" title="Caution"></i>
</td>
<td class="content">
CreateObject は、オブジェクトの現在のインスタンスがない場合に
使用します。 オブジェクトのインスタンスが既に実行されている場合は、新しいイン
スタンスが開始され、指定した型のオブジェクトが作成されます。 現在のインスタン
スを使用する、またはアプリケーションを起動してファイルを読み込ませるには、
GetObject 関数を使用します。
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>オブジェクトが単一インスタンスのオブジェクトとして登録されている場合は、
CreateObject を何回実行しても、そのオブジェクトのインスタンスは 1 つしか作成さ
れません。</p>
</div>
<div class="paragraph">
<div class="title">例</div>
<p>この例では、CreateObject 関数を使用して Microsoft Excel への参照 (xlApp) を設
定します。 この参照を使用して、Microsoft Excel の Visible プロパティにアクセス
し、Microsoft Excel の Quit メソッドを使用して終了します。 最後に、参照自体が
解放されます。</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-vbscript" data-lang="vbscript">Dim xlApp As Object    ' Declare variable to hold the reference.

Set xlApp = CreateObject("excel.application")
    ' You may have to set Visible property to True
    ' if you want to see the application.
xlApp.Visible = True
    ' Use xlApp to access Microsoft Excel's
    ' other objects.</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_curdir_関数">37.6.7. CurDir 関数<a id="CurDir"></a></h4>
<div class="paragraph">
<p>現在のパスを表す Variant (String) を返します。</p>
</div>
<div class="listingblock">
<div class="title">構文</div>
<div class="content">
<pre class="highlight"><code class="language-vbscript" data-lang="vbscript">CurDir [ (drive) ]</code></pre>
</div>
</div>
<div class="paragraph">
<p>省略可能な drive 引数は、既存のドライブを指定する文字列式です。 drive を指定し
ない場合、または drive に長さ 0 の文字列 ("") を指定した場合、CurDirは、現在の
ドライブのパスを返します。 Macintosh では、CurDir は指定された drive を無視し、
単に現在のドライブのパスを返します。</p>
</div>
<div class="paragraph">
<div class="title">例</div>
<p>次の例は、CurDir 関数を使用して現在のパスを返します。 Macintosh では、CurDirに
指定された drive は無視されます。 既定のドライブ名は、HD で、パス名の各部分は、
バックスラッシュではなくコロンで区切られます。 また、\Windows ではなく
Macintosh のフォルダーを指定します。</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-vbscript" data-lang="vbscript">' Assume current path on C drive is "C:\WINDOWS\SYSTEM" (on Microsoft Windows).
' Assume current path on D drive is "D:\EXCEL".
' Assume C is the current drive.
Dim MyPath
MyPath = CurDir    ' Returns "C:\WINDOWS\SYSTEM".
MyPath = CurDir("C")    ' Returns "C:\WINDOWS\SYSTEM".
MyPath = CurDir("D")    ' Returns "D:\EXCEL".</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_date_関数">37.6.8. Date 関数<a id="Date"></a></h4>
<div class="paragraph">
<p>現在のシステム日付を含む Variant (Date) を返します。</p>
</div>
<div class="listingblock">
<div class="title">構文</div>
<div class="content">
<pre class="highlight"><code class="language-vbscript" data-lang="vbscript">Date</code></pre>
</div>
</div>
<div class="paragraph">
<div class="title">解説</div>
<p>システム日付を設定するには、Date ステートメントを使用します。</p>
</div>
<div class="paragraph">
<p>グレゴリオ暦の場合、Date と Date$ の動作は、Calendar プロパティの設定によって
変更されることはありません。 イスラム暦の場合、Date$ は mm-dd-yyyy という形式
の 10 文字の文字列を返します。ここで、mm (01 – 12)、dd (01 – 30)、および
yyyy (1400 – 1523) は、イスラム暦の月、日、および年を表します。 これに相当す
るグレゴリオ暦の範囲は 1980 年 1 月 1 日から 2099 年 12 月 31 日です。</p>
</div>
<div class="paragraph">
<div class="title">例</div>
<p>次の例では、Date 関数を使用して現在のシステム日付を返します。</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-vbscript" data-lang="vbscript">Dim MyDate
MyDate = Date    ' MyDate contains the current system date.</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_dateadd_関数">37.6.9. DateAdd 関数<a id="DateAdd"></a></h4>
<div class="paragraph">
<p>指定した時間間隔を日付に加算してその日付を含む Variant (Date) を返します。</p>
</div>
<div class="listingblock">
<div class="title">構文</div>
<div class="content">
<pre class="highlight"><code class="language-vbscript" data-lang="vbscript">DateAdd(interval, number, date)</code></pre>
</div>
</div>
<div class="paragraph">
<p>DateAdd 関数の構文に構文に使用される名前付き引数は次のとおりです。</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 20%;">
<col style="width: 80%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">指定項目</th>
<th class="tableblock halign-left valign-top">説明</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">interval</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">必須。 加算する時間間隔を表す文字列式。</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">number</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">必須。 追加するサイクル間隔の数値を表す数値式です。 将来の日時を取得するには正の値を、過去の日時を取得するには負の値を指定します。</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">date</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">必須。 時間間隔を加算する日付を表す Variant (Date)、またはリテラル。</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<div class="title">設定</div>
<p>interval 引数の設定は次のとおりです。</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 20%;">
<col style="width: 80%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">設定</th>
<th class="tableblock halign-left valign-top">説明</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">yyyy</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">年</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">q</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">四半期</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">m</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">月</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">y</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">通年での日数</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">d</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">日</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">w</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">平日</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">ww</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">週</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">h</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">時</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">n</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">分</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">s</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">秒</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<div class="title">解説</div>
<p>DateAdd 関数を使用すると、指定した時間間隔を日付に加算したり、日付から減算した
りできます。 たとえば、DateAdd を使用して、今日から 30 日後の日付、または今か
ら 45 分後の時刻を計算することができます。</p>
</div>
<div class="paragraph">
<p>date に日数を加算する場合、年間通算日 ("y")、日 ("d")、または平日 ("w") を使用
できます。</p>
</div>
<div class="admonitionblock caution">
<table>
<tr>
<td class="icon">
<i class="fa icon-caution" title="Caution"></i>
</td>
<td class="content">
ある日付に日数を足す目的で、(日曜日から土曜日まですべての曜日
を含む) "w" サイクル間隔を使用するとき、DateAdd 関数は、その日までの、指定した
合計日数を追加します。その日までの、(月曜日から金曜日までの) 仕事日の数のみを
追加するのではないことに注意してください。
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>DateAdd 関数が無効な日付を返すことはありません。 次の例では、1 月 31 日に 1 か
月を追加します。</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-vbscript" data-lang="vbscript">DateAdd("m", 1, "31-Jan-95")</code></pre>
</div>
</div>
<div class="paragraph">
<p>この場合、DateAdd は、1995 年 2 月 31 日ではなく、1995 年 2 月 28 日を返します。
date が 1996 年 1 月 31 日の場合は、1996 年は閏年であるため、1996 年 2 月 29
日を返します。</p>
</div>
<div class="paragraph">
<p>計算された日付が西暦 100 年よりも前になる場合 (つまり、date の年より多くの年を
引いた場合)、エラーが発生します。</p>
</div>
<div class="paragraph">
<p>number が Long 値ではない場合、最も近い整数に丸めてから評価されます。</p>
</div>
<div class="admonitionblock caution">
<table>
<tr>
<td class="icon">
<i class="fa icon-caution" title="Caution"></i>
</td>
<td class="content">
DateAdd の戻り値の形式は、date 引数で渡された形式ではなく、コ
ントロール パネルでの設定によって決まります。
</td>
</tr>
</table>
</div>
<div class="admonitionblock caution">
<table>
<tr>
<td class="icon">
<i class="fa icon-caution" title="Caution"></i>
</td>
<td class="content">
Calendar プロパティの設定がグレゴリオ暦の場合、date にはグレ
ゴリオ暦の日付を指定する必要があります。 カレンダーがイスラム暦である場合、指
定する日付もイスラム暦である必要があります。 月の値が名前である場合、名前は現
在の Calendar プロパティの設定と一致している必要があります。 月名が現在の
Calendar プロパティ設定と競合する可能性を最小にするには、数字で示す月の値 (短
い日付形式) を入力します。
</td>
</tr>
</table>
</div>
<div class="paragraph">
<div class="title">例</div>
<p>次の例では、日付を受け取り、DateAdd 関数を使用して、指定された月数を加算した将
来の日付を表示します。</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-vbscript" data-lang="vbscript">Dim FirstDate As Date    ' Declare variables.
Dim IntervalType As String
Dim Number As Integer
Dim Msg As String
IntervalType = "m"    ' "m" specifies months as interval.
FirstDate = InputBox("Enter a date")
Number = InputBox("Enter number of months to add")
Msg = "New date: " &amp; DateAdd(IntervalType, Number, FirstDate)
MsgBox Msg</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_datediff_関数">37.6.10. DateDiff 関数<a id="DateDiff"></a></h4>
<div class="paragraph">
<p>2 つの指定した日付の時間間隔を指定する Variant (Long) を返します。</p>
</div>
<div class="listingblock">
<div class="title">構文</div>
<div class="content">
<pre class="highlight"><code class="language-vbscript" data-lang="vbscript">DateDiff(interval, date1, date2, [ firstdayofweek, [ firstweekofyear ]] )</code></pre>
</div>
</div>
<div class="paragraph">
<p>DateDiff 関数の構文には、次の名前付き引数があります。</p>
</div>
<div class="paragraph">
<p>|指定項目 |説明
|interval |必須。 date1 と date2 の時間間隔の計算に使用する時間単位を表す文字列式です。
|date1、date2 |必須。Variant (Date)。 計算に使用する 2 つの日付です。
|firstdayofweek |省略可能。 週の始まりの曜日を表す定数です。 省略すると、日曜日を指定したものと見なされます。
|firstweekofyear |省略可能。 年の第 1 週を指定する定数です。 省略すると、1 月 1 日を含む週が第 1 週と見なされます。</p>
</div>
<div class="paragraph">
<div class="title">設定</div>
<p>interval 引数の設定は次のとおりです。</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 20%;">
<col style="width: 80%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">設定</th>
<th class="tableblock halign-left valign-top">説明</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">yyyy</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">年</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">q</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">四半期</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">m</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">月</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">y</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">通年での日数</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">d</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">日</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">w</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">平日</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">ww</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">週</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">h</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">時</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">n</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">分</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">s</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">秒</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>firstdayofweek 引数の設定は次のとおりです。</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 16.6666%;">
<col style="width: 16.6666%;">
<col style="width: 66.6668%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">定数</th>
<th class="tableblock halign-left valign-top">値</th>
<th class="tableblock halign-left valign-top">説明</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">vbUseSystem</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">NLS API 設定を使用します。</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">vbSunday</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">日曜日 (既定)</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">vbMonday</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">2</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">月曜日</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">vbTuesday</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">3</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">火曜日</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">vbWednesday</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">4</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">水曜日</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">vbThursday</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">5</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">木曜日</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">vbFriday</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">6</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">金曜日</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">vbSaturday</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">7</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">土曜日</p></td>
</tr>
</tbody>
</table>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 16.6666%;">
<col style="width: 16.6666%;">
<col style="width: 66.6668%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">定数</th>
<th class="tableblock halign-left valign-top">値</th>
<th class="tableblock halign-left valign-top">説明</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">vbUseSystem</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">NLS API 設定を使用します。</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">vbFirstJan1</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1 月 1 日が含まれる週から開始します (既定)。</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">vbFirstFourDays</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">2</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">新年で少なくとも 4 日ある最初の週から開始します。</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">vbFirstFullWeek</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">3</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">年の最初の完全な週から開始します。</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<div class="title">解説</div>
<p>DateDiff 関数を使用して、2 つの日付の間に指定した時間間隔がどのくらい存在する
かを確認します。 たとえば、DateDiff を使用して、2 つの日付間の日数や、今日から
年末までの週数を計算することができます。</p>
</div>
<div class="paragraph">
<p>date1 と date2 の間の日数を計算するには、年 ("y") または日 ("d") の日付を使用
できます。 interval が曜日 ("w") の場合、DateDiff は 2 つの日付間の週数を返し
ます。 date1 が月曜日の場合、DateDiff では date2 までの月曜日の数がカウントさ
れます。 date1 ではなく date2 がカウントされます。</p>
</div>
<div class="paragraph">
<p>一方、interval が週 ("ww") の場合、DateDiff 関数は 2 つの日付間のカレンダーの
週数を返します。 date1 と date2 間の日曜日の数がカウントされます。 DateDiff で
は、date2 が日曜日の場合は、date2 がカウントされます。date1 が日曜日の場合でも
date1 はカウントされません。</p>
</div>
<div class="paragraph">
<p>date1 が date2 よりも後の時点を示す場合、DateDiff 関数は負の数を返します。
firstdayofweek 引数は、"w" および "ww" の間隔記号を使用する計算に影響します。</p>
</div>
<div class="paragraph">
<p>date1 または date2 が日付リテラルの場合、指定した年はその日付の一部として恒久
的に保存されます。 ただし、date1 または date2 が二重引用符 (" ") で囲まれてい
て、年を省略した場合、date1 または date2 の式が評価されるたびに、現在の年がコ
ードに挿入されます。 これにより、別の年でも使用できるコードを記述することがで
きます。</p>
</div>
<div class="paragraph">
<p>連続する年の 12 月 31 日と 1 月 1 日を比較すると、1 日が経過しただけの場合でも、
年 ("yyyy") の DateDiff は 1 を返します。</p>
</div>
<div class="admonitionblock caution">
<table>
<tr>
<td class="icon">
<i class="fa icon-caution" title="Caution"></i>
</td>
<td class="content">
Calendar プロパティの設定がグレゴリオ暦の場合、date1 と date2
ではグレゴリオ暦の日付を指定する必要があります。 カレンダーがイスラム暦の場合
は、イスラム暦で日付を指定する必要があります。
</td>
</tr>
</table>
</div>
<div class="paragraph">
<div class="title">例</div>
<p>この例では、DateDiff 関数を使用して、指定された日付から今日までの日数を表示し
ます。</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-vbscript" data-lang="vbscript">Dim TheDate As Date    ' Declare variables.
Dim Msg
TheDate = InputBox("Enter a date")
Msg = "Days from today: " &amp; DateDiff("d", Now, TheDate)
MsgBox Msg</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_datepart_関数">37.6.11. DatePart 関数<a id="DatePart"></a></h4>
<div class="admonitionblock warning">
<table>
<tr>
<td class="icon">
<i class="fa icon-warning" title="Warning"></i>
</td>
<td class="content">
この関数の使用には問題があります。 一部のカレンダー年の最後の
月曜日は、週1である必要がある場合は、53週として返されます。 詳細および回避策に
ついては、「Format または DatePart 関数は、先週の最後の月曜日に間違った週番号
を返す」を参照してください。 日付の指定した部分を含む Variant (Integer) を返し
ます。
</td>
</tr>
</table>
</div>
<div class="listingblock">
<div class="title">構文</div>
<div class="content">
<pre class="highlight"><code class="language-vbscript" data-lang="vbscript">DatePart(interval, date, [ firstdayofweek, [ firstweekofyear ]])</code></pre>
</div>
</div>
<div class="paragraph">
<p>DatePart 関数の構文には、次の名前付き引数があります。</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 20%;">
<col style="width: 80%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">指定項目</th>
<th class="tableblock halign-left valign-top">説明</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">interval</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">必須。 戻す時間のサイクル間隔の 文字列式です。</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">date</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">必須。 評価する Variant (Date) の値です。</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">firstdayofweek</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">省略可能。 週の始まりの曜日を表す定数です。 省略すると、日曜日を指定したものと見なされます。</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">firstweekofyear</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">省略可能。 年の第 1 週を指定する定数です。 省略すると、1 月 1 日を含む週が第 1 週と見なされます。</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<div class="title">設定</div>
<p>interval 引数の設定は次のとおりです。</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 20%;">
<col style="width: 80%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">設定</th>
<th class="tableblock halign-left valign-top">説明</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">yyyy</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">年</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">q</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">四半期</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">m</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">月</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">y</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">通年での日数</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">d</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">日</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">w</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">平日</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">ww</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">週</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">h</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">時</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">n</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">分</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">s</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">秒</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>firstdayofweek 引数の設定は次のとおりです。</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 20%;">
<col style="width: 80%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">定数</th>
<th class="tableblock halign-left valign-top">値</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">説明</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">vbUseSystem</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">.0</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">NLS API 設定を使用します。</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">vbSunday</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1-d</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">日曜日 (既定)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">vbMonday</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">pbm-2</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">月曜日</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">vbTuesday</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1/3</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">火曜日</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">vbWednesday</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">4</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">水曜日</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">vbThursday</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">5</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">木曜日</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">vbFriday</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">6</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">金曜日</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">vbSaturday</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">7</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p><em>firstweekofyear</em> 引数の設定は次のとおりです。</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 20%;">
<col style="width: 80%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">定数</th>
<th class="tableblock halign-left valign-top">値</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">説明</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">vbUseSystem</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">.0</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">NLS API 設定を使用します。</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">vbFirstJan1</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1-d</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">1 月 1 日が含まれる週から開始します (既定)。</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">vbFirstFourDays</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">pbm-2</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">新年で少なくとも 4 日ある最初の週から開始します。</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">vbFirstFullWeek</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1/3</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<div class="title">解説</div>
<p>DatePart 関数を使用して、日付を評価し、特定の時間間隔を返すことができます。 た
とえば、曜日または現在の時間を計算するために、DatePart を使用する場合がありま
す。</p>
</div>
<div class="paragraph">
<p>firstdayofweek 引数は、"w" および "ww" の間隔記号を使用する計算に影響します。</p>
</div>
<div class="paragraph">
<p>date が日付リテラルの場合、指定した年はその日付の一部として恒久的に保存されま
す。 ただし、date が二重引用符 (" ") で囲まれていて、年を省略した場合、date の
式が評価されるたびに、現在の年がコードに挿入されます。 これにより、別の年でも
使用できるコードを記述することができます。</p>
</div>
<div class="admonitionblock warning">
<table>
<tr>
<td class="icon">
<i class="fa icon-warning" title="Warning"></i>
</td>
<td class="content">
<a href="#Calendar">Calendar</a> プロパティの設定がグレゴリオ暦の場合、
date にはグレゴリオ暦の日付を指定する必要があります。 カレンダーがイスラム暦で
ある場合、指定する日付もイスラム暦である必要があります。
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>戻された日付の部分は、現在のアラビア歴の期間の単位になります。 たとえば、現在
のカレンダーがイスラム暦で、戻された日付の部分が年の場合、年の値はイスラム暦年
になります。</p>
</div>
<div class="paragraph">
<div class="title">例</div>
<p>この例では、DatePart 関数を使用して日付を取得し、その日付が含まれる四半期が表
示されます。</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-vbscript" data-lang="vbscript">Dim TheDate As Date    ' Declare variables.
Dim Msg
TheDate = InputBox("Enter a date:")
Msg = "Quarter: " &amp; DatePart("q", TheDate)
MsgBox Msg</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_dateserial_関数">37.6.12. DateSerial 関数<a id="DateSerial"></a></h4>
<div class="paragraph">
<p>指定した年、月、日の Variant (Date) を返します。</p>
</div>
<div class="listingblock">
<div class="title">構文</div>
<div class="content">
<pre class="highlight"><code class="language-vbscript" data-lang="vbscript">DateSerial(year, month, day)</code></pre>
</div>
</div>
<div class="paragraph">
<p>DateSerial 関数の構文には、次の名前付き引数があります。</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 20%;">
<col style="width: 80%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">パーツ</th>
<th class="tableblock halign-left valign-top">説明</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">year</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">必須。Integer。 100 以上 9999 以下の数値、または数式です。</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">month</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">必須。Integer。 任意の数式。</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">day</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">必須。Integer。 任意の数式。</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<div class="title">解説</div>
<p>1991 年 12 月 31 日などの日付を指定するには、DateSerial の各引数の数値範囲がそ
     の単位の許容範囲内である必要があります。つまり、日の場合は 1 以上 31 以下、
月の場合は 1 以上 12 以下です。 ただし、特定の日付の前後の日数、月数、年数を表
す任意の数式を使用して、各引数の相対日付を指定することもできます。</p>
</div>
<div class="paragraph">
<p>次の例では、絶対日付数値の代わりに、数式を使用しています。 DateSerial 関数は、
月初めの前日 (1 - 1)、8 月から 2 か月前 (8 - 2)、1990 年から 10 年前 (1990 -
10)、つまり、1980 年 5 月 31 日を返します。</p>
</div>
<div class="paragraph">
<p>Windows 98 または Windows 2000 では、year 引数の 2 桁の年は、ユーザーが定義し
たマシン設定により解釈されます。 既定の設定では、0 以上 29 以下の値が 2000 年
から 2029 年として解釈されます。 30 以上 99 以下の既定値は、1930 年から 1999
年として解釈されます。 その他のすべての year 引数では、4 桁の年を使用します
(1800 など)。</p>
</div>
<div class="paragraph">
<p>以前の Windows バージョンでは、上記で説明した既定値に応じて、2 桁の年で解釈さ
れます。 関数が適切な値を確実に返すようにするには、4 桁の年を使用します。</p>
</div>
<div class="paragraph">
<p>いずれかの引数の値が引数の許容範囲を超えた場合は、必要に応じて次の上位の単位に
繰り越されます。 たとえば、35 日を指定した場合は、1 か月と数日と評価されます
(日数は月によって変わります)。 引数のいずれか 1 つでも -32,768 から 32,767 の
範囲を超えると、エラーが発生します。 3 つの引数で指定された日付が許容日付範囲
外の日付になると、エラーが発生します。</p>
</div>
<div class="admonitionblock caution">
<table>
<tr>
<td class="icon">
<i class="fa icon-caution" title="Caution"></i>
</td>
<td class="content">
year、month、および day は、カレンダー プロパティ設定がグレゴ
リオ暦の場合、指定した値はグレゴリオ暦と見なされます。 カレンダー プロパティの
設定がイスラム暦の場合、指定した値はイスラム暦と見なされます。
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>返される日付部分は、現在の Visual Basic のカレンダーの暦になります。 たとえば、
現在のカレンダーがイスラム暦で、返される日付部分が年の場合、年の値はイスラム暦
の年になります。 引数 year の場合、0 以上 99 以下の値は 1400 年から 1499 年と
して解釈されます。 その他のすべての year 値では、完全な 4 桁の年を使用します
(1520 など)。</p>
</div>
<div class="paragraph">
<div class="title">例</div>
<p>この例では、DateSerial 関数を使用して、指定した年、月、日の日付を返しています。</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-vbscript" data-lang="vbscript">Dim MyDate
' MyDate contains the date for February 12, 1969.
MyDate = DateSerial(1969, 2, 12)    ' Return a date.</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_datevalue_関数">37.6.13. DateValue 関数<a id="DateValue"></a></h4>
<div class="paragraph">
<p>Variant (Date) を返します。</p>
</div>
<div class="listingblock">
<div class="title">構文</div>
<div class="content">
<pre class="highlight"><code class="language-vbscript" data-lang="vbscript">DateValue(date)</code></pre>
</div>
</div>
<div class="paragraph">
<p>必須の date 引数は、通常、100 年 1 月 1 日から 9999 年 12 月 31 日までの日付を
表す文字列式です。 また、date には、この範囲内の日付や時刻、または日付と時刻の
両方を表す任意の式を指定することもできます。</p>
</div>
<div class="paragraph">
<div class="title">解説</div>
<p>date が有効な日付の区切り記号で区切られた数字のみを含む文字列である場合、
DateValue は、ユーザーがシステムに対して指定した短い日付形式に従って月、日、年
の順序を認識します。 また、DateValue は、月の名前 (長い形式または省略形) を含
んだ明確な日付も認識します。 たとえば、DateValue は、"12/30/1991" と
"12/30/91" だけでなく "December 30, 1991" と "Dec 30, 1991" も認識します。</p>
</div>
<div class="paragraph">
<p>date の年の部分を省略した場合、DateValue はコンピューターのシステム日付の現在
の年を使用します。</p>
</div>
<div class="paragraph">
<p>date 引数に時刻の情報が含まれている場合、DateValue はその時刻を返しません。 た
だし、date に無効な時刻の情報 ("89:98" など) が含まれているとエラーが発生しま
す。</p>
</div>
<div class="admonitionblock caution">
<table>
<tr>
<td class="icon">
<i class="fa icon-caution" title="Caution"></i>
</td>
<td class="content">
<a href="#Calendar">Calendar</a> プロパティの設定がグレゴリオ暦の場合、
date にはグレゴリオ暦の日付を指定する必要があります。 カレンダーがイスラム暦で
ある場合、指定する日付もイスラム暦である必要があります。 イスラム暦の日付を指
定する場合、引数 date は、"1/1/100" (グレゴリオ暦の 718 年 8 月 2 日) から
"4/3/9666" (グレゴリオ暦の 9999 年 12 月 31 日) の範囲内の日付を表す String で
す。
</td>
</tr>
</table>
</div>
<div class="paragraph">
<div class="title">例</div>
<p>次の例では、DateValue 関数を使用して文字列を日付に変換します。 "MyDate =
<mark>2/12/69</mark>" のように、日付リテラルを使用して Variant 変数または Date 変数に日付
を直接割り当てることもできます。</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-vbscript" data-lang="vbscript">Dim MyDate
MyDate = DateValue("February 12, 1969")    ' Return a date.</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_day_関数">37.6.14. Day 関数<a id="Day"></a></h4>
<div class="paragraph">
<p>月の特定の 1 日を表す 1 から 31 の範囲の整数を指定する Variant (Integer) を返
します。</p>
</div>
<div class="listingblock">
<div class="title">構文</div>
<div class="content">
<pre class="highlight"><code class="language-vbscript" data-lang="vbscript">Day(date)</code></pre>
</div>
</div>
<div class="paragraph">
<p>必須の date 引数は、日を表す任意の Variant、数式、文字列式、または任意の組み合
わせです。 date に Null が含まれている場合は Null が返されます。</p>
</div>
<div class="admonitionblock caution">
<table>
<tr>
<td class="icon">
<i class="fa icon-caution" title="Caution"></i>
</td>
<td class="content">
<a href="#Calendar">Calendar</a> プロパティの設定がグレゴリオ暦の場合、返
される整数は、date 引数のグレゴリオ暦の日を示します。 Calendar がイスラム暦の
場合、返される整数は、date 引数のイスラム暦の日を示します。
</td>
</tr>
</table>
</div>
<div class="paragraph">
<div class="title">例</div>
<p>次の例では、Day 関数を使用して、指定した日付から日を取得します。 開発環境では、
日付リテラルは、コードのロケール設定を使用して短い形式で表示されます。</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-vbscript" data-lang="vbscript">Dim MyDate, MyDay
MyDate = #February 12, 1969#    ' Assign a date.
MyDay = Day(MyDate)    ' MyDay contains 12.</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_ddb_関数">37.6.15. DDB 関数<a id="DDB"></a></h4>
<div class="paragraph">
<p>倍額定率法や、ユーザーが指定した他の方法を使用して、特定の期における資産の減価
償却費を指定する Double を返します。</p>
</div>
<div class="listingblock">
<div class="title">構文</div>
<div class="content">
<pre class="highlight"><code class="language-vbscript" data-lang="vbscript">DDB(cost, salvage, life, period, [ factor ])</code></pre>
</div>
</div>
<div class="paragraph">
<p>DDB 関数には、次の名前付き引数があります。</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 20%;">
<col style="width: 80%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">パーツ</th>
<th class="tableblock halign-left valign-top">説明</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">cost</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">必須です。 資産の初期コストを指定する Double です。</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">salvage</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">必須です。 耐用期間が終了した時点での資産の価格を指定する Double です。</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">life</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">必須です。 資産の耐用期間を指定する Double です。</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">period</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">必須。 資産の減価償却費を計算する期を指定する Double です。</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">factor</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">省略可能。 減価償却率を指定する Variant です。 省略すると、2 (倍額定率法) を指定したと見なされます。</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<div class="title">解説</div>
<p>倍額定率法では、減価償却費が加速的に計算されます。 減価償却費は、最初の期が最
も多く、その後の期では減少します。</p>
</div>
<div class="paragraph">
<p>引数の life と period は、同じ単位で指定する必要があります。 たとえば、life に
月数を指定した場合は、period にも月数を指定する必要があります。 すべての引数は、
必ず正の数で指定してください。</p>
</div>
<div class="paragraph">
<p>DDB 関数では、次の数式を使用して、指定した期の減価償却費を計算します。</p>
</div>
<div class="paragraph">
<p>価償却費/period = ((cost - salvage) * factor) / life</p>
</div>
<div class="paragraph">
<div class="title">例</div>
<p>この例では、DDB 関数を使用して、指定した期における資産の減価償却費を返します。
指定する項目は、初期コスト (InitCost)、資産の耐用期間が終了した時点での残存価
額 (SalvageVal)、資産の耐用年数 (LifeTime)、および減価償却費を計算する年単位の
期 (Depr) です。</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-vbscript" data-lang="vbscript">Dim Fmt, InitCost, SalvageVal, MonthLife, LifeTime, DepYear, Depr
Const YRMOS = 12    ' Number of months in a year.
Fmt = "###,##0.00"
InitCost = InputBox("What's the initial cost of the asset?")
SalvageVal = InputBox("Enter the asset's value at end of its life.")
MonthLife = InputBox("What's the asset's useful life in months?")
Do While MonthLife &lt; YRMOS    ' Ensure period is &gt;= 1 year.
    MsgBox "Asset life must be a year or more."
    MonthLife = InputBox("What's the asset's useful life in months?")
Loop
LifeTime = MonthLife / YRMOS    ' Convert months to years.
If LifeTime &lt;&gt; Int(MonthLife / YRMOS) Then
    LifeTime = Int(LifeTime + 1)    ' Round up to nearest year.
End If
DepYear = CInt(InputBox("Enter year for depreciation calculation."))
Do While DepYear &lt; 1 Or DepYear &gt; LifeTime
    MsgBox "You must enter at least 1 but not more than " &amp; LifeTime
    DepYear = InputBox("Enter year for depreciation calculation.")
Loop
Depr = DDB(InitCost, SalvageVal, LifeTime, DepYear)
MsgBox "The depreciation for year " &amp; DepYear &amp; " is " &amp; _
Format(Depr, Fmt) &amp; "."</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_dir_関数">37.6.16. Dir 関数<a id="Dir"></a></h4>
<div class="paragraph">
<p>指定したパターンまたはファイル属性に一致するファイル、ディレクトリ、フォルダー
の名前、またはドライブのボリューム ラベルを表す String を返します。</p>
</div>
<div class="listingblock">
<div class="title">構文</div>
<div class="content">
<pre class="highlight"><code class="language-vbscript" data-lang="vbscript">Dir [ (pathname, [ attributes ] ) ]</code></pre>
</div>
</div>
<div class="paragraph">
<p>Dir 関数の構文には、次の指定項目があります。</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 20%;">
<col style="width: 80%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">パーツ</th>
<th class="tableblock halign-left valign-top">説明</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">pathname</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">省略可能。 ファイル名を指定する文字列式です。ディレクトリまたはフォルダー、およびドライブを含めることができます。 pathname が見つからない場合は、長さ 0 の文字列 ("") が返されます。</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">attributes</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">省略可能。 ファイル属性を指定する定数または数式 (合計によって指定) です。 省略した場合は、pathname に一致する、属性のないファイルが返されます。</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<div class="title">設定</div>
<p>attributes 引数の設定は次のとおりです。</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 28.5714%;">
<col style="width: 14.2857%;">
<col style="width: 57.1429%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">定数</th>
<th class="tableblock halign-left valign-top">値</th>
<th class="tableblock halign-left valign-top">説明</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">vbNormal</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">(既定値) 属性のないファイル。</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">vbReadOnly</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">属性のないファイルと読み取り専用のファイル。</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">vbHidden</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">2</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">属性のないファイルと隠しファイル。</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">vbSystem</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">4</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">属性のないファイルとシステム ファイル。 Macintosh では使用できません。</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">vbVolume</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">8</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">ボリューム ラベル。他の属性を指定した場合は、vbVolume は無視されます。 Macintosh では使用できません。</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">vbDirectory</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">16</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">属性のないファイルとディレクトリまたはフォルダー。</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">vbAlias</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">64</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">指定されたファイル名はエイリアスです。 Macintosh でのみ使用できます。</p></td>
</tr>
</tbody>
</table>
<div class="admonitionblock caution">
<table>
<tr>
<td class="icon">
<i class="fa icon-caution" title="Caution"></i>
</td>
<td class="content">
これらの定数は、Visual Basic for Applications によって指定され、
コードの任意の場所で実際の値の代わりに使用できます。
</td>
</tr>
</table>
</div>
<div class="paragraph">
<div class="title">解説</div>
<p>Microsoft Windows では、Dir で複数の文字 (*) と 1 文字 (?) のワイルドカードを
使用して、複数のファイルを指定できます。 Macintosh では、これらの文字は有効な
ファイル名の文字と見なされ、複数のファイルを指定するためのワイルドカードとして
は使用できません。</p>
</div>
<div class="paragraph">
<p>Macintosh ではワイルドカードがサポートされないため、ファイルの種類を使用してフ
ァイルのグループを識別します。 MacID 関数を使用すると、ファイル名を使わずにフ
ァイルの種類を指定できます。 たとえば、次のステートメントでは、現在のフォルダ
ー内の最初のテキスト ファイルの名前が返されます。</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-vbscript" data-lang="vbscript">Dir("SomePath", MacID("TEXT"))</code></pre>
</div>
</div>
<div class="paragraph">
<p>フォルダー内のすべてのファイルに対して反復処理を行うには、空の文字列を指定しま
す。</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-vbscript" data-lang="vbscript">Dir("")</code></pre>
</div>
</div>
<div class="paragraph">
<p>Microsoft Windows では、Dir で MacID 関数を使用するとエラーが発生します。</p>
</div>
<div class="paragraph">
<p>attribute の値が 256 を超える場合は MacID の値と見なされます。</p>
</div>
<div class="paragraph">
<p>Dir 関数の最初の呼び出しの際に pathname を指定しないとエラーが発生します。 フ
ァイル属性も指定する場合は、pathname を指定する必要があります。</p>
</div>
<div class="paragraph">
<p>Dir は、pathname に一致する最初のファイル名を返します。 pathname に一致する追
加のファイル名を取得するには、引数なしで Dir を再度呼び出します。 一致するファ
イル名がなくなると、Dir は長さ 0 の文字列 ("") を返します。 長さ 0 の文字列が
返された後の呼び出しで、pathname を指定しないとエラーが発生します。</p>
</div>
<div class="paragraph">
<p>現在の pathname に一致するすべてのファイル名を取得せずに、新しい pathname に変
更することもできます。 ただし、Dir 関数を再帰的に呼び出すことはできません。
vbDirectory 属性を付けて Dir を呼び出しても、継続してサブディレクトリが返され
ることはありません。</p>
</div>
<div class="paragraph">
<p>Excel for Mac 2016 では、最初の Dir 関数呼び出しは成功します。 ただし、指定さ
れたディレクトリで繰り返して呼び出すと、エラーが発生します。 残念ですが、これ
は既知のバグです。</p>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
ファイル名は特定の順序で取得されるわけではないため、必要に応じて、返さ
れたファイル名を配列に格納し、その配列を並べ替えます。
</td>
</tr>
</table>
</div>
</div>
<div class="sect3">
<h4 id="_doevents_関数">37.6.17. DoEvents 関数<a id="DoEvents"></a></h4>
<div class="paragraph">
<p>オペレーティング システムが他のイベントを処理できるように、実行を渡します。</p>
</div>
<div class="listingblock">
<div class="title">構文</div>
<div class="content">
<pre class="highlight"><code class="language-vbscript" data-lang="vbscript">DoEvents( )</code></pre>
</div>
</div>
<div class="paragraph">
<div class="title">解説</div>
<p>DoEvents 関数は、単体バージョンの Visual Basic (Visual Basic Professional
Edition など) で開かれているフォームの数を表す Integer を返します。 他のすべて
のアプリケーションでは、DoEvents はゼロを返します。</p>
</div>
<div class="paragraph">
<p>DoEvents はオペレーティング システムに制御を渡します。 オペレーティング システ
ムがキュー内のイベントの処理を終了し、SendKeys キューのすべてのキーが送信され
た後、制御が戻されます。</p>
</div>
<div class="paragraph">
<p>DoEvents は、たとえばユーザーが一旦開始した処理 (ファイルの検索など) を取り消
せるようにする、といった単純な処理を行う場合に最も役に立ちます。 長時間実行し
ているプロセスの場合にプロセッサを空けるには、タイマーを使用するか、またはタス
クを ActiveX EXE コンポーネントに委任する方が適しています。 後者の場合、アプリ
ケーションとは完全に独立してタスクを続行でき、オペレーティング システムがマル
チタスクとタイム スライスの処理を行います。</p>
</div>
<div class="paragraph">
<p>イベント プロシージャ内でプロセッサに一時的に制御を渡すときは、プロシージャが、
最初の呼び出しが戻る前とは異なるコード部分から再開されないようにする必要があり
ます。異なる場所から再開すると、予期しない結果になる可能性があります。 さらに、
制御を渡している間に、他のアプリケーションが予期しない方法でプロシージャとやり
取りする可能性がある場合は、DoEvents を使用しないでください。</p>
</div>
<div class="paragraph">
<div class="title">例</div>
<p>次の例では、DoEvents 関数を使用して、1,000 回ループするごとに 1 回、オペレーテ
ィング システムに制御を渡します。 DoEvents は、開いている Visual Basic フォー
ムの数を返しますが、これが行われるのは、ホスト アプリケーションが Visual Basic
の場合のみです。</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-vbscript" data-lang="vbscript">' Create a variable to hold number of Visual Basic forms loaded
' and visible.
Dim I, OpenForms
For I = 1 To 150000    ' Start loop.
    If I Mod 1000 = 0 Then     ' If loop has repeated 1000 times.
        OpenForms = DoEvents    ' Yield to operating system.
    End If
Next I    ' Increment loop counter.</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_environ_関数">37.6.18. Environ 関数<a id="Environ"></a></h4>
<div class="paragraph">
<p>オペレーティング システムの環境変数に関連付けられた String を返します。
Macintosh では使用できません。</p>
</div>
<div class="listingblock">
<div class="title">構文</div>
<div class="content">
<pre class="highlight"><code class="language-vbscript" data-lang="vbscript">Environ( { envstring | number } )</code></pre>
</div>
</div>
<div class="paragraph">
<p>Environ 関数の構文には、次の名前付き引数があります。</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 20%;">
<col style="width: 80%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">パーツ</th>
<th class="tableblock halign-left valign-top">説明</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">envstring</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">省略可能。 環境変数の名前を含む文字列式です。</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">number</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">省略可能。 環境文字列テーブル内の環境文字列の数値順序に対応する数式です。 number 引数には任意の数式を使用できますが、評価される前に整数に丸められます。</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<div class="title">解説</div>
<p>envstring が環境文字列テーブル内にない場合は、長さ 0 の文字列 ("") が返されま
す。 それ以外の場合、Environ は指定された envstring に割り当てられているテキス
トを返します。つまり、環境文字列テーブルでその環境変数の等号 (=) の後にあるテ
キストを返します。</p>
</div>
<div class="paragraph">
<p>number を指定した場合は、環境文字列テーブルでその数値位置にある文字列が返され
ます。 この場合、Environ は envstring を含むすべてのテキストを返します。 指定
された位置に環境文字列がない場合、Environ は長さ 0 の文字列を返します。</p>
</div>
<div class="paragraph">
<div class="title">例</div>
<p>この例では、Environ 関数を使用して、PATH ステートメントのエントリ番号と長さを
環境文字列テーブルから提供しています。 Macintosh では使用できません。</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-vbscript" data-lang="vbscript">Dim EnvString, Indx, Msg, PathLen    ' Declare variables.
Indx = 1    ' Initialize index to 1.
Do
    EnvString = Environ(Indx)    ' Get environment
                ' variable.
    If Left(EnvString, 5) = "PATH=" Then    ' Check PATH entry.
        PathLen = Len(Environ("PATH"))    ' Get length.
        Msg = "PATH entry = " &amp; Indx &amp; " and length = " &amp; PathLen
        Exit Do
    Else
        Indx = Indx + 1    ' Not PATH entry,
    End If    ' so increment.
Loop Until EnvString = ""
If PathLen &gt; 0 Then
    MsgBox Msg    ' Display message.
Else
    MsgBox "No PATH environment variable exists."
End If</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_eof_関数">37.6.19. EOF 関数<a id="EOF"></a></h4>
<div class="paragraph">
<p>Random またはシーケンシャル Input で開かれたファイルの末尾に達した場合、
Boolean 値 True を含む整数を返します。</p>
</div>
<div class="listingblock">
<div class="title">構文</div>
<div class="content">
<pre class="highlight"><code class="language-vbscript" data-lang="vbscript">EOF(filenumber)</code></pre>
</div>
</div>
<div class="paragraph">
<p>filenumber 引数は必須の引数です。有効なファイル番号を含む整数です。</p>
</div>
<div class="paragraph">
<div class="title">解説</div>
<p>EOF を使用して、ファイルの末尾を越える入力によるエラーが発生しないようにします。</p>
</div>
<div class="paragraph">
<p>ファイルの末尾に達するまで、EOF 関数は False を返します。 Random または Binary
アクセスで開かれたファイルの場合、最後に実行した Get ステートメントでレコード
全体を読み取れなくなるまで、EOF は False を返します。</p>
</div>
<div class="paragraph">
<p>Binary アクセス用に開かれたファイルでは、Input 関数を使って、EOF が True を返
すまでファイルを読み取ろうとすると、エラーが発生します。 Input でバイナリ ファ
イルを読み取るときは、EOF の代わりに LOF 関数と Loc 関数を使用します。または、
EOF 関数を使用しているときは Get を使用します。 Output で開かれたファイルの場
合、EOF は常に True を返します。</p>
</div>
<div class="paragraph">
<div class="title">例</div>
<p>この例では、EOF 関数を使用してファイルの末尾を検出します。 この例では、MYFILE
は数行のテキストを含むテキスト ファイルであると仮定しています。</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-vbscript" data-lang="vbscript">Dim InputData
Open "MYFILE" For Input As #1    ' Open file for input.
Do While Not EOF(1)    ' Check for end of file.
    Line Input #1, InputData    ' Read line of data.
    Debug.Print InputData    ' Print to the Immediate window.
Loop
Close #1    ' Close file.</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_error_関数">37.6.20. Error 関数<a id="Error"></a></h4>
<div class="paragraph">
<p>指定したエラー番号に対応するエラー メッセージを返します。</p>
</div>
<div class="listingblock">
<div class="title">構文</div>
<div class="content">
<pre class="highlight"><code class="language-vbscript" data-lang="vbscript">Error [ (errornumber) ]</code></pre>
</div>
</div>
<div class="paragraph">
<p>errornumber 引数は省略可能です。任意の有効なエラー番号を指定できます。
errornumber が有効なエラー番号でも、定義されていなければ、Error から "アプリケ
ーション定義またはオブジェクト定義のエラーです。" という文字列が返されます。</p>
</div>
<div class="paragraph">
<p>errornumber が有効でない場合はエラーが発生します。 errornumber を省略した場合
は、最後に発生した実行時エラーに対応するメッセージが返されます。 実行時エラー
が発生していない場合、または errornumber が 0 の場合は、Error から長さ 0 の文
字列 ("") が返されます。</p>
</div>
<div class="paragraph">
<div class="title">解説</div>
<p>最後に発生した実行時エラーを特定するには、Err オブジェクトのプロパティ設定を調
べます。 Error 関数の戻り値は、Err オブジェクトの Description プロパティに対応
しています。</p>
</div>
<div class="paragraph">
<div class="title">例</div>
<p>この例では、Error 関数を使用して、指定したエラー番号に対応するエラー メッセー
ジを出力します。</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-vbscript" data-lang="vbscript">Private Sub PrintError()
    Dim ErrorNumber As Long, count As Long
    count = 1: ErrorNumber = 1
    On Error GoTo EOSb
    Do While count &lt; 100
        Do While Error(ErrorNumber) = "Application-defined or object-defined error": ErrorNumber = ErrorNumber + 1: Loop
        Debug.Print count &amp; "-Error(" &amp; ErrorNumber &amp; "): " &amp; Error(ErrorNumber)
        ErrorNumber = ErrorNumber + 1
        count = count + 1
    Loop
EOSb: Debug.Print ErrorNumber
End Sub</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_fileattr_関数">37.6.21. FileAttr 関数<a id="FileAttr"></a></h4>
<div class="paragraph">
<p><a href="#Open">Open</a> ステートメントを使用して開かれたファイルのファイル モードを表す
Long を返します。</p>
</div>
<div class="listingblock">
<div class="title">構文</div>
<div class="content">
<pre class="highlight"><code class="language-vbscript" data-lang="vbscript">FileAttr(filenumber, returntype)</code></pre>
</div>
</div>
<div class="paragraph">
<p>FileAttr 関数の構文に使用される名前付き引数は次のとおりです。</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 20%;">
<col style="width: 80%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">パーツ</th>
<th class="tableblock halign-left valign-top">説明</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">filenumber</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">必須。Integer。 任意の有効なファイル番号です。</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">returntype</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">必須。Integer。 返す情報の種類を示す数値。 ファイル モードを示す値を返す場合は 1 を指定します。 16 ビット システムの場合のみ、オペレーティング システムのファイル ハンドルを取得する場合に 2 を指定します。 Returntype 2 は 32 ビット システムではサポートされていないため、エラーが発生します。</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<div class="title">戻り値</div>
<p>returntype 引数が 1 の場合、ファイル アクセス モードを示す次の値が返されます。</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 20%;">
<col style="width: 80%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">モード</th>
<th class="tableblock halign-left valign-top">値</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Input</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">出力</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">2</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Random</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">4</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Append</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">8</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Binary</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">32</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<div class="title">例</div>
<p>この例では、FileAttr 関数を使用して、開かれているファイルのファイル モードおよ
びファイル ハンドルを返しています。 ファイル ハンドルは 16 ビット システムでの
み返されます。32 ビット システムで 2 つ目の引数に 2 を渡すと、エラーが発生しま
す。</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-vbscript" data-lang="vbscript">Dim FileNum, Mode, Handle
FileNum = 1    ' Assign file number.
Open "TESTFILE" For Append As FileNum    ' Open file.
Mode = FileAttr(FileNum, 1)    ' Returns 8 (Append file mode).
Handle = FileAttr(FileNum, 2)    ' Returns file handle.
Close FileNum    ' Close file.</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_filedatetime_関数">37.6.22. FileDateTime 関数<a id="FileDateTime"></a></h4>
<div class="paragraph">
<p>ファイルの作成日時または最終更新日時を示す Variant (Date) を返します。</p>
</div>
<div class="listingblock">
<div class="title">構文</div>
<div class="content">
<pre class="highlight"><code class="language-vbscript" data-lang="vbscript">FileDateTime(pathname)</code></pre>
</div>
</div>
<div class="paragraph">
<p>必須の pathname 引数は、ファイル名を指定する文字列式です。 pathname には、ディ
レクトリまたはフォルダー、およびドライブを含めることができます。</p>
</div>
<div class="paragraph">
<div class="title">例</div>
<p>この例では、FileDateTime 関数を使用して、ファイルの作成日時または最終更新日時
を特定します。 表示される日時の形式は、システムのロケール設定に基づいています。</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-vbscript" data-lang="vbscript">Dim MyStamp
' Assume TESTFILE was last modified on February 12, 1993 at 4:35:47 PM.
' Assume English/U.S. locale settings.
MyStamp = FileDateTime("TESTFILE")    ' Returns "2/12/93 4:35:47 PM".</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_filelen_関数">37.6.23. FileLen 関数<a id="FileLen"></a></h4>
<div class="paragraph">
<p>バイト単位でファイルの長さを指定する Long を返します。</p>
</div>
<div class="listingblock">
<div class="title">構文</div>
<div class="content">
<pre class="highlight"><code class="language-vbscript" data-lang="vbscript">FileLen (pathname)</code></pre>
</div>
</div>
<div class="paragraph">
<p>必須の pathname 引数は、ファイルを指定する文字列式です。 pathname には、ディレ
クトリまたはフォルダー、およびドライブを含めることができます。</p>
</div>
<div class="paragraph">
<div class="title">解説</div>
<p>FileLen 関数が呼び出されたときに指定したファイルが開いている場合、返された値は、
そのファイルを開く直前のファイル サイズを表します。</p>
</div>
<div class="admonitionblock caution">
<table>
<tr>
<td class="icon">
<i class="fa icon-caution" title="Caution"></i>
</td>
<td class="content">
開いているファイルの長さを取得するには、LOF 関数を使用します。
</td>
</tr>
</table>
</div>
<div class="paragraph">
<div class="title">例</div>
<p>この例では、FileLen 関数を使用して、ファイルの長さをバイト単位で返します。 こ
の例の目的のため、TESTFILE はデータを含んでいるファイルとします。</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-vbscript" data-lang="vbscript">Dim MySize
MySize = FileLen("TESTFILE")    ' Returns file length (bytes).</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_filter_関数">37.6.24. Filter 関数<a id="Filter"></a></h4>
<div class="paragraph">
<p>指定されたフィルター条件に基づいて、文字列配列のサブセットが含まれるゼロベース
配列を返します。</p>
</div>
<div class="listingblock">
<div class="title">構文</div>
<div class="content">
<pre class="highlight"><code class="language-vbscript" data-lang="vbscript">Filter(sourcearray, match, [ include, [ compare ]])</code></pre>
</div>
</div>
<div class="paragraph">
<p>Filter 関数の構文に使用される名前付き引数は次のとおりです。</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 20%;">
<col style="width: 80%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">パーツ</th>
<th class="tableblock halign-left valign-top">説明</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">sourcearray</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">必須です。 検索する文字列の 1 次元配列。</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">match</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">必須。 検索する文字列。</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">include</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">省略可能。 返すサブ文字列に match を含めるか、除外するかを示す Boolean 値。 include が True の場合、Filter は、match が含まれる配列のサブセットをサブ文字列として返します。 include が False の場合、Filter は、match が含まれない配列のサブセットをサブ文字列として返します。</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">compare</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">省略可能。 使用する文字列比較の種類を示す数値。 値については、「設定」セクションを参照してください。</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<div class="title">設定</div>
<p>compare 引数には、次の値を指定できます。</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 28.5714%;">
<col style="width: 14.2857%;">
<col style="width: 57.1429%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">定数</th>
<th class="tableblock halign-left valign-top">値</th>
<th class="tableblock halign-left valign-top">説明</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">vbUseCompareOption</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">-1</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Option Compare ステートメントの設定を使用して比較を実行します。</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">vbBinaryCompare</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">.0</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">バイナリ比較を実行します。</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">vbTextCompare</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1-d</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">テキスト比較を実行します。</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">vbDatabaseCompare</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">pbm-2</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Microsoft Access のみ。 データベース内の情報に基づいて比較を実行します。</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>Filter 関数によって返される配列には、一致したアイテムを格納するのに十分な数の
要素のみが含まれます。</p>
</div>
</div>
<div class="sect3">
<h4 id="_formatcurrency_関数">37.6.25. FormatCurrency 関数<a id="FormatCurrency"></a></h4>
<div class="paragraph">
<p>システムのコントロール パネルで定義された通貨記号を使用して、通貨値として書式
設定された式を返します。</p>
</div>
<div class="listingblock">
<div class="title">構文</div>
<div class="content">
<pre class="highlight"><code class="language-vbscript" data-lang="vbscript">FormatCurrency(Expression, [ NumDigitsAfterDecimal, [ IncludeLeadingDigit, [ UseParensForNegativeNumbers, [ GroupDigits ]]]])</code></pre>
</div>
</div>
<div class="paragraph">
<p>FormatCurrency 関数の構文には、次の指定項目があります。</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 20%;">
<col style="width: 80%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">パーツ</th>
<th class="tableblock halign-left valign-top">説明</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Expression</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">必須。 書式設定する式です。</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">NumDigitsAfterDecimal</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">省略可能。 表示する小数点以下の桁数を示す数値です。 既定値は -1 です。これは、コンピューターの地域の設定が使用されることを示します。</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">IncludeLeadingDigit</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">省略可能。 小数値に先頭のゼロを表示するかどうかを示す Tristate 定数です。 値については、「設定」セクションを参照してください。</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">UseParensForNegativeNumbers</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">オプション。 負の値をかっこで囲むかどうかを示す Tristate 定数です。 値については「設定値」を参照してください。</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">GroupDigits</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">省略可能。 コンピューターの地域の設定で指定されている桁区切り記号を使用して数値を区切るかどうかを示す Tristate 定数です。 値については、「設定」セクションを参照してください。</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<div class="title">設定</div>
<p>IncludeLeadingDigit、UseParensForNegativeNumbers、および GroupDigits 引数の設
定は次のとおりです。</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 28.5714%;">
<col style="width: 14.2857%;">
<col style="width: 57.1429%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">定数</th>
<th class="tableblock halign-left valign-top">値</th>
<th class="tableblock halign-left valign-top">説明</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">vbTrue</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">-1</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">True</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">vbFalse</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">.0</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">False</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">vbUseDefault</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">-2</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">コンピューターの地域の設定を使用します。</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<div class="title">解説</div>
<p>省略可能な引数を省略した場合は、コンピューターの地域の設定の値が使用されます。
通貨値に対する通貨記号の位置は、システムの地域の設定によって決まります。</p>
</div>
<div class="admonitionblock caution">
<table>
<tr>
<td class="icon">
<i class="fa icon-caution" title="Caution"></i>
</td>
<td class="content">
先頭のゼロを除き、設定情報はすべて、[地域の設定] の [通貨] タ
ブの情報に基づいています。先頭のゼロは、[数値] タブの情報に基づきます。
</td>
</tr>
</table>
</div>
</div>
<div class="sect3">
<h4 id="_formatdatetime_関数">37.6.26. FormatDateTime 関数<a id="FormatDateTime"></a></h4>
<div class="paragraph">
<p>日付または時刻として書式設定された式を返します。</p>
</div>
<div class="listingblock">
<div class="title">構文</div>
<div class="content">
<pre class="highlight"><code class="language-vbscript" data-lang="vbscript">FormatDateTime(Date, [ NamedFormat ])</code></pre>
</div>
</div>
<div class="paragraph">
<p>FormatDateTime 関数の構文には、次の指定項目があります。</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 20%;">
<col style="width: 80%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">パーツ</th>
<th class="tableblock halign-left valign-top">説明</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Date</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">必須。 書式設定する日付式。</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">NamedFormat</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">省略可能。 使用する日付/時刻の形式を示す数値。 省略すると、vbGeneralDate が使用されます。</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<div class="title">設定</div>
<p>NamedFormat 引数の設定は次のとおりです。</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 20%;">
<col style="width: 80%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">定数</th>
<th class="tableblock halign-left valign-top">値</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">説明</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">vbGeneralDate</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">.0</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">日付と時刻のどちらか、または両方を表示します。 日付部分がある場合は、短い日付として表示します。 時刻部分がある場合は、長い時刻として表示します。 両方ある場合は両方の部分を表示します。</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">vbLongDate</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1-d</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">コンピューターの地域の設定で指定されている長い日付形式を使用して日付を表示します。</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">vbShortDate</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">pbm-2</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">コンピューターの地域の設定で指定されている短い日付形式を使用して日付を表示します。</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">vbLongTime</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1/3</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">コンピューターの地域の設定で指定されている時刻形式を使用して時刻を表示します。</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">vbShortTime</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">2/4</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">24 時間形式 (hh:mm) を使用して時刻を表示します。</p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect3">
<h4 id="_formatnumber_関数">37.6.27. FormatNumber 関数<a id="FormatNumber"></a></h4>
<div class="paragraph">
<p>数値として書式設定された式を返します。</p>
</div>
<div class="listingblock">
<div class="title">構文</div>
<div class="content">
<pre class="highlight"><code class="language-vbscript" data-lang="vbscript">FormatNumber(Expression, [ NumDigitsAfterDecimal, [ IncludeLeadingDigit, [ UseParensForNegativeNumbers, [ GroupDigits ]]]])</code></pre>
</div>
</div>
<div class="paragraph">
<p>FormatNumber 関数の構文には、次の指定項目があります。</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 20%;">
<col style="width: 80%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">パーツ</th>
<th class="tableblock halign-left valign-top">説明</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Expression</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">必須。 書式設定する式です。</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">NumDigitsAfterDecimal</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">省略可能。 表示する小数点以下の桁数を示す数値です。 既定値は -1 です。これは、コンピューターの地域の設定が使用されることを示します。</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">IncludeLeadingDigit</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">省略可能。 小数値に先頭のゼロを表示するかどうかを示す Tristate 定数です。 値については、「設定」セクションを参照してください。</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">UseParensForNegativeNumbers</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">オプション。 負の値をかっこで囲むかどうかを示す Tristate 定数です。 値については「設定値」を参照してください。</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">GroupDigits</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">省略可能。 コンピューターの地域の設定で指定されている桁区切り記号を使用して数値を区切るかどうかを示す Tristate 定数です。 値については、「設定」セクションを参照してください。</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<div class="title">設定</div>
<p>IncludeLeadingDigit、UseParensForNegativeNumbers、および GroupDigits 引数の設
定は次のとおりです。</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 20%;">
<col style="width: 80%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">定数</th>
<th class="tableblock halign-left valign-top">値</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">説明</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">vbTrue</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">-1</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">True</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">vbFalse</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">.0</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">False</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">vbUseDefault</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">-2</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">コンピューターの地域の設定を使用します。</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<div class="title">解説</div>
<p>省略可能な引数を省略した場合は、コンピューターの地域の設定の値が使用されます。</p>
</div>
<div class="admonitionblock caution">
<table>
<tr>
<td class="icon">
<i class="fa icon-caution" title="Caution"></i>
</td>
<td class="content">
すべての設定情報について、[地域] の設定の [数値] タブの情報が
使用されます。
</td>
</tr>
</table>
</div>
</div>
<div class="sect3">
<h4 id="_formatpercent_関数">37.6.28. FormatPercent 関数<a id="FormatPercent"></a></h4>
<div class="paragraph">
<p>パーセンテージとして (100 倍して) 書式設定された式を、末尾に % 記号を追加して
返します。</p>
</div>
<div class="listingblock">
<div class="title">構文</div>
<div class="content">
<pre class="highlight"><code class="language-vbscript" data-lang="vbscript">FormatPercent(Expression, [ NumDigitsAfterDecimal, [ IncludeLeadingDigit, [ UseParensForNegativeNumbers, [ GroupDigits ]]]])</code></pre>
</div>
</div>
<div class="paragraph">
<p>FormatPercent 関数の構文には、次の指定項目があります。</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 20%;">
<col style="width: 80%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">パーツ</th>
<th class="tableblock halign-left valign-top">説明</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Expression</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">必須。 書式設定する式です。</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">NumDigitsAfterDecimal</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">省略可能。 表示する小数点以下の桁数を示す数値です。 既定値は -1 です。これは、コンピューターの地域の設定が使用されることを示します。</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">IncludeLeadingDigit</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">省略可能。 小数値に先頭のゼロを表示するかどうかを示す Tristate 定数です。 値については、「設定」セクションを参照してください。</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">UseParensForNegativeNumbers</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">オプション。 負の値をかっこで囲むかどうかを示す Tristate 定数です。 値については「設定値」を参照してください。</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">GroupDigits</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">省略可能。 コンピューターの地域の設定で指定されている桁区切り記号を使用して数値を区切るかどうかを示す Tristate 定数です。 値については、「設定」セクションを参照してください。</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<div class="title">設定</div>
<p>IncludeLeadingDigit、UseParensForNegativeNumbers、および GroupDigits 引数の設
定は次のとおりです。</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 28.5714%;">
<col style="width: 14.2857%;">
<col style="width: 57.1429%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">定数</th>
<th class="tableblock halign-left valign-top">値</th>
<th class="tableblock halign-left valign-top">説明</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">vbTrue</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">-1</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">True</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">vbFalse</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">.0</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">False</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">vbUseDefault</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">-2</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">コンピューターの地域の設定を使用します。</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<div class="title">解説</div>
<p>省略可能な引数を省略した場合は、コンピューターの地域の設定の値が使用されます。</p>
</div>
<div class="admonitionblock caution">
<table>
<tr>
<td class="icon">
<i class="fa icon-caution" title="Caution"></i>
</td>
<td class="content">
すべての設定情報について、[地域] の設定の [数値] タブの情報が
使用されます。
</td>
</tr>
</table>
</div>
</div>
<div class="sect3">
<h4 id="_freefile_関数">37.6.29. FreeFile 関数<a id="FreeFile"></a></h4>
<div class="paragraph">
<p><a href="#Open">Open</a> ステートメントで使用できる次のファイル番号を表す Integer を返します。</p>
</div>
<div class="listingblock">
<div class="title">構文</div>
<div class="content">
<pre class="highlight"><code class="language-vbscript" data-lang="vbscript">FreeFile [ (rangenumber) ]</code></pre>
</div>
</div>
<div class="paragraph">
<p>オプションの rangenumber 引数は、どの範囲から次の空きファイル番号を返すかを指
定する Variant です。 0 (既定値) を指定すると 1 以上 255 以下の範囲のファイル
番号を返します。 1 を指定すると 256 以上 511 以下の範囲のファイル番号を返しま
す。</p>
</div>
<div class="paragraph">
<div class="title">解説</div>
<p>まだ使用されていないファイル番号を提供するには、FreeFile を使用します。</p>
</div>
<div class="paragraph">
<div class="title">例</div>
<p>この例では、FreeFile 関数を使用して、次に使用可能なファイル番号を返します。 ル
ープ内では 5 個のファイルが出力用に開かれ、サンプル データが各ファイルに書き込
まれています。</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-vbscript" data-lang="vbscript">Dim MyIndex, FileNumber
For MyIndex = 1 To 5    ' Loop 5 times.
    FileNumber = FreeFile    ' Get unused file
        ' number.
    Open "TEST" &amp; MyIndex For Output As #FileNumber    ' Create file name.
    Write #FileNumber, "This is a sample."    ' Output text.
    Close #FileNumber    ' Close file.
Next MyIndex</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_fv_関数">37.6.30. FV 関数<a id="FV"></a></h4>
<div class="paragraph">
<p>定額の支払いを定期的に行い、利率が一定であると仮定して投資の将来価値を指定する
Double を返します。</p>
</div>
<div class="listingblock">
<div class="title">構文</div>
<div class="content">
<pre class="highlight"><code class="language-vbscript" data-lang="vbscript">FV(rate, nper, pmt, [ pv, [ type ]])</code></pre>
</div>
</div>
<div class="paragraph">
<p>FV 関数には、次の名前付き引数があります。</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 20%;">
<col style="width: 80%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">パーツ</th>
<th class="tableblock halign-left valign-top">説明</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">rate</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">必須です。 投資の利率を示す倍精度浮動小数点型 ( Double ) の値を指定します。 たとえば、年利 (APR) 10% の自動車ローンを利用して月払いで返済を行う場合、利率は 0.1/12 = 0.0083 になります。</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">nper</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">必須。 投資期間全体での支払回数の合計を示す整数型 ( Integer) の値を指定します。 たとえば、4 年間の自動車ローンを利用して月払いで返済を行う場合、このローンの支払回数の合計は 4 * 12 = 48 となります。</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">pmt</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">必須。 毎回の支払額を指定する Double。 通常、支払額には元金と利息が含まれます。投資期間内に支払額が変更されることはありません。</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">pv</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">省略可能。 現在価値、つまり将来行われる一連の支払を現時点で一括払いした場合の合計金額を示すバリアント型 ( Variant) の値を指定します。 たとえば、車を購入するために資金を借りる場合、ローンの総額が、貸方に対する現在価値となります。 省略すると、0 を指定したものと見なされます。</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">type</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">省略可能。 支払期日を示すバリアント型 ( Variant ) の値を指定します。 各期の期末に支払う場合は 0、各期の期首に支払う場合は 1 を指定します。 省略すると、0 と見なされます。</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<div class="title">解説</div>
<p>投資とは、一連の定額の支払いを一定期間にわたって行うことです。 投資には、住宅
ローンなどのローンや、毎月の貯蓄プランなどの出資があります。</p>
</div>
<div class="paragraph">
<p>引数rate と nper は、同じ単位で表した支払期間を使用して計算する必要があります。
たとえば、rate を月単位で計算する場合は、nper も月単位で計算する必要があります。</p>
</div>
<div class="paragraph">
<p>すべての引数に関して、定額預金の支払いのような出金は負の数で表し、配当金のよう
な入金は正の数で表します。</p>
</div>
<div class="paragraph">
<div class="title">例</div>
<p>次の例では、FV 関数を使用して投資の将来価値を返します。利率 (APR / 12)、支払回
数の合計 (TotPmts)、支払額 (Payment)、投資の現在価値 (PVal)、および支払が期首
に行われるか期末に行われるかを示す数値 (PayType) を指定します。 Paymentは出金
を表すので、負の値です。</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-vbscript" data-lang="vbscript">Dim Fmt, Payment, APR, TotPmts, PayType, PVal, FVal
Const ENDPERIOD = 0, BEGINPERIOD = 1    ' When payments are made.
Fmt = "###,###,##0.00"    ' Define money format.
Payment = InputBox("How much do you plan to save each month?")
APR = InputBox("Enter the expected interest annual percentage rate.")
If APR &gt; 1 Then APR = APR / 100    ' Ensure proper form.
TotPmts = InputBox("For how many months do you expect to save?")
PayType = MsgBox("Do you make payments at the end of month?", vbYesNo)
If PayType = vbNo Then PayType = BEGINPERIOD Else PayType = ENDPERIOD
PVal = InputBox("How much is in this savings account now?")
FVal = FV(APR / 12, TotPmts, -Payment, -PVal, PayType)
MsgBox "Your savings will be worth " &amp; Format(FVal, Fmt) &amp; "."</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_getallsettings_関数">37.6.31. GetAllSettings 関数<a id="GetAllSettings"></a></h4>
<div class="paragraph">
<p>Windows レジストリのアプリケーションのエントリまたはアプリケーションの初期化フ
ァイルの情報 (Macintosh の場合) から、キー設定のリストと各キー設定の値
(SaveSetting を使用して作成されたもの) を返します。</p>
</div>
<div class="listingblock">
<div class="title">構文</div>
<div class="content">
<pre class="highlight"><code class="language-vbscript" data-lang="vbscript">GetAllSettings(appname, section)</code></pre>
</div>
</div>
<div class="paragraph">
<p>GetAllSettings 関数の構文には、次の名前付き引数があります。</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-vbscript" data-lang="vbscript">パーツ 	説明
appname 	必須です。 キー設定が要求されているアプリケーションまたはプロジェクトの名前を含む文字列式です。 これは、Macintosh では System フォルダー内の Preferences フォルダーにある初期化ファイルのファイル名です。
section 	必須。 キー設定が要求されているセクションの名前を含む文字列式です。 GetAllSettings からは、指定したセクションのすべてのキー設定とそれに対応する値を含む文字列の 2 次元配列のコンテンツを持つ Variant が返されます。</code></pre>
</div>
</div>
<div class="paragraph">
<div class="title">解説</div>
<p>GetAllSettings では、appname または section のいずれかが存在しない場合、初期化
されていない Variant を返します。</p>
</div>
<div class="paragraph">
<div class="title">例</div>
<p>この例では、最初に SaveSetting ステートメントを使用して、appname として指定さ
れたアプリケーションの Windows レジストリにエントリを作成し、GetAllSettings 関
数を使用して、設定を表示します。 アプリケーション名と section の名前は、
GetAllSettings で取得することはできないので、ご注意ください。 最後に、
DeleteSetting ステートメントは、アプリケーションのエントリを削除します。</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-vbscript" data-lang="vbscript">' Variant to hold 2-dimensional array returned by GetAllSettings
' Integer to hold counter.
Dim MySettings As Variant, intSettings As Integer
' Place some settings in the registry.
SaveSetting appname := "MyApp", section := "Startup", _
key := "Top", setting := 75
SaveSetting "MyApp","Startup", "Left", 50
' Retrieve the settings.
MySettings = GetAllSettings(appname := "MyApp", section := "Startup")
    For intSettings = LBound(MySettings, 1) To UBound(MySettings, 1)
        Debug.Print MySettings(intSettings, 0), MySettings(intSettings, 1)
    Next intSettings
DeleteSetting "MyApp", "Startup"</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_getattr_関数">37.6.32. GetAttr 関数<a id="GetAttr"></a></h4>
<div class="paragraph">
<p>ファイル、ディレクトリ、またはフォルダーの属性を表す Integer を返します。</p>
</div>
<div class="listingblock">
<div class="title">構文</div>
<div class="content">
<pre class="highlight"><code class="language-vbscript" data-lang="vbscript">GetAttr(pathname)</code></pre>
</div>
</div>
<div class="paragraph">
<p>必須の pathname 引数は、ファイル名を指定する文字列式です。 pathname には、ディ
レクトリまたはフォルダー、およびドライブを含めることができます。</p>
</div>
<div class="paragraph">
<div class="title">戻り値</div>
<p>GetAttr では、次の属性の値の合計が返されます。</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 28.5714%;">
<col style="width: 14.2857%;">
<col style="width: 57.1429%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">定数</th>
<th class="tableblock halign-left valign-top">値</th>
<th class="tableblock halign-left valign-top">説明</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">vbNormal</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">.0</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">標準</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">vbReadOnly</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1-d</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">読み取り専用。</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">vbHidden</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">pbm-2</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">非表示。</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">vbSystem</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">2/4</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">システム ファイル。 Macintosh では使用できません。</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">vbDirectory</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">16</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">ディレクトリまたはフォルダー</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">vbArchive</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">32</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">前回のバックアップ以降にファイルが変更されています。 Macintosh では使用できません。</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">vbAlias</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">64</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">指定されたファイル名はエイリアスです。 Macintosh でのみ使用できます。</p></td>
</tr>
</tbody>
</table>
<div class="admonitionblock caution">
<table>
<tr>
<td class="icon">
<i class="fa icon-caution" title="Caution"></i>
</td>
<td class="content">
これらの定数は Visual Basic for Applications により指定されま
す。 これらの名前は、実際の値の代わりにコードのどの部分でも使用できます。
</td>
</tr>
</table>
</div>
<div class="paragraph">
<div class="title">解説</div>
<p>設定されている属性を確認するには、And 演算子を使用して ビット単位の比較を行い、
GetAttr 関数から返される値と目的の個々のファイル属性の値を比較します。 結果が
0 以外の場合は、指定したファイルに対してその属性が設定されています。 たとえば、
Archive 属性が設定されていない場合、次の And 式の戻り値は 0 です。</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-vbscript" data-lang="vbscript">Result = GetAttr(FName) And vbArchive</code></pre>
</div>
</div>
<div class="paragraph">
<p>Archive 属性が設定されている場合は、0 以外の値が返されます。</p>
</div>
<div class="paragraph">
<div class="title">例</div>
<p>この例では、GetAttr 関数を使用して、ファイルとディレクトリまたはフォルダーの属
性を確認します。 Macintosh では、定数 vbNormal、vbReadOnly、vbHidden、および
vbAlias のみが使用できます。</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-vbscript" data-lang="vbscript">Dim MyAttr
' Assume file TESTFILE has hidden attribute set.
MyAttr = GetAttr("TESTFILE")    ' Returns 2.

' Returns nonzero if hidden attribute is set on TESTFILE.
Debug.Print MyAttr And vbHidden

' Assume file TESTFILE has hidden and read-only attributes set.
MyAttr = GetAttr("TESTFILE")    ' Returns 3.

' Returns nonzero if hidden attribute is set on TESTFILE.
Debug.Print MyAttr And (vbHidden + vbReadOnly)

' Assume MYDIR is a directory or folder.
MyAttr = GetAttr("MYDIR")    ' Returns 16.</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_getobject_関数">37.6.33. GetObject 関数<a id="GetObject"></a></h4>
<div class="paragraph">
<p>ActiveX コンポーネントから提供されたオブジェクトの参照を返します。</p>
</div>
<div class="listingblock">
<div class="title">構文</div>
<div class="content">
<pre class="highlight"><code class="language-vbscript" data-lang="vbscript">GetObject([ pathname ], [ class ])</code></pre>
</div>
</div>
<div class="paragraph">
<p>GetObject 関数の構文に使用される名前付き引数は次のとおりです。</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 20%;">
<col style="width: 80%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">パーツ</th>
<th class="tableblock halign-left valign-top">説明</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">pathname</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">省略可能。Variant (String)。 取得するオブジェクトを含むファイルの完全パスと名前。 pathname を省略する場合は、class を指定する必要があります。</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">class</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">省略可能。Variant (String)。 オブジェクトの クラスを表す文字列。</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>class 引数の構文は appname.objecttype で、指定項目は次のとおりです。</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 20%;">
<col style="width: 80%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">指定項目</th>
<th class="tableblock halign-left valign-top">説明</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">appname</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">必須。Variant (String)。 オブジェクトを提供するアプリケーションの名前。</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">objecttype</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">必須。Variant (String)。 作成するオブジェクトの型またはクラス。</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<div class="title">解説</div>
<p>GetObject 関数は、ファイルから ActiveX オブジェクトにアクセスして、そのオブジ
ェクトをオブジェクト変数に割り当てるために使用されます。 GetObject で返された
オブジェクトをオブジェクト変数に割り当てるには、<a href="#Set">Set</a> ステートメントを使
用します。</p>
</div>
<div class="listingblock">
<div class="title">例:</div>
<div class="content">
<pre class="highlight"><code class="language-vbscript" data-lang="vbscript">Dim CADObject As Object
Set CADObject = GetObject("C:\CAD\SCHEMA.CAD")</code></pre>
</div>
</div>
<div class="paragraph">
<p>このコードを実行すると、指定した pathname に関連付けられたアプリケーションが起
動され、指定したファイル内のオブジェクトがアクティブ化されます。</p>
</div>
<div class="paragraph">
<p>pathname が長さ 0 の文字列 ("") である場合、GetObject は、指定した型の新しいオ
ブジェクト インスタンスを戻します。 pathname 引数を省略した場合、GetObject は、
指定した型の現在アクティブなオブジェクトを返します。 指定した型のオブジェクト
が存在しない場合は、エラーが発生します。</p>
</div>
<div class="paragraph">
<p>一部のアプリケーションでは、ファイルの一部をアクティブ化することができます。
ファイル名の末尾に感嘆符 (!) を付け、アクティブ化するファイルの部分を識別する
文字列を続けます。 この文字列の作成方法については、オブジェクトを作成したアプ
リケーションのドキュメントを参照してください。</p>
</div>
<div class="paragraph">
<p>たとえば、描画アプリケーションでは、図面の複数のレイヤーがファイルに保存されて
いる場合があります。 次のコードを使用して、SCHEMA.CAD という図面内のレイヤーを
アクティブ化することができます。</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-vbscript" data-lang="vbscript">Set LayerObject = GetObject("C:\CAD\SCHEMA.CAD!Layer3")</code></pre>
</div>
</div>
<div class="paragraph">
<p>オブジェクトの class を指定しない場合、起動するアプリケーションとアクティブ化
するオブジェクトは、指定したファイル名に基づいて自動的に決定されます。 ただし、
一部のファイルは複数のクラスのオブジェクトをサポートしている場合があります。
たとえば、1 つの図面が 3 つの異なる型のオブジェクト (Application オブジェクト、
Drawing オブジェクト、Toolbar オブジェクト) をサポートし、すべてが同じファイル
に含まれている場合があります。 ファイル内のアクティブ化するオブジェクトを指定
するには、省略可能な class 引数を使用します。 次に例を示します。</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-vbscript" data-lang="vbscript">Dim MyObject As Object
Set MyObject = GetObject("C:\DRAWINGS\SAMPLE.DRW", "FIGMENT.DRAWING")</code></pre>
</div>
</div>
<div class="paragraph">
<p>この例で、FIGMENT は描画アプリケーションの名前で、DRAWING は、サポートされるオ
ブジェクトの型のいずれかです。 オブジェクトがアクティブ化されたら、定義したオ
ブジェクト変数を使用して、コード内でオブジェクトを参照します。 前の例では、オ
ブジェクト変数_MyObject_を使用して、新しいオブジェクトのプロパティとメソッドに
アクセスします。 次に例を示します。</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-vbscript" data-lang="vbscript">MyObject.Line 9, 90
MyObject.InsertText 9, 100, "Hello, world."
MyObject.SaveAs "C:\DRAWINGS\SAMPLE.DRW"</code></pre>
</div>
</div>
<div class="admonitionblock caution">
<table>
<tr>
<td class="icon">
<i class="fa icon-caution" title="Caution"></i>
</td>
<td class="content">
GetObject 関数は、オブジェクトの現在のインスタンスがある場合、
または既にファイルが読み込まれた状態でオブジェクトを作成する場合に使用します。
現在のインスタンスがなく、ファイルが読み込まれた状態でオブジェクトを起動しない
場合は、<a href="#CreateObject">CreateObject</a> 関数を使用します。
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>オブジェクトが単一インスタンスのオブジェクトとして登録されている場合は、
CreateObject を何回実行しても、そのオブジェクトのインスタンスは 1 つしか作成さ
れません。 単一インスタンスのオブジェクトの場合、長さ 0 の文字列 ("") 構文で呼
び出されると、GetObject は常に同じインスタンスを返します。また、pathname 引数
が省略された場合、エラーが発生します。 GetObject を使用して、Visual Basic で作
成されたクラスに対する参照を取得することはできません。</p>
</div>
<div class="paragraph">
<div class="title">例</div>
<p>次の例では、GetObject 関数を使用して特定の Microsoft Excel ワークシート (MyXL)
に対する参照を取得します。 ワークシートの Application プロパティを使用して、
Excel の表示や終了などの操作を行います。</p>
</div>
<div class="paragraph">
<p>DetectExcel Sub プロシージャは 2 つの API 呼び出しを使用して Microsoft Excel
を検索し、実行中の場合は、Running Object テーブルに入力します。</p>
</div>
<div class="paragraph">
<p>Microsoft Excel がまだ実行されていない場合、GetObject の 1 回目の呼び出しによ
ってエラーが発生します。 この例では、このエラーによって ExcelWasNotRunning フ
ラグが True に設定されます。</p>
</div>
<div class="paragraph">
<p>GetObject の 2 回目の呼び出しでは、開くファイルを指定します。 Microsoft Excel
がまだ実行されていない場合は、2 回目の呼び出しで起動され、指定したファイル
(mytest.xls) が示すワークシートに対する参照を返します。 ファイルは指定した場所
に存在する必要があります。存在しない場合、Visual Basic エラーの Automation
error が生成されます。</p>
</div>
<div class="paragraph">
<p>このコード例では、次に、指定したワークシートを含む Microsoft Excel とウィンド
ウの両方が表示されるようになります。 最後に、以前のバージョンの Microsoft
Excel が実行中ではない場合、このコードでは Application オブジェクトの Quit メ
ソッドを使用して Microsoft Excel を終了します。 アプリケーションが既に実行中の
場合、アプリケーションを閉じる処理は試行されません。 参照自体は、Nothing に設
定することで解放されます。</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-vbscript" data-lang="vbscript">' Declare necessary API routines:
Declare Function FindWindow Lib "user32" Alias _
"FindWindowA" (ByVal lpClassName as String, _
                    ByVal lpWindowName As Long) As Long

Declare Function SendMessage Lib "user32" Alias _
"SendMessageA" (ByVal hWnd as Long,ByVal wMsg as Long, _
                    ByVal wParam as Long, _
                    ByVal lParam As Long) As Long

Sub GetExcel()
    Dim MyXL As Object    ' Variable to hold reference
                                ' to Microsoft Excel.
    Dim ExcelWasNotRunning As Boolean    ' Flag for final release.

' Test to see if there is a copy of Microsoft Excel already running.
    On Error Resume Next    ' Defer error trapping.
' Getobject function called without the first argument returns a
' reference to an instance of the application. If the application isn't
' running, an error occurs.
    Set MyXL = Getobject(, "Excel.Application")
    If Err.Number &lt;&gt; 0 Then ExcelWasNotRunning = True
    Err.Clear    ' Clear Err object in case error occurred.

' Check for Microsoft Excel. If Microsoft Excel is running,
' enter it into the Running Object table.
    DetectExcel

' Set the object variable to reference the file you want to see.
    Set MyXL = Getobject("c:\vb4\MYTEST.XLS")

' Show Microsoft Excel through its Application property. Then
' show the actual window containing the file using the Windows
' collection of the MyXL object reference.
    MyXL.Application.Visible = True
    MyXL.Parent.Windows(1).Visible = True
     Do manipulations of your  file here.
    ' ...
' If this copy of Microsoft Excel was not running when you
' started, close it using the Application property's Quit method.
' Note that when you try to quit Microsoft Excel, the
' title bar blinks and a message is displayed asking if you
' want to save any loaded files.
    If ExcelWasNotRunning = True Then
        MyXL.Application.Quit
    End IF

    Set MyXL = Nothing    ' Release reference to the
                                ' application and spreadsheet.
End Sub

Sub DetectExcel()
' Procedure dectects a running Excel and registers it.
    Const WM_USER = 1024
    Dim hWnd As Long
' If Excel is running this API call returns its handle.
    hWnd = FindWindow("XLMAIN", 0)
    If hWnd = 0 Then    ' 0 means Excel not running.
        Exit Sub
    Else
    ' Excel is running so use the SendMessage API
    ' function to enter it in the Running Object Table.
        SendMessage hWnd, WM_USER + 18, 0, 0
    End If
End Sub</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_getsetting_関数">37.6.34. GetSetting 関数<a id="GetSetting"></a></h4>
<div class="paragraph">
<p>Windows レジストリ内のアプリケーションのエントリ、または (Macintosh 上の) アプ
リケーションの初期化ファイル内の情報から、キー設定値を返します。</p>
</div>
<div class="listingblock">
<div class="title">構文</div>
<div class="content">
<pre class="highlight"><code class="language-vbscript" data-lang="vbscript">GetSetting(appname, section, key, [ default ])</code></pre>
</div>
</div>
<div class="paragraph">
<p>GetSetting 関数の構文には、次の名前付き引数があります。</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 20%;">
<col style="width: 80%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">パーツ</th>
<th class="tableblock halign-left valign-top">説明</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">appname</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">必須です。 キー設定が要求されているアプリケーションまたはプロジェクトの名前を含む文字列式です。 これは、Macintosh では System フォルダー内の Preferences フォルダーにある初期化ファイルのファイル名です。</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">section</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">必須です。 キー設定を検索するセクションの名前を含む文字列式です。</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">key</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">必須。 返すキー設定の名前を含む文字列式です。</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">default</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">省略可能。 キー設定に値が設定されていない場合、返す値を含む式です。 省略すると、default で、長さ 0 の文字列 ("") があると見なされます。</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<div class="title">解説</div>
<p>GetSetting 引数で名付けられたアイテムが存在しない場合、GetSetting は、default
の値を返します。</p>
</div>
<div class="paragraph">
<div class="title">例</div>
<p>この例では、最初に <a href="#SaveSetting">SaveSetting</a> ステートメントを使用して、
appname として指定されたアプリケーションの Windows レジストリ (または 16 ビッ
ト版 Windows プラットフォームの .ini ファイル) にエントリを作成し、GetSetting
関数を使用して、設定のうちの 1 つを表示します。 default 引数が指定されているた
め、何らかの値が返されることが保証されています。 section 名は、GetSetting で取
得することはできないので、ご注意ください。 最後に、<a href="#DeleteSetting">DeleteSetting</a> ステートメントは、アプリケーションのエントリをすべて削除します。</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-vbscript" data-lang="vbscript">' Variant to hold 2-dimensional array returned by GetSetting.
Dim MySettings As Variant
' Place some settings in the registry.
SaveSetting "MyApp","Startup", "Top", 75
SaveSetting "MyApp","Startup", "Left", 50

Debug.Print GetSetting(appname := "MyApp", section := "Startup", _
                       key := "Left", default := "25")

DeleteSetting "MyApp", "Startup"</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_hour_関数">37.6.35. Hour 関数<a id="Hour"></a></h4>
<div class="paragraph">
<p>1 日の時間を表す 0 以上 23 以下の整数を指定する Variant (Integer) を返します。</p>
</div>
<div class="listingblock">
<div class="title">構文</div>
<div class="content">
<pre class="highlight"><code class="language-vbscript" data-lang="vbscript">Hour(time)</code></pre>
</div>
</div>
<div class="paragraph">
<p>必須の time 引数は、時間を表すことができる、任意の Variant、数式、文字列式、ま
たは任意の組み合わせです。 time に Null が含まれている場合は Null が返されます。</p>
</div>
<div class="paragraph">
<div class="title">例</div>
<p>この例では、Hour 関数を使用して、指定した時刻の時間を取得します。 開発環境では、
コードのロケール設定を使用して短い時刻形式で時刻リテラルが表示されます。</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-vbscript" data-lang="vbscript">Dim MyTime, MyHour
MyTime = #4:35:17 PM#    ' Assign a time.
MyHour = Hour(MyTime)    ' MyHour contains 16.</code></pre>
</div>
</div>
<div class="paragraph">
<p>★</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_タスク別のキーワード">37.7. タスク別のキーワード</h3>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 20%;">
<col style="width: 80%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">カテゴリ</th>
<th class="tableblock halign-left valign-top">説明</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">配列</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">配列を作成、定義、使用します。</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">コンパイラディレクティブ</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">コンパイラの動作を制御します。</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">制御フロー</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">プロシージャのフローをループおよび制御します。</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">変換</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">数値とデータ型を変換します。</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">データ型</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">データ型およびバリアント サブタイプ。</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">日付と時刻</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">日付と時刻の式を変換および使用します。</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">ディレクトリとファイル</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">ファイル システムを制御し、ファイルを処理します。</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">エラー</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">エラー値をトラッピングして返します。</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">財務</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">財務計算を実行します。</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">入力と出力</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">入力を受け取って、出力を表示または印刷します。</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">算術</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">三角関数およびその他の算術計算を実行します。</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">その他</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">他のアプリケーションを開始し、イベントを処理します。</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">演算子</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">式の比較および他の操作を行います。</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">レジストリ</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">プログラムの設定を管理する。</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">文字列の操作</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">文字列および文字列型データを操作します。</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">変数と定数</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">変数および定数を宣言および定義します。</p></td>
</tr>
</tbody>
</table>
<div class="sect3">
<h4 id="_キーワード_visual_basic_for_applications">37.7.1. キーワード (Visual Basic for Applications)</h4>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 20%;">
<col style="width: 80%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">キーワード</th>
<th class="tableblock halign-left valign-top">使用されるコンテキスト</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">As</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Const ステートメント<br>
Declare ステートメント<br>
Dim ステートメント<br>
Function ステートメント<br>
Name ステートメント<br>
Open ステートメント<br>
Private ステートメント<br>
Property Get ステートメント<br>
Property Let ステートメント<br>
Property Set ステートメント<br>
Public ステートメント<br>
ReDim ステートメント<br>
Static ステートメント<br>
Sub ステートメント<br>
Type ステートメント</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Binary</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Open ステートメント<br>
Option Compare ステートメント</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">ByRef</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Call ステートメント<br>
Declare ステートメント<br>
Function ステートメント<br>
Property Get ステートメント<br>
Property Let ステートメント<br>
Property Set ステートメント<br>
Sub ステートメント</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">ByVal</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Call ステートメント<br>
Declare ステートメント<br>
Function ステートメント<br>
Property Get ステートメント<br>
Property Let ステートメント<br>
Property Set ステートメント<br>
Sub ステートメント</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Date</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Date データ型<br>
Date 関数<br>
Date ステートメント</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Else</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">If&#8230;&#8203;Then&#8230;&#8203;Else ステートメント<br>
Select Case ステートメント</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Empty</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">初期化されていない変数値を示す Variant サブタイプとして使用されます。</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Error</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Error 関数<br>
Error ステートメント<br>
On Error ステートメント</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">False</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">値は 0 です。</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">For</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">For&#8230;&#8203;Next ステートメント<br>
For Each&#8230;&#8203;Next ステートメント<br>
Open ステートメント</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Friend</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">「Friend」をご覧ください。</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Get</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Get ステートメント<br>
Property Get ステートメント</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Input</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Input 関数<br>
Input # ステートメント<br>
Line Input # ステートメント<br>
Open ステートメント</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Is</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">If&#8230;&#8203;Then&#8230;&#8203;Else ステートメント<br>
Is 演算子<br>
Select Case ステートメント</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Len</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Len 関数<br>
Open ステートメント</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Let</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Let ステートメント<br>
Property Let ステートメント</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Lock</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Lock、Unlock ステートメント<br>
Open ステートメント</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Me</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">「Me」をご覧ください。</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Mid</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Mid 関数<br>
Mid ステートメント</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">New</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Dim ステートメント<br>
Private ステートメント<br>
Public ステートメント<br>
Set ステートメント<br>
Static ステートメント</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Next</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">For&#8230;&#8203;Next ステートメント<br>
For Each&#8230;&#8203;Next ステートメント<br>
On Error ステートメント<br>
Resume ステートメント</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Nothing</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">「Nothing」をご覧ください。</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Null</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">変数に有効な値が含まれないことを示す Variant サブタイプとして使用されます。</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">On</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">On Error ステートメント<br>
On&#8230;&#8203;GoSub ステートメント<br>
On&#8230;&#8203;GoTo ステートメント</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Option</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Option Base ステートメント<br>
Option Compare ステートメント<br>
Option Explicit ステートメント<br>
Option Private ステートメント</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Optional</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Declare ステートメント<br>
Function ステートメント<br>
Property Get ステートメント<br>
Property Let ステートメント<br>
Property Set ステートメント<br>
Sub ステートメント</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">ParamArray</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Declare ステートメント<br>
Function ステートメント<br>
Property Get ステートメント<br>
Property Let ステートメント<br>
Property Set ステートメント<br>
Sub ステートメント</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Print</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Print メソッド<br>
Print # ステートメント</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Private</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Const ステートメント<br>
Declare ステートメント<br>
Enum ステートメント<br>
Function ステートメント<br>
Option Private ステートメント<br>
Private ステートメント<br>
Property Get ステートメント<br>
Property Let ステートメント<br>
Property Set ステートメント<br>
Sub ステートメント<br>
Type ステートメント</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Property</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Property Get ステートメント<br>
Property Let ステートメント<br>
Property Set ステートメント</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">PtrSafe</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">「PtrSafe」をご覧ください。</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Public</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Const ステートメント<br>
Declare ステートメント<br>
Enum ステートメント<br>
Event ステートメント<br>
Function ステートメント<br>
Property Get ステートメント<br>
Property Let ステートメント<br>
Property Set ステートメント<br>
Public ステートメント<br>
Sub ステートメント<br>
Type ステートメント</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Resume</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">On Error ステートメント<br>
Resume ステートメント</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Seek</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Seek 関数<br>
Seek ステートメント</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Set</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Set ステートメント<br>
Property Set ステートメント</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Static</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Function ステートメント<br>
Property Get ステートメント<br>
Property Let ステートメント<br>
Property Set ステートメント<br>
Static ステートメント<br>
Sub ステートメント</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Step</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">For&#8230;&#8203;Next ステートメント<br>
For Each&#8230;&#8203;Next ステートメント</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">String</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">String データ型<br>
String 関数</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Then</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">If&#8230;&#8203;Then&#8230;&#8203;Else ディレクティブ<br>
If&#8230;&#8203;Then&#8230;&#8203;Else ステートメント</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Time</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Time 関数<br>
Time ステートメント</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">To</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Dim ステートメント<br>
For&#8230;&#8203;Next ステートメント<br>
Lock、Unlock ステートメント<br>
Private ステートメント<br>
Public ステートメント<br>
ReDim ステートメント<br>
Select Case ステートメント<br>
Static ステートメント<br>
Type ステートメント</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">True</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">値は -1 です。</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">WithEvents</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Dim ステートメント<br>
Private ステートメント<br></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Public ステートメント</p></td>
</tr>
</tbody>
</table>
<div class="sect4">
<h5 id="_friend_キーワード">37.7.1.1. Friend キーワード</h5>
<div class="paragraph">
<p>フォームモジュールまたはクラスモジュールのプロシージャの定義を変更して、プロシ
ージャをクラスの外部のモジュールから呼び出し可能にします。ただし、クラスが定義
されているプロジェクトの一部である必要があります。 Friendプロシージャは標準モ
ジュールでは使用できません。</p>
</div>
<div class="listingblock">
<div class="title">構文</div>
<div class="content">
<pre class="highlight"><code class="language-vbscript" data-lang="vbscript">[ Private | Friend | Public ] [ Static ] [ Sub | Function | Property ] procedurename</code></pre>
</div>
</div>
<div class="paragraph">
<p>必須の __ procedurename は、プロジェクト全体で可視にされるプロシージャの名前で
すが、クラスのコントローラーには不可視となります。</p>
</div>
<div class="paragraph">
<div class="title">注釈</div>
<p>クラスのパブリックプロシージャは、クラスのインスタンスのコントローラーであって
も、どこからでも呼び出すことができます。 プロシージャをプライベートに宣言する
と、オブジェクトのコントローラーがプロシージャを呼び出せるようになります。また、
クラス自体が定義されているプロジェクト内からプロシージャを呼び出すこともできな
くなります。</p>
</div>
<div class="paragraph">
<p>Friendは、プロジェクト全体でプロシージャを参照できるようにしますが、オブジェク
トのインスタンスのコントローラーに対しては使用できません。 フレンドは、フォー
ムモジュールおよびクラスモジュールにのみ表示され、変数や型ではなく、プロシージ
ャ名のみを変更できます。 クラスのプロシージャは、プロジェクト内の他のすべての
クラスのFriendプロシージャにアクセスできます。 フレンドプロシージャは、そのク
ラスのタイプライブラリには表示されません。 Friendプロシージャは、遅延バインデ
ィングすることはできません。</p>
</div>
<div class="paragraph">
<div class="title">例</div>
<p>クラスモジュールに配置されると、次のコードによって、プロジェクト内のクラスのす
べてのユーザーがメンバー変数 dblBalance にアクセスできるようになります。 クラ
スのすべてのユーザーが値を取得できます。プロジェクト内のコードのみが、その変数
に値を割り当てることができます。</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-vbscript" data-lang="vbscript">Private dblBalance As Double

Public Property Get Balance() As Double
 Balance = dblBalance
End Property

Friend Property Let Balance(dblNewBalance As Double)
 dblBalance = dblNewBalance
End Property</code></pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="_me_キーワード">37.7.1.2. Me キーワード<a id="Me"></a></h5>
<div class="paragraph">
<p>Me キーワードは暗黙的に宣言された変数と同様に動作します。 クラス モジュール内
のすべてのプロシージャは、これを自動的に利用できます。</p>
</div>
<div class="paragraph">
<p>クラスに複数のインスタンスが含まれる可能性がある場合、Me を使用して、コードが
実行されているクラスの特定のインスタンスを参照できます。 現在実行されているク
ラスのインスタンスに関する情報を別のモジュール内のプロシージャに渡す場合、Me
を使用すると特に便利です。</p>
</div>
<div class="paragraph">
<p>たとえば、モジュールに以下のプロシージャが含まれているとします。</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-vbscript" data-lang="vbscript">Sub ChangeFormColor(FormName As Form)
 FormName.BackColor = RGB(Rnd * 256, Rnd * 256, Rnd * 256)
End Sub</code></pre>
</div>
</div>
<div class="paragraph">
<p>以下のステートメントを使用し、このプロシージャを呼び出して Form クラスの現在の
インスタンスを引数として渡すことができます。</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-vbscript" data-lang="vbscript">ChangeFormColor Me</code></pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="_nothing_キーワード">37.7.1.3. Nothing キーワード<a id="Nothing"></a></h5>
<div class="paragraph">
<p>Nothing キーワードは、オブジェクト変数と実際のオブジェクトの関連付けを解除する
ために使用されます。 Nothingをオブジェクト変数に代入するには、 <a href="#Set">Set</a> ス
テートメントを使用します。 次に例を示します。</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-vbscript" data-lang="vbscript">Set MyObject = Nothing</code></pre>
</div>
</div>
<div class="paragraph">
<p>複数のオブジェクト変数が同じ実際のオブジェクトを参照していることがあります。
オブジェクト変数に Nothing を代入すると、その変数は実際のオブジェクトを参照し
なくなります。</p>
</div>
<div class="paragraph">
<p>複数のオブジェクト変数が同じオブジェクトを参照する場合、変数が参照するオブジェ
クトに関連付けられているメモリおよびシステムリソースは、 setを使用して明
示的に設定されているか、または暗黙的に設定されている場合にのみ解放されます。実
際のオブジェクトを参照している最後のオブジェクト変数がスコープ外になった後。</p>
</div>
</div>
<div class="sect4">
<h5 id="_ptrsafe_キーワード">37.7.1.4. PtrSafe キーワード<a id="PtrSafe"></a></h5>
<div class="paragraph">
<p>PtrSafeキーワードは、次のコンテキストで使用されます。 Declare ステートメントで
す。</p>
</div>
<div class="paragraph">
<p>PtrSafe キーワードを含む Declare ステートメントが推奨される構文です。 PtrSafe
が含まれる Declare ステートメントが 32 ビットおよび 64 ビット プラットフォーム
の VBA7 開発環境で正常に機能するのは、64 ビット数を格納する必要がある Declare
ステートメント内のすべてのデータ型 (パラメーターおよび戻り値) が 64 ビット整数
用の LongLong またはポインターおよびハンドル用の LongPtr を使用するように更新
されている場合のみです。</p>
</div>
<div class="paragraph">
<p>VBA バージョン6以前との下位互換性を確保するには、次の構文を使用します。</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-vbscript" data-lang="vbscript">#If VBA7 Then
Declare PtrSafe Sub...
#Else
Declare Sub...
#EndIf</code></pre>
</div>
</div>
<div class="paragraph">
<p>64ビットバージョンの Office で実行する場合、 DeclareステートメントにはPtrSafe
キーワードを含める必要があります。 PtrSafe キーワードは、Declare ステートメン
トを 64 ビットの開発環境で安全に実行できることを示すキーワードです。</p>
</div>
<div class="paragraph">
<p>DeclareステートメントにPtrSafeキーワードを追加した場合のみ、 declareステートメ
ントが明示的に64ビットを対象としていることを意味します。 64ビットを格納する必
要があるステートメント内のすべてのデータ型 (戻り値とパラメーターを含む) は、64
ビット積分またはLongPtrのポインターとハンドルに対してlonglongを使用して、64ビ
ットの数を保持するように変更する必要があります。</p>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_配列キーワードの概要">37.7.2. 配列キーワードの概要</h4>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Action</th>
<th class="tableblock halign-left valign-top">キーワード</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">配列かどうかを確認します。</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#IsArray">IsArray</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">配列を作成します。</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#Array">Array</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">既定の下限を変更します。</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#Option Base">Option Base</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">配列を宣言および初期化します。</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#Dim">Dim</a>、<a href="#Private">Private</a>、<a href="#Public">Public</a>、<a href="#ReDim">ReDim</a>、<a href="#Static">Static</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">配列の限界を調べます。</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#LBound">LBound</a>、<a href="#UBound">UBound</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">配列を再初期化します。</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#Erase">Erase</a>、<a href="#ReDim">ReDim</a></p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect3">
<h4 id="_制御フローキーワードの概要">37.7.3. 制御フローキーワードの概要</h4>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Action</th>
<th class="tableblock halign-left valign-top">キーワード</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">構内</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="GoSub&.html#8230;&#8203;Return">GoSub&#8230;&#8203;Return</a>、<a href="#GoTo">GoTo</a>、<a href="#On Error">On Error</a>、
<a href="On&.html#8230;&#8203;GoSub">On&#8230;&#8203;GoSub</a>、<a href="On&.html#8230;&#8203;GoTo">On&#8230;&#8203;GoTo</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">プログラムを終了または一時停止する</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#DoEvents">DoEvents</a>、<a href="#End">End</a>、
<a href="#Exit">Exit</a>、<a href="#Stop">Stop</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Loop</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="Do&.html#8230;&#8203;Loop">Do&#8230;&#8203;Loop</a>、<a href="For&.html#8230;&#8203;Next">For&#8230;&#8203;Next</a>、<a href="For Each&.html#8230;&#8203;Next">For Each&#8230;&#8203;Next</a>、<a href="While&.html#8230;&#8203;Wend">While&#8230;&#8203;Wend</a>、<a href="#With">With</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">決定を行う</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#Choose">Choose</a>、<a href="If&.html#8230;&#8203;Then&#8230;&#8203;Else">If&#8230;&#8203;Then&#8230;&#8203;Else</a>、
<a href="#Select Case">Select Case</a>、<a href="#Switch">Switch</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">プロシージャを使用する</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#Call">Call</a>、<a href="#_function">Function</a>、<a href="#Property Get">Property Get</a>、
<a href="#Property Let">Property Let</a>、<a href="#Property Set">Property Set</a>、<a href="#Sub">Sub</a></p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect3">
<h4 id="_変換キーワードの概要">37.7.4. 変換キーワードの概要</h4>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Action</th>
<th class="tableblock halign-left valign-top">キーワード</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">ANSI 値を文字列に。</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#Chr">Chr</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">文字列を小文字または大文字に。</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#Format">Format</a>、<a href="#LCase">LCase</a>、<a href="#Ucase">Ucase</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">日付をシリアル値に。</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#DateSerial">DateSerial</a>、<a href="#DateValue">DateValue</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">10 進数を他の基数に。</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#Hex">Hex</a>、<a href="#Oct">Oct</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">数値を文字列に。</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#Format">Format</a>、<a href="#Str">Str</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">あるデータ型を別のデータ型に。</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#データ型の概要">データ型の概要</a>を参照してください。</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">日付を日、月、週、または年に。</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#Day">Day</a>、<a href="#Month">Month</a>、<a href="#Weekday">Weekday</a>、<a href="#Year">Year</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">時刻を時、分、または秒に。</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#Hour">Hour</a>、<a href="#Minute">Minute</a>、<a href="#Second">Second</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">文字列を ASCII 値に。</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#Asc">Asc</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">文字列を数値に。</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#Val">Val</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">時刻をシリアル値に。</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#TimeSerial">TimeSerial</a>、<a href="#TimeValue">TimeValue</a></p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect3">
<h4 id="_日付と時刻のキーワード_サマリー">37.7.5. 日付と時刻のキーワード サマリー</h4>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">アクション</th>
<th class="tableblock halign-left valign-top">キーワード</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">現在の日付または時刻を取得します。</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#Date">Date</a>、<a href="#Now">Now</a>、<a href="#Time">Time</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">日付の計算を実行します。</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#DateAdd">DateAdd</a>、<a href="#DateDiff">DateDiff</a>、
<a href="#DatePart">DatePart</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">日付を返します。</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#DateSerial">DateSerial</a>、<a href="#DateValue">DateValue</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">時刻を返します。</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#TimeSerial">TimeSerial</a>、<a href="#TimeValue">TimeValue</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">日付または時刻を設定します。</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#Date">Date</a>、<a href="#Time">Time</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">処理時間を計測します。</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#Timer">Timer</a></p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect3">
<h4 id="_ディレクトリとファイルのキーワード_サマリー">37.7.6. ディレクトリとファイルのキーワード サマリー</h4>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Action</th>
<th class="tableblock halign-left valign-top">キーワード</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">ディレクトリまたはフォルダーを変更します。</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#ChDir">ChDir</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">ドライブを変更します。</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#ChDrive">ChDrive</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">ファイルをコピーします。</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#FileCopy">FileCopy</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">ディレクトリまたはフォルダーを作成します。</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#MkDir">MkDir</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">ディレクトリまたはフォルダーを削除します。</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#RmDir">RmDir</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">ファイル、ディレクトリ、またはフォルダーの名前を変更します。</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#Name">Name</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">現在のパスを取得します。</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#CurDir">CurDir</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">ファイルの日付/時刻スタンプを取得します。</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#FileDateTime">FileDateTime</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">ファイル、ディレクトリ、ラベルの属性を取得します。</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#GetAttr">GetAttr</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">ファイルの長さを取得します。</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#FileLen">FileLen</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">ファイル名またはボリューム ラベルを取得します。</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#Dir">Dir</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">ファイルの属性情報を設定します。</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#SetAttr">SetAttr</a></p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect3">
<h4 id="_エラー_キーワード_サマリー">37.7.7. エラー キーワード サマリー</h4>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Action</th>
<th class="tableblock halign-left valign-top">キーワード</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">実行時エラーを生成する。</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#Clear">Clear</a>、<a href="#Error">Error</a>、<a href="#Raise">Raise</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">エラー メッセージを取得する。</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#Error">Error</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">エラー情報を提供する。</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#Err">Err</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Error バリアントを返す。</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#CVErr">CVErr</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">実行時にエラーをトラップする。</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#On Error">On Error</a>、<a href="#Resume">Resume</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">検証を入力する。</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#IsError">IsError</a></p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect3">
<h4 id="_財務キーワードの概要">37.7.8. 財務キーワードの概要</h4>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Action</th>
<th class="tableblock halign-left valign-top">キーワード</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">減価償却費の計算</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#DDB">DDB</a>、<a href="#SLN">SLN</a>、<a href="#SYD">SYD</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">将来価値の計算</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#FV">FV</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">利率の計算</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#Rate">Rate</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">内部利益率の計算</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#IRR">IRR</a>、<a href="#MIRR">MIRR</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">期間数の計算</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#NPer">NPer</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">支払い額の計算</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#IPmt">IPmt</a>、<a href="#Pmt">Pmt</a>、<a href="#PPmt">PPmt</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">現在価値の計算</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#NPV">NPV</a>、<a href="#PV">PV</a></p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect3">
<h4 id="_入力と出力のキーワードの概要">37.7.9. 入力と出力のキーワードの概要</h4>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Action</th>
<th class="tableblock halign-left valign-top">キーワード</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">ファイルにアクセスするかファイルを作成します。</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#Open">Open</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">ファイルを閉じます。</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#Close">Close</a>、<a href="#Reset">Reset</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">出力の表示を管理します。</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#Format">Format</a>、<a href="#Print">Print</a>、
<a href="Print .html">Print #</a>、<a href="#Spc">Spc</a>、<a href="#Tab">Tab</a>、<a href="Width .html">Width #</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">ファイルをコピーします。</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#FileCopy">FileCopy</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">ファイルに関する情報を取得します。</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#EOF">EOF</a>、<a href="#FileAttr">FileAttr</a>、
<a href="#FileDateTime">FileDateTime</a>、<a href="#FileLen">FileLen</a>、<a href="#FreeFile">FreeFile</a>、
<a href="#GetAttr">GetAttr</a>、<a href="#Loc">Loc</a>、<a href="#LOF">LOF</a>、<a href="#Seek">Seek</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">ファイルを管理します。</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#Dir">Dir</a>、<a href="#Kill">Kill</a>、<a href="#Lock">Lock</a>、<a href="#Unlock">Unlock</a>、<a href="#Name">Name</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">ファイルを読み取ります。</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#Get">Get</a>、<a href="#Input">Input</a>、<a href="Input .html">Input #</a>、
<a href="Line Input .html">Line Input #</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">ファイルの長さを返します。</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#FileLen">FileLen</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">ファイル属性を設定または取得します。</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#FileAttr">FileAttr</a>、 <a href="#GetAttr">GetAttr</a>、 <a href="#SetAttr">SetAttr</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">ファイル内の読み取り/書き込み位置を設定します。</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#Seek">Seek</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">ファイルに書き込みます。</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="Print .html">Print #</a>、<a href="#Put">Put</a>、
<a href="Write .html">Write #</a></p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect3">
<h4 id="_数学キーワード_サマリー">37.7.10. 数学キーワード サマリー</h4>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">アクション</th>
<th class="tableblock halign-left valign-top">キーワード</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">三角関数を派生させる。</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#Atn">Atn</a>、<a href="#Cos">Cos</a>、<a href="#Sin">Sin</a>、<a href="#Tan">Tan</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">一般的な計算。</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#Exp">Exp</a>、<a href="#Log">Log</a>、<a href="#Sqr">Sqr</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">乱数を生成する。</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#Randomize">Randomize</a>、<a href="#Rnd">Rnd</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">絶対値を取得する。</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#Abs">Abs</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">式の符号を取得する。</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#Sgn">Sgn</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">数値変換を実行する。</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#Fix">Fix</a>、<a href="#Int">Int</a></p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect3">
<h4 id="_その他のキーワード_サマリー">37.7.11. その他のキーワード サマリー</h4>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">アクション</th>
<th class="tableblock halign-left valign-top">キーワード</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">保留中のイベントを処理する。</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#DoEvents">DoEvents</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">他のプログラムを実行する。</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#AppActivate">AppActivate</a>、<a href="#Shell">Shell</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">キー操作をアプリケーションへ送信する。</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#SendKeys">SendKeys</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">コンピューターから警告音を鳴らす。</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#Beep">Beep</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">システム</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#Environ">Environ</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">コマンド ライン文字列を提供する。</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#Command">Command</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">オートメーション</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#CreateObject">CreateObject</a>、<a href="#GetObject">GetObject</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">色</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#QBColor">QBColor</a>、<a href="#RGB">RGB</a></p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect3">
<h4 id="_レジストリ_キーワードの概要">37.7.12. レジストリ キーワードの概要</h4>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Action</th>
<th class="tableblock halign-left valign-top">キーワード</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">プログラムの設定を削除します。</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#DeleteSetting">DeleteSetting</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">プログラムの設定を読み込みます。</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#GetSetting">GetSetting</a>、<a href="#GetAllSettings">GetAllSettings</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">プログラムの設定を保存します。</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#SaveSetting">SaveSetting</a></p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect3">
<h4 id="_文字列操作キーワードの概要">37.7.13. 文字列操作キーワードの概要</h4>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Action</th>
<th class="tableblock halign-left valign-top">キーワード</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">2 個の文字列を比較します。</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#StrComp">StrComp</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">文字列を変換します。</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#StrConv">StrConv</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">小文字または大文字に変換します。</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#Format">Format</a>、<a href="#Lcase">Lcase</a>、<a href="#Ucase">Ucase</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">文字を繰り返し並べた文字列を作成します。</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#Space">Space</a>、<a href="#String">String</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">文字列の長さを検索します。</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#Len">Len</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">文字列の書式設定を行います。</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#Format">Format</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">文字列を中央に配置します。</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#LSet">LSet</a>、<a href="#Rset">Rset</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">文字列を操作します。</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#InStr">InStr</a>、<a href="#Left">Left</a>、<a href="#LTrim">LTrim</a>、
<a href="#Mid">Mid</a>、<a href="#Right">Right</a>、<a href="#RTrim">RTrim</a>、<a href="#Trim">Trim</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">文字列の比較規則を設定します。</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#Option Compare">Option Compare</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">ASCII 値および ANSI 値を使用します。</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#Asc">Asc</a>、<a href="#Chr">Chr</a></p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect3">
<h4 id="_変数と定数のキーワード_サマリー">37.7.14. 変数と定数のキーワード サマリー</h4>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 20%;">
<col style="width: 80%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Action</th>
<th class="tableblock halign-left valign-top">キーワード</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">値の代入</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#Let">Let</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">変数または定数の宣言</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#Const">Const</a>、<a href="#Dim">Dim</a>、<a href="#Private">Private</a>、
<a href="#Public">Public</a>、<a href="#New">New</a>、<a href="#Static">Static</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">モジュールをプライベートとして宣言</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#Option Private Module">Option Private Module</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">変数に関する情報の取得</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#IsArray">IsArray</a>、 <a href="#IsDate">IsDate</a>、 <a href="#IsEmpty">IsEmpty</a>、 <a href="#IsError">IsError</a>、 <a href="#IsMissing">IsMissing</a>、 <a href="#IsNull">IsNull</a>、
<a href="#IsNumeric">IsNumeric</a>、 <a href="#isobject">isobject</a>、 <a href="#TypeName">TypeName</a>、
<a href="#VarType">VarType</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">現在のオブジェクトの参照</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#Me">Me</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">変数の明示的宣言を要求</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#Option Explicit">Option Explicit</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">既定のデータ型の設定</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#Deftype">Deftype</a></p></td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="sect2">
<h3 id="_microsoft_forms_リファレンス">37.8. Microsoft Forms リファレンス</h3>

</div>
<div class="sect2">
<h3 id="_オブジェクト_visual_basic_for_applications">37.9. オブジェクト (Visual Basic for Applications)</h3>
<div class="sect3">
<h4 id="_err_オブジェクト">37.9.1. Err オブジェクト</h4>
<div class="paragraph">
<p>実行時エラーに関する情報が含まれます。</p>
</div>
<div class="paragraph">
<div class="title">解説</div>
<p>Err オブジェクトのプロパティは、エラーの生成元 (Visual Basic、オブジェクト、ま
たはプログラマー) によって設定されます。</p>
</div>
<div class="paragraph">
<p>Err オブジェクトの既定のプロパティは、Number です。 既定のプロパティはオブジェ
クト名 Err で表すことができるので、Err 関数または Err ステートメントを使用して
作成された以前のコードを変更する必要はありません。</p>
</div>
<div class="paragraph">
<p>実行時エラーが発生すると、Err オブジェクトのプロパティには、エラーを一意に示す
情報およびエラーの処理に使用できる情報が設定されます。 コードで実行時エラーを
生成するには、Raise メソッドを使用します。</p>
</div>
<div class="paragraph">
<p>Err オブジェクトのプロパティは、エラー処理ルーチン内の Exit Sub、Exit Function、
Exit Property、または Resume Next ステートメントの後で 0 または長さ 0 の文字列
("") にリセットされます。 エラー処理ルーチン外で Resume ステートメントのいずれ
かの形式を使用した場合、Err オブジェクトのプロパティはリセットされません。 Err
を明示的にリセットするには、Clear メソッドを使用できます。</p>
</div>
<div class="paragraph">
<p>システム エラーおよびクラス モジュールに実行時エラーを生成するには、Error ステ
ートメントではなく Raise メソッドを使用します。 他のコードでの Raise メソッド
の使用は、返す必要のある情報量によって異なります。</p>
</div>
<div class="paragraph">
<p>Err オブジェクトは、グローバルなスコープの組み込みオブジェクトです。 コード内
にそのインスタンスを作成する必要はありません。</p>
</div>
<div class="paragraph">
<div class="title">例</div>
<p>この例では、Err オブジェクトのプロパティ (Number、Description、 HelpContext、
HelpFile、 Source) を使用して、エラー メッセージ ダイアログ ボックスを作成しま
す。</p>
</div>
<div class="paragraph">
<p>Clear メソッドを最初に使用すると、Visual Basic エラーを Raise メソッドで生成す
るときに、Visual Basic の既定値が Err オブジェクトのプロパティになることに注意
してください。</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-vbscript" data-lang="vbscript">Dim Msg
' If an error occurs, construct an error message
On Error Resume Next    ' Defer error handling.
Err.Clear
Err.Raise 6    ' Generate an "Overflow" error.
' Check for error, then show message.
If Err.Number &lt;&gt; 0 Then
    Msg = "Error # " &amp; Str(Err.Number) &amp; " was generated by " _
            &amp; Err.Source &amp; Chr(13) &amp; Err.Description
    MsgBox Msg, , "Error", Err.Helpfile, Err.HelpContext
End If</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_メソッド_4">37.9.2. メソッド</h4>
<div class="sect4">
<h5 id="_clear_メソッド">37.9.2.1. Clear メソッド</h5>
<div class="paragraph">
<p>Err オブジェクトのプロパティ設定をすべて解除します。</p>
</div>
<div class="listingblock">
<div class="title">構文</div>
<div class="content">
<pre class="highlight"><code class="language-vbscript" data-lang="vbscript">object.Clear</code></pre>
</div>
</div>
<div class="paragraph">
<p>object は、常に Err オブジェクトです。</p>
</div>
<div class="paragraph">
<div class="title">解説</div>
<p>たとえば On Error Resume Next を使用してエラー処理の延期を使用する場合など、エ
ラーが処理された後に Err オブジェクトを明示的に解除するには Clear を使用します。
次のいずれかのステートメントが実行される場合は必ず、Clear メソッドが自動的に呼
び出されます。</p>
</div>
<div class="ulist">
<ul>
<li>
<p>すべての種類の Resume ステートメント</p>
</li>
<li>
<p>Exit Sub、Exit Function、Exit Property</p>
</li>
<li>
<p>あらゆる On Error ステートメント</p>
</li>
</ul>
</div>
<div class="admonitionblock caution">
<table>
<tr>
<td class="icon">
<i class="fa icon-caution" title="Caution"></i>
</td>
<td class="content">
他のオブジェクトへのアクセス時に発生したエラーを処理する場合、
On Error Goto より On Error Resume Next ステートメントの使用をお勧めします。
オブジェクトの操作後に Err を確認すると、エラーの発生時にコードがアクセスして
いたオブジェクトを明確にできます。 Err.Number にエラー コードを設定したオブジ
ェクトと、最初にエラーを生成したオブジェクト (Err.Source で指定されるオブジェ
クト) についても確認できます。
</td>
</tr>
</table>
</div>
<div class="paragraph">
<div class="title">例</div>
<p>この例では、Err オブジェクトの Clear メソッドを使用して Err オブジェクトの数値
プロパティーを 0 に、文字列プロパティーを長さ 0 の文字列にリセットします。 次
のコードから Clear を省略した場合は、(エラーの発生後に) ループが繰り返されるた
びに、2 回目以降の計算でエラーが生成されたかどうかには関係なく、エラー メッセ
ージのダイアログ ボックスが表示されます。 コードをシングル ステップで実行する
と効果を表示できます。</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-vbscript" data-lang="vbscript">Dim Result(10) As Integer    ' Declare array whose elements
            ' will overflow easily.
Dim indx
On Error Resume Next    ' Defer error trapping.
Do Until indx = 10
    ' Generate an occasional error or store result if no error.
    Result(indx) = Rnd * indx * 20000
    If Err.Number &lt;&gt; 0 Then
        MsgBox Err, , "Error Generated: ", Err.HelpFile, Err.HelpContext
        Err.Clear    ' Clear Err object properties.
    End If
    indx = indx + 1
Loop</code></pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="_raise_メソッド">37.9.2.2. Raise メソッド</h5>
<div class="paragraph">
<p>実行時エラーを生成します。</p>
</div>
<div class="listingblock">
<div class="title">構文</div>
<div class="content">
<pre class="highlight"><code class="language-vbscript" data-lang="vbscript">object.Raise number, source, description, helpfile, helpcontext</code></pre>
</div>
</div>
<div class="paragraph">
<p>Raise メソッドには、以下のオブジェクト修飾子および名前付き引数があります。</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 20%;">
<col style="width: 80%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">引数</th>
<th class="tableblock halign-left valign-top">説明</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">object</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">必須です。 常に、Err オブジェクトです。</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">number</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">必須。 エラーの性質を識別する長整数型 (Long) です。 Visual Basic のエラー (Visual Basic で定義されたエラーおよびユーザーで定義されたエラー) は 0–65535 の値を使用します。 0–512 の値はシステム エラー用に予約されています。513–65535 の値は、ユーザー定義エラー用に使用できます。</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Number プロパティをクラス モジュール内で独自のエラー コードに設定する場合、エラー コード番号を vbObjectError 定数に加えます。 たとえば、 エラー番号 513 を生成するには、vbObjectError + 513 を <strong>Number </strong>プロパティに割り当てます。</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">source</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">省略可能。 エラーを生成したオブジェクトまたはアプリケーションの名前を示す文字列式です。 Source プロパティをオブジェクトに対して設定する場合、project.class の形式を使用します。 source を指定しない場合、現在の Visual Basic プロジェクトのプログラム ID が使用されます。</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">description</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Optional. エラーを説明する文字列式です。 指定しない場合、Number の値が調べられます。 Visual Basic の実行時エラー コードにマップできる場合、Error 関数によって返される文字列が Description として使用されます。 Number に対応する Visual Basic エラーがない場合、"アプリケーション定義またはオブジェクト定義のエラーです。" というメッセージが使用されます。</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">helpfile</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">省略可能。 このエラーに関するヘルプを確認できるヘルプ ファイルへの完全修飾パスです。 指定しない場合、Visual Basic では、完全修飾された、Visual Basic ヘルプ ファイルのドライブ、パス、およびファイル名が使用されます。 HelpFile を参照してください。</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">helpcontext</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">省略可能。 エラーに関するヘルプを提供する helpfile 内のトピックを識別するコンテキスト ID です。 省略した場合、Number プロパティに対応するエラーに応じた、Visual Basic ヘルプ ファイルのコンテキスト ID が使用されます (存在する場合)。 HelpContext を参照してください。</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<div class="title">解説</div>
<p>number 以外のすべての引数はオプションです。 一部の引数を指定しないで Raise を
使用し、Err オブジェクトのプロパティ設定にクリアされていない値が含まれる場合、
その値はエラーの値としての役割を果たします。</p>
</div>
<div class="paragraph">
<p>実行時エラーを生成するのに Raise を使用しますが、これを Error ステートメントの
代わりに使用することもできます。</p>
</div>
<div class="paragraph">
<p>クラス モジュールを記述する場合、エラーを生成するのに Raise が役立ちます。Err
オブジェクトでは、Error ステートメントでエラーを生成する場合に提供できる情報よ
りも豊富な情報が提供されるためです。 たとえば、Raise メソッドを使用すると、エ
ラーの生成元を Source プロパティに指定したり、エラーに関するオンライン ヘルプ
を参照したりできます。</p>
</div>
<div class="paragraph">
<div class="title">例</div>
<p>この例では、Err オブジェクトの Raise メソッドを使用し、Visual Basic で記述され
たオートメーション オブジェクト内でエラーを生成します。 このエラーには、
MyProj.MyObject というプログラム ID があります。 MacIntosh では、既定のドライ
ブ名は "HD" であり、パス名の部分はバックスラッシュではなくコロンで区切られます。</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-vbscript" data-lang="vbscript">Const MyContextID = 1010407    ' Define a constant for contextID.
Function TestName(CurrentName, NewName)
    If Instr(NewName, "bob") Then    ' Test the validity of NewName.
        ' Raise the exception
        Err.Raise vbObjectError + 513, "MyProj.MyObject", _
        "No ""bob"" allowed in your name", "c:\MyProj\MyHelp.Hlp", _
        MyContextID
    End If
End Function</code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_演算子の概要">37.10. 演算子の概要</h3>

</div>
<div class="sect2">
<h3 id="_statements">37.11. Statements</h3>
<div class="paragraph">
<p><a href="#AppActivate">AppActivate</a></p>
</div>
<div class="paragraph">
<p><a href="#Beep">Beep</a>
<a href="#Call">Call</a>
<a href="#ChDir">ChDir</a>
<a href="#ChDrive">ChDrive</a>
<a href="#Close">Close</a>
<a href="#Const">Const</a>
<a href="#Date">Date</a>
<a href="#Declare">Declare</a>
<a href="#Deftype">Deftype</a>
<a href="#DeleteSetting">DeleteSetting</a>
<a href="#Dim">Dim</a>
<a href="Do&.html#8230;&#8203;Loop">Do&#8230;&#8203;Loop</a>
<a href="#End">End</a>
<a href="#Enum">Enum</a>
<a href="#Erase">Erase</a>
<a href="#Error">Error</a>
<a href="#Event">Event</a>
<a href="#Exit">Exit</a>
<a href="#FileCopy">FileCopy</a>
<a href="For Each&.html#8230;&#8203;Next">For Each&#8230;&#8203;Next</a>
<a href="For&.html#8230;&#8203;Next">For&#8230;&#8203;Next</a>
<a href="#_function">Function</a>
<a href="#Get">Get</a>
<a href="GoSub&.html#8230;&#8203;Return">GoSub&#8230;&#8203;Return</a>
<a href="#GoTo">GoTo</a>
<a href="If&.html#8230;&#8203;Then&#8230;&#8203;Else">If&#8230;&#8203;Then&#8230;&#8203;Else</a>
<a href="#Implements">Implements</a>
<a href="Input .html">Input #</a>
<a href="#Kill">Kill</a>
<a href="#Let">Let</a>
<a href="Line Input .html">Line Input #</a>
<a href="#Load">Load</a>
<a href="#Lock、Unlock">Lock、Unlock</a>
<a href="#LSet">LSet</a>
<a href="#Mid">Mid</a>
<a href="#MkDir">MkDir</a>
<a href="#Name">Name</a>
<a href="#On Error">On Error</a>
<a href="On&.html#8230;&#8203;GoSub、On&#8230;&#8203;GoTo">On&#8230;&#8203;GoSub、On&#8230;&#8203;GoTo</a>
<a href="#Open">Open</a>
<a href="#Option Base">Option Base</a>
<a href="#Option Compare">Option Compare</a>
<a href="#Option Explicit">Option Explicit</a>
<a href="#Option Private">Option Private</a>
<a href="Print .html">Print #</a>
<a href="#Private">Private</a>
<a href="#Property Get">Property Get</a>
<a href="#Property Let">Property Let</a>
<a href="#Property Set">Property Set</a>
<a href="#Public">Public</a>
<a href="#Put">Put</a>
<a href="#RaiseEvent">RaiseEvent</a>
<a href="#Randomize">Randomize</a>
<a href="#ReDim">ReDim</a>
<a href="#Rem">Rem</a>
<a href="#Reset">Reset</a>
<a href="#Resume">Resume</a>
<a href="#RmDir">RmDir</a>
<a href="#RSet">RSet</a>
<a href="#SaveSetting">SaveSetting</a>
<a href="#Seek">Seek</a>
<a href="#Select Case">Select Case</a>
<a href="#SendKeys">SendKeys</a>
<a href="#Set">Set</a>
<a href="#SetAttr">SetAttr</a>
<a href="#Static">Static</a>
<a href="#Stop">Stop</a>
<a href="#Sub">Sub</a>
<a href="#Time">Time</a>
<a href="#Type">Type</a>
<a href="#Unload">Unload</a>
<a href="While&.html#8230;&#8203;Wend">While&#8230;&#8203;Wend</a>
<a href="Width .html">Width #</a>
<a href="#With">With</a>
<a href="Write .html">Write #</a></p>
</div>
<div class="sect3">
<h4 id="_on_error_ステートメントon_error">37.11.1. On Error ステートメント[[On Error]]</h4>
<div class="paragraph">
<p>エラー処理ルーチンを有効にして、プロシージャ内のルーチンの場所を指定します。エ
ラー処理ルーチンを無効にする目的でも使用できます。</p>
</div>
<div class="listingblock">
<div class="title">構文</div>
<div class="content">
<pre class="highlight"><code class="language-vbscript" data-lang="vbscript">On Error GoTo line
On Error Resume Next
**On Error GoTo 0**</code></pre>
</div>
</div>
<div class="paragraph">
<p>On Error ステートメントの構文では、次の形式を使用できます。</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 20%;">
<col style="width: 80%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Statement</th>
<th class="tableblock halign-left valign-top">説明</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">On Error GoTo line</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">必須の_line_ 引数で指定された_行_から始まるエラー処理ルー
チンを有効にします。<br>
_Line_引数には、任意の行ラベルまたは行番号を指定します。<br>
実行時エラーが発生した場合は、を_line_に分岐し、エラー処理ルーチンをアクティブ
にします。<br>
指定した_行_は、 On Errorステートメントと同じプロシージャ内にある必要がありま
す。それ以外の場合は、コンパイル時エラーが発生します。</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">On Error Resume Next</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">実行時エラーが発生したときに、エラーが発生して実行が続行されるステートメントの直後のステートメントに制御が移動することを指定します。 オブジェクトにアクセスするときは、 On Error GoTo の代わりにこの形式を使用してください。</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">On Error GoTo 0</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">現在のプロシージャですべての有効なエラー ハンドラーを無効にします。</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<div class="title">注釈</div>
<p>On Error ステートメントを使用しない場合は、発生するすべての実行時エラーが致命
的となります。つまり、エラー メッセージが表示され、実行が停止します。</p>
</div>
<div class="paragraph">
<p>"Enabled" エラーハンドラーは、 On errorステートメントによって有効にされたもの
です。"アクティブな" エラーハンドラーは、エラー処理のプロセスに含まれる有効な
ハンドラーです。 エラー処理ルーチンがアクティブな間 (error の発生とResume、
<a href="#exit">exit Sub、 Exit Function、またはexit Property</a>ステートメントの間) にエラーが
発生すると、現在のプロシージャのエラーハンドラーはエラーを処理できません。 制
御は、呼び出し元のプロシージャに戻ります。</p>
</div>
<div class="paragraph">
<p>呼び出し元のプロシージャに有効なエラー処理ルーチンがある場合は、エラーを処理す
るためにアクティブ化されます。 呼び出し元のプロシージャのエラーハンドラーがア
クティブである場合は、有効になっているが非アクティブなエラーハンドラが見つかる
まで、制御は前の呼び出しプロシージャを戻します。 非アクティブなエラー処理ルー
チンが存在しない場合、エラーは実際に発生した時点で致命的です。</p>
</div>
<div class="paragraph">
<p>エラーハンドラーが呼び出し元のプロシージャに制御を戻すたびに、そのプロシージャ
が現在のプロシージャになります。 任意のプロシージャでエラーハンドラーによって
エラーが処理された後、 Resumeステートメントで指定された位置にある現在のプロシ
ージャから実行が再開されます。</p>
</div>
<div class="admonitionblock caution">
<table>
<tr>
<td class="icon">
<i class="fa icon-caution" title="Caution"></i>
</td>
<td class="content">
エラー処理ルーチンは、 Sub プロシージャまたは<strong>Function</strong> プロ
シージャではありません。 行ラベルまたは行番号でマークが付けられた、コードのセ
クションのことです。
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>エラー処理ルーチンは、 <a href="#Err">Err</a> オブジェクトの<strong>Number</strong> プロパティの値に依
存して、エラーの原因を特定します。 エラー処理ルーチンは、その他のエラーが発生
する前、またはエラーを発生させる可能性があるプロシージャを呼び出す前に、 Err
オブジェクト内の関連するプロパティ値をテストあるいは保存する必要があります。
Err オブジェクト内のプロパティ値は、最新のエラーのみを反映します。 Err.Number
に対応するエラー メッセージは Err.Description に含まれます。</p>
</div>
<div class="paragraph">
<p>On Error Resume Nextを実行すると、実行時エラーの原因となったステートメントの直
後のステートメント、または on エラーを含むプロシージャからの直前のステートメン
トに従って、ステートメントが続行されます。 次のステートメントを再開します。 こ
のステートメントを使用すると、実行時エラーが発生しても実行を続行できます。 エ
ラー処理ルーチンは、コントロールをプロシージャ内の別の場所に転送するのではなく、
エラーが発生する場所に配置できます。 On Error Resume nextステートメントは、別
のプロシージャが呼び出されたときに非アクティブになります。そのため、そのルーチ
ン内でインラインエラー処理が必要な場合は、呼び出された各ルーチンでOn error
resume nextステートメントを実行する必要があります。</p>
</div>
<div class="admonitionblock caution">
<table>
<tr>
<td class="icon">
<i class="fa icon-caution" title="Caution"></i>
</td>
<td class="content">
他のオブジェクトへのアクセス中に生成されたエラーを処理するとき
に、On Error GoTo よりも On Error Resume Next 構成要素が適している場合がありま
す。 オブジェクトの操作後に Err を確認すると、エラーの発生時にコードがアクセス
していたオブジェクトを明確にできます。 Err.Number にエラー コードを設定したオ
ブジェクトと、最初にエラーを生成したオブジェクト (Err.Source で指定されるオブ
ジェクト) についても確認できます。
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>On Error GoTo 0 は、現在のプロシージャでエラー処理を無効にします。 このステー
トメントは、プロシージャに 0 という番号の行が含まれている場合でも、エラー処理
コードの開始行として行 0 を指定しません。 On Error GoTo 0 ステートメントがない
場合、プロシージャが終了するときに、エラー ハンドラーは自動的に無効にされます。</p>
</div>
<div class="paragraph">
<p>エラーが発生しなかったときに、エラー処理コードが実行されないようにするには、以
下のように、エラー処理ルーチンの直前に、Exit Sub、Exit Function、または Exit
Property ステートメントを挿入します。</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-vbscript" data-lang="vbscript">Sub InitializeMatrix(Var1, Var2, Var3, Var4)
 On Error GoTo ErrorHandler
 . . .
 Exit Sub
ErrorHandler:
 . . .
 Resume Next
End Sub</code></pre>
</div>
</div>
<div class="paragraph">
<p>ここでは、エラー処理コードがExit subステートメントの後に続き、 End sub ステー
トメントの前に、プロシージャフローから分離しています。 エラー処理コードは、プ
ロシージャ内の任意の場所に配置できます。</p>
</div>
<div class="paragraph">
<p>オブジェクトが実行可能ファイルとして実行中の場合、オブジェクト内の未トラップの
エラーは、制御アプリケーションに戻されます。 開発環境では、適切なオプションが
設定されている場合のみ、未トラップのエラーは制御アプリケーションに戻されます。
デバッグ中に、どのオプションを設定する必要があるか、設定の方法、そしてホストが
クラスを作成できるかどうかの詳細については、ホスト アプリケーションの文書を参
照してください。</p>
</div>
<div class="paragraph">
<p>その他のオブジェクトにアクセスするオブジェクトを作成する場合、そこから未処理で
戻されたエラーの処理を試行する必要があります。 このようなエラーを処理できない
場合は、Err.Number 内でエラー コードを自分のエラーの 1 つにマップして、それを
オブジェクトの呼び出し元に戻します。 vbObjectError 定数にエラー コードを追加す
ることにより、エラーを指定する必要があります。 たとえば、エラー コードが 1052
の場合、以下のように割り当てます。</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-vbscript" data-lang="vbscript">Err.Number = vbObjectError + 1052</code></pre>
</div>
</div>
<div class="admonitionblock caution">
<table>
<tr>
<td class="icon">
<i class="fa icon-caution" title="Caution"></i>
</td>
<td class="content">
Windowsダイナミックリンクライブラリ(DLL) または Macintosh コー
ドリソースへの通話中のシステムエラーは、例外を発生させずに、Visual Basic のエ
ラートラップを使用してトラップすることはできません。 DLL 関数を呼び出すときは、
各戻り値の成功または失敗を確認する必要があります (API 仕様による)。エラーが発
生した場合は、 Errオブジェクトの<strong>LastDLLError</strong> プロパティの値を確認してくだ
さい。 LastDLLErrorは常に Macintosh で0を返します。
</td>
</tr>
</table>
</div>
<div class="paragraph">
<div class="title">例</div>
<p>この例では、最初に On Error GoTo ステートメントを使用して、プロシージャ内のエ
ラー処理ルーチンの場所を指定します。 この例では、開かれたファイルを削除しよう
としたときに、エラー番号 55 が生成されます。 エラーはエラー処理ルーチンで処理
され、次に、制御がエラーを起こしたステートメントに戻されます。 On Error GoTo 0
ステートメントは、エラー トラッピングをオフにします。</p>
</div>
<div class="paragraph">
<p>次に、On Error Resume nextステートメントを使用してエラートラップを延期し、次の
ステートメントによって生成されたエラーのコンテキストが特定のものとして認識され
るようにします。 エラーが処理された後で、 Err.Clear が使用され、 Err オブジェ
クトのプロパティを消去していることに注意してください。</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-vbscript" data-lang="vbscript">Sub OnErrorStatementDemo()
 On Error GoTo ErrorHandler ' Enable error-handling routine.
 Open "TESTFILE" For Output As #1 ' Open file for output.
 Kill "TESTFILE" ' Attempt to delete open
 ' file.
 On Error Goto 0 ' Turn off error trapping.
 On Error Resume Next ' Defer error trapping.
 ObjectRef = GetObject("MyWord.Basic") ' Try to start nonexistent
 ' object, then test for
'Check for likely Automation errors.
 If Err.Number = 440 Or Err.Number = 432 Then
 ' Tell user what happened. Then clear the Err object.
 Msg = "There was an error attempting to open the Automation object!"
 MsgBox Msg, , "Deferred Error Test"
 Err.Clear ' Clear Err object fields
 End If
Exit Sub ' Exit to avoid handler.
ErrorHandler: ' Error-handling routine.
 Select Case Err.Number ' Evaluate error number.
 Case 55 ' "File already open" error.
 Close #1 ' Close open file.
 Case Else
 ' Handle other situations here...
 End Select
 Resume ' Resume execution at same line
 ' that caused the error.
End Sub</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_ongosubongoto_ステートメントongosubongotoongosubongoto">37.11.2. On&#8230;&#8203;GoSub、On&#8230;&#8203;GoTo ステートメント[[On&#8230;&#8203;GoSub]][[On&#8230;&#8203;GoTo]][[On&#8230;&#8203;GoSub、On&#8230;&#8203;GoTo]]</h4>
<div class="paragraph">
<p>式の値に応じて、複数の指定した行のいずれかに分岐します。</p>
</div>
<div class="listingblock">
<div class="title">構文</div>
<div class="content">
<pre class="highlight"><code class="language-vbscript" data-lang="vbscript">On expression GoSub destinationlist
On expression GoTo destinationlist</code></pre>
</div>
</div>
<div class="paragraph">
<p>On&#8230;&#8203;GoSub ステートメントおよび On&#8230;&#8203;GoTo ステートメントの構文には、次の指定項
目があります。</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 20%;">
<col style="width: 80%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">パーツ</th>
<th class="tableblock halign-left valign-top">説明</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">expression</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">必ず指定します。 0 以上 255 以下の整数に評価される任意の数値式です。 expression が整数以外の数値の場合は、評価の前に四捨五入されます。</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">destinationlist</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">必須。 コンマで区切られた行番号または行ラベルのリスト。</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<div class="title">解説</div>
<p>expression の値により、destinationlist 内のどの行に分岐するかが決まります。
expression の値が 1 より小さい場合やリスト内の項目数よりも大きい場合、結果は次
のいずれかになります。</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 20%;">
<col style="width: 80%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">expression の値</th>
<th class="tableblock halign-left valign-top">その結果</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">0 に等しい</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">On&#8230;&#8203;GoSub または On&#8230;&#8203;GoTo の次のステートメントに制御が移動します。</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">リスト内の項目数より大きい</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">On&#8230;&#8203;GoSub または On&#8230;&#8203;GoTo の次のステートメントに制御が移動します。</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">負の値</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">エラーが発生します。</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">255 より大きい</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">エラーが発生します。</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>同じリスト内に行番号と行ラベルが混在していてもかまいません。 On&#8230;&#8203;GoSub および
On&#8230;&#8203;GoTo には、任意の数の行番ラベルと行番号を使用できます。 ただし、1 行に収
まらない数のラベルや番号を使用する場合は、行連結文字を使用して、論理行が次の物
理行につながるようにする必要があります。</p>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
Select Case を使用すると、より構造化された柔軟な方法で複数の分岐を実行
できます。
</td>
</tr>
</table>
</div>
<div class="paragraph">
<div class="title">例</div>
<p>この例では、On&#8230;&#8203;GoSub ステートメントと On&#8230;&#8203;GoTo ステートメントを使用して、そ
れぞれサブルーチンと行番号に分岐します。</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-vbscript" data-lang="vbscript">Sub OnGosubGotoDemo()
Dim Number, MyString
 Number = 2 ' Initialize variable.
 ' Branch to Sub2.
 On Number GoSub Sub1, Sub2 ' Execution resumes here after
 ' On...GoSub.
 On Number GoTo Line1, Line2 ' Branch to Line2.
 ' Execution does not resume here after On...GoTo.
 Exit Sub
Sub1:
 MyString = "In Sub1" : Return
Sub2:
 MyString = "In Sub2" : Return
Line1:
 MyString = "In Line1"
Line2:
 MyString = "In Line2"
End Sub</code></pre>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_visual_basic_add_in_model_reference">37.12. Visual Basic Add-in Model reference</h3>
<div class="paragraph">
<p>Visual Basic エディターのカスタマイズ方法と、環境を拡張するために使用できるオ
ブジェクト モデルについて説明します。</p>
</div>
<div class="ulist">
<ul>
<li>
<p>コレクション</p>
</li>
<li>
<p>イベント</p>
</li>
<li>
<p>メソッド</p>
</li>
<li>
<p>オブジェクト</p>
</li>
<li>
<p>プロパティ</p>
</li>
</ul>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_tip">38. tip</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_yyyymmddss時刻のフォーマット">38.1. YYYYMMDDSS時刻のフォーマット</h3>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-vbscript" data-lang="vbscript">dim now_time
dim now_value
now_value = now()
now_time = cstr(year(now_value))
now_time = now_time &amp; right("0" &amp; cstr( month ( now_value) ), 2)
now_time = now_time &amp; right("0" &amp; cstr( day   ( now_value) ), 2)
now_time = now_time &amp; "_"
now_time = now_time &amp; right("0" &amp; cstr( hour  ( now_value) ), 2)
Wscript.echo now_time</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_vbscriptでiniファイルを使う">38.2. vbscriptでiniファイルを使う</h3>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-vbscript" data-lang="vbscript">Function ReadIni(FilePath, Section, Key)

    Const ForReading  = 1
    Const ForWriting = 2
    Const ForAppending = 8

    dim intEqualPos
    dim fso, IniFile
    dim sFilePath, sKey, sLeftString, sLine, sSection

    set fso = CreateObject("Scripting.FileSystemObject")
    ReadIni = ""
    sFilePath = trim( FilePath)
    sSection = trim(Section)
    sKey = trim(Key)
    if fso.FileExists(sFilePath) then
        set IniFile = fso.OpenTextFile(sFilePath, ForReading,  False)

        do while IniFile.AtEndOfStream = false
            sLine = trim (IniFile.ReadLine)
            if LCase(sLine) = "[" &amp; LCase(sSection) &amp; "]" then
                sLine = trim(IniFile.ReadLine)
                do while Left ( sLine, 1) &lt;&gt;  "["
                    intEqualPos = InStr(1, sLine, "=", 1)

                    if intEqualPos &gt; 0 Then
                        sLeftString = Trim( Left(sLine , intEqualPos - 1) )

                        if LCase(sLeftString) = LCase(sKey) Then
                            ReadIni = Trim(Mid( sLine, intEqualPos +1))
                            if ReadIni = "" Then
                                ReadIni = " "
                            end if

                            exit Do
                        end if
                    End if

                    if IniFile.AtEndOfStream Then
                        Exit Do
                    end if
                    sLine = Trim(IniFile.readline)
                Loop
            End If
        Loop
        IniFile.Close
    else
        ReadIni = ""
    end if

end Function


sub Main
    dim FilePath , Section, Key
    '	FilePath = "C:\Users\server1\Documents\excelマクロ\vbscript サンプル\ini\readini.ini"
    FilePath = ".\readini.ini"
    Section = "ファイル名"
    '	Key = "fuga"
    msgbox  ReadIni(FilePath, Section, 1)
    msgbox  ReadIni(FilePath, Section, 2)
    msgbox  ReadIni(FilePath, Section, 3)

    Section = "ファイル名"
    '	Key = "fuga"
    Section = "組み合わせ"
    dim msg
    msg = ReadIni(FilePath, Section, 1)
    msg = msg &amp; ReadIni(FilePath, Section, 2)
    msg = msg &amp; ReadIni(FilePath, Section, 3)


    msgbox msg


end sub

call Main</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_gui_と_cui_のどちらで実行されたかを判定する方法">38.3. GUI と CUI のどちらで実行されたかを判定する方法</h3>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-vbscript" data-lang="vbscript">Option Explicit

Dim strExe

'スクリプトを起動した exe ファイル名を取得
'（exe のフルパスを \ で分割して配列にした後、最後の要素の文字列を取得）
strExe = split(WSCript.FullName, "\")(UBound(split(WSCript.FullName, "\")))

Select Case UCase(strExe)
  Case "WSCRIPT.EXE"
    WSCript.Echo WSCript.FullName &amp; "(GUI)で起動しました。"
  Case "CSCRIPT.EXE"
    WSCript.Echo WSCript.FullName &amp; "(CUI)で起動しました。"
End Select</code></pre>
</div>
</div>
<div class="paragraph">
<p><a href="https://bayashita.com/p/category/show/21">[VBScript</a>の記事一覧 : バヤシタ]</p>
</div>
</div>
</div>
</div>
</div>
<div id="footer">
<div id="footer-text">
Last updated 2021-04-12 09:33:55 +0900
</div>
</div>
</body>
</html>